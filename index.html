<!doctype html>
<html __wid="8iiFCgMH" version="12" mode="edit"><HEAD __wid="nyQjClRO"><META __wid="VC-iR3Y0" name="mobile-web-app-capable" content="yes"/><META name="apple-mobile-web-app-capable" content="yes" __wid="h-Ul6mwY"/><META name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" __wid="iiS6bfZA"/><SCRIPT __wid="znuXkD9m" id="script-main">webstrate.on("loaded", function () { new Function(document.querySelector("#bootstrap").textContent)(); });</SCRIPT><TITLE __wid="F6LQLpsp">Codestrate</TITLE></HEAD><BODY __wid="KajDX5Up" class>































<DIV __wid="_Y8mEnp4" id="sections"><DIV class="section section-hidden" name="Codestrate Log" __wid="6WniXaU3" data-id="xkt5zenG"><DIV class="paragraph body-paragraph locked" name="Documentation" __wid="jpXvKUZw" data-id="DrMaEVSz"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="gBmsN7jw"><H2 __wid="jhmhuwyt">Description</H2>
<DIV __wid="VneVsyzM">The <B __wid="cFeH5tGf">Codestrate Log</B> logs acitivies like updates of system sections or packages.</DIV>
<DIV __wid="UDuLvcne">It can be removed at any time by the user. This section will be newly created automatically if it is not available.</DIV></DIV></DIV><DIV class="paragraph body-paragraph locked" name="Persistent Log Pull System Sections" __wid="N5HsL3kh" data-id="kxWdaP8u"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" id="persistent-log-pull-system-sections" class="persistent-log" __wid="CVMGKYWc"><P class="info" __wid="BWDeAivm">[2018-02-09T15:09:33.248Z] Updating system sections from /itchy-cow-67/ finished (version 75751).</P><P __wid="yyWeDvk4">[2018-02-09T15:09:33.248Z] Updated system section "4CsvECcC".</P><P class="info" __wid="igmEdXdF">[2018-02-09T15:09:33.245Z] Updating system sections from /itchy-cow-67/ started (version 75751).</P><P class="info" __wid="Vzmh82MG">[2018-02-09T14:28:18.761Z] Updating system sections from /brown-rattlesnake-86/ finished (version 75745).</P><P __wid="GRp6wMdp">[2018-02-09T14:28:18.761Z] Updated system section "PJGnfYsy".</P><P __wid="V5ihWZR4">[2018-02-09T14:28:18.756Z] Updated system section "QF65zNxe".</P><P class="info" __wid="bZJM3F2p">[2018-02-09T14:28:18.752Z] Updating system sections from /brown-rattlesnake-86/ started (version 75745).</P><P class="info" __wid="TKGLspTF">[2018-02-09T14:26:10.151Z] Updating system sections from /brown-rattlesnake-86/ finished (version 75742).</P><P __wid="Nu9CNqLq">[2018-02-09T14:26:10.151Z] Updated system section "QF65zNxe".</P><P class="info" __wid="PSvqzGdt">[2018-02-09T14:26:10.146Z] Updating system sections from /brown-rattlesnake-86/ started (version 75742).</P><P class="info" __wid="TssUurYq">[2018-02-09T13:35:34.214Z] Updating system sections from /brown-rattlesnake-86/ finished (version 75739).</P><P __wid="YehjQuta">[2018-02-09T13:35:34.214Z] Updated system section "QF65zNxe".</P><P class="info" __wid="sADmsjue">[2018-02-09T13:35:34.211Z] Updating system sections from /brown-rattlesnake-86/ started (version 75739).</P></DIV></DIV></DIV><DIV name="Bootstrapping" class="section section-hidden" data-type="system" data-group="basic" data-id="QF65zNxe" __wid="5r4ZbGeg"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" draggable="false" data-id="DTYb8h2d" __wid="UBPFGVFF"><DIV data-type="content" contenteditable="false" class="section-documentation" type="text/html" codemirror="true" __wid="yJmaBx6B"><H2 __wid="GGLrzH7n">Codestrate Bootstrapping</H2>A codestrate is bootstrapped with a single line of code that is in a script tag in the head of the document. The script will then query for the code paragraph with the ID <CODE __wid="7dtfZNjP">#bootstrap</CODE> (see below) and execute the code in a Function object. The scope of code paragraph execution does not create a closure to their surrounding context preventing any interferences with other code executions. The #bootstrap code then executes all code that has a class .bootstrap-module before paragraphs with "run-on-load" (green running man) get executed.<DIV __wid="nNsJray8"><BR __wid="VHr5gqVb"/></DIV><DIV __wid="ve4HzAdp">The <CODE __wid="4LaY6NPD">.bootstrap</CODE>-module code paragraphs add a loading screen, establish <I __wid="LGzPyf93">virtual machines</I>Â for JavaScript and JSON, enable "run-on-load" code paragraph execution, add functions to import libraries and require code from other code paragraphs, and add query extensions (e.g., query selectors that are based on MutationObserver). The virtual machines allow execution of JavaScript code after page load and without creating a closure to their surrounding context.<BR __wid="MzzcXR8V"/><H2 __wid="yeHPajde">Attention</H2><DIV __wid="3c66NM9h">Do not change the ID of the #bootstrap code. It needs to be #bootstrap, otherwise the codestrate will not bootstrap.</DIV></DIV><H1 __wid="JqiPqTDe">APIs</H1><H2 __wid="B2wLDNJH">Commands API</H2><DIV __wid="mrZTB3JM">The Commands API is used to store commands, which should be available everywhere in a codestrate. A command consists of the following three parts:</DIV><DIV __wid="D5wKudHw"><UL __wid="iYU6vQ8S"><LI __wid="YsHXpT2S"><CODE __wid="Zr68VgQa">id</CODE>: The identifier of a command. Use points to divide the command id from it's package or prefix (e.g. <CODE __wid="gMr8hRye">codestrates.sections.addSection</CODE>).</LI><LI __wid="vmjxikb6"><CODE __wid="ySsTCkRr">name</CODE>: A human readable name/description of the command.</LI><LI __wid="sbtTpCn9"><CODE __wid="3gcenjaD">action</CODE>: A callback function, containing the action of a command.</LI><LI __wid="rFkhPsy5"><CODE __wid="Y54JtbwX">description</CODE>: An optional description of the command.</LI></UL><DIV __wid="5vHXyJkP">To manage, add or remove commands the following functions exist:</DIV></DIV><DIV __wid="bYpmLyBZ"><UL __wid="2SE9t3UX"><LI __wid="CaFKUNSF"><CODE __wid="S5cdQshw">Codestrate.commands</CODE>: Returns the full list of commands.</LI><LI __wid="xSBuMjFW"><CODE __wid="76qY2GQu">Codestrate.getCommand(id)</CODE>: Returns the command with the given id.</LI><LI __wid="df4x8VrX"><CODE __wid="87F3zjcF">Codestrate.executeCommand(id)</CODE>: Executes the command with given id.</LI><LI __wid="dCqEcBu8"><CODE __wid="7FdiUPc8">Codestrate.addCommand(id, name, action, description = "")</CODE>: Adds a new command.</LI><LI __wid="97C3fHJb"><CODE __wid="DrTRwWJ9">Codestrate.removeCommand(id)</CODE>: Removes a exisiting command.</LI><LI __wid="S7ZpZDjf"><CODE __wid="CZ6ztxj2">Codestrate.updateCommand(id, name, action, description = "")</CODE>: Removes a existing command and then adds the updated version.<BR __wid="abQQUb4E"/></LI></UL><H2 __wid="CX75JjRb">KeyBindings API</H2></DIV><DIV __wid="NubcQp3N">The KeyBindings API works in conjunction with the Commands API. It allows to map commands to keybindings. A keybinding consists of the following three parts:</DIV><DIV __wid="VbBdcrdC"><UL __wid="5tGMyx6h"><LI __wid="9NEse9Hg"><CODE __wid="WbrRH8Jg">id</CODE>: The id of a command.</LI><LI __wid="LCQ4fewk"><CODE __wid="TrrFzRmL">key</CODE>: The keyboard shortcut (see <A href="https://craig.is/killing/mice" target="_blank" __wid="ix2FY8RM">here</A> for a list of supported keys).</LI><LI __wid="a3iqxpnF"><CODE __wid="zKMBsjSS">preventDefault</CODE>: If set true, the shortcut will prevent the default shortcut action to be executed.</LI></UL><DIV __wid="ss5RmbH7">To manage, add or remove keybindings the following functions exit:</DIV></DIV><DIV __wid="VeJcjvcG"><UL __wid="ZmjcBREd"><LI __wid="bMHtSTn3"><CODE __wid="HySbub8D">Codestrate.keyBindings</CODE>: Returns a list of all keybindings.</LI><LI __wid="77Zt7xR4"><CODE __wid="wKZZjfuf">Codestrate.addKeyBinding(id, key, preventDefault = false)</CODE>: Adds a new keybinding.</LI><LI __wid="EcDYkHDT"><CODE __wid="jqnR7cCd">Codestrate.removeKeyBinding(id, key)</CODE>: Removes a existing keybinding.</LI></UL><DIV __wid="V4c3dcjE"><B __wid="A5gAnhRy">Hint</B>: Instead of using <CODE __wid="6Ehp7cVN">cmd</CODE> and <CODE __wid="2jxJnPSv">ctrl</CODE> one can use <CODE __wid="fRcGCkeS">mod</CODE>, which is <KBD __wid="wCAewpGL">ctrl</KBD> on Windows and <KBD __wid="uxk2cJYk">cmd</KBD> on macOS.</DIV></DIV></DIV></DIV>
<DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="UQHBUNEJ" __wid="shPa3QvQ"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="W3i54dCC">{
	"version": "1.2.2",
	"description": "Bootstraps the bootstrap code and executes all other 'run-on-load' paragraphs.",
	"changelog":
	{

		"1.0": "Initital Release",
		"1.0.1": "Added description.",
		"1.1": "Changed Execute Code Paragraphs and expose Codestrate.executeParagraphsSync function to execute multiple paragraphs in sync order.",
		"1.2": "Added Commands and KeyBindings APIs.",
		"1.2.1": "Introduced Codestrate.addEventListener(\"loaded\", () => {}) event and a new event mechansims allowing to create custom events on the codestrate object (also allowing for immediate trigger event on addEventListener depending on an immediateTriggerEvent function parameter on the Codestrate.createEvent function).",
		"1.2.2": "Loading overlay and disconnect overlay have a close button (X) at the top right to close the overlay."
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Bootstrap Code" draggable="false" last-execution-state="success" data-id="usn4MyQZ" __wid="7FgB7Xwx"><PRE data-type="content" type="text/javascript" id="bootstrap" __wid="DxfBCp62">window.getParameterByName = function (name, url) {
  if (!url) {
    url = window.location.href;
  }
  name = name.replace(/[\[\]]/g, "\\$&");
  var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
    results = regex.exec(url);
  if (!results) return null;
  if (!results[2]) return '';
  return decodeURIComponent(results[2].replace(/\+/g, " "));
};

const exec = getParameterByName("exec");

// Do not execute bootstrap code. This is also used by pull sections to minimize transclusion time
// of codestrate from which sections will be pulled.
if (exec === "no") {
  // const loadedEvent = new CustomEvent("codestrateloaded");
  // window.dispatchEvent(loadedEvent);
  return;
}

// Bluntly override Codestrate object if it exists
const Codestrate = window.Codestrate = {};

// Define properties on codestrate object and make them not writable (default)
Object.defineProperties(Codestrate, {

  version: {
    get() {
      return document.documentElement.getAttribute("version") || 0;
    },
    set(version) {
      document.documentElement.setAttribute("version", version);
    },
  },

  mode: {
    get() {
      return document.documentElement.getAttribute("mode") || "edit";
    },
    set(mode) {
      if (typeof mode === 'undefined') {
        document.documentElement.removeAttribute("mode");
      } else {
        document.documentElement.setAttribute("mode", mode);
      }
    },
  },
  OS: {
    get() {
      return {
        isMac() {
          return (navigator.userAgent.indexOf("Mac OS X") != -1);
        }
      };
    }
  }
});

/**
 * Execute bootstrap modules. All code paragraphs with bootstrap-module class will
 * be executed in the order in which they are defined. Changing the order can
 * break the Codestrate.
 */
var modules = document.querySelectorAll(".bootstrap-module");

if (!modules) return;

var len = modules.length;

for (var i = 0; i &lt; len; i++) {
  let module = modules[i];
  let paragraph = module.closest('.paragraph');

  let codeSource = paragraph.getAttribute("id") ||
    (paragraph.getAttribute("name") &&
      paragraph.getAttribute("name").replace(/\W/g, "_")) ||
    `VM${Date.now()}`;

  let code = modules[i].textContent;
  code = `${code}\n//# sourceURL=${codeSource}`;
  new Function(code)();
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Event Handling" style data-id="N3B5Vng9" __wid="rpaUtyuf"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="AuUuvpyV">// available codestrate events
const events = [];

// registered event handlers
const eventHandlers = {};

const createEvent = (name, triggerImmediately = false, immediateEventObject = undefined) => {
	events.push({
		name,
		triggerImmediately,
		immediateEventObject
	});
};

const checkEvent = (name) => {
	// throw event if event wasn't created
	if (!events.some((event) => event.name === name)) {
		throw new Error(`event "${name}" does not exist`);
	}
	return true;
};

const shouldTriggerEventImmediately = (name) => {
	let eventMetadata = events.find((event) => event.name === name);
	if (eventMetadata.triggerImmediately) {
		if (typeof eventMetadata.triggerImmediately === 'function') {
			return eventMetadata.triggerImmediately();
		}
		return eventMetadata.triggerImmediately;
	}
	return false;
};

const addEventListener = (name, handler) => {
	checkEvent(name);

	if (!eventHandlers.hasOwnProperty(name)) {
		eventHandlers[name] = [];
	}
	let handlers = eventHandlers[name];
	handlers.push(handler);

	// checks if event should be triggered immediately, e.g., useful for the loaded event that should
	// trigger the event handler immediately if the codestrate has already loaded
	if (shouldTriggerEventImmediately(name)) {
		let eventMetadata = events.find((event) => event.name === name);
		let eventObject;
		if (typeof eventMetadata.immediateEventObject === 'function') {
			eventObject = eventMetadata.immediateEventObject();
		}
		else {
			eventObject = eventMetadata.immediateEventObject;
		}
		handler(eventObject);
	}
};

const removeEventListener = (name, handler = undefined) => {
	checkEvent(name);

	if (!eventHandlers.hasOwnProperty(name)) {
		return;
	}

	// Remove all handlers for this event
	if (!handler) {
		delete eventHandlers[name];
		return;
	}

	let handlers = eventHandlers[name];
	let idx = handlers.indexOf(handler);
	handlers.splice(idx, 1);
};

const dispatchEvent = (name, event) => {
	checkEvent(name);

	if (eventHandlers.hasOwnProperty(name)) {
		let handlers = eventHandlers[name];
		for (let i = 0; i &lt; handlers.length; i++) {
			handlers[i](event);
		}
	}
};

Object.defineProperty(Codestrate, "events", {
	get() {
		return events;
	}
});

Codestrate.createEvent = createEvent;
Codestrate.addEventListener = addEventListener;
Codestrate.removeEventListener = removeEventListener;
Codestrate.dispatchEvent = dispatchEvent;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="YTQS3snR" name="Loaded Event Handling" __wid="VzhM9dfB"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="BPCTsRtD">// Codestrate has loaded state
let loaded = false;

// create loaded event
Codestrate.createEvent("loaded", () => {
	return loaded;
});

// Codestrate loaded property
Object.defineProperty(Codestrate, "loaded", {
  get() {
    return loaded;
  }
});

// create hook to dispatch loaded event on window object to allow transcluders of this codestrate to
// register an event handler for codestrateloaded events
Codestrate.addEventListener("loaded", (event) => {

	// flag codestrate as loaded
	loaded = true;

  const loadedEvent = new CustomEvent("codestrateloaded");
  window.dispatchEvent(loadedEvent);
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Get Parameter By Name Function" data-id="AfanMQdJ" style __wid="buGW3Jii"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="X8UFAaC5">if (!Codestrate.hasOwnProperty("params")) {

  /**
   * Creates an array of all url parameters
   */
  const params = {};
  const paramsString = window.location.search.substring(1).split('&');
  for (let i = 0; i &lt; paramsString.length; i++) {
    let paramString = paramsString[i];

    // Ignore if parameter string is empty
    if (!paramString || paramString === "") {
      continue;
    }

    let keyValue = paramsString[i].split('=');
    let key = keyValue[0];
    let value = keyValue[1] && decodeURIComponent(keyValue[1].replace(/\+/g, " "));

    // Try to parse value into a JavaScript object or primitive type (e.g., bool), ignore if it fails
    try {
      value = JSON.parse(value);
    } catch (error) {
      // Ignore
    }

    params[key] = value;
  }

  Object.defineProperty(Codestrate, 'params', {
    get: () => {
      return {
        _params: params,
        has(name) {
          return this._params.hasOwnProperty(name);
        },
        get(name, defaultValue = undefined) {
          return this.has(name) ? this._params[name] : defaultValue;
        }
      };
    }
  });
}

// @deprecated, will be removed soon
const getParameterByName = function (name, url) {
  console.warn(`window.getParameterByName is deprecated; use Codestrate.params.get(name, defaultValue)`);

  if (!url) {
    url = window.top.location.href;
  }
  name = name.replace(/[\[\]]/g, "\\$&");
  var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
    results = regex.exec(url);
  if (!results) return null;
  if (!results[2]) return '';
  return decodeURIComponent(results[2].replace(/\+/g, " "));
};

window.getParameterByName = getParameterByName;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Polyfills" data-id="kBAUzKmQ" style __wid="NAaLVHpG"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="bfUfHvLH">if (window.Element && !Element.prototype.closest) {

	console.log('Adding polyfill for Element.prototype.closest');

	Element.prototype.closest =
		function (s) {
		var matches = (this.document || this.ownerDocument).querySelectorAll(s),
				i,
				el = this;
		do {
			i = matches.length;
			while (--i >= 0 && matches.item(i) !== el) {};
		} while ((i &lt; 0) && (el = el.parentElement));
		return el;
	};
}

if (!Element.prototype.matches) {

	console.log('Adding polyfill for Element.prototype.matches');

	Element.prototype.matches =
		Element.prototype.matchesSelector ||
		Element.prototype.mozMatchesSelector ||
		Element.prototype.msMatchesSelector ||
		Element.prototype.oMatchesSelector ||
		Element.prototype.webkitMatchesSelector ||
		function (s) {
		var matches = (this.document || this.ownerDocument).querySelectorAll(s),
				i = matches.length;
		while (--i >= 0 && matches.item(i) !== this) {}
		return i > -1;
	};
}

// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18
if (!Array.prototype.forEach) {

	console.log('Adding polyfill for Array.prototype.forEach');

	Array.prototype.forEach = function (callback /*, thisArg*/ ) {

		var T, k;

		if (this == null) {
			throw new TypeError('this is null or not defined');
		}

		// 1. Let O be the result of calling toObject() passing the
		// |this| value as the argument.
		var O = Object(this);

		// 2. Let lenValue be the result of calling the Get() internal
		// method of O with the argument "length".
		// 3. Let len be toUint32(lenValue).
		var len = O.length >>> 0;

		// 4. If isCallable(callback) is false, throw a TypeError exception.
		// See: http://es5.github.com/#x9.11
		if (typeof callback !== 'function') {
			throw new TypeError(callback + ' is not a function');
		}

		// 5. If thisArg was supplied, let T be thisArg; else let
		// T be undefined.
		if (arguments.length > 1) {
			T = arguments[1];
		}

		// 6. Let k be 0
		k = 0;

		// 7. Repeat, while k &lt; len
		while (k &lt; len) {

			var kValue;

			// a. Let Pk be ToString(k).
			//    This is implicit for LHS operands of the in operator
			// b. Let kPresent be the result of calling the HasProperty
			//    internal method of O with argument Pk.
			//    This step can be combined with c
			// c. If kPresent is true, then
			if (k in O) {

				// i. Let kValue be the result of calling the Get internal
				// method of O with argument Pk.
				kValue = O[k];

				// ii. Call the Call internal method of callback with T as
				// the this value and argument list containing kValue, k, and O.
				callback.call(T, kValue, k, O);
			}
			// d. Increase k by 1.
			k++;
		}
		// 8. return undefined
	};
}

if (!window.requestAnimationFrame) {

	console.log('Adding polyfill for window.requestAnimationFrame');

	// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
	// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating

	// requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel

	// MIT license

	(function () {
		var lastTime = 0;
		var vendors = ['ms', 'moz', 'webkit', 'o'];
		for (var x = 0; x &lt; vendors.length && !window.requestAnimationFrame; ++x) {
			window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
			window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||
				window[vendors[x] + 'CancelRequestAnimationFrame'];
		}

		if (!window.requestAnimationFrame)
			window.requestAnimationFrame = function (callback, element) {
				var currTime = new Date().getTime();
				var timeToCall = Math.max(0, 16 - (currTime - lastTime));
				var id = window.setTimeout(function () {
					callback(currTime + timeToCall);
				},
																	 timeToCall);
				lastTime = currTime + timeToCall;
				return id;
			};

		if (!window.cancelAnimationFrame)
			window.cancelAnimationFrame = function (id) {
				clearTimeout(id);
			};
	}());
}

if (!Element.prototype || !CharacterData.prototype || !DocumentType.prototype) {

	console.log('Adding polyfill for {Element.prototype, CharacterData.prototype, DocumentType.prototype}.replaceWith');

	// from: https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/replaceWith()/replaceWith().md
	(function (arr) {
		arr.forEach(function (item) {
			if (item.hasOwnProperty('replaceWith')) {
				return;
			}
			Object.defineProperty(item, 'replaceWith', {
				configurable: true,
				enumerable: true,
				writable: true,
				value: function replaceWith() {
					var argArr = Array.prototype.slice.call(arguments),
							docFrag = document.createDocumentFragment();

					argArr.forEach(function (argItem) {
						var isNode = argItem instanceof Node;
						docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));
					});

					this.parentNode.replaceChild(docFrag, this);
				}
			});
		});
	})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="AhVjMmTX" name="Bind & Unbind Function" style __wid="F3aPersj"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="9kw5n4CV">Function.prototype.bind = (function(origBind) {
  return function() {
		let that = this.unbind();
		var fn = origBind.apply(that, arguments);
    fn.__origFn__ = that.__origFn__ || that;
    return fn;
  };
}(Function.prototype.bind));

Function.prototype.unbind = function() {
  return this.__origFn__ || this;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Random String" draggable="false" data-id="HRefSutb" style __wid="9ctYEpGX"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="J2GKvHTc">Codestrate.util = {
	/**
	 * Get random string of size.
	 * @param  {int}    size     Expected length of string (optional).
	 * @param  {string} alphabet List of characters to be used in string (optional).
	 * @return {string}          Generated string.
	 * @public
	 */
	randomString(size = 8,
								// Does not include 0, O, o, 1, I, l for readability.
								alphabet = "23456789abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ") {
		const len = alphabet.length;
		let str = "";
		while (size--) {
			str += alphabet[this.random(0, len)];
		}
		return str;
	},

	/**
	 * Get random integer from interval [min, max). Unbiased and evenly distributed (or close to).
	 * @param  {int} min Minimum number, inclusive.
	 * @param  {int} max Maximum number, exclusive.
	 * @return {int}     Random number in interval [min, max);
	 * @public
	 */
	random(min, max) {
		return Math.floor(min + Math.random() * (max - min));
	}
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="6MetzGEq" name="Overlay Helper" __wid="uzDv5kst"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="utFeg24Z">Codestrate.createProgressOverlay = () => {

  // Hide document while loading all external webstrates.
  const loadingContainer = document.createElement("transient");
  loadingContainer.classList.add("overlay");

  const loadingIndicator = document.createElement("div");
  loadingIndicator.classList.add("loading-indicator");

  const centerPiece = document.createElement("div");
  centerPiece.classList.add("center-piece");
  centerPiece.appendChild(loadingIndicator);
  loadingContainer.appendChild(centerPiece);

  const closeButton = document.createElement("div");
  closeButton.classList.add("close");
  closeButton.innerHTML = `&lt;i class="material-icons">close&lt;/i>`;
  loadingContainer.appendChild(closeButton);

  // remove loading container on click on close button
  closeButton.addEventListener("click", () => {
    loadingContainer.remove();
  });

  return loadingContainer;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Loading Indicator" data-id="U6W7p2mW" style __wid="ckhyhGt4"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="AdrfXGFx">let overlay = Codestrate.createProgressOverlay();
overlay.classList.add("loading");
document.body.appendChild(overlay);

const removeOverlay = () => {
  // Push to next macro task to allow CSS of codestrate to be properly applied before removing
  // the loading indicator. Otherwise it will be a bit jaggy
  setTimeout(() => {
    setTimeout(() => {
      overlay.remove();
    }, 0);
  }, 0);
};

// remove loading indicator after codestrate loaded
Codestrate.addEventListener("loaded", removeOverlay);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Disconnect / Reconnect Code" draggable="false" style data-id="7NLAf26s" __wid="QUS7b7eA"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="3xRAcHgd">let overlay;

const showOfflineOverlay = () => {
  if (!overlay) {
    overlay = Codestrate.createProgressOverlay();
    overlay.classList.add("disconnected");
    document.body.appendChild(overlay);
  }
};

webstrate.on("reconnect", function () {
  if (overlay) {
    overlay.remove();
    overlay = null;
  }
});

webstrate.on("disconnect", function () {
  showOfflineOverlay();
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Query Extensions" draggable="false" data-id="gbYXPcgb" style __wid="CLNMv6zs"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="zAW9csHa">// The Codestrates Query Extension do not trigger events for elements with class "template" or
// elements that have a parent with class "template". This is a temporary solution until actual
// HTML5 template elements are supported within Codestrates.

/**
 * Ignore mutations for elements with class template or for elements that have a parent element
 * with class template
 */
const isMutationAllowed = (element) => {
	return !element.closest(".template");
};

/**
 * The live query selector
 */
const liveQuerySelectorAll = function (selector, observerOptions = { subtree: true, childList: true }) {

	const elements = this.querySelectorAll(selector);

	let addResolve;
	let removeResolve;

	let observer;
	if (observerOptions) {
		observer = new MutationObserver(mutations => {

			mutations.forEach(mutation => {

				switch (mutation.type) {
					case "childList":

						if (removeResolve) {
							Array.prototype.forEach.call(mutation.removedNodes, (node) => {
								if (node.nodeType !== 1) return;

								try {
									if (node.matches(selector)) {
										removeResolve(node);
									}

									if (observerOptions.subtree) {
										const subNodes = node.querySelectorAll(selector);
										Array.prototype.forEach.call(subNodes, (subNode) => removeResolve(subNode));
									}
								} catch (error) {
									window.console.error(error, node);
								}
							});
						}

						if (addResolve) {
							Array.prototype.forEach.call(mutation.addedNodes, (node) => {
								if (node.nodeType !== 1) return;

								try {
									if (node.matches(selector)) {
										addResolve(node);
									}

									if (observerOptions.subtree) {
										const subNodes = node.querySelectorAll(selector);
										Array.prototype.forEach.call(subNodes, (subNode) => addResolve(subNode));
									}
								} catch (error) {
									window.console.error(error, node);
								}
							});
						}
						break;
				}
			});
		});
		observer.observe(this, observerOptions);
	}

	const resolver = {
		added(resolve) {

			if (typeof resolve !== "function")
				throw new Error("First parameter needs to be a function");

			// Add resolve function that also checks for allowed mutations
			addResolve = (element) => {
				if (!isMutationAllowed(element)) return;
				resolve(element);
			};

			// Immediately callback resolve function to notifiy callee about initial elements
			Array.prototype.forEach.call(elements, (element) => {
				addResolve(element);
			});

			return resolver;
		},
		removed(resolve) {
			if (typeof resolve !== "function")
				throw new Error("First parameter needs to be a function");

			// Remove resolve function that also checks for allowed mutations
			removeResolve = (element) => {
				if (!isMutationAllowed(element)) return;
				resolve(element);
			};

			return resolver;
		},
		stop() {
			if (observer) {
				observer.disconnect();
			}
		}
	};

	return resolver;
};

Document.prototype.liveQuerySelectorAll = liveQuerySelectorAll;
Element.prototype.liveQuerySelectorAll = liveQuerySelectorAll;

/******************************************************************************/

const liveAttribute = function(attributeName) {
	const element = this;

	let attributeChanged;

	const observer = new MutationObserver(mutations => {

		if (typeof attributeChanged === "function") {
			mutations.forEach(mutation => {

				if (mutation.attributeName === attributeName) {
					attributeChanged(mutation.target.getAttribute(attributeName), mutation.oldValue);
				}
			});
		}
	});
	observer.observe(element, { attributes: true, attributeOldValue: true });

	let resolver = {
		changed(resolve) {

			// Attribute changed function that also checks for allowed mutations
			attributeChanged = (value, oldValue) => {
				if (!isMutationAllowed(element)) return;
				resolve(value, oldValue);
			};

			// Immediately callback resolve function to notifiy callee about initial attribute value
			attributeChanged(element.getAttribute(attributeName), undefined);
			return resolver;
		},
		stop() {
			observer.disconnect();
		}
	};

	return resolver;
};

Element.prototype.liveAttribute = liveAttribute;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Virtual Machine (VM)" data-id="hJYaHnaf" style __wid="itnj7sFu"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="rZim4YR8">const mergeContexts = (...contexts) => {
  const context = {};

  contexts.forEach(ctx => {
    Object.keys(ctx).forEach(key => {
      context[key] = ctx[key];
    });
  });

  return context;
};

const updateTypeSelectors = (names) => {
  document.liveQuerySelectorAll('.code-paragraph').added((paragraph) => {
    const ParagraphUtils = Codestrate.require('#paragraph-utils');
    let header = ParagraphUtils.getHeaderElement(paragraph);
    let content = ParagraphUtils.getContentElement(paragraph);
    // debugger;
    ParagraphUtils.addSelectElement(header, "type", content, names);
  });
};

Codestrate.VirtualMachines = {
  _vms: {},
  get(name) {
    return this._vms[name];
  },
  create(names, executeFunc) {

    if (Codestrate.loaded) {
      updateTypeSelectors(names);
    } else {
      window.addEventListener("codestrateloaded", function codestrateLoaded() {
        updateTypeSelectors(names);
        window.removeEventListener("codestrateloaded", codestrateLoaded);
      });
    }

    const vm = {
      context: {}
    };

    vm.addToGlobalContext = (context) => {
      vm.context = mergeContexts(vm.context, context);
    };

    vm.getExecutionContext = (context = {}) => {

      const tmpContext = mergeContexts(vm.context, {
        console: Codestrate.activeConsole || window.console,
        Variable: window.Variable,
        SharedMemory: Codestrate.SharedMemory
      }, context);

      return {
        execute: (code) => {
          try {
            return executeFunc(code, tmpContext);
          } catch (error) {

            // Log events only once, but still propagate them to the first paragraph
            // that initiated execution
            if (!error.handled) {
              // Set actual source of error
              error.source = tmpContext.codeSource;
              error.paragraph = tmpContext.paragraph;
              error.handled = true;
              tmpContext.console.error(error);
            }

            throw error;
          }
        }
      };
    };

    // Store vm
    if (typeof names === 'string') {
      this._vms[names] = vm;
    } else {
      names.forEach((name) => {
        this._vms[name] = vm;
      });
    }
  }
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="true" name="JavaScript VM" last-execution-state="success" data-id="wpGiGayi" style __wid="jUvaPAND"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="sVaVD3RY">Codestrate.VirtualMachines.create(["text/javascript"], (code, context) => {
	code = `${code}\n//# sourceURL=${context.codeSource}`;

	let argNames = Object.keys(context);
	let args = argNames.map((key) => context[key]);

	let f = new Function(...argNames, code);

	// bind each argument function to the paragraph
	args = args.map((arg) => {
		if (typeof arg === 'function') {
			return arg.bind(context.paragraph);
		}
		return arg;
	});

	// bind function to code paragraph, so that 'this' keyword refers to paragraph instead of window
	// object
	return f.call(context.paragraph, ...args);
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="JSON VM" data-id="42Z4ifSq" style __wid="J9migtad"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="k6aJBewH">Codestrate.VirtualMachines.create(["application/json"], (code) => {
	const f = new Function(`return ${code}`);
	return f();
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Execute Code Paragraphs" data-id="GVBwaApD" style __wid="yKixiT2x"><PRE data-type="content" type="text/javascript" class="bootstrap-module" __wid="M4NCkxea">// create events for execute paragraphs
Codestrate.createEvent("beforeruncode");
Codestrate.createEvent("successruncode");
Codestrate.createEvent("errorruncode");
Codestrate.createEvent("afterruncode");

Codestrate.runCode = (paragraph, exports) => {

  // Block execution of consecutive code paragraphs until this paragraph executed completely after
  // importing all libs or requiring other code paragraphs.
  let blockHandle = Codestrate.blockExecution("Codestrate.runCode");

  const codeSelector = '[data-type="content"]';
  const element = paragraph.querySelector(codeSelector);

  if (!element) {
    throw new Error(`Could not find ${codeSelector} in paragraph`);
  }

  const codeType = element.getAttribute("type");
  if (!codeType) {
    throw new Error(`Could not find type attribute on ${element}`);
  }

  var code = element.innerText;

  Codestrate.dispatchEvent("beforeruncode", {
    paragraph: paragraph,
    code: code
  });

  let codeSource = paragraph.getAttribute("id") ||
    (paragraph.getAttribute("name") && paragraph.getAttribute("name").replace(/\W/g, "_")) ||
    `VM${Codestrate.util.randomString()}`;

  try {
    const vm = Codestrate.VirtualMachines.get(codeType);

    const context = vm.getExecutionContext({
      paragraph,
      codeSource,
      exports
    });

    context.execute(code);

    Codestrate.dispatchEvent("successruncode", {
      paragraph: paragraph,
      code: code
    });
  } catch (error) {

    Codestrate.dispatchEvent("errorruncode", {
      error: error,
      paragraph: paragraph,
      code: code
    });
  }

  Codestrate.dispatchEvent("afterruncode", {
    paragraph: paragraph,
    code: code
  });

  // Release block handle
  blockHandle.continue();
};

let paragraphSelector = '.paragraph[run-on-load="true"]';


if (!Codestrate.params.has("edit") && Codestrate.mode !== "edit") {
  let groupSelector = `.section[data-group="basic"] ${paragraphSelector}`;
  paragraphSelector = `.section:not([data-group]) ${paragraphSelector},${groupSelector}`;
}
// groups as parameters are deprecated
else if (Codestrate.params.has("groups")) {
  let groups = Codestrate.params.get("groups");
  let groupSelector = groups.map((group) => {
    return `.section[data-group="${group}"] ${paragraphSelector}`;
  }).join(",");

  paragraphSelector = `.section:not([data-group]) ${paragraphSelector},${groupSelector}`;
}

// console.log('execute selector', paragraphSelector);

Codestrate.executeParagraphsSync = (executeOnLoadParagraphs) => {
  return new Promise((resolve, reject) => {

		const exports = {};
    const len = executeOnLoadParagraphs.length;

    let currentIndex = 0;
    let blockedExecutionCount = 0;

    const execute = () => {

      // Break execution loop when all paragraph have been executed.
      if (currentIndex >= len) {
        return resolve(exports);
      }

      const paragraph = executeOnLoadParagraphs[currentIndex];

      Codestrate.runCode(paragraph, exports);

      if (!blockedExecutionCount) {
        execute(++currentIndex);
      }
    };

    Codestrate.blockExecution = (message = "", timeout = 30000) => {
      ++blockedExecutionCount;
      let hasContinued = false;

      let timeoutHandle;

      const continueWithNext = () => {
        clearTimeout(timeoutHandle);
        --blockedExecutionCount;

        if (!blockedExecutionCount) {
          hasContinued = true;
          execute(++currentIndex);
        }
      };

      timeoutHandle = setTimeout(() => {
        const confirmMessage = `Loading "${message}" is taking too long. Do you want to continue?`;
        if (window.confirm(confirmMessage)) {
          continueWithNext();
        }
      }, timeout);

      return {
        continue: () => {
          if (!hasContinued) {
            continueWithNext();
          }
        }
      };
    };

    // Execute first paragraph if one exists.
    if (len) {
      execute(currentIndex);
    }
  });
};

(async() => {
  const executeOnLoadParagraphs = Array.from(document.querySelectorAll(paragraphSelector));

  let exports = await Codestrate.executeParagraphsSync(executeOnLoadParagraphs);

	// store global exports
	Codestrate.global = exports;

	// trigger codestrate loaded event
	Codestrate.dispatchEvent("loaded");
})();</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Template Code" draggable="false" run-on-load="true" data-id="BsNZH7Rd" last-execution-state="success" __wid="LyQqGH84"><PRE data-type="content" type="text/javascript" __wid="EDZaDUDG">const func = `return eval('\`' + __str__ + '\`');`;

window.template = function (str, data) {
	let context = Object.assign({}, data, {
		__str__: str
	});

	const argNames = Object.keys(context);
	const args = argNames.map((key) => context[key]);

	const f = new Function(...argNames, func);
	return f(...args);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Import Function" run-on-load="true" style data-id="HpbBedd6" last-execution-state="success" __wid="x8Nq7DYM"><PRE data-type="content" type="text/javascript" __wid="ps2qGxGB">const relativeUrlRegex = new RegExp('^\\s*(?:[a-z0-9]+:)?//', 'i');
const isCacheEnabled = Codestrate.params.get("cache", false);
const cacheKeyPrefix = "notestrate-import:";

console.debug(`Cache enabled: ${isCacheEnabled}`);

let importsContainer = document.head.querySelector('transient#imports');

// Add imports container if it does not exist.
if (!importsContainer) {
	importsContainer = document.createElement("transient");
	importsContainer.setAttribute("id", "imports");
	document.head.insertBefore(importsContainer, document.head.firstChild);
}

/**
 * Returns true if the resource is relative path to this webstrate.
 *
 * @param {string} src Url to resource.
 * @param {boolean} Returns true if the resource is relative.
 */
const isRelativeResource = (src) => {
	return !relativeUrlRegex.test(src);
};

const getLatestAssets = () => {

	let latestAssets = {};
	let assets = webstrate.assets.call({});
	Array.prototype.forEach.call(assets, asset => {
		if (!latestAssets[asset.fileName] || latestAssets[asset.fileName].v &lt; asset.v) {
			latestAssets[asset.fileName] = asset;
		}
	});

	return latestAssets;
};

// Webstrate assets to check if cached resource needs to be updated.
const assets = []; //getLatestAssets();

/**
* Executes JavaScript code by adding it to a script element, which is then appended
* to the importsContainer transient element. The script element is returned.
*
* @param {string} code The JavaScript code.
* @return {HTMLScriptElement} The script element containing the code.
*/
const executeJavaScript = function (code) {

	// Add sourcemap functionality to script
	code = `${code}\n//# sourceURL=${Codestrate.util.randomString()}`;

	const script = document.createElement("script");
	script.setAttribute("type", "text/javascript");

	// Use text node to make large scripts work (> 65k characters)
	const textNode = document.createTextNode(code);
	script.appendChild(textNode);

	importsContainer.appendChild(script);

	return script;
};

/**
* Executes the CSS by adding it to a style element, which is then appended to the
* importsContainer transient element. The style element is returned.
*
* @param {string} css The CSS style.
* @param {HTMLStyleElement The style element containing the css.
*/
const executeCss = function (css) {

	// Create the style element
	const style = document.createElement("style");

	// Add styles
	style.innerHTML = css;

	// WebKit hack :(
	style.appendChild(document.createTextNode(""));

	// Add the style element to the page
	importsContainer.appendChild(style);

	return style;
};

const storeInCache = (src, type) => {

	// Check if cache is enabled and only cache resources are from this webstrate.
	if (!isCacheEnabled || !isRelativeResource(src)) {
		return false;
	}

	// Get asset and only cache if asset for resource exists.
	const asset = assets[src];

	if (typeof (Storage) !== "undefined" && asset) {

		// Get resource and store its content in cache.
		fetch(src, { credentials: 'include' }).then(externalResource => {
			externalResource.text().then(content => {

				const resource = {
					asset,
					type,
					content
				};

				localStorage.setItem(`${cacheKeyPrefix}${src}`, JSON.stringify(resource));
			});
		});
	}
};

/**
 * It loads the source from cache if the cache is enabled and if it exists in cache
 */
const loadFromCache = (src) => {

	if (!isCacheEnabled) {
		return false;
	}

	if (typeof (Storage) !== "undefined") {

		const value = localStorage.getItem(`${cacheKeyPrefix}${src}`);

		if (value) {
			try {
				const { asset, type, content } = JSON.parse(value);

				// If asset does not exist then it has been updated eventually
				if (assets[asset.fileName].v > asset.v) {
					localStorage.removeItem(`${cacheKeyPrefix}${src}`);
					return false;
				}

				let imported = importsContainer.querySelector(`[data-src="${src}"]`);

				// Source already imported
				if (imported) {
					return true;
				}

				// 				console.debug(`Loading ${asset.fileName}?v=${asset.v} from cache`);

				let element;
				if (type === "text/javascript") {
					element = executeJavaScript(content);
				}
				else if (type === "text/css") {
					element = executeCss(content);
				}
				else {
					throw new Error(`Type "${type}" is not supported.`);
				}
				element.setAttribute("data-cached", "true");
				element.setAttribute("data-src", src);
				return true;
			} catch (error) {
				debugger;
				console.error(`Could not load source ${src} from cache. Removing it from cache.`, error);
				localStorage.removeItem(`${cacheKeyPrefix}${src}`);
			}
		}
	}

	return false;
};

window.importLib = function (src, type = "text/javascript") {

	// Block execution of consecutive code paragraphs until all external libraries imported
	// by the current code paragraph have been executed.
	const blockHandle = Codestrate.blockExecution(src);

	const loadLibrary = (s, callback) => {

		if (loadFromCache(s)) {
			setTimeout(() => {
				callback();
			}, 0);
			return;
		}

		let script = importsContainer.querySelector(`script[src="${s}"]`);

		// Import source only once.
		if (!script) {
			script = document.createElement("script");
			script.setAttribute("type", type);
			script.setAttribute("src", s);
			script.onload = () => {
				script.__loaded = true;

				if (isCacheEnabled) {
					storeInCache(s, type);
				}

				callback();

				if (script.__callbacks) {
					script.__callbacks.forEach(cb => cb());
				}
			};
			importsContainer.appendChild(script);
		}
		// Script is imported by another code paragraph, but has not been loaded completely
		// by the first one. So, the callback is added to a list and called after the
		// has loaded.
		else if (!script.__loaded) {
			if (!script.__callbacks) {
				script.__callbacks = [];
			}
			script.__callbacks.push(callback);
		}
		// The script has been loaded and executed before. Just continue.
		else {
			callback();
		}
	};

	// Returns a promise like function, which will be executed when all imports
	// were loaded.
	return {

		then: (resolve) => {

			if (typeof src === "string") {
				loadLibrary(src, () => {
					try {
						resolve();
					} finally {
						blockHandle.continue();
					}
				});
			} else if (Array.isArray(src)) {

				const len = src.length;
				let i = 0;

				const loadNextLib = () => {
					if (i &lt; len) {
						loadLibrary(src[i], () => {
							++i;
							loadNextLib();
						});
					} else {
						try {
							resolve();
						} finally {
							blockHandle.continue();
						}
					}
				};

				loadNextLib();
			} else {
				throw new Error(`The 1 parameter must be a string or an array of strings instead of ${src}`);
			}
		}
	};
};

/**
 * Load style from source.
 *
 * @param {string|Array} src The url to the source or an array of urls to sources.
 */
const loadStyle = (src) => {

	// Load resource from cache and return on success.
	if (loadFromCache(src))	return;

	let link = importsContainer.querySelector(`link[src="${src}"]`);

	// Import resource only once.
	if (!link) {
		link = document.createElement("link");
		link.setAttribute("rel", "stylesheet");
		link.setAttribute("href", src);
		importsContainer.appendChild(link);

		if (isCacheEnabled) {
			storeInCache(src, "text/css");
		}
	}
};

// Export importStyle function to global window object.
window.importStyle = function (src) {
	if (typeof src === "string") {
		loadStyle(src);
	} else if (Array.isArray(src)) {
		src.forEach(loadStyle);
	} else {
		throw new Error(`The 1 parameter must be a string or an array of strings instead of ${src}`);
	}
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Require Function" run-on-load="true" data-id="47dEZgUz" __wid="gD4qta68"><PRE data-type="content" type="text/javascript" __wid="vqS27FWu">const vm = Codestrate.VirtualMachines.get("text/javascript");

const requireSingle = (codeElement, data, reuseExports, multiple = false) => {

	let code;
	if (multiple) {
		code = codeElement.map((element) => {
			return element.innerText;
		}).join("\n\n");
		codeElement = codeElement[0];
	}
	else {
		code = codeElement.innerText;
	}

	// Replace placeholders like ${myVar} in code
	if (data) {
		code = template(code, data);
	}

	let paragraph = codeElement.closest(".paragraph");

	let codeSource = paragraph.getAttribute("id") ||
			(paragraph.getAttribute("name") &&
			 paragraph.getAttribute("name").replace(/\W/g, "_")) ||
			`VM${Codestrate.util.randomString()}`;

	const type = codeElement.getAttribute("type");

	if (type === "text/javascript") {

		// Return exports from previous execution when resuse exports is enabled
		if (reuseExports && codeElement.__exports) {
			return codeElement.__exports;
		}

		let exports = {};
		const context = vm.getExecutionContext({
			paragraph,
			codeSource,
			exports: exports
		});

		context.execute(code);

		if (reuseExports) {
			// Store exports in for later reuse
			codeElement.__exports = exports;
		}

		return exports;
	} else if (type === "application/json") {
		const jsonVM = Codestrate.VirtualMachines.get(type);
		const context = jsonVM.getExecutionContext();
		return context.execute(code);
	} else if (type === "text/css") {
		return code;
	} else if (type === "text/html") {
		let html = codeElement.innerHTML;

		if (data) {
			html = template(html, data);
		}

		const container = document.createElement("div");
		container.innerHTML = html;

		return Array.from(container.children).map(c => c);
	}

	return code;
};

const require = (selector, data, reuseExports = true) => {
	const codeElements = Array.from(document.querySelectorAll(`${selector}[data-type="content"]`));

	if (!codeElements.length) {
		throw new Error(`require("${selector}") does not exist`);
	}

	if (codeElements.length > 1) {
		return requireSingle(codeElements, data, reuseExports, true);
	}

	return requireSingle(codeElements[0], data, reuseExports);
};

const requireAll = (selector, data, reuseExports = true) => {
	const codeElements = Array.from(document.querySelectorAll(`${selector}[data-type="content"]`));

	let exports = Array.prototype.map.call(codeElements, (codeElement) => {
		return requireSingle(codeElement, data, reuseExports);
	});

	return exports;
};

// Add require to global execution context for JavaScript virtual machine
vm.addToGlobalContext({
	require,
	requireAll
});

// For debugging: export to Codestrate object
Codestrate.require = require;
Codestrate.requireAll = requireAll;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Destroy Event Listeners On Rerun" style draggable="false" data-id="8237gBwR" last-execution-state="success" __wid="Eede9Uhp"><PRE data-type="content" type="text/javascript" id="destroy-event-listeners-on-rerun" __wid="XcJ34PgZ">Codestrate.addEventListener("beforeruncode", (event) => {

	const {
		paragraph,
		code
	} = event;

	// Add codestrate object
	if (!paragraph.codestrate) {
		paragraph.codestrate = {};
	}

	if (paragraph.__listeners) {
		// console.info('removing event listeners added during a previous run of this paragraph', paragraph.__listeners);
		paragraph.__listeners.forEach((listener) => {
			listener.source.removeEventListener(...listener.parameters);
		});

		// Clear list of event listeners
		paragraph.__listeners.length = 0;
	} else {
		paragraph.__listeners = [];
	}

	if (!paragraph.codestrate.customAddEventListener) {
		paragraph.codestrate.customAddEventListener = function () {
			var parameters = Array.from(arguments);
			// window.console.log('arguments %o', parameters);

			try {
				paragraph.codestrate.oldAddEventListener.call(this, ...parameters);
				paragraph.__listeners.push({
					source: this,
					parameters: parameters
				});
			} catch (error) {
				throw error;
			}
		};
	}

	// Only register custom event listener once as another code paragraph might have already done this
	if (Node.prototype.addEventListener === paragraph.codestrate.customAddEventListener) {
		console.warn('prevent overriding addEventListener multiple times');
		return;
	}

	// Keep a reference to the previous event listener, which will be re-added after the code paragraph ran
	paragraph.codestrate.oldAddEventListener = Node.prototype.addEventListener;

	// Temporarily override addEventListener with custom implementation
	Node.prototype.addEventListener = paragraph.codestrate.customAddEventListener;
});

Codestrate.addEventListener("afterruncode", (event) => {

	const {
		paragraph
	} = event;

	// Ignore this code paragraph's after run
	if (paragraph.querySelector('#destroy-event-listeners-on-rerun')) {
		return;
	}

	// Re-add old addEventListener
	if (paragraph.codestrate.oldAddEventListener) {
		Node.prototype.addEventListener = paragraph.codestrate.oldAddEventListener;
		delete paragraph.codestrate.oldAddEventListener;
	}
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Destroy DOM Elements On Rerun" style data-id="qaqmECVU" __wid="fNwhRehb"><PRE data-type="content" type="text/javascript" id="destroy-dom-elements-on-rerun" __wid="xxpuptzw">Codestrate.addEventListener("beforeruncode", (event) => {

	const {
		paragraph,
		code
	} = event;

	// Add codestrate object
	if (!paragraph.codestrate) {
		paragraph.codestrate = {};
	}

	if (paragraph.__appendedChildren) {
		console.info("removing children appended during a previous run of this paragraph", paragraph.__appendedChildren);
		paragraph.__appendedChildren.forEach((child) => {
			child.remove();
		});

		// Clear list of event listeners
		paragraph.__appendedChildren.length = 0;
	} else {
		paragraph.__appendedChildren = [];
	}

	if (!paragraph.codestrate.customAppendChild) {
		paragraph.codestrate.customAppendChild = function (child) {
			paragraph.__appendedChildren.push(child);
			paragraph.codestrate.oldAppendChild.call(this, child);
		};
	}

	// Only register custom appendChild once as another code paragraph might have already done this
	if (Node.prototype.appendChild === paragraph.codestrate.customAppendChild) {
		console.warn("prevent overriding appendChild multiple times");
		return;
	}

	// Keep a reference to the previous appendChild function, which will be re-added after the code paragraph ran
	paragraph.codestrate.oldAppendChild = Node.prototype.appendChild;

	// Temporarily override appendChild with custom implementation
	Node.prototype.appendChild = paragraph.codestrate.customAppendChild;
});

Codestrate.addEventListener("afterruncode", (event) => {

	const {
		paragraph
	} = event;

	// Ignore this code paragraph"s after run
	if (paragraph.querySelector("#destroy-dom-elements-on-rerun")) {
		return;
	}

	// Re-add old addEventListener
	if (paragraph.codestrate.oldAddEventListener) {
		Node.prototype.appendChild = paragraph.codestrate.oldAppendChild;
		delete paragraph.codestrate.oldAppendChild;
	}
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" run-on-load="true" last-execution-state="success" draggable="false" name="Dialog VM Overwrite" style data-id="W54QAJP8" __wid="uqRLcSn8"><PRE data-type="content" type="text/javascript" __wid="4fjsuBhk">const Dialogs = require("#dialog-utils");

const vm = Codestrate.VirtualMachines.get("text/javascript");
vm.addToGlobalContext({
	alert: Dialogs.alert,
	confirm: Dialogs.confirm,
	prompt: Dialogs.prompt,
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="wrrZ5anC" name="Reload codestrate" run-on-load="true" last-execution-state="success" __wid="AtBtSq9t"><PRE data-type="content" type="text/javascript" __wid="QfE4VHnC">webstrate.on("signal", (signal, senderId) => {

	// reload codestrate when reload message comes in
	if (signal.source === "codestrate" && signal.cmd === "reload") {
		// reload codestrate
		Codestrate.reload(signal.message, senderId === webstrate.clientId);
	}
});

// only reloads this codestrate
Codestrate.reload = (message, self = true) => {

	if (self) {
		alert(message, "Reloading Codestrate");
		(async() => {
			// reload when last operations were received by the server
			await webstrate.dataSaved();
			window.location.reload();
		})();
	}
	else {
		(async() => {
			let result = await confirm(`${message}&lt;br>&lt;br>Do you want to reload?`, "Reloading Codestrate");
			if (result) {
				window.location.reload();
			}
		})();
	}
};

// triggers reloading all clients connected to this codestrate
Codestrate.reloadAll = (message) => {

	(async() => {
		// reload when last operations were received by the server
		await webstrate.dataSaved();

		webstrate.signal({
			source: "codestrate",
			cmd: "reload",
			message
		});
	})();
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="dn6jQVsC" name="Commands and Key Bindings" run-on-load="true" __wid="gvtsVbZp"><PRE data-type="content" type="text/javascript" __wid="nK8V2MU6">const commandList = [];
const keyBindings = [];

/******************************************************************************/

const findCommand = (id) => commandList.find(el => el.id === id);
const findCommandIndex = (id) => commandList.findIndex(el => el.id === id);

const findKeyBinding = (id, key) => keyBindings.find(el => (el.id === id && el.key === key));
const findKeyBindingIndex = (id, key) => keyBindings.findIndex(el => (el.id === id && el.key === key));

/******************************************************************************/

importLib([
	"mousetrap.min.js",
	"mousetrap-global-bind.min.js"
]).then(() => {

	/**
	 * Returns the whole command map.
	 */
	const getCommandList = () => {
		return commandList.map(command => Object.assign({}, command));
	};

	/**
	 * Returns a command if found.
	 */
	const getCommand = (id) => {
		return Object.assign({}, findCommand(id));
	};

	/**
	 * Executes a command if found.
	 */
	const executeCommand = (id, event = null) => {
		const command = findCommand(id);
		if (command) {
			return command.action(event);
		} else {
			console.log(`Command "${id}" not found!`);
			return false;
		}
	};

/******************************************************************************/

	/**
	 * Adds a new command.
	 */
	const addCommand = (id, name, action, description = "") => {
		if (id === null || id === "") {
			console.error("A command needs an id!");
			return false;
		} else if (findCommand(id)) {
			console.error("A command needs an unique id!");
			return false;
		} else if (name === null || name === "") {
			console.error("A command needs a name!");
			return false;
		} else if (action === null || typeof action !== "function") {
			console.error("A command action needs to be of type function!");
			return false;
		}

		const command = {
			id: id,
			name: name,
			action: action,
			description: description
		};

		commandList.push(command);

		var evt = document.createEvent("CustomEvent");
		evt.initCustomEvent("CommandAdded", true, true, command);
		window.dispatchEvent(evt);

		return command;
	};

	/**
	 * Removes a command if found.
	 */
	const removeCommand = (id) => {
		const command = findCommand(id);

		if (!command) {
			console.log(`Command "${id}" not found!`);
			return false;
		}

		const index = findCommandIndex(name);
		commandList.splice(index, 1);

		var evt = document.createEvent("CustomEvent");
		evt.initCustomEvent("CommandRemoved", true, true, command);
		window.dispatchEvent(evt);

		return command;
	};

	/**
	 * Updates a command by removing and adding it again.
	 */
	const updateCommand = (id, name, action, description) => {
		const oldCommand = removeCommand(id);
		const newCommand = addCommand(id, name, action, description);
		return {
			oldCommand: oldCommand,
			newCommand: newCommand
		};
	};

/******************************************************************************/

	/**
	 * Returns the keyBindings.
	 */
	const getKeyBindings = () => {
		return keyBindings.map(keyBinding => Object.assign({}, keyBinding));
	};

	/**
	 * Binds a new key mapping.
	 */
	const bindKey = (id, key, preventDefault = false) => {
		if (id === null || id === "") {
			console.error("A keybinding needs a command id!");
			return false;
		} else if (findKeyBinding(id, key)) {
			console.log("This keybinding already exits.");
			return false;
		} else if (key === null || key === "") {
			console.error("A keybinding needs keys!");
			return false;
		}

		const keyBinding = {
			id: id,
			key: key,
			preventDefault: preventDefault
		};

		keyBindings.push(keyBinding);
		Mousetrap.bindGlobal(key, (event) => {
			if (preventDefault) {
				event.preventDefault();
				executeCommand(id, event);
				return false;
			} else {
				return executeCommand(id, event);
			}
		});

		var evt = document.createEvent("CustomEvent");
		evt.initCustomEvent("KeyBindingAdded", true, true, keyBinding);
		window.dispatchEvent(evt);

		return keyBinding;
	};

	/**
	 * Removes and unbinds a key mapping.
	 */
	const unbindKey = (id, key) => {
		const keyBinding = findKeyBinding(id, key);

		if (!keyBinding) {
			console.log(`Keybinding "${id}" - "${key}" not found!`);
			return false;
		}

		const index = findKeyBindingIndex(id, key);
		keyBindings.splice(index, 1);
		Mousetrap.unbind(key);

		var evt = document.createEvent("CustomEvent");
		evt.initCustomEvent("KeyBindingRemoved", true, true, keyBinding);
		window.dispatchEvent(evt);

		return keyBinding;
	};

/******************************************************************************/

	Object.defineProperty(Codestrate, "commands", {
		get: () => getCommandList()
	});
	Object.defineProperty(Codestrate, "getCommand", {
		value: (id) => getCommand(id),
	});
	Object.defineProperty(Codestrate, "executeCommand", {
		value: (id) => executeCommand(id),
	});
	Object.defineProperty(Codestrate, "addCommand", {
		value: (id, name, action, description) => addCommand(id, name, action, description),
	});
	Object.defineProperty(Codestrate, "removeCommand", {
		value: (id) => removeCommand(id),
	});
	Object.defineProperty(Codestrate, "updateCommand", {
		value: (id, name, action, description) => updateCommand(id, name, action, description),
	});

	Object.defineProperty(Codestrate, "keyBindings", {
		get: () => getKeyBindings(),
	});
	Object.defineProperty(Codestrate, "addKeyBinding", {
		value: (id, key, preventDefault) => bindKey(id, key, preventDefault),
	});
	Object.defineProperty(Codestrate, "removeKeyBinding", {
		value: (id, key) => unbindKey(id, key),
	});
});</PRE></DIV></DIV><DIV name="Console" class="section section-hidden" data-type="system" data-group="basic" data-id="nyjy5imM" __wid="qx6TYbDK"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" draggable="false" data-id="BR9vXBE3" __wid="jLym6BsV"><DIV data-type="content" contenteditable="false" class="section-documentation" type="text/html" codemirror="true" __wid="RgDzw65Y"><H2 __wid="AzeKSNeT">Description</H2>The console section adds a console to each code paragraph. All console calls within a paragraph are logged to the paragraph's console before logs are redirected to the browser console. To show the console, this section adds a console button to each paragraph header. Clicking the console button toggles the console. Consoles are hidden by default and located in a transient element, which means their state is not synchronized with other clients have the same codestrate open.</DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="x22UQapi" __wid="r2PNZHpd"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="XgYKxvAV">{
	"version": "1.1",
	"description": "Adds a console to each code paragraph.",
	"changelog":
	{
		"1.1": "Styling with variables.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" name="Console Code" draggable="false" last-execution-state="success" data-id="8gS9rQm6" run-on-load="true" __wid="5eRtkiQD"><PRE data-type="content" type="text/javascript" __wid="hd3GXPW7">importLib("moment.min.js").then(() => {

	class Console {

		constructor(paragraph, container) {
			this.messageBufferSize = 100;
			this.paragraph = paragraph;
			this.container = container;

			// Logs go to buffer and will be subsequently rendered in requestAnimationFrame.
			this._outputBuffer = [];

			this._addHeader();
			this._addOutput();
			this._addInput();

			this._addCloseButton();

			this.container.classList.add("close");

			// Scroll to paragraph that produced the error
			this.paragraph.addEventListener("click", (event) => {
				let target = event.target;

				const error = target.closest("[error-id]");
				if (error) {
					event.preventDefault();

					const source = error.getAttribute("source");
					const lineNumber = Number(error.getAttribute("line-number")) - 1;

					const paragraph = error.__paragraph;
					paragraph.classList.remove("collapsed");

					const section = paragraph.closest(".section");
					section.classList.remove("section-hidden");

					const content = paragraph.querySelector("[data-type='content']");

					// add class to line with error
					if (content.__editor && content.__editor.editor) {

						let cm = content.__editor.editor;
						const addError = (lineHandle) => {
							cm.addLineClass(lineHandle, "background", "line-error");
							cm.addLineClass(lineHandle, "text", "line-error-text");
							// cm.addLineClass(lineHandle, "gutter", "line-error-text");
							// cm.addLineClass(lineHandle, "wrap", "line-error-text");

							cm.focus();
							cm.setCursor(lineNumber, 0);
						};

						const removeError = (lineHandle) => {
							cm.removeLineClass(lineHandle, "background", "line-error");
							cm.removeLineClass(lineHandle, "text", "line-error-text");
							// cm.removeLineClass(lineHandle, "gutter", "line-error-text");
							// cm.removeLineClass(lineHandle, "wrap", "line-error-text");
						};

						// Remove previous error
						if (this.errorLineHandle) {
							removeError(this.errorLineHandle);
							this.errorLineHandle = null;
						}

						// Add error
						this.errorLineHandle = cm.getLineHandle(lineNumber);
						addError(this.errorLineHandle);

						// remove error on editor change
						let that = this;
						cm.on("change", function change() {
							cm.off("change", change);

							if (that.errorLineHandle) {
								removeError(that.errorLineHandle);
								that.errorLineHandle = null;
							}
						});
					}

					paragraph.scrollIntoView();
				}
			});
		}

		open() {
			this.container.classList.remove("close");
			setTimeout(() => {
				this.container.classList.add("open");
			}, 1);
		}

		close() {
			const onClosed = (event) => {
				if (event.propertyName === "height") {
					this.container.removeEventListener("transitionend", onClosed);
					this.container.classList.add("close");
				}
			};

			this.container.removeAttribute("style");
			this.container.addEventListener("transitionend", onClosed, false);
			this.container.classList.remove("open");
		}

		toggle() {
			if (this.container.classList.contains("open")) {
				this.close();
			} else {
				this.open();
			}
		}

		destroy() {
			this.close();

			this.container.addEventListener("transitionend", (event) => {
				if (event.propertyName === "height") {
					this.container.remove();
				}
			}, false);
		}

		log() {
			this._internalLog("log", ...arguments);
		}

		info() {
			this._internalLog("info", ...arguments);
		}

		error() {
			this._internalLog("error", ...arguments);
		}

		warn() {
			this._internalLog("warn", ...arguments);
		}

		debug() {
			this._internalLog("debug", ...arguments);
		}

		trace() {
			this._internalLog("trace", ...arguments);
		}

		_addHeader() {
			this.header = document.createElement("div");
			this.header.setAttribute("class", "header");
			this.container.appendChild(this.header);
		}

		_addOutput() {
			this.output = document.createElement("div");
			this.output.setAttribute("class", "output");
			this.container.appendChild(this.output);
		}

		_addInput() {
			this.input = document.createElement("div");
			this.input.setAttribute("class", "input");

			let history = [];
			let historyIndex = -1;

			const inputElement = document.createElement("input");
			inputElement.setAttribute("type", "text");
			inputElement.addEventListener("keydown", event => {

				// alert("key code" + event.key);

				if (event.keyCode === 13) {

					// Get console input
					const value = inputElement.value;

					// Ignore empty console input
					if (value.trim() === "") {
						return;
					}

					// Push console input to history
					history.push(value);
					historyIndex = history.length;

					try {
						// const f = new Function("console", `return ${value}`);
						// const result = f(this);

						this.log(value);

						const result = eval(value);

						this.log(result);
					} catch (error) {
						this.error(error);
					}
					finally {
						// Reset console input
						inputElement.value = "";
					}
				} else if (event.keyCode === 38) {
					if (historyIndex > 0) {
						inputElement.value = history[--historyIndex];
					}
				} else if (event.keyCode === 40) {
					if (historyIndex &lt; history.length - 1) {
						inputElement.value = history[++historyIndex];
					}
					else {
						historyIndex = history.length;
						inputElement.value = "";
					}
				}
			});
			this.input.appendChild(inputElement);

			this.container.appendChild(this.input);
		}

		_addCloseButton() {
			const closeConsole = document.createElement("span");
			closeConsole.setAttribute("class", "close-console");
			closeConsole.addEventListener("click", event => {
				if (typeof this.onClose === "function") {
					if (this.onClose.call(this)) {
						this.close();
					}
				} else {
					this.close();
				}
			});

			const icon = document.createElement("i");
			icon.setAttribute("class", "material-icons");
			closeConsole.appendChild(icon);

			this.header.appendChild(closeConsole);
		}

		_updateScroll() {
			this.output.scrollTop = this.output.scrollHeight;
		}

		_internalLog(type, ...args) {

			// Log to actual DevTools console including the paragraph that contains the code.
			const console = window.console;
			if (console) {
				const consoleLog = console[type];
				if (typeof consoleLog === "function") {
					const location = this.paragraph.getAttribute("name") || "No Name";
					console.group("Console %c%s", "color: orange;", location);
					consoleLog.call(window, ...args);
					console.groupCollapsed("%cLog Source", "font-weight: normal;");
					console.log(this.paragraph);
					console.groupEnd();
					console.groupEnd();
				}
			}

			this._outputBuffer.push({
				// timestamp: moment().format("YYYY-MM-DD HH:mm:ss.SSS"),
				timestamp: moment().format("HH:mm:ss.SSS"),
				type: type,
				args: args
			});

			let location = "";

			/**
       * Convert arg to output that conforms to console output.
       */
			const convertArg = (arg) => {

				let converted = arg;

				if (arg instanceof Error) {

					let error = arg;

					// let codeSource = tmpContext.codeSource;
					// if (error.source) {
					// codeSource = error.source;
					// }

					// window.console.log(error.source);

					const codeSelector = "[data-type='content']";
					const element = error.paragraph.querySelector(codeSelector);

					// window.console.error(error, error.source);
					const regex = new RegExp("^([^\n]+)\n" + // error string
																	 "[^]+?" + // whatever comes before the parenthesis
																	 "\\((?:.*?):" + // code name or trash, non-capturing
																	 "([0-9]+):([0-9]+)\\)" // parenthesis
																	);

					const matches = error.stack.match(regex);
					if (matches) {
						let [_, errorString, lineNumber, letterNumber] = matches;
						// Everything except SyntaxErrors will be in a `new Function` construct with
						// two appended lines, which we should account for.
						if (errorString.substring(0,12) !== "SyntaxError:") {
							lineNumber = lineNumber - 2;
						}

						const errorId = Codestrate.util.randomString();

						location = `&lt;span error-id="${errorId}" source="${error.source}" line-number="${lineNumber}">${error.source}:${lineNumber}&lt;/span>`;

						converted = `${errorString}&lt;br>&nbsp;&nbsp;at (${location})`;

						setTimeout(() => {
							const spans = document.querySelectorAll(`[error-id="${errorId}"]`);
							Array.prototype.forEach.call(spans, (span) => {
								span.__paragraph = error.paragraph;
							});
						}, 0);
					} else {
						converted = error.stack;
					}
				} else if (arg instanceof HTMLElement) {
					// Convert HTML element to a string.
					// !!! The replace is required otherwise the console will render the HTML
					// instead of logging the markup.
					converted = arg.outerHTML.replace(/[\u00A0-\u9999&lt;>\&]/gim, (idx) => {
						return `&#${idx.charCodeAt(0)};`;
					});
				} else if (typeof arg === "object") {
					try {
						converted = JSON.stringify(arg, null, "  ");
					} catch (error) {
						// window.console.error(error);
						converted = arg.toString();
					}
				}

				let type = typeof arg;
				if (arg === null) {
					type = "null";
				}

				return `&lt;span class="${type}">${converted}&lt;/span>`;
			};

			const logToOutput = () => {

				// Reduce log messages to maximum of buffer size
				let limit = this.messageBufferSize - this._outputBuffer.length;
				while (this.output.childNodes.length > limit && this.output.childNodes.length > 0) {
					this.output.firstElementChild.remove();
				}

				const fragment = document.createDocumentFragment();

				this._outputBuffer.forEach((item) => {
					const entry = document.createElement("div");
					entry.classList.add("log-output");
					entry.classList.add(item.type);

					const args = item.args.map(convertArg);
					let message = args.join(" ");

					entry.innerHTML = `
&lt;div class="time">${item.timestamp}&lt;/div>
&lt;div class="message">${message}&lt;/div>
&lt;div class="location">${location}&lt;/div>
`;
					fragment.appendChild(entry);
				});

				this.output.appendChild(fragment);

				this._updateScroll();

				// Clear output buffer
				this._outputBuffer.length = 0;

				// Allow new animation frame requests
				this.requestedAnimationFrame = false;
			};

			if (!this.requestedAnimationFrame) {
				this.requestedAnimationFrame = true;
				window.requestAnimationFrame(logToOutput);
			}
		}
	}

	// Hook into Active Essay bootstrap and set console for currently executed code block
	Codestrate.addEventListener("beforeruncode", event => {
		const { paragraph } = event;

		// Set active console.
		Codestrate.activeConsole = paragraph.console;
	});

	const addConsole = (paragraph) => {

		// Add console only once
		if (paragraph.console) return;

		const consoleContainer = document.createElement("transient");
		consoleContainer.setAttribute("class", "console");

		// Attach actual console to element
		const console = new Console(paragraph, consoleContainer);
		paragraph.console = console;
		paragraph.appendChild(consoleContainer);
	};

	document.liveQuerySelectorAll(".paragraph.code-paragraph").added(addConsole);
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" name="Console Style" data-id="Xi64tc6E" __wid="MGzRYRhb"><STYLE data-type="content" type="text/css" class="themable" codemirror="true" __wid="c2bLreAB">html .console {
	margin-top: 8px;
	width: 100%;
	height: 0;
	opacity: 0;
	pointer-events: none;
	z-index: 9;
	border-radius: 2px;
	display: none;
	background: var(--color-primary-shade-1);
	padding: 8px;
	/* -webkit-transition: height 500ms ease-in-out 0s, opacity 500ms ease-in-out 0s;
	-moz-transition: height 500ms ease-in-out 0s, opacity 500ms ease-in-out 0s;
	transition: height 500ms ease-in-out 0s, opacity 500ms ease-in-out 0s; */
}

html .console.open {
	display: flex;
	/* flex: 1; */
	/* flex-direction: column; */
	flex-flow: column;
	min-height: 192px;
	opacity: 1.0;
	pointer-events: all;
	overflow: hidden;
	overflow-y: hidden;
	resize: vertical;
}

html .console.close {
	border: 0;
	padding: 0;
	margin: 0;
}

html .console .header {
	padding: 4px;
	border-bottom: 1px solid var(--color-tertiary-text);
}

html .console .header:before {
	content: "Console";
}

html .console .close-console {
	position: absolute;
	top: 0;
	right: 0;
	height: 100%;
	z-index: 1;
	cursor: pointer;
	/* font-size: .6em; */
}

/******************************************************************************/

/* html .console .close-console i:after {
content: "close";
position: absolute;
top: 50%;
right: 0;
font-size: .8em;
transform: translate3d(0, -50%, 0);
} */

html .console .output,
html .console .input {
	font-family: var(--font-monospace);
	font-size: 0.8125rem;
}

html .console .output {
	flex: 1;
	/* background-color: orange; */
	overflow: hidden;
	overflow-y: auto;
	/* padding: 5px; */
	/* border-top: 1px solid rgba(255, 255, 255, .05);
	border-bottom: 1px solid rgba(255, 255, 255, .05); */
}

html .console > .output > .log-output {
	display: flex;
	flex-direction: row;
	/* word-break: break-all; */
	/* word-wrap: break-word; */
	/* float: right; */
	/* white-space: pre-wrap; */
	padding: 0 4px;
	border-top: 1px solid rgba(255, 255, 255, .05);
	border-bottom: 1px solid rgba(255, 255, 255, .05);
	/* margin-bottom: -1px; */
}

html .console > .output > .log-output > * {
	/* display: inline; */
	padding: 3px;
}

html .console > .output > .log-output > .message {
	flex: 1;
}

/* html .console > .output > div:not(:last-child) {
padding: 3px 0 3px 0;
border-bottom: 1px solid rgba(255, 255, 255, .1);
}

html .console > .output > div:last-child {
padding: 3px 0 0 0;
}

html .console > .output > div > .time {
color: rgb(135, 135, 129);
} */

/******************************************************************************/

html .console > .output > .log-output.error {
	color: var(--material-color-red);
	background-color: rgba(var(--material-color-red-rgb), 0.1);
}

html .console > .output > .log-output .time,
html .console > .output > .log-output .location {
	color: var(--color-tertiary-text);
}

html .console > .output > .log-output .location {
	text-decoration: underline;
	cursor: pointer;
}

html .console > .output > .log-output.warn {
	color: var(--material-color-yellow);
	background-color: rgba(var(--material-color-yellow-rgb), 0.1);
}

html .console > .output > .log-output.info {
	color: var(--material-color-light-blue);
	background-color: rgba(var(--material-color-light-blue-rgb), 0.1);
}

html .console > .output > .log-output.debug {
	color: var(--color-tertiary-text);
}

html .console > .output > .log-output > .message .number,
html .console > .output > .log-output > .message .boolean {
	color: #9179ff;
}

html .console > .output > .log-output > .message .object {

}

html .console > .output > .log-output > .message .null,
html .console > .output > .log-output > .message .undefined {
	color: rgb(135, 135, 129);
}

html .console > .output > .log-output > .message.info:before {
	content: "INFO: ";
	display: inline-block;
}

/******************************************************************************/

html .console .input {
	padding: 4px;
	border-top: 1px solid var(--color-tertiary-text);
}

html .console .input:before {
	content: ">";
	margin-right: 5px;
	font-weight: bold;
	width: 10px;
	display: inline-block;
}

html .console .input input[type="text"] {
	font-family: inherit;
	border: 0;
	outline: 0;
	color: var(--color-primary-text);
	width: calc(100% - 15px);
	background-color: transparent;
}

/******************************************************************************/

html .console [error-id] {
	text-decoration: underline;
	cursor: pointer;
}

html .CodeMirror .line-error {
	background-color: var(--material-color-red);
	animation-name: highlight;
	animation-duration: 1250ms;
	opacity: .15;
	margin-right: 5px;
}

/* html .CodeMirror .line-error-text {
text-decoration: underline;
text-decoration-color: red;
text-decoration-style: wavy;
} */

/* html .CodeMirror .line-error-gutter {
text-decoration: underline;
text-decoration-color: red;
text-decoration-style: wavy;
} */

/* html .CodeMirror .line-error-wrap {
text-decoration: underline;
text-decoration-color: red;
text-decoration-style: wavy;
} */

/******************************************************************************/

@keyframes highlight {
	from {
		opacity: .5;
	}
}</STYLE></DIV></DIV><DIV class="section section-hidden" name="Migration" data-type="system" data-group="editing" data-id="ifppNbfJ" __wid="MA8SDsz8"><DIV class="paragraph body-paragraph locked collapsed" draggable="false" name="Documentation" data-id="4W22rTyt" __wid="2Mh6Ni3w"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="Uh6B6Tj5"><H2 __wid="cGqs44Dj">Description</H2><DIV __wid="ubGSgdrT">The migration section allows to update document structure of previous versions of a codestrate. For example, the "Put sections into div#sections" adds a div element with ID sections to the document body and then moves all sections previously in the document body to the newly created div#sections element.</DIV><DIV __wid="xEAVKtNy">The migration section also allows to add or update assets that changed of have been added between two versions of a codestrate.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="rYz2ZveL" __wid="8Fmf5ihM"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="4UecYHjS">{
	"version": "1.0",
	"description": "Performs migration steps like updating and pulling assets.",
	"changelog":
	{
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph code-paragraph collapsed" name="Migration Facade" draggable="false" data-id="BjiiG8sZ" last-execution-state="error" run-on-load="true" __wid="N9pu63jT"><PRE data-type="content" type="text/javascript" __wid="4BAAFJ3K">const AssetUtils = require("#asset-utils");

const Migration = (minVersion, name, perform, assets = []) => {

	if (typeof minVersion !== "number") {
		throw new Error("Migration must have a minimum version");
	}

	if (!name) {
		throw new Error("Migration must have a name");
	}

	if (typeof perform !== "function") {
		throw new Error("perform must implement migration process");
	}

	return {
		name,
		minVersion,
		migrate() {
			return new Promise((resolve, reject) => {
				(async() => {

					// Fetching assets and uploading them to this codestrate
					if (assets.length) {
						window.console.log(`fetching assets for migration ${name}`);

						for (let i = 0; i &lt; assets.length; i++) {
							let assetName = assets[i];
							let response = await fetch(assetName, { credentials: "include" });
							let blob = await response.blob();
							window.console.log(assetName, blob);
							let asset = await AssetUtils.uploadBlob(assetName, blob);
						}

						window.console.log(`all assets uploaded for migration ${name}`);
					}

					window.console.log(`running migration ${name}`);
					let task = perform();

					// Allow promises as return values for migration perform
					if (task instanceof Promise) {
						await task;
					}

					window.console.log(`migration ${name} completed`);

					resolve();
				})();
			});
		}
	}
}

// Adding migration class to JavaScript execution context. This will make the Migration class
// available in code paragraphs only and not expose it to the global window scope.
const vm = Codestrate.VirtualMachines.get("text/javascript");
vm.addToGlobalContext({
	Migration
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" last-execution-state="success" name="Migration Loader" run-on-load="true" data-id="kTHY8iBv" __wid="ER4CMXDn"><PRE data-type="content" type="text/javascript" __wid="LTGWAA5i">// Never perform migration on prototype!!!
if (webstrate.webstrateId !== "Codestrate") {

	// Prevent other code paragraphs from being executed, allow 60 seconds to execute before timeout
	const blockHandle = Codestrate.blockExecution("migration", 60000);

	(async() => {
		let requires = requireAll(".migration");

		// Get all migrations and filter out obselete migrations
		let migrations = Array.prototype.map.call(requires, (r) => {
			return r.migration;
		}).filter((m) => m.minVersion > Codestrate.version);

		if (migrations.length) {

			let result = await confirm("Do you want to migrate this codestrate?", "Codestrate Migration");

			if (result) {
				// Sort migrations to apply them in proper order
				migrations.sort((m1, m2) => m1.minVersion > m2.minVersion);

				// Perform all migrations

				for (let i = 0; i &lt; migrations.length; i++) {
					await migrations[i].migrate();
					Codestrate.version = migrations[i].minVersion;
				}
			}
		}

		// Continue with next code paragraph
		blockHandle.continue();

		// Reload if migrations where applied
		if (migrations.length) {

			let result = await confirm("Do you want to remove migration scripts?", "Migration Completed");

			if (result) {
				// Get all migration code paragraphs, and remove them
				let migrations = document.querySelectorAll(".migration");
				Array.prototype.forEach.call(migrations, (migration) => {
					let paragraph = migration.closest(".paragraph");
					if (paragraph) {
						paragraph.remove();
					}
				});
			}

			// Reload after timeout to make sure the codestrate works without side-effects
			setTimeout(() => {
				alert("Reloading codestrate in 5 seconds");
				window.location.reload();
			}, 5000);
		}
	})();
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Migration - Put sections into div#sections" data-id="ENaMHnxt" __wid="DBLJhdM7"><PRE data-type="content" type="text/javascript" class="migration" __wid="LraLUNmf">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/codemirror.css",
	"/Codestrate/codemirror-addon-simplescrollbars.css",
	"/Codestrate/codemirror-addon-dialog.css",
	"/Codestrate/codemirror-addon-show-hint.css",
	"/Codestrate/codemirror-addon-foldgutter.css",
	"/Codestrate/codemirror-addon-matchesonscrollbar.css",
	"/Codestrate/codemirror.js",
	"/Codestrate/codemirror-addon-annotatescrollbar.js",
	"/Codestrate/codemirror-addon-simplescrollbars.js",
	"/Codestrate/codemirror-addon-scrollpastend.js",
	"/Codestrate/codemirror-addon-show-hint.js",
	"/Codestrate/codemirror-addon-javascript-hint.js",
	"/Codestrate/codemirror-addon-xml-hint.js",
	"/Codestrate/codemirror-addon-html-hint.js",
	"/Codestrate/codemirror-addon-css-hint.js",
	"/Codestrate/codemirror-addon-anyword-hint.js",
	"/Codestrate/codemirror-addon-comment.js",
	"/Codestrate/codemirror-addon-continuecomment.js",
	"/Codestrate/codemirror-addon-foldcode.js",
	"/Codestrate/codemirror-addon-foldgutter.js",
	"/Codestrate/codemirror-addon-brace-fold.js",
	"/Codestrate/codemirror-addon-xml-fold.js",
	"/Codestrate/codemirror-addon-markdown-fold.js",
	"/Codestrate/codemirror-addon-comment-fold.js",
	"/Codestrate/codemirror-addon-indent-fold.js",
	"/Codestrate/codemirror-addon-matchbrackets.js",
	"/Codestrate/codemirror-addon-matchtags.js",
	"/Codestrate/codemirror-addon-closebrackets.js",
	"/Codestrate/codemirror-addon-closetag.js",
	"/Codestrate/codemirror-addon-searchcursor.js",
	"/Codestrate/codemirror-addon-match-highlighter.js",
	"/Codestrate/codemirror-addon-matchesonscrollbar.js",
	"/Codestrate/codemirror-addon-jump-to-line.js",
	"/Codestrate/codemirror-addon-search.js",
	"/Codestrate/codemirror-mode-xml.js",
	"/Codestrate/codemirror-mode-htmlmixed.js",
	"/Codestrate/codemirror-mode-javascript.js",
	"/Codestrate/codemirror-mode-css.js",
	"/Codestrate/codemirror-mode-go.js",
	"/Codestrate/quadtree.js",
];

// The perform function applies necessary changes to the DOM to update the document structure
const perform = () => {
	let container = document.createElement("div");
	container.setAttribute("id", "sections");

	const sections = document.querySelectorAll("body > div.section");
	Array.prototype.forEach.call(sections, (s) => {
		container.appendChild(s);
	});
	document.body.appendChild(container);
};

// This migration will move all sections from body to a new div.sections element
exports.migration = Migration(1, "SectionsToDiv", perform, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Migration - Pull beatify libraries
" data-id="prqCkgr6" __wid="VHdEeGnk"><PRE data-type="content" type="text/javascript" class="migration" __wid="eBabhe3Q">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/beautify.js",
	"/Codestrate/beautify-css.js",
	"/Codestrate/beautify-html.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(2, "PullBeautifyLibraries", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" style name="Migration - Add section-visible to sections" data-id="RZFZNFxT" __wid="5r5ZsAKJ"><PRE data-type="content" type="text/javascript" class="migration" __wid="7cfwkSFV">// This migration will add section-visible class to sections that are currently visible. The
// class is required e.g., for the tooltip to display tooltip downwards for first visible section.
// Because otherwise the tooltips will be cut off.
exports.migration = Migration(3, "AddSectionVisibleClass", () => {
	let sections = document.querySelectorAll(".section:not(.section-hidden)");
	Array.prototype.forEach.call(sections, (section) => {
		section.classList.add("section-visible");
	});
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Migration - Pull linter libraries" style data-id="jqsLHEwJ" __wid="9iBdZZVr"><PRE data-type="content" type="text/javascript" class="migration" __wid="RKZwufpT">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/codemirror-linter-jshint.js",
	"/Codestrate/codemirror-linter-htmlhint.js",
	"/Codestrate/codemirror-linter-csslint.js",
	"/Codestrate/codemirror-linter-jsonlint.js",

	"/Codestrate/codemirror-addon-lint.js",
	"/Codestrate/codemirror-addon-lint.css",

	"/Codestrate/codemirror-addon-javascript-lint.js",
	"/Codestrate/codemirror-addon-html-lint.js",
	"/Codestrate/codemirror-addon-css-lint.js",
	"/Codestrate/codemirror-addon-json-lint.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(4, "PullLinterLibraries", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Migration - Pull active line addon" data-id="UQdEcpxj" __wid="eVcerHza"><PRE data-type="content" type="text/javascript" class="migration" __wid="FxPmps9f">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/codemirror-addon-active-line.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(5, "PullActiveLineAddon", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="WfAEm9Ru" name="Migration - Update sortable.js" __wid="usBGBthE"><PRE data-type="content" type="text/javascript" class="migration" __wid="zBNLyHwe">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/Sortable.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(6, "UpdateSortableLibrary", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="pNACvEvY" name="Migration - CodeMirror Addons" __wid="MPupfRND"><PRE data-type="content" type="text/javascript" class="migration

" __wid="GtrbxmS2">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/codemirror-addon-rulers.js",
	"/Codestrate/codemirror-addon-merge.js",
	"/Codestrate/codemirror-addon-merge.css"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(7, "PullCodeMirrorAddons", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="ApzRYKv7" name="Migration - Extended Material Icons" __wid="gLGBtJgE"><PRE data-type="content" type="text/javascript" class="migration" __wid="68aYuKPA">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/materialdesignicons-webfont.eot",
	"/Codestrate/materialdesignicons-webfont.svg",
	"/Codestrate/materialdesignicons-webfont.ttf",
	"/Codestrate/materialdesignicons-webfont.woff",
	"/Codestrate/materialdesignicons-webfont.woff2"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(8, "PullExtendedMaterialIcons", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="bG5xHrLM" name="Migration - CodeMirror Markdown Modes" __wid="xFjjCjbp"><PRE data-type="content" type="text/javascript" class="migration" __wid="Z5ArGFDb">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/codemirror-mode-markdown.js",
	"/Codestrate/codemirror-mode-gfm.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(9, "PullCodeMirrorMarkdownModes", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="NZvcTwxk" name="Migration - Roboto Fonts" __wid="tJcuxmSs"><PRE data-type="content" type="text/javascript" class="migration" __wid="f4AwXWDb">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/roboto-300.woff",
	"/Codestrate/roboto-300-italic.woff",
	"/Codestrate/roboto-400.woff",
	"/Codestrate/roboto-400-italic.woff",
	"/Codestrate/roboto-500.woff",
	"/Codestrate/roboto-500-italic.woff",
	"/Codestrate/roboto-700.woff",
	"/Codestrate/roboto-700-italic.woff",

	"/Codestrate/roboto-mono-400.woff",
	"/Codestrate/roboto-mono-400-italic.woff",
	"/Codestrate/roboto-mono-700.woff",
	"/Codestrate/roboto-mono-700-italic.woff",

	"/Codestrate/roboto-300.woff2",
	"/Codestrate/roboto-300-italic.woff2",
	"/Codestrate/roboto-400.woff2",
	"/Codestrate/roboto-400-italic.woff2",
	"/Codestrate/roboto-500.woff2",
	"/Codestrate/roboto-500-italic.woff2",
	"/Codestrate/roboto-700.woff2",
	"/Codestrate/roboto-700-italic.woff2",

	"/Codestrate/roboto-mono-400.woff2",
	"/Codestrate/roboto-mono-400-italic.woff2",
	"/Codestrate/roboto-mono-700.woff2",
	"/Codestrate/roboto-mono-700-italic.woff2"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(10, "PullRobotoFonts", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="icKECWX2" name="Migration - Missing Roboto Regular Font" __wid="YSKjhuRY"><PRE data-type="content" type="text/javascript" class="migration" __wid="n3RrNW9T">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/roboto-regular.ttf",
	"/Codestrate/roboto-regular.woff",
	"/Codestrate/roboto-regular.woff2"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(11, "PullRobotoMissingFonts", () => {}, assets);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="a5ZdEh3M" name="Migration - JSZip and FileSaver libraries" __wid="YNjbfnHa"><PRE data-type="content" type="text/javascript" class="migration" __wid="wiPrDKAm">// These are dependencies that have been added to the new version of Codestrates or need an update
const assets = [
	"/Codestrate/jszip.min.js",
	"/Codestrate/FileSaver.min.js"
];

// This migration will copy all assets from originating codestrate
exports.migration = Migration(12, "PullJSZipAndFileSaver", () => {}, assets);</PRE></DIV></DIV><DIV class="section section-hidden" name="User & Client Manager" data-type="system" data-group="basic" data-id="5anpeYib" __wid="6rdW3Lsz"><DIV class="paragraph body-paragraph locked collapsed" draggable="false" name="Documentation" data-id="JF57SD8B" __wid="WXEfCTHU"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="QBwucMZC"><H2 __wid="3f73G5j4">Description</H2><DIV __wid="FC9HPpqu">The user manager adds a users array to the Codestrate global window object. Each object in the users array will have the user id and a generated user color. For example, the color can be used in the in the Codestrate to have a consistent user color for remote pointers and remote cursors.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="yMviPwWQ" __wid="uuP3XXbr"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="Ug8MWFX6">{
	"version": "1.0",
	"description": "Manages users on a global window object.",
	"changelog":
	{
		"1.0": "Initital Release"
	}
}</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" run-on-load="true" name="Client Manager Global" data-id="icqmBqmd" last-execution-state="success" __wid="kRPPnC3F"><PRE data-type="content" type="text/javascript" __wid="Fnx7GCYz">const clients = [];

// Add a clients array to the global Codestrate object
Object.defineProperty(Codestrate, "clients", {
	get() {
		return clients;
	}
});

// create events
Codestrate.createEvent("clientUpdateProperty");
Codestrate.createEvent("clientAdd");
Codestrate.createEvent("clientUpdate");
Codestrate.createEvent("clientRemove");

let ignoreUpdates = false;

/**
 * Get the client object.
 *
 * @param {string} The client id.
 */
const getClient = (id = webstrate.clientId) => {
	return clients.find((c) => c.id === id);
};

/**
 * Adds a new client to the clients array and generates a random client color. Nothing will
 * happen if a client already exists.
 *
 * @param {string} id The client id.
 * @param {object} userObject The user object.
 */
const addClient = (id, userObject) => {
	let client = getClient(id);

	// Add client only if it does not exist
	if (!client) {

		let handler = {
			get: function (target, name) {
				return target[name];
			},
			set: function (target, name, value) {
				target[name] = value;

				Codestrate.dispatchEvent("clientUpdateProperty", {
					propertyName: name,
					client
				});

				if (!ignoreUpdates) {
					sendClientData(undefined, false, client.id);
				}

				// Indicate success
				return true;
			}
		};

		userObject.id = id;
		userObject.color = '#' + (Math.random() * 0xFFFFFF &lt;&lt; 0).toString(16);
		userObject.avatarUrl = webstrate.user.avatarUrl || "unknown.jpg";
		client = new Proxy(userObject, handler);

		clients.push(client);
	}
};

/**
 * Removes a client from the clients array.
 *
 * @param {string} id The client id.
 */
const removeClient = (id) => {
	const idx = clients.findIndex((c) => c.id === id);
	const client = clients.splice(idx, 1);

	Codestrate.dispatchEvent("clientRemove", client[0]);
};

/**
 * Update a clients data.
 *
 * @param {string} id The client id.
 *
 */
const updateClient = (id, data) => {

	// Add client only if it does not exist
	let client = getClient(id);
	if (client) {
		ignoreUpdates = true;

		// merge data into client
		Object.assign(client, data);

		if (client.anonymous) {
			Codestrate.dispatchEvent("clientAdd", client);
		}

		// client is not anonymous anymore
		delete client.anonymous;

		ignoreUpdates = false;

		Codestrate.dispatchEvent("clientUpdate", client);
	}
};

/**
 * Get other client ids (all connected client ids except for own client id).
 */
const otherClientIds = () => {
	return webstrate.clients.filter((c) => c !== webstrate.clientId);
};

/**
 * Send client data to other clients.
 */
const sendClientData = (receiverId = undefined, giveMeYourClientData = true, clientId = undefined) => {

	const clientData = getClient(clientId);

	if (!clientData) {
		console.warn(`could not find client data for client ${clientId}`);
		return;
	}

	const otherClients = otherClientIds();

	webstrate.signal({
		cmd: "ClientData",
		clientData,
		giveMeYourClientData
	}, receiverId ? [receiverId] : otherClients);
};

webstrate.on("signal", (message, senderId) => {

	let {
		cmd,
		clientData,
		giveMeYourClientData
	} = message;

	if (cmd === "ClientData") {

		// ignore own message
		if (webstrate.clientId === senderId) {
			return;
		}

		updateClient(clientData.id, clientData);

		if (giveMeYourClientData) {
			// Also send back own avatar to sender client.
			sendClientData(senderId, false);
		}
	}
});

/**
 * Add existing clients on connect
 */
const onConnect = () => {
	// Add all existing clients
	webstrate.clients.forEach((c) => {
		if (webstrate.clientId === c) {
			addClient(c, webstrate.user);
		} else {
			addClient(c, {
				username: "anonymous",
				anonymous: true
			});
		}
	});

	// Send this clients data
	sendClientData();
};

/**
 * Remove all clients on disconnect
 */
const onDisconnect = () => {
	clients.forEach((client) => removeClient(client.id));
};

// Add a client to the list of clients when it joins
webstrate.on("clientJoin", (clientId) => addClient(clientId, {
	username: "anonymous",
	anonymous: true
}));

// Remove a client from the list of clients when it leaves
webstrate.on("clientPart", (clientId) => removeClient(clientId));

// Add clients on reconnect
webstrate.on("reconnect", onConnect);

// Clear all clients
webstrate.on("disconnect", onDisconnect);

// reconnect is only called when disconnected before and not on initial load,
// therefore we call onConnect here
onConnect();</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Client Manager Utils" data-id="XKUmvrUu" __wid="gi7cc2d4"><PRE data-type="content" type="text/javascript" id="client-manager" __wid="9jtfcvss">/**
 * Convert a hex colour to a rgb/rgba value
 * @param {string} hex
 * @param {?number} opacity
 * @returns {string}
 */
const convertHexToRGBA = (hex, opacity) => {
	hex = hex.replace("#", "");
	const r = parseInt(hex.substring(0, 2), 16);
	const g = parseInt(hex.substring(2, 4), 16);
	const b = parseInt(hex.substring(4, 6), 16);

	return `rgba(${r},${g},${b},${opacity})`;
};

const getClient = exports.getClient = (id = webstrate.clientId) => {
	return Codestrate.clients.find((c) => c.id === id);
};

const getClientColor = exports.getClientColor = (id = webstrate.clientId) => {
	const client = getClient(id);

	if (!client) {
		// return "#00ff00";
		throw new Error(`Client ${id} does not exist in ${JSON.stringify(Codestrate.clients)}`);
	}

	return client.color;
};

exports.getClientColorInRGBA = (id = webstrate.clientId, opacity = 1.0) => {
	return convertHexToRGBA(getClientColor(id), opacity);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="User Manager Global" run-on-load="true" data-id="Fyk5aXMy" last-execution-state="success" __wid="VAVYYpAp"><PRE data-type="content" type="text/javascript" __wid="32BTqdMC">Object.defineProperty(Codestrate, "users", {
  get() {
    let users = [];

    Codestrate.clients.forEach((c) => {
      let user = users.find((u) => u.id === c.userId);
      if (!user) {
        user = {
          id: (c.userId || c.id),
          username: c.username,
          displayName: c.displayName,
          avatarUrl: c.avatarUrl,
          clients: [c]
        };
        users.push(user);
      } else {
        user.clients.push(c);
      }
    });

    return users;
  }
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="User Manager" data-id="Bh7aPTWt" __wid="WNXGhYrS"><PRE data-type="content" type="text/javascript" id="user-manager" __wid="UwkWWdbV">exports.getUser = (userId = webstrate.user.userId) => {
	return Codestrate.users.find((user) => user.id === userId);
};</PRE></DIV></DIV><DIV name="Idle Timer" class="section section-hidden" data-type="system" data-group="basic" data-id="bZ9ftpMD" __wid="gtFGPEi9"><DIV class="paragraph body-paragraph locked collapsed" draggable="false" name="Documentation" data-id="CpWbeNtn" __wid="nDkrye3S"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="7CY4HByE"><H2 __wid="SyhMYFSr">Description</H2><DIV __wid="Nutz3Rtj">The idle timer section is a small extension to the Codestrate, which sends out awake signals when the user interacts with the Codestrate. For example, the idle timer is used for the avatar to indicate whether a user is present or absent.</DIV></DIV></DIV>
<DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="Mv7cqyj9" __wid="xK5r2kfJ"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="kqbXUqvt">{
	"version": "1.0",
	"description": "Sends out signals, when users interact with the Codestrate or are idle.",
	"changelog":
	{
		"1.0": "Initital Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" run-on-load="true" name="Idle Timer Code" data-id="SJuq3Muw" last-execution-state="success" draggable="false" __wid="qixsEUGS"><PRE data-type="content" type="text/javascript" __wid="vcUbgu6b">// Time until client becomes idle/inactive (in milliseconds)
const IDLE_TIMEOUT = 300 * 1000;

let isIdle = false;
let idleTimeout;
let lastAction = Date.now();

const actionHappend = () => {
	lastAction = Date.now();

	// Send awake message only if client was in idle mode
	if (isIdle) {
		isIdle = false;
		signalAwake();
	}

	if (idleTimeout) {
		clearTimeout(idleTimeout);
	}

	idleTimeout = setTimeout(() => {
		isIdle = true;
		signalIdle();
	}, IDLE_TIMEOUT);
};

/**
 * Signal awake message to all clients.
 */
const signalAwake = () => {
	webstrate.signal({ type: "IdleTimer", cmd: "awake" });
};

/**
 * Signal idle message to recipients or all clients.
 *
 * @param {Array|string} [recicipients] An array of client ids or a single client id indicating the recipients of the idle signal.
 */
const signalIdle = (recipients = webstrate.clients) => {
	webstrate.signal({
		type: "IdleTimer",
		cmd: "idle",
		idleTime: Date.now() - lastAction
	}, recipients);
};

// Send idle state to joining clients when idle = true
webstrate.on("clientJoin", (clientId) => {

	// Ignore own client join event
	if (clientId === webstrate.clientId) return;

	if (isIdle) {
		// We have to set a timeout here to cope with race condition. The signalIdle is
		// sent to the requesting client before the callback that listens for this message
		// is registered.
		setTimeout(() => signalIdle(clientId), 10000);
	}
});

// webstrate.on("reconnect", actionHappend);

document.addEventListener("mousemove", actionHappend);
document.addEventListener("keydown", actionHappend);
document.addEventListener("touchstart", actionHappend);
document.addEventListener("touchmove", actionHappend);
document.addEventListener("touchend", actionHappend);
actionHappend();</PRE></DIV></DIV><DIV name="Dialogs" class="section section-hidden" data-type="system" data-group="basic" data-id="aUnGvNB7" __wid="ZYh2fNf4"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="AVYTegUf" draggable="false" __wid="V58kCWTB"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="7CxxUUvL"><H2 __wid="hsvixsMD">Description</H2><DIV __wid="Bd4cvF6T">The dialog section adds support to write custom non-modal dialogs that can be used for various purposes. For example, it is used to overwrite a browser's default dialogs with non-blocking dialogs. This section also provides a dialog to show tags and restore them.</DIV><H2 __wid="SUs5GgNN">Usage</H2><DIV __wid="RXKsSpDN">You can either use one of the basic dialog functions <CODE __wid="q9rMBK83">promt()</CODE>, <CODE __wid="RBPFtkXU">alert()</CODE> and <CODE __wid="PQjYhdc3">confirm()</CODE> or create your own dialogs using the <CODE __wid="Wh5y4uk7">#dialog-template</CODE>.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="Xz6yvM28" __wid="Ph8WfGFz"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="iBue2UfS">{
	"version": "1.1.2",
	"description": "Provides a dialog template and basic functions to use them.",
	"changelog":
	{
		"1.1.2": "Added some styling for inputs and selects.",
		"1.1.1": "Expanded documentation.",
		"1.1": "Applied Material Design theme.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph body-paragraph collapsed locked" name="Dialog Template" draggable="false" data-id="wtHuW5uq" __wid="RTYk39es"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" id="dialog-template" __wid="6hUH9MFN"><DIV class="modal" __wid="ne8q4VFm"></DIV>
<DIV class="dialog ${className}" __wid="c4hDjzxC">
	<DIV class="title" __wid="PrsfsGme">${title}</DIV>
	<DIV class="body" __wid="xXT8MBCZ">${message}</DIV>
	<DIV class="actions" __wid="XiN7cRQQ">${actions}</DIV>
</DIV></DIV></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" last-execution-state="success" name="Dialog Utils" data-id="LkND9ZyA" __wid="E3VuvhbZ"><PRE data-type="content" type="text/javascript" id="dialog-utils" __wid="AMd3vqsT">/**
 * Shows an alert to the user.
 *
 * @param message      The message of the alert.
 * @param title        The title of the alert.
 * @param className    Additional classNames of the alert.
 *
 * @return Promise which resolves when the user clicks OK.
 */
exports.alert = (message, title = "", className = "") => {
	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: title === "" ? "&nbsp;" : title,
			message: message,
			actions: `&lt;div class="button ok">OK&lt;/div>`,
			className: className
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");

		const ok = () => {
			transient.remove();
			resolve(true);
		};

		okBtn.addEventListener("click", ok);

		document.body.appendChild(transient);
	});
};

/******************************************************************************/

/**
 * Shows a promt to the user.
 *
 * @param message      The message of the prompt.
 * @param defaultValue The default value of the prompt input.
 * @param title        The title of the prompt.
 * @param className    Additional classNames of the prompt.
 *
 * @return Promise which resolves either to false or the prompt input value.
 */
exports.prompt = (message, defaultValue = "", title = "", className = "") => {
	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: title === "" ? "&nbsp;" : title,
			message: `&lt;div>${message}&lt;/div>
&lt;input class="input" type="text" value="${defaultValue}">`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: className
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");
		const input = transient.querySelector(".input");

		const ok = () => {
			transient.remove();
			resolve(input.value);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		input.addEventListener("keydown", e => {
			e.stopPropagation();

			if (e.keyCode === 13) {
				e.preventDefault();
				ok();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		});

		document.body.appendChild(transient);

		input.focus();
	});
};

/******************************************************************************/

/**
 * Shows a confirm dialog to the user.
 *
 * @param message      The message of the confirm dialog.
 * @param title        The title of the confirm dialog.
 * @param className    Additional classNames of the confirm dialog.
 *
 * @return Promise which resolves either to true or false.
 */
exports.confirm = (message, title = "", className = "") => {
	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: title === "" ? "&nbsp;" : title,
			message: message,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: className
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");

		const ok = () => {
			transient.remove();
			resolve(true);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);
	});
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Dialog Style" draggable="false" data-id="L4rzUGdH" style __wid="nWgwfEP5"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="CS6XWztn">@keyframes dialogAnimation {
	from {
		transform: translate(-50%, -50%) translate(0, 96px) scale(0.75);
		opacity: 0;
	}
}

@keyframes modalAnimation {
	from {
		opacity: 0;
	}
}

html .dialog {
	display: flex;
	flex-direction: column;
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	min-width: 384px;
	max-width: calc(100vw - 32px);
	z-index: 400;
	box-shadow: var(--material-shadow-z24);
	border-radius: 2px;
	background: var(--color-primary-shade-1);
	animation: dialogAnimation var(--navigation-transition);
}

html .modal {
	position: fixed;
	left: 0;
	top: 0;
	width: 100vw;
	height: 100vh;
	background: var(--color-primary-text);
	opacity: 0.25;
	pointer-events: none;
	z-index: 399;
	animation: modalAnimation var(--navigation-transition);
}

/******************************************************************************/

html .dialog .title {
	color: var(--color-primary-text);
	display: flex;
	align-items: center;
	font-size: 1.425rem;
	font-weight: 500;
	letter-spacing: 0.02em;
	line-height: 2rem;
	flex: 1;
	margin: 0;
	padding: 24px 24px 0;
}

html .dialog .body {
	color: var(--color-secondary-text);
	font-size: 1rem;
	font-weight: 400;
	letter-spacing: 0.02em;
	line-height: 1.25rem;
	margin-top: 20px;
	padding: 0 24px 24px;
	max-height: 80vh;
	overflow-y: auto;
	max-width: 512px;
}

html .dialog .actions {
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	justify-content: flex-end;
	padding: 8px;
}

/******************************************************************************/

html .dialog .button {
	color: var(--color-primary-text);
	background: none;
	font-size: 1rem;
	font-weight: 500;
	letter-spacing: 0.04em;
	line-height: 2.25rem;
	text-decoration: none;
	text-transform: uppercase;
	display: inline-block;
	box-sizing: border-box;
	min-width: 64px;
	height: 36px;
	padding: 0 16px;
	border: none;
	outline: none;
	text-align: center;
	overflow: hidden;
	vertical-align: middle;
	border-radius: 2px;
	cursor: pointer;
	margin-right: 8px;
	user-select: none;
}

html .dialog .button:last-child {
	margin-right: 0;
}

html .dialog .button:hover {
	background-color: var(--color-primary-shade-2);
}

/******************************************************************************/

html .dialog .body input {
	font-size: 1rem;
	width: 100%;
	padding: 4px;
	outline: 0;
	color: var(--color-primary-text);
	background-color: transparent;
	border: 0;
	border-bottom: 1px solid var(--color-tertiary-text);
	margin-top: 8px;
	margin-bottom: 16px;
}

html .dialog .body input:focus {
	border-bottom-color: var(--color-secondary-text);
}

html .dialog .body input:invalid {
	border-bottom-color: var(--material-color-red);
}

html .dialog .body input::-webkit-calendar-picker-indicator {
	opacity: 1.0;
}

html .dialog .body input::-webkit-calendar-picker-indicator:hover {
	background: var(--color-primary-shade-2);
}

/******************************************************************************/

html .dialog .body select {
	background: var(--material-color-grey-100);
	color: var(--material-color-grey-900);
	font-size: 1rem;
	font-family: var(--font-primary);
	border: none;
	border-radius: 2px;
	outline: none;
	padding: 4px;
	margin-top: 8px;
	margin-bottom: 16px;
	width: 100%;
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" last-execution-state="success" run-on-load="true" name="Show Tags Dialog" data-id="JTLwYcxH" style __wid="gSn7hPhH"><PRE data-type="content" type="text/javascript" __wid="qtfpRA3F">/**
 * Shows a dialog displaying tags of the Codestrate and allowing for restoring them.
 */
Codestrate.showTags = () => {
	const transient = document.createElement("transient");

	const tags = webstrate.tags();
	const keys = Object.keys(tags);
	keys.reverse();

	let tagElementsString = "&lt;ul class='tags'>";
	let len = keys.length > 10 ? 10 : keys.length;
	for (var i = 0; i &lt; len; i++) {
		tagElementsString += `&lt;li class="tag" data-key="${keys[i]}" data-tag="${tags[keys[i]]}">${tags[keys[i]]}&lt;/li>`;
	}
	tagElementsString += "&lt;/ul>";

	const elements = require("#dialog-template", {
		title: "Restore Codestrate",
		message: tagElementsString,
		actions: `&lt;div class="button cancel">Cancel&lt;/div>`,
		className: ""
	});

	elements.forEach(e => transient.appendChild(e));

	const tagElements = Array.from(transient.querySelectorAll(".tag"));
	tagElements.forEach(element => {
		element.addEventListener("click", e => {
			const tag = element.getAttribute("data-tag");
			webstrate.restore(tag);
			window.location.reload();
		});
	});

	const cancelBtn = transient.querySelector(".cancel");

	const cancel = () => {
		transient.remove();
	};

	cancelBtn.addEventListener("click", e => {
		transient.remove();
	});

	document.body.appendChild(transient);
};</PRE></DIV>
<DIV class="paragraph style-paragraph collapsed" name="Show Tags Dialog Style" data-id="2yNTLyMH" style __wid="uBVmkZbY"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="hh5Y3srN">html .dialog ul.tags {
	list-style-type: none;
	margin: 0;
	padding: 0;
}

html .dialog ul li.tag {
	padding: 6px 8px;
	cursor: pointer;
	border-radius: 2px;
}

html .dialog ul li.tag:hover {
	background-color: var(--color-primary-shade-2);
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="us8cGJst" name="Dialog Examples" last-execution-state="success" __wid="eYvYnQEq"><PRE data-type="content" type="text/javascript" __wid="3Bt5KeFT">// Dialogs return promises, so either ".then()" or "async()" needs to be used to make code wait for them.
(async() => {

	await alert("ALERT ALERT", "ALERT");
	console.log("Pressed OK on alert");

	const myConfirmResult = await confirm("Are you really sure??", "My Title");
	if (myConfirmResult){
		console.log("Pressed OK on confirm");
	} else {
		console.log("Pressed Cancel on confirm");
	}

	const myPromptResult = await prompt("What's your name?", "Alice", "Name");
	if (myPromptResult === false) {
		console.log("Pressed Cancel on prompt");
	} else if (myPromptResult === "") {
		console.log("Empty prompt value");
	} else {
		console.log(`Hello ${myPromptResult}!`);
	}

})();</PRE></DIV></DIV><DIV class="section section-hidden" name="Toasts" data-type="system" data-id="KpPUf4hU" __wid="C3YprkRZ"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="fMjDPWw3" __wid="KM5s5Q5s"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="dzrX78Lc"><H2 __wid="7U3ue8P9">Description</H2><DIV __wid="uXtVgMta">The toast section adds the functionality to display toast messages in the bottom right corner of the screen. It is possible to set the timeout time add an optional action to toasts. This section also takes care, that there is only one toast visible at a time. Others will be queued in a waitinglist.</DIV><H2 __wid="kfEaZceW">Usage</H2><DIV __wid="kHZ5rgbS">See <CODE __wid="idanS3Jy">.toast-utils</CODE> paragraph for function documentation.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="NWNPBCkV" __wid="cxr2HRb9"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="Zkih6ea8">{
	"version": "1.0.1",
	"description": "Utility to display toast messages.",
	"changelog":
	{
		"1.0.1": "Added usage to documentation.",
		"1.0": "Initial version."
	}
}</PRE></DIV><DIV class="paragraph body-paragraph locked collapsed" data-id="Ntg4itsi" name="Toast Template" __wid="BTRbWwK9"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" id="toast-template" __wid="M6aBfXeA"><DIV class="toast ${className}" __wid="XXdQJaKs">
	<DIV class="body" __wid="ZDXsV2J8">${message}</DIV>
	<DIV class="action" __wid="WEmiA8Gn">${action}</DIV>
</DIV></DIV></DIV><DIV class="paragraph code-paragraph collapsed" data-id="mhwRpSfq" name="Toast Utils" __wid="qDZ5VM63"><PRE data-type="content" type="text/javascript" id="toast-utils" __wid="eRBnPxhw">const waitingList = [];

/******************************************************************************/

const hideToast = (transient) => {

  const toast = transient.querySelector(".toast");

	// toast set to be hidden before, e.g., a user double clicked on the element, which would add the
	// transitionend listener twice
	if (toast.classList.contains("hidden")) return;

  // make sure to remove transient when transition finished hiding the toast
  toast.addEventListener("transitionend", function onAnimationEnd() {
    // remove toast from waiting list because it has been shown and its timeout elapsed
    waitingList.shift();

    // remove toast from DOM
    transient.remove();
    toast.removeEventListener("transitionend", onAnimationEnd);

    if (waitingList.length > 0) {
      showToast();
    }
  });

  toast.classList.add("hidden");
};

const showToast = () => {
  let {
    toast,
    timeout
  } = waitingList[0];

  // append toast message to document
  document.body.appendChild(toast);

  // remove toast after timeout elapsed
  setTimeout(() => {
    hideToast(toast);
  }, timeout || 3000);
};

/******************************************************************************/

/**
 * Creates a toast message in the bottom right corner.
 *
 * @param message     The message of the toast.
 * @param timeout     The timout time in milliseconds.
 * @param action      The optional action function of the toast.
 * @param actionTitle The title of the action.
 * @param className   Additional classNames for the toast.
 */
exports.toast = (message, timeout = 3000, action = undefined, actionTitle = "", className = "") => {
  const transient = document.createElement("transient");

  const elements = require("#toast-template", {
    message: `&lt;div>${message}&lt;/div>`,
    action: `${(typeof action === "function") ? `&lt;div class="button custom-action">${actionTitle || "OK"}&lt;/div>` : ""}&lt;div class="button close">&lt;i class="material-icons">&lt;/i>&lt;/div>`,
    className: className
  });

  elements.forEach((e) => transient.appendChild(e));

  // check if an action function was defined for this toast
  if (action && typeof action === "function") {
    const actionBtn = transient.querySelector(".button.custom-action");
    actionBtn.addEventListener("click", () => hideToast(transient));
    actionBtn.addEventListener("click", action);
  }

  const closeBtn = transient.querySelector(".button.close");
  closeBtn.addEventListener("click", () => hideToast(transient));

  waitingList.push({
    toast: transient,
    timeout: timeout
  });

  if (waitingList.length === 1) {
    showToast();
  }
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Global Context" data-id="3HsuLjYL" run-on-load="true" last-execution-state="success" __wid="rWT46aHR"><PRE data-type="content" type="text/javascript" __wid="BPP52q8B">const Toasts = require("#toast-utils");

const vm = Codestrate.VirtualMachines.get("text/javascript");
vm.addToGlobalContext({
	toast: Toasts.toast
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Toast Style" data-id="es3FhyeZ" __wid="BzZCxurs"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="BLagfM9T">@keyframes toastAnimation {
	from {
		opacity: 0;
		transform: translate(0, 72px);
	}
}

html .toast {
	position: fixed;
	right: 24px;
	bottom: 24px;
	display: flex;
	align-items: center;
	justify-content: space-between;
	min-height: 48px;
	max-width: calc(100% - 48px);
	background: var(--color-primary-shade-1);
	box-shadow: var(--material-shadow-z6);
	border-radius: 2px;
	padding: 16px;
	z-index: 500;
	font-size: 0.875rem;
	word-wrap: break-word;
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	animation: toastAnimation var(--navigation-transition);
	transition: opacity var(--navigation-transition),
							transform var(--navigation-transition);
}

html .toast.hidden {
	opacity: 0;
	transform: translate(0, 72px);
}

/******************************************************************************/

html .toast .action {
	display: flex;
}

html .toast .button {
	border-radius: 2px;
	cursor: pointer;
}

html .toast .button.custom-action {
	font-weight: 500;
	letter-spacing: 0.04em;
	text-transform: uppercase;
	color: var(--color-accent);
	margin-left: 48px;
}

html .toast .button.close {
	margin-left: 16px;
	user-select: none;
}

html .toast .button.close i:after {
	content: "close";
	font-size: 1rem;
}

/******************************************************************************/

@media only screen and (max-device-width: 480px) {
	html .toast {
		right: 0;
		bottom: 0;
		width: 100%;
		max-width: 100%;
		border-radius: 0;
	}
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" name="Toast Examples" data-id="hKqqJwjM" last-execution-state="success" __wid="NGB8AhcY"><PRE data-type="content" type="text/javascript" __wid="MPgps26N">// Simple Toast
toast("My message of this toast, I have a close button:");

// Toast with custom timout
toast("I'm a very fast toast. Usually they stay for 3 seconds", 1000);

// Toast with custom action
toast("I can log messages!", 5000, () => console.log("You clicked me!"));

// Toast with custom action and title
toast("I can have every name, too", 5000, () => console.log("You clicked me, too!"), "Click Me");</PRE></DIV></DIV><DIV class="section section-hidden" data-id="9LquKSJE" name="Global Navigation" data-type="system" data-group="basic" __wid="YyvW5Qs8"><DIV class="paragraph body-paragraph collapsed locked" data-id="KDD29nq9" name="Documentation" draggable="false" __wid="yxZrX2vJ"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="sTX6GxzU"><H2 __wid="GdjjDKap">Description</H2><DIV __wid="cstNKAGm">The global navigation provides a basic navigation consisting of a <B __wid="kj5HDvJs">toolbar </B>at the top of the screen and a <B __wid="jnTzrSM7">menu </B>sidebar on the left. Using the two "Utils" paragraphs <CODE __wid="X9CBtjWw">#global-toolbar-utils</CODE> and <CODE __wid="6ZJyDfmQ">#global-menu-utils</CODE> it is possible to add new items to either the toolbar or the menu.</DIV><H2 __wid="EUDzdiEF">Global Toolbar</H2><DIV __wid="sHVPZjxd">The toolbar is fixed at the top of the screen. The toolbar consists of three container: left-, center- and right-aligned. You can put items in either of these. The toolbar should be used for actions, which add content and create new things (like adding paragraphs), or important inputs and searches.</DIV><H3 __wid="vTL7bNPb">Usage</H3><DIV __wid="UbyMGWYx">To add elements to the toolbar you can use the functions provided and documented in the <CODE __wid="55m6RQEq">#global-toolbar-utils</CODE> paragraph below.</DIV><H2 __wid="piBJFHew">Global Menu</H2><DIV __wid="AZDrCdYX">The global menu is a drawer on the left side of the screen. It can be opened by hovering the handle to open it temporarily (as long as hovered). Pressing the "menu" button in the toolbar pins the menu to be permanently visible. The menu should be used for actions, which have many entries and can be easier described by text. For multiple entries of the same package or category submenus should be used.</DIV><H3 __wid="8AHEDKiE">Usage</H3><DIV __wid="gUUQYRBb">To add elements to the toolbar you can use the functions provided and documented in the <CODE __wid="Y4apDjfv">#global-menu-utils</CODE> paragraph below.</DIV><H3 __wid="eYquRNwK">Pinning the Menu</H3><DIV __wid="3gGmCTms">The global menu uses a transient attribute added to the body element to indicate whether it is pinned or not. The respective attribute is <CODE __wid="5T4JZxRQ">transient-menu-pinned="true"</CODE>. It can also be used by other code to adjust UI elements so the menu doesn't overlay other content.</DIV><DIV __wid="fmGjgcqi"><BR __wid="HNrSve8A"/></DIV><DIV __wid="Y9LnpMyh">The <CODE __wid="2TQRbt2M">#global-menu-utils</CODE> also provide functions to open, close or toggle the menu pinning.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="R2Gx7nZ3" style __wid="ngnjGjN5"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="aJCcsQHt">{
	"version": "1.2.4",
	"description": "Provides the basic navigation consisting of toolbar and menu.",
	"changelog":
	{
		"1.2.4": "Commands API used.",
		"1.2.3": "Adjusted placing and styles of toolbar to new structure.",
		"1.2.2": "Updated Codestrate menu entries.",
		"1.2.1": "Updated documentation and added examples.",
		"1.2": "Added toolbar and changed theme to Material Design.",
		"1.1": "Added submenus and create functions.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph body-paragraph locked collapsed" data-id="UvFTUhZK" name="Global Toolbar Template" draggable="false" style __wid="6f5YVenu"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" __wid="nTykXfY4"><TEMPLATE id="global-toolbar-template" __wid="wnfeAKvd">
	<TRANSIENT id="global-toolbar" __wid="6s4Y9iMh">
		<DIV class="toolbar-row" __wid="AHikCkN6">
			<DIV class="toolbar-container toolbar-left" __wid="wZGKF2it"></DIV>
			<DIV class="toolbar-container toolbar-center" __wid="8PhUm5nb"></DIV>
			<DIV class="toolbar-container toolbar-right" __wid="q5uj2AAd"></DIV>
		</DIV>
	</TRANSIENT>
</TEMPLATE></DIV></DIV><DIV class="paragraph body-paragraph collapsed" data-id="sP2y6U2W" name="Global Menu Template" draggable="false" style __wid="zwPgwWJa"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="true" __wid="pBqPfRBc"><TEMPLATE id="global-menu-template" __wid="JxzNHtuq">
	<TRANSIENT id="global-menu" __wid="pCXnxaWU">
		<SPAN class="handle material-icons" __wid="trZjhH5a"></SPAN>
		<DIV class="menu-container" __wid="bWY48TGA"></DIV>
	</TRANSIENT>
</TEMPLATE></DIV></DIV><DIV class="paragraph code-paragraph collapsed" data-id="pa2PDQ5T" name="Add Global Toolbar and Menu" draggable="false" style run-on-load="true" last-execution-state="success" __wid="LqGPE8fu"><PRE data-type="content" type="text/javascript" __wid="ruPyQNpv">const globalToolbarTemplate = document.querySelector("#global-toolbar-template");
const globalToolbarFragment = document.importNode(globalToolbarTemplate.content, true);
document.body.appendChild(globalToolbarFragment);

const globalMenuTemplate = document.querySelector("#global-menu-template");
const globalMenuFragment = document.importNode(globalMenuTemplate.content, true);
document.body.appendChild(globalMenuFragment);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="giNkDZSm" name="Global Toolbar Utils" draggable="false" style __wid="9Wi5YkBB"><PRE data-type="content" type="text/javascript" id="global-toolbar-utils" __wid="A2PP9PBa">const globalToolbar = document.querySelector("#global-toolbar");
const toolbarLeft = globalToolbar.querySelector(".toolbar-left");
const toolbarCenter = globalToolbar.querySelector(".toolbar-center");
const toolbarRight = globalToolbar.querySelector(".toolbar-right");

/******************************************************************************/

exports.open = () => {
	document.body.removeAttribute("transient-toolbar-hidden");
};

exports.close = () => {
	document.body.setAttribute("transient-toolbar-hidden", "true");
};

exports.toggle = () => {
	if (document.body.hasAttribute("transient-toolbar-hidden")) {
		exports.open();
	} else {
		exports.close();
	}
};

/******************************************************************************/

/**
 * Adds a &lt;hr> divider to the toolbar.
 *
 * @param container  Toolbar container to add the divider to
 *                   (-1: left, 0: center, 1: right (default)).
 * @param classNames Additional CSS classes for the divider.
 */
exports.addDivider = (container, classNames = false) => {
	const divider = document.createElement("hr");
	if (classNames) divider.setAttribute("class", classNames);
	exports.addToolbarItem(divider, container);
};

/**
 * Adds an HTML element to a toolbar container.
 *
 * @param toolbarItem The HTML element to add to the toolbar.
 * @param container   Toolbar container to add the item to
 *                    (-1: left, 0: center, 1: right (default)).
 */
exports.addToolbarItem = (toolbarItem, container = 1) => {
	if (container === -1) {
		toolbarLeft.appendChild(toolbarItem);
	} else if (container === 0) {
		toolbarCenter.appendChild(toolbarItem);
	} else {
		toolbarRight.appendChild(toolbarItem);
	}
};

/******************************************************************************/

/**
 * Creates and adds a button to the toolbar.
 *
 * @param title      The title-attribute of the button.
 * @param icon       The icon of the button (use Material Icons string).
 * @param classNames Additional CSS classes for the button.
 * @param container  Toolbar container to add the button to
 *                   (-1: left, 0: center, 1: right (default)).
 * @param action     The function to perform on clicks.
 */
exports.addButton = (title, icon, classNames, container, action) => {
	const button = exports.createButton(title, icon, classNames, action);
	exports.addToolbarItem(button, container);
};

/**
 * Creates and adds a title to the toolbar.
 *
 * @param title      The title-attribute of the title.
 * @param classNames Additional CSS classes for the title.
 * @param content    The text of the title.
 * @param container  Toolbar container to add the title to
                     (-1: left, 0: center, 1: right (default)).
 */
exports.addTitle = (title, classNames, content, container) => {
	const titleElement = exports.createTitle(title, classNames, content);
	exports.addToolbarItem(titleElement, container);
};

/**
 * Creates and adds a input for the toolbar.
 *
 * @param title       The title-attribute of the input.
 * @param classNames  Additional CSS classes for the input.
 * @param content     The text of the input.
 * @param container   Toolbar container to add the input to
 *                    (-1: left, 0: center, 1: right (default)).
 * @param inputAction Function for the "input" eventlistener of the input.
 */
exports.addInput = (title, classNames, content, container, inputAction) => {
	const input = exports.createInput(title, classNames, content, inputAction);
	exports.addToolbarItem(input, container);
};

/**
 * Creates and adds a search for the toolbar.
 *
 * @param title        The title-attribute of the search.
 * @param classNames   Additional CSS classes for the search.
 * @param placeholder  The placeholder text of the search.
 * @param container    Toolbar container to add the search to
 *                     (-1: left, 0: center, 1: right (default)).
 * @param searchAction Function for the search.
 *
 * @return The created search.
 */
exports.addSearch = (title, classNames, placeholder, container, searchAction) => {
	const search = exports.createSearch(title, classNames, placeholder, searchAction);
	exports.addToolbarItem(search, container);
};

/******************************************************************************/

/**
 * Creates a button for the toolbar and returns it.
 *
 * @param title      The title-attribute of the button.
 * @param icon       The icon of the button (use Material Icons string).
 * @param classNames Additional CSS classes for the button.
 * @param action     The function to perform on clicks.
 *
 * @return The created button.
 */
exports.createButton = (title, icon = "", classNames = false, action = false) => {
	const button = document.createElement("span");
	button.setAttribute("title", title);

	const i = document.createElement("i");
	i.classList.add("material-icons");
	i.innerHTML = icon;

	button.appendChild(i);

	if (classNames) {
		button.setAttribute("class", classNames);
	}
	button.classList.add("toolbar-button");

	if (typeof action === "function") {
		button.addEventListener("click", action);
	}

	return button;
};

/**
 * Creates a title for the toolbar and returns it.
 *
 * @param title      The title-attribute of the title.
 * @param classNames Additional CSS classes for the title.
 * @param content    The text of the title.
 *
 * @return The created title.
 */
exports.createTitle = (title, classNames = false, content = false) => {
	const titleElement = document.createElement("span");
	titleElement.setAttribute("title", title);

	if (classNames) {
		titleElement.setAttribute("class", classNames);
	}
	titleElement.classList.add("toolbar-title");

	if (content) {
		titleElement.innerText = content;
	}

	return titleElement;
};

/**
 * Creates a input for the toolbar and returns it.
 *
 * @param title       The title-attribute of the input.
 * @param classNames  Additional CSS classes for the input.
 * @param content     The text of the input.
 * @param inputAction Function for the "input" eventlistener of the input.
 *
 * @return The created input.
 */
exports.createInput = (title, classNames = false, content = false, inputAction = false) => {
	const inputElement = exports.createTitle(title, classNames, content);
	inputElement.classList.add("toolbar-input");
	inputElement.setAttribute("contenteditable", "true");
	inputElement.addEventListener("keypress", event => {
		if (event.which === 13) {
			event.preventDefault();
		}
	});

	if (typeof inputAction === "function") {
		inputElement.addEventListener("input", () => inputAction(inputElement));
	}

	return inputElement;
};

/**
 * Creates a search for the toolbar and returns it.
 *
 * @param title        The title-attribute of the search.
 * @param classNames   Additional CSS classes for the search.
 * @param placeholder  The placeholder text of the search.
 * @param searchAction Function for the search.
 *
 * @return The created search.
 */
exports.createSearch = (title, classNames = false, placeholder = false, searchAction = false) => {
	const search = document.createElement("span");
	search.setAttribute("title", title);

	if (classNames) {
		search.setAttribute("class", classNames);
	}
	search.classList.add("toolbar-search");

	const searchInput = document.createElement("input");
	searchInput.classList.add("toolbar-search-input");
	searchInput.setAttribute("placeholder", placeholder ? placeholder : "Search");
	searchInput.addEventListener("keypress", event => {
		if (event.which === 13) {
			searchAction(searchInput);
		}
	});

	const searchButton = exports.createButton("Search", "", "toolbar-search-button-search", () => {
		searchAction(searchInput);
	});

	const clearSearchButton = exports.createButton("Clear Search", "", "toolbar-search-button-clear", () => {
		searchInput.value = "";
	});

	search.appendChild(searchButton);
	search.appendChild(searchInput);
	search.appendChild(clearSearchButton);

	return search;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" style draggable="false" name="Global Menu Utils" data-id="H9YMLbvG" __wid="jL9m3Qik"><PRE data-type="content" type="text/javascript" id="global-menu-utils" __wid="XsawXV3A">const globalMenu = document.querySelector("#global-menu");
const container = globalMenu.querySelector(".menu-container");

/******************************************************************************/

exports.open = () => {
	document.body.setAttribute("transient-menu-pinned", "true");
};

exports.close = () => {
	document.body.removeAttribute("transient-menu-pinned");
};

exports.toggle = () => {
	if (document.body.hasAttribute("transient-menu-pinned")) {
		exports.close();
	} else {
		exports.open();
	}
};

/******************************************************************************/

/**
 * Adds a &lt;hr> divider to the menu.
 *
 * @param classNames Additional CSS classes for the divider.
 */
exports.addDivider = (classNames = false) => {
	const divider = document.createElement("hr");
	if (classNames) divider.setAttribute("class", classNames);
	container.appendChild(divider);
};

/**
 * Adds an HTML element to the menu.
 *
 * @param menuItem The HTML elemen to add.
 */
exports.addMenuItem = (menuItem) => {
	container.appendChild(menuItem);
};

/******************************************************************************/

/**
 * Creates and adds a button to the menu.
 *
 * @param name       The name of the button.
 * @param classNames Additional CSS classes for the button.
 * @param action     The function to perform on clicks.
 */
exports.addButton = (name, classNames, action) => {
	const button = exports.createButton(name, classNames, action);
	container.appendChild(button);
};

/**
 * Creates and adds (if not already available) a submenu to the menu.
 *
 * @param name The name of the submenu.
 */
exports.addSubMenu = (subMenuName) => {
	let subMenu = container.querySelector(`.sub-menu[name="${subMenuName}"]`);
	if (!subMenu) {
		subMenu = exports.createSubMenu(subMenuName);
		container.appendChild(subMenu);
	}
};

/**
 * Adds an HTML element to a submenu. The submenu will be added if not available.
 *
 * @param menuItem    The HTML elemen to add.
 * @param subMenuName The name of the submenu.
 */
exports.addMenuItemToSubMenu = (menuItem, subMenuName) => {
	let subMenu = container.querySelector(`.sub-menu[name="${subMenuName}"]`);
	if (!subMenu) {
		subMenu = exports.createSubMenu(subMenuName);
		container.appendChild(subMenu);
	}
	subMenu.appendChild(menuItem);
};

/**
 * Creates and adds a button to a submenu. The submenu will be added if not available.
 *
 * @param name        The name of the button.
 * @param classNames  Additional CSS classes for the button.
 * @param action      The function to perform on clicks.
 * @param subMenuName The name of the submenu.
 */
exports.addButtonToSubMenu = (name, classNames, action, subMenuName) => {
	const button = exports.createButton(name, classNames, action);
	exports.addMenuItemToSubMenu(button, subMenuName);
};

/******************************************************************************/

/**
 * Creates a button for the menu and returns it.
 *
 * @param name       The name of the button.
 * @param classNames Additional CSS classes for the button.
 * @param action     The function to perform on clicks.
 *
 * @return The created button.
 */
exports.createButton = (name, classNames, action) => {
	const button = document.createElement("div");
	button.innerText = name;

	if (classNames) {
		button.setAttribute("class", classNames);
	}
	button.classList.add("menu-button");

	if (typeof action === "function") {
		button.addEventListener("click", action);
	}

	return button;
};

/**
 * Creates a submenu and returns it.
 *
 * @param name The name of the submenu.
 */
exports.createSubMenu = (name) => {
	const subMenu = document.createElement("div");
	subMenu.setAttribute("name", name);
	subMenu.classList.add("sub-menu", "hidden");

	const label = document.createElement("div");
	label.classList.add("label");
	label.innerHTML = `&lt;span class="expander">&lt;i class="material-icons">&lt;/i>&lt;/span>&lt;span class="title">${name}&lt;/span>`;
	label.addEventListener("click", () => {
		subMenu.classList.toggle("hidden");
	});

	subMenu.appendChild(label);

	return subMenu;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Init Global Toolbar and Menu" draggable="false" style data-id="7aMu3qpU" run-on-load="true" last-execution-state="success" __wid="4kedhWPk"><PRE data-type="content" type="text/javascript" __wid="Eji7rvJg">const GlobalToolbarUtils = require("#global-toolbar-utils");
const GlobalMenuUtils = require("#global-menu-utils");
const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

// Add menu button
Codestrate.addCommand("codestrates.toggleMenu", "Toggle Menu", () => {
	GlobalMenuUtils.toggle();
});
GlobalToolbarUtils.addButton("Menu", "", "toolbar-button-menu", -1, () => {
	Codestrate.executeCommand("codestrates.toggleMenu");
});

// Add contenteditable for the Codestrate title
const titleInput = GlobalToolbarUtils.createInput("Codestrate Title", "toolbar-input-title", document.title, (inputElement) => {
	document.title = inputElement.innerText;
});

titleInput.__titleObserver = new MutationObserver(() => {
	const position = HTMLUtils.getCaretPosition(titleInput);
	titleInput.innerText = document.title;
	HTMLUtils.setCaretPosition(titleInput, position);
});

titleInput.__titleObserver.observe(document.querySelector("title"), { characterData: true, attributes: false, childList: true, subtree: true });
GlobalToolbarUtils.addToolbarItem(titleInput, -1);

/******************************************************************************/

Codestrate.addCommand("codestrates.sections.addSection", "Add Section", () => {
	const section = document.createElement("div");
	section.classList.add("section");
	section.classList.add("section-visible");

	const sections = document.querySelector('#sections');
	if (Codestrate.focussedSection) {
		sections.insertBefore(section, Codestrate.focussedSection.nextSibling);
	} else {
		sections.appendChild(section);
	}

	Codestrate.simulateClick(section);
});
GlobalToolbarUtils.addButton("Add Section", "label", false, 1, () => {
	Codestrate.executeCommand("codestrates.sections.addSection");
});

Codestrate.addCommand("codestrates.sections.addBodyParagraph", "Add Body Paragraph", () => {
	const bodyParagraph = ParagraphUtils.createBodyParagraph();
	bodyParagraph.querySelector("[data-type='content']").classList.add("writing");
	ParagraphUtils.insertParagraphAfterFocussed(bodyParagraph);
});
GlobalToolbarUtils.addButton("Add Body Paragraph", "text_fields", "section-tools", 1, () => {
	Codestrate.executeCommand("codestrates.sections.addBodyParagraph");
});

Codestrate.addCommand("codestrates.sections.addStyleParagraph", "Add Style Paragraph", () => {
	ParagraphUtils.insertParagraphAfterFocussed(ParagraphUtils.createStyleParagraph());
});
GlobalToolbarUtils.addButton("Add Style Paragraph", "brush", "section-tools", 1, () => {
	Codestrate.executeCommand("codestrates.sections.addStyleParagraph");
});

Codestrate.addCommand("codestrates.sections.addCodeParagraph", "Add Code Paragraph", () => {
	ParagraphUtils.insertParagraphAfterFocussed(ParagraphUtils.createCodeParagraph());
});
GlobalToolbarUtils.addButton("Add Code Paragraph", "code", "section-tools", 1, () => {
	Codestrate.executeCommand("codestrates.sections.addCodeParagraph");
});

Codestrate.addCommand("codestrates.sections.addDataParagraph", "Add Data Paragraph", () => {
	ParagraphUtils.insertParagraphAfterFocussed(ParagraphUtils.createDataParagraph());
});
GlobalToolbarUtils.addButton("Add Data Paragraph", "storage", "section-tools", 1, () => {
	Codestrate.executeCommand("codestrates.sections.addDataParagraph");
});

/******************************************************************************/

const getLoadModeLabel = () => {
	return Codestrate.mode === "edit" ? 'Switch to "No Edit" Mode' : 'Switch to Edit Mode';
};

Codestrate.addCommand("codestrates.toggleLoadMode", "Toggle Load Mode", () => {
	if (Codestrate.mode === "edit") {
		Codestrate.mode = "no-edit";
		toggleLoadModeButton.innerHTML = getLoadModeLabel();
	}
	else {
		Codestrate.mode = "edit";
		toggleLoadModeButton.innerHTML = getLoadModeLabel();
	}

	toast(`Codestrate is in "${Codestrate.mode}" mode`);
});
const toggleLoadModeButton = GlobalMenuUtils.createButton(getLoadModeLabel(), false, () => {
	Codestrate.executeCommand("codestrates.toggleLoadMode");
});

Codestrate.addCommand("codestrates.createCodestrateCopy", "Create Copy of Codestrate", () => {
	window.open(`/${webstrate.webstrateId}/?copy`);
});
const createCodestrateCopyButton = GlobalMenuUtils.createButton("Create Copy of Codestrate", false, () => {
	Codestrate.executeCommand("codestrates.createCodestrateCopy");
});

Codestrate.addCommand("codestrates.tagCodestrate", "Tag Codestrate", async() => {
	const name = await prompt("Set a tag name:", "", "Tag Codestrate");
	if (name) {
		webstrate.tag(name);
		toast(`Tagged codestrate "${name}"`);
	}
});
const tagCodestrateButton = GlobalMenuUtils.createButton("Tag Codestrate", false, () => {
	Codestrate.executeCommand("codestrates.tagCodestrate");
});

Codestrate.addCommand("codestrates.restoreCodestrate", "Restore Codestrate", () => {
	Codestrate.showTags();
});
const restoreCodestrateButton = GlobalMenuUtils.createButton("Restore Codestrate", false, () => {
	Codestrate.executeCommand("codestrates.restoreCodestrate");
});

/******************************************************************************/

const subMenuName = "Codestrate";

GlobalMenuUtils.addMenuItemToSubMenu(toggleLoadModeButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(createCodestrateCopyButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(tagCodestrateButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(restoreCodestrateButton, subMenuName);</PRE></DIV>
<DIV class="paragraph style-paragraph collapsed" data-id="y7Q3AHEx" draggable="false" style name="Global Toolbar Style" __wid="Xpgc3zYR"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="uS3c2ggU">html #global-toolbar {
	background: var(--color-primary);
	color: var(--color-primary-text);
	display: block;
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 64px;
	overflow-x: scroll;
	overflow: visible;
	z-index: 200;
	box-shadow: var(--material-shadow-z4);
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	transition: transform var(--navigation-transition),
							box-shadow var(--navigation-transition);
}

html #global-toolbar::-webkit-scrollbar {
	display: none;
}

html body[transient-toolbar-hidden="true"] #global-toolbar {
	box-shadow: none;
	transform: translate(0, -100%);
}

/******************************************************************************/

html #global-toolbar .toolbar-row {
	display: flex;
	justify-content: space-between;
	position: relative;
	align-items: center;
	width: 100%;
	height: 100%;
	padding: 8px;
}

html #global-toolbar .toolbar-container {
	display: flex;
	box-sizing: border-box;
	height: 48px;
	vertical-align: middle;
	z-index: 1;
}

html #global-toolbar .toolbar-left {
	flex: 1 0 auto;
	justify-content: flex-start;
	order: -1;
	padding-right: 32px;
}

html #global-toolbar .toolbar-center {
	flex: 1 1 100%;
	justify-content: center;
	order: 0;
}

html #global-toolbar .toolbar-right {
	flex: 0 0 auto;
	justify-content: flex-end;
	order: 1;
	padding-left: 32px;
}

/******************************************************************************/

html #global-toolbar .toolbar-button {
	display: flex;
	padding: 4px;
	width: 48px;
	height: 48px;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	border-radius: 50%;
	flex-shrink: 0;
	user-select: none;
}

html #global-toolbar .toolbar-title {
	font-size: 1.25rem;
	font-weight: 500;
	letter-spacing: 0.02rem;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
	align-self: center;
	padding: 0 16px;
}

html #global-toolbar .toolbar-title+.toolbar-title {
	padding-left: 0;
}

html #global-toolbar .toolbar-input {
	cursor: text;
	outline: none;
}

html #global-toolbar .toolbar-input:empty:before {
	content: "Empty";
	opacity: 0.5;
}

html #global-toolbar .toolbar-search {
	background: var(--color-primary-shade-1);
	border-radius: 4px;
	display: flex;
	flex: 0 1 512px;
}

html #global-toolbar .toolbar-search-input {
	flex: 0 1 100%;
	outline: none;
	background: none;
	border: none;
	color: var(--color-primary-text);
	text-overflow: ellipsis;
	font-size: 1em;
	letter-spacing: 0.02rem;
}

html #global-toolbar .toolbar-search-input::placeholder {
	color: var(--color-tertiary-text);
}

html #global-toolbar .toolbar-search-button-search,
html #global-toolbar .toolbar-search-button-clear {
	width: 40px;
	height: 40px;
	margin: 4px;
}

html #global-toolbar .toolbar-search-button-search i:after {
	content: "search";
}

html #global-toolbar .toolbar-search-input:placeholder-shown ~ .toolbar-search-button-clear {
	visibility: hidden;
}

html #global-toolbar .toolbar-search-button-clear i:after {
	content: "clear";
}

/******************************************************************************/

html #global-toolbar .toolbar-input-title:empty:before {
	content: "No Title";
}

html #global-toolbar .toolbar-button-menu {
	padding-right: 24px;
	padding-left: 24px;
}

html #global-toolbar .toolbar-button-menu i:after {
	content: "menu";
}

/******************************************************************************/

html #global-toolbar hr {
	border: none;
	border-left: 1px solid var(--color-primary-text);
	margin: 8px 4px;
	opacity: 0.8;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Global Menu Style" draggable="false" data-id="wckGBv9N" style __wid="du6NTTM2"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="L6qvakWs">html #global-menu {
	background-color: var(--color-primary-shade-1);
	color: var(--color-primary-text);
	position: fixed;
	top: 0;
	left: 0;
	width: 288px;
	height: 100%;
	z-index: 100;
	padding-top: 80px;
	padding-bottom: 8px;
	box-shadow: var(--material-shadow-z16);
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	transition: transform var(--navigation-transition),
							box-shadow var(--navigation-transition),
							padding-top var(--navigation-transition);
}

html body[transient-toolbar-hidden="true"] #global-menu {
	padding-top: 16px;
}

html body:not([transient-menu-pinned="true"]) #global-menu {
	transform: translate(-100%, 0);
	box-shadow: none;
}

/******************************************************************************/

html body:not([transient-menu-pinned="true"])  #global-menu:hover {
	transform: none;
	box-shadow: var(--material-shadow-z16);
}

html #global-menu .handle {
	position: absolute;
	right: 0;
	top: 50%;
	transform: translate(100%, -50%);
	transition: opacity var(--navigation-transition);
}

html #global-menu .handle:after {
	content: "keyboard_arrow_right";
	background: var(--color-primary);
	border-top-right-radius: 50%;
	border-bottom-right-radius: 50%;
}

html #global-menu:hover .handle,
html body[transient-menu-pinned="true"] #global-menu .handle {
	opacity: 0;
}

/******************************************************************************/

html #global-menu .menu-container {
	display: flex;
	flex-direction: column;
	width: 100%;
	height: 100%;
	overflow: hidden;
	overflow-y: auto;
	flex-wrap: nowrap;
}

/******************************************************************************/

html #global-menu .menu-container hr {
	border: 0;
	border-bottom: 1px solid var(--color-primary-shade-3);
	width: 100%;
}

html #global-menu .menu-container .menu-button,
html #global-menu .menu-container .sub-menu > .label {
	height: 40px;
	font-weight: 500;
	cursor: pointer;
	font-size: 0.9rem;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
	display: flex;
	align-items: center;
	justify-content: flex-start;
	border: none;
	background: none;
	padding-left: 16px;
	padding-right: 16px;
	flex-shrink: 0;
	user-select: none;
}


html #global-menu .menu-container .sub-menu {
	display: flex;
	flex-direction: column;
	flex-wrap: nowrap;
	flex-shrink: 0;
	border: 0;
	padding-bottom: 8px;
	border-bottom: 1px solid var(--color-primary-shade-3);
	margin-bottom: 8px;
}

html #global-menu .menu-container .sub-menu > .label .expander {
	margin-right: 8px;
}

html #global-menu .menu-container .menu-button:hover,
html #global-menu .menu-container .sub-menu > .label:hover,
html #global-menu .menu-container .sub-menu:not(.hidden) > .label {
	background: var(--color-primary-shade-2);
}

html #global-menu .menu-container .sub-menu > .label i {
	font-size: 1.4rem;
	display: flex
}

html #global-menu .menu-container .sub-menu > .label i:after {
	content: "keyboard_arrow_down";
}

html #global-menu .menu-container .sub-menu.hidden > .label i:after {
	content: "keyboard_arrow_right";
}

html #global-menu .menu-container .sub-menu.hidden > *:not(.label) {
	display: none;
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="LihLx6rS" name="Global Navigation Examples" last-execution-state="success" __wid="XgA9rDVJ"><PRE data-type="content" type="text/javascript" __wid="FhJfEx5b">const GlobalToolbarUtils = require("#global-toolbar-utils");
const GlobalMenuUtils = require("#global-menu-utils");

/******************************************************************************/

// Add a divider to the left of the toolbar
GlobalToolbarUtils.addDivider(-1, "example-css-class");

// Add a button which logs something to the left of the toolbar
GlobalToolbarUtils.addButton("Example Button", "message", "example-css-class", -1, () => console.log("You logged something from the toolbar!"));

// Add a title to the center of the toolbar
GlobalToolbarUtils.addTitle("Example Title", "example-css-class", "You can't edit me!", 0);

// Add an input, which logs it's content, to the center of the toolbar
GlobalToolbarUtils.addInput("Example Input", "example-css-class", "Edit me!", 0, (inputElement) => console.log(inputElement.innerText));

// Add a search, which logs it's content and clears itself, to the right of the toolbar
GlobalToolbarUtils.addSearch("Example Search", "example-css-class", "Oh my I'm empty!", 1, (searchInput) => {
	if (searchInput.value === "") {
		console.log("Enter something first!");
	} else {
		console.log(searchInput.value);
		searchInput.value = "";
	}
});

// Add custom element to the center of the toolbar
const toolbarSpan = document.createElement("span");
toolbarSpan.setAttribute("style", "background: hotpink; width: 48px;");
GlobalToolbarUtils.addToolbarItem(toolbarSpan, 0);

/******************************************************************************/

// Add a button to the menu
GlobalMenuUtils.addButton("Example Button", "example-css-class", () => console.log("You logged something from the menu!"));

// Add a divider to the menu
GlobalMenuUtils.addDivider("example-css-class");

// Add a empty submenu to the menu
GlobalMenuUtils.addSubMenu("Empty SubMenu");

// Add a submenu with a button to the menu
GlobalMenuUtils.addButtonToSubMenu("SubMenu 1", "example-css-class", () => console.log("SubMenu 1"), "Example SubMenu");

// Add custom element to the menu
const menuSpan = document.createElement("span");
menuSpan.setAttribute("style", "background: hotpink; height: 48px;");
GlobalMenuUtils.addMenuItem(menuSpan);</PRE></DIV></DIV><DIV class="section section-hidden" name="Snackbar" data-type="system" data-id="NELYfTiq" __wid="gRgCHTvC"><DIV class="paragraph body-paragraph collapsed locked" name="Documentation" data-id="aveXm4uW" __wid="HnsVyPPa"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="rb6Tuub2"><H2 __wid="TgJbD5Df">Description</H2>
<DIV __wid="sfgXZGPf">The snackbar provides a toolbar to display actions to manipulate or transform currently focussed paragraphs or elements. To use basic snackbar functions like adding items one needs to use the <CODE __wid="pN4vp9UK">#snackbar-utils</CODE>. The management of when items show is done by the "Snackbar Tools", which can be accessed using the <CODE __wid="2zGegVBc">#snackbar-tools</CODE>.</DIV><H2 __wid="B3pPJuYg">Snackbar</H2><DIV __wid="khSNZsrH">The snackbar implementation offers a second toolbar at the bottom of the screen, which can be expanded to show content like editors, consoles or any other HTML elements. The content can also be expanded to show even more of the content.</DIV><H3 __wid="riMpe4gr">States</H3><DIV __wid="4mFkZvRN">The snackbar has three states, indicated by three classes, which are attached to the <CODE __wid="KcVzUqHi">#snackbar</CODE> element.</DIV><DIV __wid="Jvh3brLV"><UL __wid="tHQs7ykF"><LI __wid="hKWwZpH8"><CODE __wid="efBtwARw">.row-open</CODE>: The toolbar part of the snackbar is visible.</LI><LI __wid="SkB45bD5"><CODE __wid="uRddUPxg">.content-open</CODE>: The content of the snackbar is visible (e.g. when editing HTML of body paragraphs).</LI><LI __wid="jyHFzcZe"><CODE __wid="XpWkbBjd">.content-expanded-open</CODE>: The content of the snackbar is expanded to the top of the screen.</LI></UL><DIV __wid="vwjGXJWg"><B __wid="qtuUuRsL">Note</B>: Switching between these states is usually done by the Snackbar implementation and Snackbar Tools. So calling the <CODE __wid="DVrRcQBv">openRow() / openContent() / openContentExpanded()</CODE> and respective <CODE __wid="ARtHfTjn">close()</CODE> functions usually don't need to be called manually.</DIV></DIV><H3 __wid="dJpx7in7">Snackbar Content</H3><H4 __wid="P63ZN6LK">Adding and Removing Content</H4><DIV __wid="HB7XtKBn">It is possible to show display any HTML element in the content of the snackbar. This can be done by using the <CODE __wid="NYPAMTVe">setContent()</CODE> function. The snackbar will automatically switch to the <CODE __wid="K9JGN8Jg">.content-open</CODE> state upon setting content.</DIV><DIV __wid="uahqjXej">Removing the content later on can be done by the <CODE __wid="d6NZfdDn">removeContent()</CODE> function. The function will return the content of the snackbar and additionally fire an <CODE __wid="LhWwatgr">SnackbarRemoveContent</CODE> event with the content as <CODE __wid="FNWVmmd9">event.detail</CODE>. Upon removing the content, the snackbar will automatically switch back to the <CODE __wid="hfmbdTMk">.row-open</CODE> state.</DIV><DIV __wid="uWy73Mtx"><B __wid="e5GBauHJ">Note</B>: When closing the content (by pressing the close button or calling the <CODE __wid="MW8QqhsX">closeContent()</CODE> function) without removing the content in advance, the content will automatically be removed. Therefore the event of removing content should be listened to in case the content is still needed.</DIV><H4 __wid="772EmN9R">SnackbarRemoveContent Event</H4><DIV __wid="AkywffVC">When the content of the snackbar closes and the content gets removed an event will be fired containing the removed content. Functions and listen to the event and react on it, if the removed content is still needed, e.g. if it's the editor of a paragraph.</DIV><H4 __wid="KbUP6R3R">Snackbar Content Related Paragraph</H4><DIV __wid="HEnk3Fsy">If the content of the snackbar is related to a paragraph (e.g. when opening the console of a code paragraph in it), the related paragraph should receive the attribute <CODE __wid="ChmXhWuf">transient-content-paragraph="true"</CODE>. This makes it easier for the user to find the related paragraph at a glance. Remember to remove the attribute after the content is closed.</DIV><H3 __wid="HFd7Ns2t">Usage</H3><DIV __wid="LtPDJqFE">Functions to open the row, the content and the expanded content aswell as functions to add items can be found in the <CODE __wid="V9h7WgaT">#snackbar-utils</CODE>.</DIV><H2 __wid="TAXD3LNJ">Snackbar Tools</H2><DIV __wid="8xJgnzwK">The snackbar tools are an extension of the snackbar providing the functionality to show and hide icons according to the currently selected/clicked element/paragraph/section. Upon clicking on any element expect the global toolbar, global menu or snackbar itself, the set of active tools will be updated.</DIV><DIV __wid="tAENPwYB">This is done by adding <CODE __wid="ixw5jVzh">-tools="true"</CODE> attributes to the snackbar element and a <CODE __wid="wFViQ5An">-tools</CODE> class to the items. Using a styling like this then hides all items, which are not active at the moment:</DIV><PRE __wid="QV5zAue2"><CODE __wid="JLCjenvC">html #snackbar:not([myName-tools="true"]) .myName-tools {
  display: none;
}</CODE></PRE><DIV __wid="nRMh52US"><B __wid="LQiTBtSt">Note</B>: The styling needs to be added manually if needed.</DIV><H3 __wid="p9mjYj26">Default Tools</H3><DIV __wid="KjKpzaHA">The default tools, which come with this section, are the following:</DIV><DIV __wid="HSjaUSya"><UL __wid="Xf4DCNNc"><LI __wid="qNSZQS6j"><CODE __wid="dHTcp7pD">.section-tools</CODE>: Activated, when there is a <CODE __wid="gsZSVnYG">Codestrate.focussedSection</CODE>.</LI><LI __wid="SJapm7N5"><CODE __wid="ECWU3Wac">.paragraph-tools</CODE>: Activated, when there is a<CODE __wid="XhhvL8Un">Codestrate.focussedParagraph</CODE>.</LI><LI __wid="BKD4xffF"><CODE __wid="TphdkTsg">.body-tools</CODE>: Activated, when the <CODE __wid="y6kv8386">Codestrate.focussedParagraph</CODE> is a body paragraph.</LI><LI __wid="hSrLVPid"><CODE __wid="hZJfziSk">.style-tools</CODE>: Activated, when the <CODE __wid="WZri5ad6">Codestrate.focussedParagraph</CODE> is a style paragraph.</LI><LI __wid="y23SEYVW"><CODE __wid="a7KgTJrm">.code-tools</CODE>: Activated, when the <CODE __wid="C4d2VZQA">Codestrate.focussedParagraph</CODE> is a code paragraph.</LI><LI __wid="mCPHgj9h"><CODE __wid="enTzJYqn">.data-tools</CODE>: Activated, when the <CODE __wid="SPj35QgB">Codestrate.focussedParagraph</CODE> is a data paragraph.</LI><LI __wid="ytTcQvzD"><CODE __wid="B69iTRjj">.content-tools</CODE>: Activated, when the content of the snackbar is visible. The content tools override other tools. So while the content is open, only content-tools are visible.</LI></UL><H3 __wid="xuG7Ng92">Adding Tools</H3></DIV><DIV __wid="dv9gBiUa">Tools can be added using the <CODE __wid="y2iqGS7W">addTools()</CODE> function of the <CODE __wid="b6tTdey5">#snackbar-tools</CODE> paragraph. The functions takes two parameters:</DIV><DIV __wid="8aqy87Ku"><UL __wid="HwpAAZ54"><LI __wid="5wKWPavQ"><CODE __wid="x3gMqNkh">checkToolsAction</CODE>: A callback function, which is called every time the Snackbar Tools update the tools (so when clicking on elements). The function is called with the <CODE __wid="MMzSHyaK">event.target</CODE> as a parameter and needs to return either <CODE __wid="xiwSieCc">true</CODE> if the tools should be activated or <CODE __wid="TiY3Nsuj">false</CODE> if the tools should be deactivated.</LI><LI __wid="UiYUfXRy"><CODE __wid="bhkC2SNz">toolsAttribute</CODE>: The attribute name the tools.</LI></UL></DIV><H3 __wid="wq5dhZSp">Usage</H3><DIV __wid="HWEka5Sq">Functions to enable/disable the Snackbar Tools or to add new tools can be found in the <CODE __wid="vCvHUvTc">#snackbar-tools</CODE> paragraph.</DIV></DIV></DIV><DIV class="paragraph data-paragraph collapsed locked" name="Properties" data-id="A6UVbUGd" style __wid="kCbiktcf"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="K59vwxVv">{
	"version": "1.0.2",
	"description": "Snackbar at the bottom of the screen to show contextual actions.",
	"changelog":
	{
		"1.0.2": "Adjusted height to new structure.",
		"1.0.1": "Added documentation, comments and examples.",
		"1.0": "Initial Release"
	}
}</PRE></DIV><DIV class="paragraph body-paragraph collapsed locked" data-id="isazPvip" name="Snackbar Template" style __wid="JXmxgJwE"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" __wid="9KvEerhv"><TEMPLATE id="snackbar-template" __wid="HPHZskcJ">
	<TRANSIENT id="snackbar" __wid="3288GA4s">
		<DIV class="snackbar-fade" __wid="bmy7Nmnd"></DIV>
		<DIV class="snackbar" __wid="DTLGRkJC">
			<DIV class="snackbar-row" __wid="dRTXtqyH">
				<DIV class="snackbar-container snackbar-left" __wid="Zb43mRsG">
					<SPAN class="snackbar-title content-tools content-title" __wid="cUMYYzBh"></SPAN>
				</DIV>
				<DIV class="snackbar-container snackbar-center" __wid="UTyyxYGQ"></DIV>
				<DIV class="snackbar-container snackbar-right" __wid="P8YE8ru3">
					<SPAN title="Expand Content" class="snackbar-button content-tools content-expand" __wid="vAvV8gtH">
						<I class="material-icons" __wid="kw5rz6N9"></I>
					</SPAN>
					<SPAN title="Close Content" class="snackbar-button content-tools content-close" __wid="Si69wBj2">
						<I class="material-icons" __wid="BrCzEH6Q"></I>
					</SPAN>
				</DIV>
			</DIV>
			<DIV class="snackbar-content" __wid="sR6ktfLc"></DIV>
		</DIV>
	</TRANSIENT>
</TEMPLATE></DIV></DIV><DIV class="paragraph code-paragraph collapsed" data-id="TSpdaCip" style name="Add Snackbar" last-execution-state="success" run-on-load="true" __wid="m94nv8Vz"><PRE data-type="content" type="text/javascript" __wid="WYS9EQrY">const snackbarTemplate = document.querySelector("#snackbar-template");
const snackbarFragment = document.importNode(snackbarTemplate.content, true);
document.body.appendChild(snackbarFragment);

/******************************************************************************/

const SnackbarUtils = require("#snackbar-utils");
SnackbarUtils.initContentControls();</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" style name="Snackbar Utils" data-id="uG6BBKVh" __wid="gTffFUdu"><PRE data-type="content" type="text/javascript" id="snackbar-utils" __wid="p66pXafy">const snackbar = document.querySelector("#snackbar");

const snackbarRow = snackbar.querySelector(".snackbar-row");
const snackbarLeft = snackbarRow.querySelector(".snackbar-left");
const snackbarCenter = snackbarRow.querySelector(".snackbar-center");
const snackbarRight = snackbarRow.querySelector(".snackbar-right");

const snackbarContent = snackbar.querySelector(".snackbar-content");
const snackbarContentTitle = snackbarRow.querySelector(".content-title");
const snackbarContentExpand = snackbarRow.querySelector(".content-expand");
const snackbarContentClose = snackbarRow.querySelector(".content-close");

/******************************************************************************/

/**
 * Creates the "Expand Content" and "Close Content" buttons in the snackbar.
 */
exports.initContentControls = () => {
	snackbarContentExpand.addEventListener("click", (event) => {
		exports.toggleContentExpanded();
	});

	snackbarContentClose.addEventListener("click", (event) => {
		exports.closeContent();
	});
};

/******************************************************************************/

/**
 * Functions for opening and closing of the snackbar. They "cascade", so for
 * example closing the "row" will also close the "content" or closing the
 * "content" will also close the "expanded content".
 */

exports.openRow = () => {
	snackbar.classList.add("row-open");
};

exports.closeRow = () => {
	exports.closeContent();
	snackbar.classList.remove("row-open");
};

exports.toggleRow = () => {
	if (snackbar.classList.contains("row-open")) {
		exports.closeRow();
	} else {
		exports.openRow();
	}
};


exports.openContent = () => {
	exports.openRow();
	snackbar.classList.add("content-open");
};

exports.closeContent = () => {
	exports.removeContent();
	exports.closeContentExpanded();
	snackbar.classList.remove("content-open");
};

exports.toggleContent = () => {
	if (snackbar.classList.contains("content-open")) {
		exports.closeContent();
	} else {
		exports.openContent();
	}
};


exports.openContentExpanded = () => {
	exports.openContent();
	snackbar.classList.add("content-expanded-open");
};

exports.closeContentExpanded = () => {
	snackbar.classList.remove("content-expanded-open");
};

exports.toggleContentExpanded = () => {
	if (snackbar.classList.contains("content-expanded-open")) {
		exports.closeContentExpanded();
	} else {
		exports.openContentExpanded();
	}
};

/******************************************************************************/

/**
 * Adds a &lt;hr> divider to the snackbar.
 *
 * @param container  Snackbar container to add the divider to
 *                   (-1: left, 0: center, 1: right (default)).
 * @param classNames Additional CSS classes for the divider.
 */
exports.addDivider = (container, classNames = false) => {
	const divider = document.createElement("hr");
	if (classNames) divider.setAttribute("class", classNames);
	exports.addSnackbarItem(divider, container);
};

/**
 * Adds an HTML element to a snackbar container.
 *
 * @param snackbarItem The HTML element to add to the snackbar.
 * @param container    Snackbar container to add the item to
 *                     (-1: left, 0: center, 1: right (default)).
 */
exports.addSnackbarItem = (snackbarItem, container = 1) => {
	if (container === -1) {
		snackbarLeft.appendChild(snackbarItem);
	} else if (container === 0) {
		snackbarCenter.appendChild(snackbarItem);
	} else {
		snackbarRight.appendChild(snackbarItem);
	}
};

/**
 * Sets the content and optionally the title of the snackbar and opens the
 * content.
 * Note: Removes previous content before setting the new one.
 *
 * @param element The HTML element which the content should be set to.
 * @param title   The title of the content.
 */
exports.setContent = (element, title = false) => {
	exports.removeContent();
	snackbarContent.appendChild(element);
	snackbarContentTitle.innerText = title ? title : "";
	exports.openContent();
};

/**
 * Returns the current content of the snackbar. Don't use this method to move
 * content out of the snackbar, use "removeContent()" instead.
 *
 * @return The current content element.
 */
exports.getContent = () => {
	return snackbarContent.firstChild;
};


/**
 * Removes the content out of the snackbar, fires the "SnackbarRemoveContent"
 * event and closes the snackbar content.
 *
 * @return The removed content element.
 */
exports.removeContent = () => {
	const content = exports.getContent();

	if (content) {
		var evt = document.createEvent("CustomEvent");
		evt.initCustomEvent("SnackbarRemoveContent", true, true, content);
		window.dispatchEvent(evt);

		while (snackbarContent.firstChild) {
			snackbarContent.removeChild(snackbarContent.firstChild);
		}

		exports.closeContent();
	}

	return content;
};

/******************************************************************************/

/**
 * Creates and adds a button to the snackbar.
 *
 * @param title      The title-attribute of the button.
 * @param icon       The icon of the button (use Material Icons string).
 * @param classNames Additional CSS classes for the button.
 * @param container  Snackbar container to add the button to
 *                   (-1: left, 0: center, 1: right (default)).
 * @param action     The function to perform on clicks.
 */
exports.addButton = (title, icon, classNames, container, action) => {
	const button = exports.createButton(title, icon, classNames, action);
	exports.addSnackbarItem(button, container);
};

/**
 * Creates and adds a title to the snackbar.
 *
 * @param title      The title-attribute of the title.
 * @param classNames Additional CSS classes for the title.
 * @param content    The text of the title.
 * @param container  Snackbar container to add the title to
                     (-1: left, 0: center, 1: right (default)).
 */
exports.addTitle = (title, classNames, content, container) => {
	const titleElement = exports.createTitle(title, classNames, content);
	exports.addSnackbarItem(titleElement, container);
};

/**
 * Creates and adds a input for the snackbar.
 *
 * @param title       The title-attribute of the input.
 * @param classNames  Additional CSS classes for the input.
 * @param content     The text of the input.
 * @param container   Snackbar container to add the input to
 *                    (-1: left, 0: center, 1: right (default)).
 * @param inputAction Function for the "input" eventlistener of the input.
 */
exports.addInput = (title, classNames, content, container, inputAction) => {
	const input = exports.createInput(title, classNames, content, inputAction);
	exports.addSnackbarItem(input, container);
};

/******************************************************************************/

/**
 * Creates a button for the snackbar and returns it.
 *
 * @param title      The title-attribute of the button.
 * @param icon       The icon of the button (use Material Icons string).
 * @param classNames Additional CSS classes for the button.
 * @param action     The function to perform on clicks.
 *
 * @return The created button.
 */
exports.createButton = (title, icon = "", classNames = false, action = false) => {
	const button = document.createElement("span");
	button.setAttribute("title", title);

	const i = document.createElement("i");
	i.classList.add("material-icons");
	i.innerHTML = icon;

	button.appendChild(i);

	if (classNames) {
		button.setAttribute("class", classNames);
	}
	button.classList.add("snackbar-button");

	if (typeof action === "function") {
		button.addEventListener("click", action);
	}

	return button;
};

/**
 * Creates a title for the snackbar and returns it.
 *
 * @param title      The title-attribute of the title.
 * @param classNames Additional CSS classes for the title.
 * @param content    The text of the title.
 *
 * @return The created title.
 */
exports.createTitle = (title, classNames = false, content = false) => {
	const titleElement = document.createElement("span");
	titleElement.setAttribute("title", title);

	if (classNames) {
		titleElement.setAttribute("class", classNames);
	}
	titleElement.classList.add("snackbar-title");

	if (content) {
		titleElement.innerText = content;
	}

	return titleElement;
};

/**
 * Creates a input for the snackbar and returns it.
 *
 * @param title       The title-attribute of the input.
 * @param classNames  Additional CSS classes for the input.
 * @param content     The text of the input.
 * @param inputAction Function for the "input" eventlistener of the input.
 *
 * @return The created input.
 */
exports.createInput = (title, classNames = false, content = false, inputAction = false) => {
	const inputElement = exports.createTitle(title, classNames, content);
	inputElement.classList.add("snackbar-input");
	inputElement.setAttribute("contenteditable", "true");
	inputElement.addEventListener("keypress", event => {
		if (event.which === 13) {
			event.preventDefault();
		}
	});

	if (typeof inputAction === "function") {
		inputElement.addEventListener("input", () => inputAction(inputElement));
	}

	return inputElement;
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" style name="Snackbar Style" data-id="D7BPWi9D" __wid="rcfwg9zS"><STYLE data-type="content" type="text/css" codemirror="true" contenteditable="true" class="themable" __wid="Cs3JhJFp">html #snackbar .snackbar {
	background: var(--color-primary);
	color: var(--color-primary-text);
	display: block;
	position: fixed;
	bottom: 0;
	left: 50%;
	width: 64rem;
	max-width: 100vw;
	margin-right: 16px;
	z-index: 50;
	box-shadow: none;
	opacity: 0;
	transform: translate(-50%, 100%);
	overflow-x: scroll;
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	transition: transform var(--navigation-transition),
							box-shadow var(--navigation-transition),
							width var(--navigation-transition),
							opacity var(--navigation-transition),
							left var(--navigation-transition);
}

html #snackbar .snackbar::-webkit-scrollbar {
	display: none;
}

@keyframes fadeAnimation {
	from {
		opacity: 0;
	}
}

html #snackbar .snackbar-fade {
	position: fixed;
	left: 0;
	top: 0;
	width: 100vw;
	height: 100vh;
	background: var(--color-primary-text);
	opacity: 0.25;
	pointer-events: none;
	z-index: 249;
	animation: fadeAnimation var(--navigation-transition);
	display: none;
}

html #snackbar.content-expanded-open .snackbar-fade {
	display: block;
}

/******************************************************************************/

html #snackbar.row-open .snackbar {
	box-shadow: var(--material-shadow-z6);
	transform: translate(-50%, 0);
	opacity: 1;
}

html #snackbar.content-open .snackbar-content {
	height: calc(25vh - 48px);
}

html #snackbar.content-expanded-open .snackbar-content {
	height: calc(100vh - 48px);
}

html #snackbar.content-expanded-open .snackbar {
	z-index: 250;
}

html body[transient-menu-pinned="true"] #snackbar .snackbar {
	left: calc(50% + 144px);
	max-width: calc(100vw - 288px);
}

/******************************************************************************/

html #snackbar .snackbar-row {
	display: flex;
	justify-content: space-between;
	position: relative;
	align-items: center;
	width: 100%;
	height: 48px;
	padding: 8px;
}

html #snackbar .snackbar-container {
	display: flex;
	box-sizing: border-box;
	height: 32px;
	vertical-align: middle;
	z-index: 1;
}

html #snackbar .snackbar-left {
	flex: 1 0 auto;
	justify-content: flex-start;
	order: -1;
	padding-right: 24px;
}

html #snackbar .snackbar-center {
	flex: 1 1 100%;
	justify-content: center;
	order: 0;
}

html #snackbar .snackbar-right {
	flex: 0 0 auto;
	justify-content: flex-end;
	order: 1;
	padding-left: 24px;
}

/******************************************************************************/

html #snackbar .snackbar-content {
	display: block;
	position: relative;
	background: var(--color-primary-shade-1);
	color: var(--color-primary-text);
	height: 0;
	overflow-y: auto;
	width: 100%;
	padding: 0 24px;
	transition: height var(--navigation-transition),
							padding var(--navigation-transition);
}

html #snackbar.content-open .snackbar-content {
	padding: 16px;
}

html #snackbar .content-title {
	order: -999;
}

html #snackbar .content-expand {
	order: 998;
}

html #snackbar .content-close {
	order: 999;
}

html #snackbar .content-expand i:after {
	content: "fullscreen";
}

html #snackbar.content-expanded-open .content-expand i:after {
	content: "fullscreen_exit";
}

html #snackbar .content-close i:after {
	content: "close";
}

/******************************************************************************/

html #snackbar .snackbar-button {
	display: flex;
	padding: 4px;
	width: 32px;
	height: 32px;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	border-radius: 50%;
	margin: 0 4px;
	user-select: none;
}

html #snackbar .snackbar-title {
	font-size: 1.25rem;
	font-weight: 500;
	letter-spacing: 0.02rem;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
	align-self: center;
	padding: 0 8px;
}

html #snackbar .snackbar-title+.snackbar-title {
	padding-left: 0;
}

html #snackbar .snackbar-input {
	cursor: text;
	outline: none;
}

html #snackbar .snackbar-input:empty:before {
	content: "Empty";
	opacity: 0.5;
}

/******************************************************************************/

html #snackbar hr {
	border: none;
	border-left: 1px solid var(--color-primary-text);
	margin: 4px;
	opacity: 0.8;
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="gArzG7N6" draggable="false" style name="Snackbar Tools" last-execution-state="success" run-on-load="true" __wid="hTiw9ZZu"><PRE data-type="content" type="text/javascript" id="snackbar-tools" __wid="tVZVQWYs">const SnackbarUtils = require("#snackbar-utils");

/******************************************************************************/

const snackbar = document.querySelector("#snackbar");

let enabled = true;
let previousEvent = false;
let additionalTools = [];

exports.currentParagraph = false;
exports.currentSection = false;

/******************************************************************************/

/**
 * Enables the snackbar tools.
 */
exports.enable = () => {
	enabled = true;
};

/**
 * Disables the snackbar tools.
 */
exports.disable = () => {
	enabled = false;
	SnackbarUtils.closeRow();
};

/**
 * Toggles the snackbar tools.
 */
exports.toggle = () => {
	if (enabled) {
		exports.disable();
	} else {
		exports.enable();
	}
};

/******************************************************************************/

/**
 * Adds additional tools to the snackbar.
 *
 * @param checkToolsAction Function, which takes one argument (target) and
 *                         returns true if tools should be active and false if
 *                         not.
 * @param toolsAttribute   The name of the attribute for the new tools. Needs to
 *                         contain "tools" in it.
 *
 * @return True if tools were added successfully, else false.
 */
exports.addTools = (checkToolsAction, toolsAttribute) => {
	if (typeof checkToolsAction === "function" &&
			typeof toolsAttribute === "string" &&
			toolsAttribute.indexOf("tools") !== -1) {
		additionalTools.push({
			checkToolsAction: checkToolsAction,
			toolsAttribute: toolsAttribute
		});
		return true;
	} else {
		return false;
	}
};

/******************************************************************************/

// Update tools on every click
window.addEventListener("click", (event) => {

	// Only proceed if there is a target and the tools are enabled
	if (!enabled || !event.target || !event.target.closest) {
		return;
	}

	// Don't update tools upon clicking on UI
	if (event.target.closest("#global-toolbar") ||
		  event.target.closest("#global-menu") ||
		  event.target.closest("#snackbar")) {
		if (previousEvent) {
			event = previousEvent;
		}
	}

	previousEvent = event;

	// Update basic snackbar attributes for paragraphs
	if (Codestrate.focussedParagraph) {
		snackbar.setAttribute("paragraph-tools", "true");
		if (Codestrate.focussedParagraph.classList.contains("body-paragraph") &&
				!Codestrate.focussedParagraph.classList.contains("locked")) {
			snackbar.setAttribute("body-tools", "true");
		} else {
			snackbar.removeAttribute("body-tools");
		}
		if (Codestrate.focussedParagraph.classList.contains("style-paragraph")) {
			snackbar.setAttribute("style-tools", "true");
		} else {
			snackbar.removeAttribute("style-tools");
		}
		if (Codestrate.focussedParagraph.classList.contains("code-paragraph")) {
			snackbar.setAttribute("code-tools", "true");
		} else {
			snackbar.removeAttribute("code-tools");
		}
		if (Codestrate.focussedParagraph.classList.contains("data-paragraph")) {
			snackbar.setAttribute("data-tools", "true");
		} else {
			snackbar.removeAttribute("data-tools");
		}
	} else {
		snackbar.removeAttribute("body-tools");
		snackbar.removeAttribute("style-tools");
		snackbar.removeAttribute("code-tools");
		snackbar.removeAttribute("data-tools");
		snackbar.removeAttribute("paragraph-tools");
	}

	// Update basic snackbar attribute for sections
	if (Codestrate.focussedSection) {
		snackbar.setAttribute("section-tools", "true");
	} else {
		snackbar.removeAttribute("section-tools");
	}

	// Update basic snackbar attribute for content
	if (snackbar.classList.contains("content-open")) {
		snackbar.setAttribute("content-tools", "true");
	} else {
		snackbar.removeAttribute("content-tools");
	}

	// Add additional snackbar attributes
	additionalTools.forEach(additionalTool => {
		if (additionalTool.checkToolsAction(event.target)) {
			snackbar.setAttribute(additionalTool.toolsAttribute, "true");
		} else {
			snackbar.removeAttribute(additionalTool.toolsAttribute);
		}
	});

	// Open and close snackbar depending on if there are active tools
	let open = false;
	const openTools = Array.from(snackbar.attributes).filter(att => att.name.indexOf("tools") !== -1).map(att => att.name);
	if (openTools.length > 0) {
		openTools.forEach(tool => {
			if (!open && snackbar.querySelector(`.snackbar-row .${tool}`)) {
				open = true;
			}
		});
	}

	if (open) {
		SnackbarUtils.openRow();
	} else {
		SnackbarUtils.closeRow();
	}
}, false);</PRE></DIV><DIV class="paragraph style-paragraph collapsed" style draggable="false" name="Snackbar Tools Style" data-id="Nj3GC2by" __wid="NVqNPrDH"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="YRT9FzWg">html #snackbar:not([section-tools="true"]) .section-tools {
	display: none;
}

html #snackbar:not([paragraph-tools="true"]) .paragraph-tools {
	display: none;
}

html #snackbar:not([body-tools="true"]) .body-tools {
	display: none;
}

html #snackbar:not([style-tools="true"]) .style-tools {
	display: none;
}

html #snackbar:not([code-tools="true"]) .code-tools {
	display: none;
}

html #snackbar:not([data-tools="true"]) .data-tools {
	display: none;
}

/******************************************************************************/

html #snackbar:not([content-tools="true"]) .content-tools {
	display: none;
}

html #snackbar .snackbar-title.content-tools+.snackbar-title {
	padding-left: 8px;
}

html #snackbar[content-tools="true"] .snackbar-button:not(.content-tools),
html #snackbar[content-tools="true"] .snackbar-title:not(.content-tools),
html #snackbar[content-tools="true"] hr:not(.content-tools) {
	display: none;
}

html .paragraph-header {
	transition: border-left var(--navigation-transition);
}

html .paragraph[transient-content-paragraph] .paragraph-header {
	border-left: 4px solid var(--color-accent);
	border-radius: 4px 2px 2px 4px;
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" name="Snackbar Tools HTML Editor" style data-id="7vfcpFtU" run-on-load="true" last-execution-state="success" __wid="KgqSgcVc"><PRE data-type="content" type="text/javascript" __wid="G49KEQHk">const SnackbarUtils = require("#snackbar-utils");
const SnackbarTools = require("#snackbar-tools");

/******************************************************************************/

const toolsName = "html-editor-tools";
const snackbar = document.querySelector("#snackbar");
let currentParagraph = false;

/******************************************************************************/

const editorToSnackbar = (editor) => {

	// Make editor visible
	editor.classList.remove("hidden");

	// Get title of the content
	const name = Codestrate.focussedParagraph.getAttribute("name") ? Codestrate.focussedParagraph.getAttribute("name") : "Unnamed Paragraph";

	SnackbarUtils.setContent(editor, name + " HTML");

	// Store related paragraph and set attribute
	currentParagraph = Codestrate.focussedParagraph;
	currentParagraph.setAttribute("transient-content-paragraph", "true");

	// Update and enable editor
	const htmlEditor = currentParagraph.querySelector("[data-type='content']").__editor;
	htmlEditor.enableMutationObserver();
	htmlEditor.updateEditor();

	// Activate editor tools ("Save HTML" button)
	snackbar.setAttribute(toolsName, "true");
};

const editorToParagraph = (editor) => {
	editor.classList.add("hidden");
	currentParagraph.appendChild(editor);
	const htmlEditor = currentParagraph.querySelector("[data-type='content']").__editor;
	htmlEditor.disableMutationObserver();
	currentParagraph.removeAttribute("transient-content-paragraph");
	currentParagraph = false;
	SnackbarUtils.closeContent();
	snackbar.removeAttribute(toolsName);
};

/******************************************************************************/

SnackbarUtils.addButton("Show HTML Editor", "", "body-tools html-editor-button", 1, () => {

	// Check if there is a HTML in the content
	const content = SnackbarUtils.getContent();
	if (content && content.classList.contains("html-editor")) {
		editorToParagraph(content);
	} else {
		const editor = Codestrate.focussedParagraph.querySelector(".html-editor");
		editorToSnackbar(editor);
	}
});

// Listen to the "SnackbarRemoveContent" event in case the snackbar content gets
// closed from somewhere else
window.addEventListener("SnackbarRemoveContent", (event) => {
	if (currentParagraph && event.detail && event.detail.classList.contains("html-editor")) {
		editorToParagraph(event.detail);
	}
});

SnackbarUtils.addButton("Save HTML", "", toolsName + " html-save-button", 1, () => {
	const editor = currentParagraph.querySelector("[data-type='content']").__editor;
	editor.saveHtml();
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="CYYui4Xj" name="Snackbar Tools HTML Editor Style" __wid="znfG27fY"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="ZHXQnDtt">html #snackbar:not([html-editor-tools="true"]) .html-editor-tools {
	display: none;
}

html #snackbar[html-editor-tools="true"][content-tools="true"] .html-editor-tools {
	display: flex;
}

html #snackbar .snackbar-content .html-editor .CodeMirror,
html #snackbar .snackbar-content .html-editor .CodeMirror-gutters  {
	background: none;
}

/******************************************************************************/

html #snackbar .html-editor-button i:after {
	content: var(--xml);
	font-family: "Material Design Icons";
}

html #snackbar .html-save-button i:after {
	content: "save";
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="P7Cm8syW" draggable="false" style name="Snackbar Tools Code Execution" last-execution-state="success" run-on-load="true" __wid="Yr4pBsx5"><PRE data-type="content" type="text/javascript" __wid="E2rsbh9F">const SnackbarUtils = require("#snackbar-utils");
const SnackbarTools = require("#snackbar-tools");

/******************************************************************************/

const runOnLoadAttributeName = "run-on-load";
let currentParagraph = false;

/******************************************************************************/

const consoleToSnackbar = (console) => {
	const name = Codestrate.focussedParagraph.getAttribute("name") ? Codestrate.focussedParagraph.getAttribute("name") : "Unnamed Paragraph";
	SnackbarUtils.setContent(console, name + " Console");
	currentParagraph = Codestrate.focussedParagraph;
	currentParagraph.setAttribute("transient-content-paragraph", "true");
	currentParagraph.console.open();
};

const consoleToParagraph = (console) => {
	currentParagraph.appendChild(console);
	currentParagraph.console.close();
	currentParagraph.removeAttribute("transient-content-paragraph");
	currentParagraph = false;
	SnackbarUtils.closeContent();
};

/******************************************************************************/

SnackbarUtils.addButton("Execute Code", "play_circle_outline", "code-tools", 1, () => {
	Codestrate.runCode(Codestrate.focussedParagraph);
});

SnackbarUtils.addButton("Toggle Console", "message", "code-tools", 1, () => {
	const content = SnackbarUtils.getContent();
	if (content && content.classList.contains("console")) {
		consoleToParagraph(content);
	} else {
		const console = Codestrate.focussedParagraph.querySelector(".console");
		consoleToSnackbar(console);
	}
});

window.addEventListener("SnackbarRemoveContent", (event) => {
	if (currentParagraph && event.detail && event.detail.classList.contains("console")) {
		consoleToParagraph(event.detail);
	}
});

SnackbarUtils.addButton("Run on load", "directions_run", "code-tools", 1, () => {
	if (Codestrate.focussedParagraph.hasAttribute(runOnLoadAttributeName)) {
		Codestrate.focussedParagraph.removeAttribute(runOnLoadAttributeName);
	} else {
		Codestrate.focussedParagraph.setAttribute(runOnLoadAttributeName, "true");
	}
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Snackbar Tools Code Execution Style" data-id="SfU3DezA" __wid="f2vfKtmc"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="px4AhVyc">html #snackbar .snackbar-content .console {
	height: 100%;
	margin: 0;
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="VB7G4SeT" name="Snackbar Examples" last-execution-state="success" __wid="MrtM7DCH"><PRE data-type="content" type="text/javascript" class="snackbar-examples" __wid="igrGxZMf">const SnackbarUtils = require("#snackbar-utils");
const SnackbarTools = require("#snackbar-tools");

/******************************************************************************/

// Set a name for the tools of this example
const toolsName = "snackbar-example-tools";

/******************************************************************************/

// Add a new tools category, which is only visible in this paragraph
SnackbarTools.addTools((target) => {

	// Check if the user clicked on paragraph
	let paragraph = target.closest(".paragraph");
	if (!paragraph) return false;

	// Instead of using the "target" parameter it would have also been possible to
	// use the "Codestrate.focussedParagraph" variable, to get the currently
	// selected paragraph.
	paragraph = Codestrate.focussedParagraph;

	// Check if the paragraph has a content with the example class
	const content = paragraph.querySelector(".snackbar-examples[data-type='content']");
	if (!content) return false;

	// Return true and activate tools
	return true;
}, toolsName);

// Add a button to the left container of the snackbar, which class is the
// example tools class
SnackbarUtils.addButton("Example Button", "info", toolsName, -1, () => {
	console.log("Something from the button.");
});

/******************************************************************************/

// Add a title to the center conainer of the snackbar, which is always visible,
// when the snackbar is open
SnackbarUtils.addTitle("Example Title", "", "My Title", 0);

// Add another button, which toggles the background of a selected paragraph
// using the "Codestrate.focussedParagraph"
// Set the className "paragraph-tools" to make the button active on paragraphs
SnackbarUtils.addButton("Example Background Button", "brush", "paragraph-tools", -1, () => {
	const attributeName = "transient-snackbar-example";

	const paragraph = Codestrate.focussedParagraph;
	if (paragraph.getAttribute(attributeName)) {
		paragraph.removeAttribute(attributeName);
	} else {
		paragraph.setAttribute(attributeName, "true");
	}
});

/******************************************************************************/

// See the "Snackbar Tools HTML Editor" and "Snackbar Tools Code Execution"
// paragraphs for more examples on how to set content and make use of the
// "SnackbarRemoveContent" event.</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="LqkSYjsg" name="Snackbar Examples Style" __wid="mUaXnVSb"><STYLE data-type="content" type="text/css" codemirror="true" class="snackbar-examples" __wid="qRea3fuz">/* Hide the tools when they are not activated */
html #snackbar:not([snackbar-example-tools="true"]) .snackbar-example-tools {
	display: none;
}

/* Change background of toggled paragraph */
html .paragraph[transient-snackbar-example="true"] {
	background: hotpink;
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-id="FMzikLfC" data-type="system" name="Palettes" __wid="Pv8agFsk"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="6bepHddM" __wid="HBLs8vGg"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="J7qNkyNZ"><H2 __wid="PUuetssX">Description</H2><DIV __wid="RdcWGm4h">Adds the palette API.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="GQAsPcsz" style __wid="vWbbcuBm"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="iHCFc3TC">{
	"version": "1.0",
	"description": "Adds the palette API.",
	"changelog":
	{
		"1.0": "Initial version."
	}
}</PRE></DIV><DIV class="paragraph body-paragraph locked collapsed" data-id="tiLdGVnN" name="Palette Template" style draggable="false" __wid="aNfr42FA"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" __wid="adtz9QfH"><TEMPLATE id="palette-template" __wid="UrLZCWxD">
	<TRANSIENT id="palette" class="palette" __wid="qDrjDA64">
		<DIV class="palette-modal" __wid="WzFGFtm7"></DIV>
		<SPAN class="palette-search" __wid="BBZWqbv3">
			<SPAN class="palette-icon palette-button" __wid="p3gR89Zm">
				<I class="material-icons" __wid="QLY6Uh7N">keyboard_arrow_right</I>
			</SPAN>
			<INPUT class="palette-input" placeholder="Placeholder" __wid="FMfNs3TL"/>
			<SPAN title="Close" class="palette-button-close palette-button material-ripple-primary-text" __wid="uLmR3r9j">
				<I class="material-icons" __wid="UTRJCBC8">close</I>
			</SPAN>
		</SPAN>
	</TRANSIENT>
</TEMPLATE></DIV></DIV><DIV class="paragraph code-paragraph collapsed locked" data-id="xdVKdgmM" name="Awesomplete" __wid="zQvEWJPQ"><PRE data-type="content" type="text/javascript" id="awesomplete" contenteditable="false" __wid="ZQzdM5Cr">/**
 * Simple, lightweight, usable local autocomplete library for modern browsers
 * Because there werenÃ¢â¬â¢t enough autocomplete scripts in the world? Because IÃ¢â¬â¢m completely insane and have NIH syndrome? Probably both. :P
 * @author Lea Verou http://leaverou.github.io/awesomplete
 * MIT license
 */

(function () {

var _ = function (input, o) {
	var me = this;

    // Keep track of number of instances for unique IDs
    Awesomplete.count = (Awesomplete.count || 0) + 1;
    this.count = Awesomplete.count;

	// Setup

	this.isOpened = false;

	this.input = $(input);
	this.input.setAttribute("autocomplete", "off");
	this.input.setAttribute("aria-owns", "awesomplete_list_" + this.count);
	this.input.setAttribute("role", "combobox");

	o = o || {};

	configure(this, {
		minChars: 2,
		maxItems: 10,
		autoFirst: false,
		data: _.DATA,
		filter: _.FILTER_CONTAINS,
		sort: o.sort === false ? false : _.SORT_BYLENGTH,
		item: _.ITEM,
		replace: _.REPLACE
	}, o);

	this.index = -1;

	// Create necessary elements

	this.container = $.create("div", {
		className: "awesomplete",
		around: input
	});

	this.ul = $.create("ul", {
		hidden: "hidden",
        role: "listbox",
        id: "awesomplete_list_" + this.count,
		inside: this.container
	});

	this.status = $.create("span", {
		className: "visually-hidden",
		role: "status",
		"aria-live": "assertive",
        "aria-atomic": true,
        inside: this.container,
        textContent: this.minChars != 0 ? ("Type " + this.minChars + " or more characters for results.") : "Begin typing for results."
	});

	// Bind events

	this._events = {
		input: {
			"input": this.evaluate.bind(this),
			"blur": this.close.bind(this, { reason: "blur" }),
			"keydown": function(evt) {
				var c = evt.keyCode;

				// If the dropdown `ul` is in view, then act on keydown for the following keys:
				// Enter / Esc / Up / Down
				if(me.opened) {
					if (c === 13 && me.selected) { // Enter
						evt.preventDefault();
						me.select();
					}
					else if (c === 27) { // Esc
						me.close({ reason: "esc" });
					}
					else if (c === 38 || c === 40) { // Down/Up arrow
						evt.preventDefault();
						me[c === 38? "previous" : "next"]();
					}
				}
			}
		},
		form: {
			"submit": this.close.bind(this, { reason: "submit" })
		},
		ul: {
			"mousedown": function(evt) {
				var li = evt.target;

				if (li !== this) {

					while (li && !/li/i.test(li.nodeName)) {
						li = li.parentNode;
					}

					if (li && evt.button === 0) {  // Only select on left click
						evt.preventDefault();
						me.select(li, evt.target);
					}
				}
			}
		}
	};

	$.bind(this.input, this._events.input);
	$.bind(this.input.form, this._events.form);
	$.bind(this.ul, this._events.ul);

	if (this.input.hasAttribute("list")) {
		this.list = "#" + this.input.getAttribute("list");
		this.input.removeAttribute("list");
	}
	else {
		this.list = this.input.getAttribute("data-list") || o.list || [];
	}

	_.all.push(this);
};

_.prototype = {
	set list(list) {
		if (Array.isArray(list)) {
			this._list = list;
		}
		else if (typeof list === "string" && list.indexOf(",") > -1) {
				this._list = list.split(/\s*,\s*/);
		}
		else { // Element or CSS selector
			list = $(list);

			if (list && list.children) {
				var items = [];
				slice.apply(list.children).forEach(function (el) {
					if (!el.disabled) {
						var text = el.textContent.trim();
						var value = el.value || text;
						var label = el.label || text;
						if (value !== "") {
							items.push({ label: label, value: value });
						}
					}
				});
				this._list = items;
			}
		}

		if (document.activeElement === this.input) {
			this.evaluate();
		}
	},

	get selected() {
		return this.index > -1;
	},

	get opened() {
		return this.isOpened;
	},

	close: function (o) {
		if (!this.opened) {
			return;
		}

		this.ul.setAttribute("hidden", "");
		this.isOpened = false;
		this.index = -1;

		$.fire(this.input, "awesomplete-close", o || {});
	},

	open: function () {
		this.ul.removeAttribute("hidden");
		this.isOpened = true;

		if (this.autoFirst && this.index === -1) {
			this.goto(0);
		}

		$.fire(this.input, "awesomplete-open");
	},

	destroy: function() {
		//remove events from the input and its form
		$.unbind(this.input, this._events.input);
		$.unbind(this.input.form, this._events.form);

		//move the input out of the awesomplete container and remove the container and its children
		var parentNode = this.container.parentNode;

		parentNode.insertBefore(this.input, this.container);
		parentNode.removeChild(this.container);

		//remove autocomplete and aria-autocomplete attributes
		this.input.removeAttribute("autocomplete");
		this.input.removeAttribute("aria-autocomplete");

		//remove this awesomeplete instance from the global array of instances
		var indexOfAwesomplete = _.all.indexOf(this);

		if (indexOfAwesomplete !== -1) {
			_.all.splice(indexOfAwesomplete, 1);
		}
	},

	next: function () {
		var count = this.ul.children.length;
		this.goto(this.index &lt; count - 1 ? this.index + 1 : (count ? 0 : -1) );
	},

	previous: function () {
		var count = this.ul.children.length;
		var pos = this.index - 1;

		this.goto(this.selected && pos !== -1 ? pos : count - 1);
	},

	// Should not be used, highlights specific item without any checks!
	goto: function (i) {
		var lis = this.ul.children;

		if (this.selected) {
			lis[this.index].setAttribute("aria-selected", "false");
		}

		this.index = i;

		if (i > -1 && lis.length > 0) {
			lis[i].setAttribute("aria-selected", "true");

			this.status.textContent = lis[i].textContent + ", list item " + (i + 1) + " of " + lis.length;

            this.input.setAttribute("aria-activedescendant", this.ul.id + "_item_" + this.index);

			// scroll to highlighted element in case parent's height is fixed
			this.ul.scrollTop = lis[i].offsetTop - this.ul.clientHeight + lis[i].clientHeight;

			$.fire(this.input, "awesomplete-highlight", {
				text: this.suggestions[this.index]
			});
		}
	},

	select: function (selected, origin) {
		if (selected) {
			this.index = $.siblingIndex(selected);
		} else {
			selected = this.ul.children[this.index];
		}

		if (selected) {
			var suggestion = this.suggestions[this.index];

			var allowed = $.fire(this.input, "awesomplete-select", {
				text: suggestion,
				origin: origin || selected
			});

			if (allowed) {
				this.replace(suggestion);
				this.close({ reason: "select" });
				$.fire(this.input, "awesomplete-selectcomplete", {
					text: suggestion
				});
			}
		}
	},

	evaluate: function() {
		var me = this;
		var value = this.input.value;

		if (value.length >= this.minChars && this._list.length > 0) {
			this.index = -1;
			// Populate list with options that match
			this.ul.innerHTML = "";

			this.suggestions = this._list
				.map(function(item) {
					return new Suggestion(me.data(item, value));
				})
				.filter(function(item) {
					return me.filter(item, value);
				});

			if (this.sort !== false) {
				this.suggestions = this.suggestions.sort(this.sort);
			}

			this.suggestions = this.suggestions.slice(0, this.maxItems);

			this.suggestions.forEach(function(text, index) {
					me.ul.appendChild(me.item(text, value, index));
				});

			if (this.ul.children.length === 0) {

                this.status.textContent = "No results found";

				this.close({ reason: "nomatches" });

			} else {
				this.open();

                this.status.textContent = this.ul.children.length + " results found";
			}
		}
		else {
			this.close({ reason: "nomatches" });

                this.status.textContent = "No results found";
		}
	}
};

// Static methods/properties

_.all = [];

_.FILTER_CONTAINS = function (text, input) {
	return RegExp($.regExpEscape(input.trim()), "i").test(text);
};

_.FILTER_STARTSWITH = function (text, input) {
	return RegExp("^" + $.regExpEscape(input.trim()), "i").test(text);
};

_.SORT_BYLENGTH = function (a, b) {
	if (a.length !== b.length) {
		return a.length - b.length;
	}

	return a &lt; b? -1 : 1;
};

_.ITEM = function (text, input, item_id) {
	var html = input.trim() === "" ? text : text.replace(RegExp($.regExpEscape(input.trim()), "gi"), "&lt;mark>$&&lt;/mark>");
	return $.create("li", {
		innerHTML: html,
		"aria-selected": "false",
        "id": "awesomplete_list_" + this.count + "_item_" + item_id
	});
};

_.REPLACE = function (text) {
	this.input.value = text.value;
};

_.DATA = function (item/*, input*/) { return item; };

// Private functions

function Suggestion(data) {
	var o = Array.isArray(data)
	  ? { label: data[0], value: data[1] }
	  : typeof data === "object" && "label" in data && "value" in data ? data : { label: data, value: data };

	this.label = o.label || o.value;
	this.value = o.value;
}
Object.defineProperty(Suggestion.prototype = Object.create(String.prototype), "length", {
	get: function() { return this.label.length; }
});
Suggestion.prototype.toString = Suggestion.prototype.valueOf = function () {
	return "" + this.label;
};

function configure(instance, properties, o) {
	for (var i in properties) {
		var initial = properties[i],
		    attrValue = instance.input.getAttribute("data-" + i.toLowerCase());

		if (typeof initial === "number") {
			instance[i] = parseInt(attrValue);
		}
		else if (initial === false) { // Boolean options must be false by default anyway
			instance[i] = attrValue !== null;
		}
		else if (initial instanceof Function) {
			instance[i] = null;
		}
		else {
			instance[i] = attrValue;
		}

		if (!instance[i] && instance[i] !== 0) {
			instance[i] = (i in o)? o[i] : initial;
		}
	}
}

// Helpers

var slice = Array.prototype.slice;

function $(expr, con) {
	return typeof expr === "string"? (con || document).querySelector(expr) : expr || null;
}

function $$(expr, con) {
	return slice.call((con || document).querySelectorAll(expr));
}

$.create = function(tag, o) {
	var element = document.createElement(tag);

	for (var i in o) {
		var val = o[i];

		if (i === "inside") {
			$(val).appendChild(element);
		}
		else if (i === "around") {
			var ref = $(val);
			ref.parentNode.insertBefore(element, ref);
			element.appendChild(ref);
		}
		else if (i in element) {
			element[i] = val;
		}
		else {
			element.setAttribute(i, val);
		}
	}

	return element;
};

$.bind = function(element, o) {
	if (element) {
		for (var event in o) {
			var callback = o[event];

			event.split(/\s+/).forEach(function (event) {
				element.addEventListener(event, callback);
			});
		}
	}
};

$.unbind = function(element, o) {
	if (element) {
		for (var event in o) {
			var callback = o[event];

			event.split(/\s+/).forEach(function(event) {
				element.removeEventListener(event, callback);
			});
		}
	}
};

$.fire = function(target, type, properties) {
	var evt = document.createEvent("HTMLEvents");

	evt.initEvent(type, true, true );

	for (var j in properties) {
		evt[j] = properties[j];
	}

	return target.dispatchEvent(evt);
};

$.regExpEscape = function (s) {
	return s.replace(/[-\\^$*+?.()|[\]{}]/g, "\\$&");
};

$.siblingIndex = function (el) {
	/* eslint-disable no-cond-assign */
	for (var i = 0; el = el.previousElementSibling; i++);
	return i;
};

// Initialization

function init() {
	$$("input.awesomplete").forEach(function (input) {
		new _(input);
	});
}

// Are we in a browser? Check for Document constructor
if (typeof Document !== "undefined") {
	// DOM already loaded?
	if (document.readyState !== "loading") {
		init();
	}
	else {
		// Wait for it
		document.addEventListener("DOMContentLoaded", init);
	}
}

_.$ = $;
_.$$ = $$;

// Make sure to export Awesomplete on self when in a browser
if (typeof self !== "undefined") {
	self.Awesomplete = _;
}

// Expose Awesomplete as a CJS module
if (typeof module === "object" && module.exports) {
	module.exports = _;
}

return _;

}());</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="m9ZfAY6G" name="Palette Utils" last-execution-state="error" draggable="false" style __wid="kUNaD8z8"><PRE data-type="content" type="text/javascript" id="palette-utils" __wid="iMTRBLDW">exports.addPalette = (id, icon, placeholder,
											action, initialList,
											commandId, commandName, commandDescription = "",
											keyBinding = "", preventKeyDefault = false) => {
	const paletteTemplate = document.querySelector("#palette-template");
	const paletteFragment = document.importNode(paletteTemplate.content, true);
	document.body.appendChild(paletteFragment);

	/******************************************************************************/

	const palette = document.querySelector("#palette");
	const paletteModal = palette.querySelector(".palette-modal");
	const paletteIcon = palette.querySelector(".palette-icon > i");
	const paletteInput = palette.querySelector(".palette-input");
	const paletteButtonClose = palette.querySelector(".palette-button-close");

	/******************************************************************************/

	palette.id = id;
	paletteIcon.innerHTML = icon;
	paletteInput.setAttribute("placeholder", placeholder);

	/******************************************************************************/

	const showPalette = () => {
		paletteInput.value = "";
		palette.classList.add("visible");
		paletteInput.focus();
	};

	const hidePalette = () => {
		palette.classList.remove("visible");
		paletteInput.blur();
	};

	const togglePalette = () => {
		if (palette.classList.contains("visible")) {
			hidePalette();
		} else {
			showPalette();
		}
	};

	const runCommand = (value) => {
		paletteInput.value = "";
		hidePalette();

		action(value);
	};

	/******************************************************************************/

	Codestrate.addCommand(commandId, commandName, () => togglePalette(), commandDescription);
	if (keyBinding)	Codestrate.addKeyBinding(commandId, keyBinding, preventKeyDefault);

	/******************************************************************************/

	paletteModal.addEventListener("click", () => hidePalette());
	paletteButtonClose.addEventListener("click", () => hidePalette());

	paletteInput.addEventListener("keydown", (e) => {
		if (e.keyCode === 13) {
			e.preventDefault();
			myAwesomplete.select();
			runCommand(paletteInput.value);
		} else if (e.keyCode === 27) {
			e.preventDefault();
			hidePalette();
		}
	});

	/******************************************************************************/

	require("#awesomplete");
	const myAwesomplete = new Awesomplete(paletteInput, {
		autoFirst: true,
		maxItems: 100,
		minChars: 0
	});

	const list = initialList;
	myAwesomplete.list = list;

	palette.__getList = () => {
		return list;
	};

	palette.__addListElement = (listElement) => {
		list.push(listElement);
		myAwesomplete.list = list;
	};

	palette.__removeListElement = (listElement) => {
		const index = list.findIndex(el => (el.label === listElement.label && el.value === listElement.value));
		if (index > -1) {
			list.splice(index, 1);
			myAwesomplete.list = list;
		}
	};


	/******************************************************************************/

	return palette;
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="NWmXiMi9" name="Palette Style" draggable="false" style __wid="a57ZfmDs"><STYLE data-type="content" type="text/css" codemirror="true" __wid="qMUupRUy">html .palette .palette-modal {
	position: fixed;
	left: 0;
	top: 0;
	width: 100vw;
	height: 100vh;
	background: var(--color-primary-text);
	opacity: 0.25;
	z-index: 397;
	transition: opacity var(--navigation-transition);
	opacity: 0;
	pointer-events: none;
}

html .palette.visible .palette-modal {
	opacity: 0.35;
	pointer-events: all;
}

html .palette .palette-search {
	display: flex;
	flex-direction: row;
	position: fixed;
	top: 160px;
	left: 50%;
	min-width: 400px;
	z-index: 398;
	box-shadow: var(--material-shadow-z24);
	border-radius: 2px;
	background: var(--color-primary-shade-1);
	transition: opacity var(--navigation-transition),
							transform var(--navigation-transition);
	opacity: 0;
	transform: translate(-50%, -50%) translate(0, 96px) scale(0.75);
	pointer-events: none;
}

html .palette.visible .palette-search {
	opacity: 1;
	transform: translate(-50%, -50%);
	pointer-events: all;
}

/******************************************************************************/

html .palette .palette-button {
	display: flex;
	padding: 4px;
	width: 48px;
	height: 48px;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	border-radius: 50%;
	flex-shrink: 0;
	user-select: none;
}

html .palette .palette-search {
	background: var(--color-primary-shade-1);
	border-radius: 4px;
	display: flex;
	flex: 0 1 512px;
}

html .palette .palette-input {
	flex: 0 1 100%;
	outline: none;
	background: none;
	border: none;
	color: var(--color-primary-text);
	text-overflow: ellipsis;
	font-size: 1em;
	letter-spacing: 0.02rem;
}

html .palette .palette-input::placeholder {
	color: var(--color-tertiary-text);
}

html .palette .palette-button-search,
html .palette .palette-button-close {
	width: 40px;
	height: 40px;
	margin: 4px;
}

html .palette .palette-icon {
	cursor: default;
}

/******************************************************************************/

html .palette .awesomplete [hidden] {
	display: none;
}

html .palette .awesomplete .visually-hidden {
	position: absolute;
	clip: rect(0, 0, 0, 0);
}

html .palette .awesomplete {
	display: inline-block;
	position: relative;
	display: flex;
	flex: 0 1 100%;
}

html .palette .awesomplete > input {
	display: block;
}

html .palette .awesomplete > ul {
	position: absolute;
	left: 0;
	top: 48px;
	color: var(--color-primary-text);
	z-index: 398;
	min-width: 100%;
	box-sizing: border-box;
	list-style: none;
	padding: 0;
	margin: 0;
	max-height: 320px;
	overflow-y: auto;
	border-radius: 0 0 4px 4px;
	background: var(--color-primary-shade-1);
	box-shadow: var(--material-shadow-z24);
	transition: 0.3s cubic-bezier(0.4, 0.2, 0.5, 1.4);
	transform-origin: 1.43em -.43em;
}

html .palette .awesomplete > ul::-webkit-scrollbar-thumb {
	border-radius: 0px;
	background-color: var(--color-primary-shade-3);
}

html .palette .awesomplete > ul:empty {
	display: none;
}

html .palette .awesomplete > ul[hidden],
html .palette .awesomplete > ul:empty {
	opacity: 0;
	transform: scale(0);
	display: block;
	transition-timing-function: ease;
}

html .palette .awesomplete > ul > li {
	position: relative;
	padding: 8px;
	cursor: pointer;
}

html .palette .awesomplete > ul > li:hover {
	background: rgba(var(--color-primary-shade-3-rgb), 0.25);
	color: var(--color-primary-text);
}

html .palette .awesomplete mark {
	background: rgba(var(--color-primary-shade-3-rgb), 0.5);
	color: var(--color-primary-text);
}

html .palette .awesomplete > ul > li[aria-selected="true"] {
	background: rgba(var(--color-primary-shade-3-rgb), 0.5);
	color: var(--color-primary-text);
}

html .palette .awesomplete li[aria-selected="true"] mark {
	background: rgba(var(--color-primary-shade-3-rgb), 1);
	color: var(--color-primary-text);
	border-radius: 1px;
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-id="RWxfFGXB" data-type="system" name="The Codestrate Code" data-group="editing" __wid="DTv2QDuZ">

    <DIV class="paragraph body-paragraph locked collapsed" data-id="5du9n32b" name="Documentation" draggable="false" __wid="iDcXkque"><DIV data-type="content" type="text/html" class="section-documentation" contenteditable="false" codemirror="true" __wid="LBULnREF"><H2 __wid="s349RsHy">Description</H2><DIV __wid="R8DAQHWU">This section is the nucleus of how the Codestrate started. It organically grew with new features being introduced over the course of time. We have started to dissect the section and move paragraphs to their own sections. Yet, the development and use of Codestrates is very organic and we haven't entirely refactored the Codestrates prototype. But, this section will possibly fade away over time.</DIV><DIV __wid="nvuKk3Xd">At the moment, it still contains paragraphs that create the transient user interface for paragraphs such as paragraph headers and paragraph actions (e.g., lock, delete, collapse, and move paragraph).</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" data-id="9Tcd2zNW" name="Properties" __wid="fPwCJWvc"><PRE data-type="content" type="application/json" contenteditable="false" class="section-properties" __wid="C7uQqNfY">{
	"version": "1.2",
	"description": "The nucleus of the Codestrate.",
	"changelog":
	{
		"1.2": "Added 'Variables' code paragraph.",
		"1.1": "Focussed Paragraph and Section changes.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph code-paragraph collapsed" data-id="TwAVFiuS" name="DOM Utils" style draggable="false" run-on-load="true" last-execution-state="success" __wid="EXKTSzTW"><PRE data-type="content" type="text/javascript" id="dom-utils" __wid="S8ad7wPJ">const HTMLUtils = window.HTMLUtils = (function () {

	this.getCaretPosition = function (editableDiv) {
		var caretPos = 0, sel, range;
		if (window.getSelection) {
			sel = window.getSelection();
			if (sel.rangeCount) {
				range = sel.getRangeAt(0);
				if (range.commonAncestorContainer.parentNode == editableDiv) {
					caretPos = range.endOffset;
				}
			}
		} else if (document.selection && document.selection.createRange) {
			range = document.selection.createRange();
			if (range.parentElement() == editableDiv) {
				var tempEl = document.createElement("span");
				editableDiv.insertBefore(tempEl, editableDiv.firstChild);
				var tempRange = range.duplicate();
				tempRange.moveToElementText(tempEl);
				tempRange.setEndPoint("EndToEnd", range);
				caretPos = tempRange.text.length;
			}
		}
		return caretPos;
	};

	this.setCaretPosition = function(editableDiv, position) {

		// Only set new caret position if position > 0
		if (position &lt;= 0) return;

		var textNode = editableDiv.firstChild;
		var range = document.createRange();
		range.setStart(textNode, position);
		range.setEnd(textNode, position);
		var sel = window.getSelection();
		sel.removeAllRanges();
		sel.addRange(range);
	};

	this.pasteHtmlAtCaret = function (html) {
		var sel, range;
		if (window.getSelection) {
			// IE9 and non-IE
			sel = window.getSelection();
			if (sel.getRangeAt && sel.rangeCount) {
				range = sel.getRangeAt(0);
				range.deleteContents();

				// Range.createContextualFragment() would be useful here but is
				// non-standard and not supported in all browsers (IE9, for one)
				var el = document.createElement("div");
				el.innerHTML = html;
				var frag = document.createDocumentFragment(), node, lastNode;
				while ((node = el.firstChild)) {
					lastNode = frag.appendChild(node);
				}
				range.insertNode(frag);

				// Preserve the selection
				if (lastNode) {
					range = range.cloneRange();
					range.setStartAfter(lastNode);
					range.collapse(true);
					sel.removeAllRanges();
					sel.addRange(range);
				}
			}
		} else if (document.selection && document.selection.type != "Control") {
			// IE &lt; 9
			document.selection.createRange().pasteHTML(html);
		}
	};

	this.appendChildAtCaret = function (child, beforeInsert) {
		if (window.getSelection) {

			// IE9 and non-IE
			const selection = window.getSelection();

			let range;
			if (selection.focusNode && selection.getRangeAt && selection.rangeCount) {
				range = selection.getRangeAt(0);
			}
			else {
				range = HTMLUtils.lastRange;
			}

			if (range) {

				// Check if child should be inserted at range.
				if (typeof beforeInsert === 'function') {
					if (!beforeInsert(range)) {
						return false;
					}
				}

				range.deleteContents();
				range.insertNode(child);

				// Preserve the selection
				if (child) {
					range = range.cloneRange();
					range.setStartAfter(child);
					range.collapse(true);
					selection.removeAllRanges();
					selection.addRange(range);
				}

				return true;
			}
		} else {
			throw new Error(`Append child at caret is not supported.`);
		}

		return false;
	};

	return this;
}).call({});

/******************************************************************************/

/**
 * This is a hack for iOS devices where the selection on contenteditable
 * changes when clicking a button.
 */
document.addEventListener("selectionchange", event => {
	if (window.getSelection) {
		const selection = window.getSelection();

		let node = selection.focusNode;
		if (node) {

			const range = selection.getRangeAt(0);
			HTMLUtils.lastRange = range.cloneRange();

			if (node.nodeType === 3) {
				node = node.parentElement;
			}

			const bodyParagraphContent = node.closest(".paragraph.body-paragraph [data-type='content'][contenteditable]");

			if (bodyParagraphContent) {
				bodyParagraphContent._selectionRange = range.cloneRange();
			}
		}
	}
});

/******************************************************************************/

Element.prototype.appendChildAtCaret = function(child) {
	if (!this.isContentEditable) return;

	let range = this._selectionRange;

	if (range) {
		// range.deleteContents();
		range.insertNode(child);

		if (window.getSelection) {
			const selection = window.getSelection();

			// Preserve the selection
			if (child) {
				range = range.cloneRange();
				range.setStartAfter(child);
				range.collapse(true);
				selection.removeAllRanges();
				selection.addRange(range);
			}
		}
		return true;
	}
	return false;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="8GcNuGZD" name="Action Utils" draggable="false" __wid="rm9YWRBL"><PRE data-type="content" type="text/javascript" id="action-utils" __wid="cP3jzkxA">exports.create = (action, options = {}) => {

	options = Object.assign({
		classNames: null,
		text: null
	}, options);

	const button = document.createElement("div");
	button.setAttribute("class", "action" + (options.classNames ? " " + options.classNames : ""));
	button.addEventListener("click", action);

	if (options.text) {
		const text = document.createElement("span");
		text.setAttribute("class", "action-label");
		text.innerText = options.text;
		button.appendChild(text);
	}

	if (options.tooltip) {
		button.setAttribute("tooltip", options.tooltip);
	}

	const icon = document.createElement("i");
	icon.setAttribute("class", "material-icons");
	button.appendChild(icon);

	return button;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="WPJxSYWH" name="Section Code" draggable="false" style run-on-load="true" last-execution-state="success" __wid="xdNUBbx6"><PRE data-type="content" type="text/javascript" __wid="6fW2XfaX">const ActionUtils = require("#action-utils");
const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

/**
 * Add a transient header to the section. This transient element will
 * contain all section specific actions, like collapse, and sortable.
 */
const addArticleHeader = (section) => {

	// Add section header only once.
	if (section.querySelector(".section-header")) return;

	const header = document.createElement("transient");
	header.setAttribute("class", "section-header");

	addEditableElement(section, header, "name");
	addEditableElement(section, header, "id");

	addToggleCollapse(section, header);
	addToggleVisibility(section, header);
	addHideCollapsedParagraphsAction(section, header);

	addDeleteAction(section, header);
	addToggleSystemSectionAction(section, header);
	addTogglePackageSectionAction(section, header);

	addDataIdElement(section, header);

	section.insertBefore(header, section.firstChild);
};

/******************************************************************************/

const addEditableElement = (section, header, attributeName) => {

	// Add title name element to header.
	const nameElement = document.createElement("span");
	nameElement.setAttribute("class", `${attributeName}-input`);
	nameElement.setAttribute("contenteditable", "true");

	section.liveAttribute(attributeName).changed(value => {
		// This fixes a bug introduced in Chrome 57 and Safari resulting in reverse text input.
		let position = HTMLUtils.getCaretPosition(nameElement);
		nameElement.innerHTML = value || "";
		HTMLUtils.setCaretPosition(nameElement, position);
	});

	nameElement.addEventListener("input", function () {
		const name = nameElement.innerText;
		const hasName = !!name.trim().length;

		if (!hasName) {
			section.removeAttribute(attributeName);
		} else {
			section.setAttribute(attributeName, name);
		}
	});
	header.appendChild(nameElement);
};

const addDataIdElement = (section, header) => {
	const idElement = document.createElement("span");
	idElement.classList.add("data-id-label");
	let id = section.getAttribute("data-id");
	if (!id) {
		id = Codestrate.util.randomString();
		section.setAttribute("data-id", id);
	}
	idElement.innerText = id;
	idElement.setAttribute("tooltip", "true");

	header.appendChild(idElement);
};

/******************************************************************************/

const removeSection = (section) => {
	const sections = document.getElementById("sections");
	const nextSection = section.nextSibling;
	section.remove();
	toast(`Section "${section.getAttribute("name") || "No Name"}" deleted`, 5000, () => sections.insertBefore(section, nextSection), "Undo");
};

const addDeleteAction = (section, header) => {
	const action = ActionUtils.create(() => {

		const name = section.getAttribute("name");

		let message = "Do you really want to delete this section?";
		if (name && name !== "") {
			message = "Do you really want to delete section " + name + " ?";
		}

		const result = confirm(message, "Delete Section");

		if (result instanceof Promise) {
			result.then(r => {
				if (r) {
					removeSection(section);
				}
			});
		} else if (result) {
			removeSection(section);
		}
	}, { classNames: "delete-section", tooltip: true });

	header.appendChild(action);
};

/******************************************************************************/

const addTemplates = (section, propertiesTemplateId) => {
	const firstParagraph = section.querySelector(".paragraph");

	const documentationTemplate = document.querySelector("#section-documentation-template");
	let documentationParagraph;

	if (documentationTemplate) {
		documentationParagraph = ParagraphUtils.createBodyParagraph();
		documentationParagraph.setAttribute("name", "Documentation");

		const content = documentationParagraph.querySelector("[data-type='content']");
		content.classList.add("section-documentation");
		content.innerHTML = documentationTemplate.innerHTML;

		section.insertBefore(documentationParagraph, firstParagraph);
	}

	const propertiesTemplate = document.querySelector(`#${propertiesTemplateId}`);
	let propertiesParagraph;

	if (propertiesTemplate) {
		propertiesParagraph = ParagraphUtils.createDataParagraph();
		propertiesParagraph.setAttribute("name", "Properties");

		const content = propertiesParagraph.querySelector("[data-type='content']");
		content.classList.add("section-properties");
		content.innerHTML = propertiesTemplate.innerHTML;

		section.insertBefore(propertiesParagraph, firstParagraph);
	}

	toast("Section documentation and properties added", false, () => {
		section.removeChild(documentationParagraph);
		section.removeChild(propertiesParagraph);
	}, "Undo");
};

const addTogglePackageSectionAction = (section, header) => {
	const action = ActionUtils.create(() => {

		if (section.hasAttribute("data-type") && (section.getAttribute("data-type") === "package")) {
			section.removeAttribute("data-type");
		} else {
			section.setAttribute("data-type", "package");
			if (!section.querySelector(".section-documentation") && !section.querySelector(".section-properties")) {
				confirm("Every package section should have a section documentation and properties. Do you want to copy the templates into this section?", "Missing Properties").then((result) => {
					if (result) {
						addTemplates(section, "package-section-properties-template");
					}
				});
			}
		}
	}, {
		classNames: "toggle-package-section",
		tooltip: true
	});

	header.appendChild(action);
};

const addToggleSystemSectionAction = (section, header) => {
	const action = ActionUtils.create(() => {

		if (section.hasAttribute("data-type") && (section.getAttribute("data-type") === "system")) {
			section.removeAttribute("data-type");
		} else {
			section.setAttribute("data-type", "system");
			if (!section.querySelector(".section-documentation") && !section.querySelector(".section-properties")) {
				confirm("Every system section should have a section documentation and properties. Do you want to copy the templates into this section?", "Missing Properties").then((result) => {
					if (result) {
						addTemplates(section, "system-section-properties-template");
					}
				});
			}
		}
	}, {
		classNames: "toggle-system-section",
		tooltip: true
	});

	header.appendChild(action);
};

/******************************************************************************/

const addHideCollapsedParagraphsAction = (section, header) => {
	const action = ActionUtils.create(() => {
		section.classList.toggle("hide-collapsed-paragraphs");
	}, {
		classNames: "hide-collapsed-paragraphs2",
		tooltip: true
	});

	header.appendChild(action);
};

const addToggleVisibility = (section, header) => {
	const action = ActionUtils.create(() => {

		if (section.classList.contains("section-hidden")) {
			section.classList.remove("section-hidden");
			section.classList.add("section-visible");
		} else {
			section.classList.remove("section-visible");
			section.classList.add("section-hidden");
			toast(`Section "${section.getAttribute("name") || "No Name"}" hidden`, false, () => {
				section.classList.remove("section-hidden");
				section.classList.add("section-visible");
			}, "Undo");
		}
	}, {
		classNames: "toggle-visibility-section",
		tooltip: true
	});

	header.appendChild(action);
};

const addToggleCollapse = (section, header) => {
	const action = ActionUtils.create(() => {

		if (section.classList.contains("collapsed")) {
			section.classList.remove("collapsed");
		} else {
			section.classList.add("collapsed");
		}
	}, {
		classNames: "toggle-collapse",
		tooltip: true
	});

	header.appendChild(action);
};

/******************************************************************************/

// Live query the body for existing sections on load and new sections added later
const sectionQuery = document.liveQuerySelectorAll(".section").added(addArticleHeader);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="8SKMAbq9" name="Paragraph Utils Code" style draggable="false" __wid="myNP9RaW"><PRE data-type="content" type="text/javascript" id="paragraph-utils" __wid="yFgiSDGt">const paragraphHeaderClass = "paragraph-header";

/******************************************************************************/

const createParagraph = (type) => {
  const paragraph = document.createElement("div");
  paragraph.classList.add("paragraph");
  paragraph.classList.add(`${type}-paragraph`);
  return paragraph;
};

/******************************************************************************/

exports.createBodyParagraph = (content = "") => {
  const paragraph = createParagraph("body");

  const contentContainer = document.createElement("div");
  contentContainer.setAttribute("data-type", "content");
  contentContainer.setAttribute("type", "text/html");
  contentContainer.setAttribute("codemirror", "true");
  contentContainer.contentEditable = true;
  contentContainer.innerHTML = content;

  paragraph.appendChild(contentContainer);

  return paragraph;
};

exports.createStyleParagraph = (style = "/* CSS here */", containerElement = "style") => {
  const paragraph = createParagraph("style");

  const styleContainer = document.createElement(containerElement);
  styleContainer.setAttribute("data-type", "content");
  styleContainer.setAttribute("type", "text/css");
  styleContainer.setAttribute("codemirror", "true");

  const textNode = document.createTextNode(style);
  styleContainer.appendChild(textNode);

  paragraph.appendChild(styleContainer);

  return paragraph;
};

exports.createCodeParagraph = (code = "// JavaScript code here") => {
  const paragraph = createParagraph("code");

  const codeContainer = document.createElement("pre");
  codeContainer.setAttribute("data-type", "content");
  codeContainer.setAttribute("type", "text/javascript");

  const textNode = document.createTextNode(code);
  codeContainer.appendChild(textNode);

  paragraph.appendChild(codeContainer);

  return paragraph;
};

exports.createDataParagraph = (data = "/* JSON here */") => {
  const paragraph = createParagraph("data");

  const dataContainer = document.createElement("pre");
  dataContainer.setAttribute("data-type", "content");
  dataContainer.setAttribute("type", "application/json");

  const textNode = document.createTextNode(data);
  dataContainer.appendChild(textNode);

  paragraph.appendChild(dataContainer);

  return paragraph;
};

exports.insertParagraphAfterFocussed = (paragraph) => {
  if (Codestrate.focussedParagraph) {
    Codestrate.focussedSection.insertBefore(paragraph, Codestrate.focussedParagraph.nextSibling);
    Codestrate.simulateClick(paragraph);
  } else if (Codestrate.focussedSection) {
    Codestrate.focussedSection.appendChild(paragraph);
    Codestrate.simulateClick(paragraph);
  } else {
    alert("Select a section first!", "Cannot Add Paragraph");
  }
};

/******************************************************************************/

/**
 * Get paragraph header or create a new transient header if it does not exist.
 */
const getHeader = (paragraph) => {

  let header = paragraph.querySelector(`.${paragraphHeaderClass}`);
  if (!header) {
    header = document.createElement("transient");
    header.setAttribute("class", paragraphHeaderClass);
    paragraph.insertBefore(header, paragraph.firstChild);
  }
  return header;
};

/**
 * Get content element.
 */
const getContentElement = (paragraph) => {
  return paragraph.querySelector('[data-type="content"]');
};

exports.getHeaderElement = getHeader;
exports.getContentElement = getContentElement;

/******************************************************************************/

exports.addHeaderAction = (paragraph, className, action, options) => {

  let header = getHeader(paragraph);

  // Only add header action once.
  if (header.querySelector(`.${className}`)) return;

  const actionElement = document.createElement("div");
  actionElement.setAttribute("class", `action ${className}`);

  // Add action if defined.
  if (action) {
    actionElement.addEventListener("click", action);
  }

  // Add tooltip when provided as optional setting
  if (options && options.tooltip) {
    actionElement.setAttribute("tooltip", options.tooltip);
  }

  const icon = document.createElement("i");
  icon.setAttribute("class", "material-icons");
  actionElement.appendChild(icon);

  header.appendChild(actionElement);

  return actionElement;
};

exports.addEditableElement = (target, attributeName, proxyElement) => {

  // Only add editable element once.
  if (target.querySelector(`span.${attributeName}-input`)) return;

  // Add title name element to header.
  const nameElement = document.createElement("span");
  nameElement.setAttribute("class", `input ${attributeName}-input`);
  nameElement.setAttribute("contenteditable", "true");

  // Update when changing to the attribute happen (also remote updates).
  proxyElement.liveAttribute(attributeName).changed((value) => {
    // This fixes a bug introduced in Chrome 57 and Safari resulting in reverse text input.
    let position = HTMLUtils.getCaretPosition(nameElement);
    nameElement.innerHTML = value || "";
    HTMLUtils.setCaretPosition(nameElement, position);
  });

  nameElement.addEventListener("input", function () {
    const name = nameElement.innerText;
    const hasName = !!name.trim().length;

    if (!hasName) {
      proxyElement.removeAttribute(attributeName);
    } else {
      proxyElement.setAttribute(attributeName, name);
    }
  });
  target.appendChild(nameElement);
};

exports.addSelectElement = (target, attributeName, proxyElement, options) => {

  // Only add editable element once.
  let selectList = target.querySelector(`select.${attributeName}-input`);
  if (!selectList) {
    //Create and append select list
    selectList = document.createElement("select");
    selectList.classList.add("input");
    selectList.classList.add(`${attributeName}-input`);
    selectList.addEventListener("change", (event) => {
      let selectedValue = selectList.value;
      proxyElement.setAttribute(attributeName, selectedValue);

      // remove invalid options if a valid option was selected
      if (!selectList.selectedOptions[0].hasAttribute("invalid")) {
        let invalidOptions = selectList.querySelectorAll('option[valid="false"]');
        Array.prototype.forEach.call(invalidOptions, (o) => o.remove());
      }
    });
  }

  const addOption = (value, valid = true) => {

    let option = selectList.querySelector(`option[value="${value}"]`);
    if (!option) {
      option = document.createElement("option");
			selectList.appendChild(option);
    }

		option.setAttribute("valid", valid);
    option.value = value;
    option.text = valid ? value : `${value} (invalid)`;
  };

  const initOptions = () => {
//     setTimeout(() => {
      //Create and append the options
      for (let i = 0; i &lt; options.length; i++) {
        addOption(options[i]);
      }

      proxyElement.liveAttribute(attributeName).changed((value) => {
        if (!selectList.querySelector(`option[value="${value}"]`)) {
          addOption(value, false);
        }

        selectList.value = value;
      });
//     }, 0);
  };

  // wait until all possible options initialized
  if (Codestrate.loaded) {
    initOptions();
  } else {
    window.addEventListener("codestrateloaded", function codestrateLoaded() {
      initOptions();
      window.removeEventListener("codestrateloaded", codestrateLoaded);
    });
  }

  target.appendChild(selectList);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="G87Cp7CG" name="Add data-ids to Sections and Paragraphs" run-on-load="true" style draggable="false" last-execution-state="success" __wid="RbgNEibj"><PRE data-type="content" type="text/javascript" __wid="kYWuDzsz">const ids = [];

// Adds a random data-id attribute to all sections and paragraphs, which are missing one,
// and checks for duplicate ids.
document.liveQuerySelectorAll(".section, .paragraph").added(element => {
	let id = element.getAttribute("data-id");
	if (!id) {
		id = Codestrate.util.randomString();
		element.setAttribute("data-id", id);
		ids.push(id);
	} else if (ids.includes(id)) {
		// console.error(`There are duplicate data-ids: "${id}"!`); // FIXME: Gets triggered when dragging and dropping paragraphs
	} else {
		ids.push(id);
	}
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="drVmLP3i" name="Focussed Paragraph and Section" draggable="false" style run-on-load="true" last-execution-state="success" __wid="LTvkfkVR"><PRE data-type="content" type="text/javascript" __wid="MqsY9pRj">const focussedAttribute = "transient-focussed";

/******************************************************************************/

const updateFocus = (event) => {
	if (!event.target || !event.target.closest) return;

	// No update on toolbar, menu or snackbar
	if (event.target.closest("#global-toolbar") ||
			event.target.closest("#global-menu") ||
			event.target.closest("#snackbar")) {
		return;
	}

	// Update paragraph
	const paragraph = event.target.closest(".paragraph");

	if (paragraph !== window.Codestrate.focussedParagraph) {
		if (window.Codestrate.focussedParagraph) {
			window.Codestrate.focussedParagraph.removeAttribute(focussedAttribute);
			window.Codestrate.focussedParagraph = null;
		}

		if (paragraph) {
			window.Codestrate.focussedParagraph = paragraph;
			window.Codestrate.focussedParagraph.setAttribute(focussedAttribute, "true");
		}
	}

	// Update section
	const section = event.target.closest(".section");

	if (section !== window.Codestrate.focussedSection) {
		if (window.Codestrate.focussedSection) {
			window.Codestrate.focussedSection.removeAttribute(focussedAttribute);
			window.Codestrate.focussedSection = null;
		}

		if (section) {
			window.Codestrate.focussedSection = section;
			window.Codestrate.focussedSection.setAttribute(focussedAttribute, "true");
		}
	}
};

/******************************************************************************/

window.addEventListener("click", function (event) {
	updateFocus(event);
}, true);

/*window.addEventListener("focus", function (event) {
	updateFocus(event);
}, true);*/

/******************************************************************************/

Codestrate.simulateClick = (element) => {
	const evObj = document.createEvent('Events');
	evObj.initEvent("click", true, false);
	element.dispatchEvent(evObj);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="mdyivJjZ" name="Paragraph Title Code" run-on-load="true" draggable="false" style last-execution-state="success" __wid="xzP4V7HM"><PRE data-type="content" type="text/javascript" __wid="jHm9fvMM">const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

document.liveQuerySelectorAll(".paragraph").added(paragraph => {
	const header = ParagraphUtils.getHeaderElement(paragraph);
	const content = ParagraphUtils.getContentElement(paragraph);

	ParagraphUtils.addEditableElement(header, "name", paragraph);
	ParagraphUtils.addEditableElement(header, "id", content);
	ParagraphUtils.addEditableElement(header, "class", content);
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="TTfmS2at" name="Paragraph Collapse Action Code" draggable="false" run-on-load="true" style last-execution-state="success" __wid="HgQY83y2"><PRE data-type="content" type="text/javascript" __wid="T8vbrBDy">const SectionUtils = require("#paragraph-utils");

/******************************************************************************/

const addCollapsibleAction = function(paragraph) {
	SectionUtils.addHeaderAction(paragraph, "collapse-expand", () => {
		paragraph.classList.toggle("collapsed");
	}, {
		tooltip: true
	});

	// CodeMirror requires a refresh on the editor if any of the parent or
	// container styles changed.
	const updateEditor = () => {
		const content = paragraph.querySelector("[data-type='content']");

		if (content && content.__editor && content.__editor.editor) {
			content.__editor.editor.refresh();
		}
	};

	paragraph.liveAttribute("class").changed(updateEditor);
};

/******************************************************************************/

document.liveQuerySelectorAll(".paragraph").added(addCollapsibleAction);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="Wn58bYws" name="Paragraph Sortable Action Code" draggable="false" run-on-load="true" last-execution-state="success" style __wid="iGn4jbVX"><PRE data-type="content" type="text/javascript" __wid="ZtwrsxCg">importLib("Sortable.js").then(() => {

	const ParagraphUtils = require("#paragraph-utils");

	const addSortableAction = function(paragraph) {
		ParagraphUtils.addHeaderAction(paragraph, "drag-handle");

		paragraph.addEventListener("dragstart", event => {
			let clonedNode = paragraph.cloneNode(true);
			clonedNode.classList.remove("dragging");
			clonedNode.removeAttribute("style");

			let transients = clonedNode.querySelectorAll("transient");
			Array.prototype.forEach.call(transients, transient => {
				transient.remove();
			});

			let html = clonedNode.outerHTML;

			let data = {
				webstrateId: webstrate.webstrateId,
				type: "paragraph",
				html: html
			};

			event.dataTransfer.setData("application/x-codestrate", JSON.stringify(data));

		}, false);
	};

/******************************************************************************/

	const initSortable = function(section) {

		// Events fired on the drop targets
		section.addEventListener("dragover", event => {
			event.preventDefault();
		}, false);

		section.addEventListener("drop", event => {
			let plainData = event.dataTransfer.getData("application/x-codestrate");
			if (!plainData) return;

			let data = JSON.parse(plainData);

			// Drag and drop occured in the same codestrate, thus ignore it
			if (data.webstrateId === webstrate.webstrateId) {
				return;
			}

			let container = document.createElement("div");
			container.innerHTML = data.html;
			section.appendChild(container.children[0]);
		}, false);

		Sortable.create(section, {
			group: {
				name: "blocks"//,
				// pull: "clone"
			},
			animation: 150,
			// sort: false,
			draggable: ".paragraph",
			handle: ".drag-handle",
			ghostClass: "dragging",  // Class name for the drop placeholder
			chosenClass: "dragging",  // Class name for the chosen item
			dragClass: "dragging",  // Class name for the dragging item

			scrollSensitivity: 30, // px, how near the mouse must be to an edge to start scrolling.
			scrollSpeed: 30, // px

			onChoose: function (/**Event*/evt) {

				if (window.Codestrate.focussedParagraph) {
					// removeConsole(window.Codestrate.focussedParagraph);
					// window.Codestrate.focussedParagraph = null;
				}
			},

			// Element dragging started
			onStart: function (/**Event*/evt) {

				const codes = Array.from(document.querySelectorAll("pre[type],*[codemirror]"));
				codes.forEach(code => {
					if (code.__editor) {
						code.__editor.editor.setOption("dragDrop", false);
					}
				});
			},

			// Element dragging ended
			onEnd: function (/**Event*/evt) {
				const codes = Array.from(document.querySelectorAll("pre[type],*[codemirror]"));
				codes.forEach(code => {
					if (code.__editor) {
						code.__editor.editor.setOption("dragDrop", true);
					}
				});
			},
		});
	};

/******************************************************************************/

	document.liveQuerySelectorAll(".section").added(initSortable);
	document.liveQuerySelectorAll(".paragraph").added(addSortableAction);
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Paragraph Delete Action Code" draggable="false" run-on-load="true" style data-id="js38GiLb" last-execution-state="success" __wid="gXQD9eKy"><PRE data-type="content" type="text/javascript" __wid="7e6Tbhgg">const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

const removeParagraph = (paragraph) => {
	const section = paragraph.closest(".section");
	const nextParagraph = paragraph.nextSibling;
	paragraph.remove();
	toast(`Paragraph "${paragraph.getAttribute("name") || "No Name"}" deleted`, 5000, () => section.insertBefore(paragraph, nextParagraph), "Undo");
};

const addDeleteAction = (paragraph) => {
	ParagraphUtils.addHeaderAction(paragraph, "delete-paragraph", () => {

		const name = paragraph.getAttribute("name");

		let message = "Do you really want to delete this paragraph?";
		if (name && name !== "") {
			message = "Do you really want to delete paragraph " + name + " ?";
		}

		const result = confirm(message, "Delete Paragraph");

		if (result instanceof Promise) {
			result.then(r => {
				if (r) {
					removeParagraph(paragraph);
				}
			});
		} else if (result) {
			removeParagraph(paragraph);
		}
	}, {
		tooltip: true
	});
};

/******************************************************************************/

document.liveQuerySelectorAll(".paragraph").added(addDeleteAction);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Lock Paragraph Code" run-on-load="true" draggable="false" style data-id="iqecX7XG" last-execution-state="success" __wid="vWV8LSPt"><PRE data-type="content" type="text/javascript" contenteditable="true" __wid="e2vA82qy">const SectionUtils = require("#paragraph-utils");

/******************************************************************************/

const addLockAction = (paragraph) => {
	const lockElement = SectionUtils.addHeaderAction(paragraph, "lock-content", () => {

		const content = paragraph.querySelector("[data-type='content']");
		if (content) {
			if (!content.hasAttribute("contenteditable") || content.getAttribute("contenteditable") === "true") {
				content.setAttribute("contenteditable", "false");
			} else {
				content.setAttribute("contenteditable", "true");
			}
		}
	}, {
		tooltip: true
	});

	const content = paragraph.querySelector("[data-type='content']");

	if (content) {
		content.liveAttribute("contenteditable").changed((value, oldValue) => {
			const readOnly = value && value === "false" ? true : false;
			if (readOnly) {
				paragraph.classList.add("locked");
			} else {
				paragraph.classList.remove("locked");
			}
		});
	}
};

/******************************************************************************/

document.liveQuerySelectorAll(".paragraph").added(addLockAction);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Hash Scroll Code" run-on-load="true" style data-id="4rUSqsbU" draggable="false" last-execution-state="success" __wid="8q8wGuk5"><PRE data-type="content" type="text/javascript" __wid="Wu43VFVC">const element = document.getElementById(window.location.hash.substr(1));

if (element) {
	const scrollToElement = element.parentElement;

	window.addEventListener("codestrateloaded", () => {
		if (scrollToElement) {
			window.scrollTo(0, scrollToElement.getBoundingClientRect().top);
		}
	});
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Variable Code" data-id="LkEsdkdw" draggable="false" run-on-load="true" style last-execution-state="success" __wid="6HqnDe9G"><PRE data-type="content" type="text/javascript" __wid="aCSYXC3b">window.Variable = function (name) {
	const variables = Array.from(document.querySelectorAll(`div.variable[data-name="${name}"]`));

	this.set = function (value) {
		variables.forEach(variable => {
			variable.innerHTML = value;
		});
	};

	this.setTransient = function (value) {
		variables.forEach(variable => {
			variable.innerHTML = `&lt;transient>${value}&lt;/transient>`;
		});
	};

	this.appendChild = function(child) {
		if (variables.length === 0) {
			console.warn(`Variable ${name} does not exist`);
		}

		if (variables.length > 1) {
			console.warn(`Variable.appendChild only applied to first variable`);
		}

		if (variables.length > 0) {
			variables[0].appendChild(child);
		}
	};

	return this;
}.bind({});</PRE></DIV></DIV><DIV class="section section-hidden" data-id="PJGnfYsy" name="The Codestrate Style" data-type="system" data-group="basic" __wid="J44sTxPY"><DIV class="paragraph body-paragraph collapsed locked" data-id="5B8NDkAt" name="Documentation" style draggable="false" __wid="VUdhBYFH"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="XyBVmP8c"><H2 __wid="K8qM5wpj">Description</H2><DIV __wid="L2nbRQe5">This section provides the basic styling of the user interface of Codestrates. This includes variables, Material Design styles and paragraph and section styles. Other than this styles should always be inside their respective section/package.</DIV><H2 __wid="5PCt4BMe">Theme Variables</H2><DIV __wid="WnbTtbqv">Codestrate uses CSS variables for the basic color theme and fonts. The variables can be found in the "Theme Variables" paragraph. They are available in the whole document and should be used wherever one creates user interfaces for Codestrates, as they ensure legibility and consistent use of colors throughout Codestrates. They also make it possible to easily create new themes for Codestrates.</DIV><H3 __wid="CuVEkT66">Fonts</H3><DIV __wid="4X5XDE7k">For the fonts of Codestrates there are three variables:</DIV><DIV __wid="TCUGChQw"><UL __wid="QsjgcUBn"><LI __wid="4L4icEXW"><CODE __wid="kDmmNNxx">var(--font-primary)</CODE>: The main font for user interfaces of a Codestrate. This should be a sans-serif font most of the time.</LI><LI __wid="vFRtwCkb"><CODE __wid="NkjU4Kis">var(--font-secondary)</CODE>: The font for body text in body-paragraphs and alike. This can be both a serif or sans-serif font, depending on the theme.</LI><LI __wid="KinsmN4r"><CODE __wid="AuksZxCU">var(--font-monospace)</CODE>: The font for editors and other usecases, where a monospace font is needed.</LI></UL></DIV><H3 __wid="ujH9bHh5">Colors</H3><DIV __wid="X7EAZEWu">The color variables of a Codestrate can be divided in three categories:</DIV><DIV __wid="zwDQi4Vr"><DIV __wid="w8JZQccU"><B __wid="YGHG9E7z">Primary Color</B></DIV><DIV __wid="eJ8P6KJ8"><UL __wid="gfjMKQcH"><LI __wid="NdzpuJMC"><CODE __wid="wHA5gtdD">var(--color-primary)</CODE>: The primary color of the Codestrate.</LI><LI __wid="2fZ3Y5MG"><CODE __wid="ZU4Csc7W">var(--color-primary-shade-1)</CODE>: A darker or brighter shade of the primary color.</LI><LI __wid="zaWAvLuE"><CODE __wid="atTpaxRB">var(--color-primary-shade-2)</CODE>: A more darker or brighter shade of the primary color.</LI><LI __wid="s82hAiiT"><CODE __wid="2rNyDUUF">var(--color-primary-shade-3)</CODE>: A even more darker or brighter shade of the primary color.</LI></UL></DIV><DIV __wid="sKKEW92i"><DIV __wid="LvpyZjbe"><B __wid="qjrKY6ub">Text Color</B></DIV><DIV __wid="S2vT8kEB"><UL __wid="W9shar4i"><LI __wid="BSMcHxgy"><CODE __wid="ybDxm8kR">var(--color-primary-text)</CODE>: The primary text color. This should have a high contrast to the primary color. Used for main user interfaces and headlines.</LI><LI __wid="xaW8GnqX"><CODE __wid="9RFnnyiN">var(--color-secondary-text)</CODE>: A darker or brighter shade of the primary text color, which has less contrast to the primary color. Used for less important text and general body text.</LI><LI __wid="ea4jr3td"><CODE __wid="bNQ7X8RL">var(--color-tertiary-text)</CODE>: A even darker or brighter shade of the primary text color, which has even less contrast to the primary color. Used for disabled or unimportant text.</LI></UL></DIV><DIV __wid="WP6Qrgng"><DIV __wid="ddWw86Ah"><B __wid="rGa8BwyP">Accent Color</B></DIV></DIV><DIV __wid="2DMRV2mA"><UL __wid="EPcpdLFU"><LI __wid="p47S3t2A"><CODE __wid="AmZtaUfj">var(--color-accent)</CODE>: An accent color for highlights or important user interfaces, which also adds a bit of color to the general theme.</LI><LI __wid="NAS79EJe"><CODE __wid="CgzBpeXc">var(--color-accent-text)</CODE>: A text font, which is legible on the accent color.</LI></UL><H4 __wid="PZg5mBNd">RGB-Values</H4></DIV><DIV __wid="DPLgz76q">The variables described above need to have a value, so they can be directly used (e.g. <CODE __wid="bLdBLzpZ">#FFFFFF</CODE> or <CODE __wid="jCZJWNTZ">rgb(255, 255, 255)</CODE>). In addition to these variables one also needs to provide the raw RGB values of the colors (e.g. <CODE __wid="X4UCu79U">255, 255, 255</CODE>). These are stored in variables with the same name and the suffix <CODE __wid="SuAVhqqn">-rgb</CODE>. This is needed to use colors with an alpha value. The code snippet below shows an example:</DIV><PRE __wid="m9h9nECC"><CODE __wid="8LiAtaVf">/* Has accent color and opacity of 50 % in background */
.myClass {
  background: rgba(var(--color-accent-rgb), 0.5);
}</CODE></PRE><H2 __wid="g2CViBgc">The <CODE __wid="Aw8QxQGQ">themable</CODE> Class</H2><DIV __wid="a2uyDXc5">The class <CODE __wid="hqzHkZHE">themable</CODE>, which can be found on many of the style paragraphs in this section, is used by the package "Theme Creator". The class indicates the Theme Creator, that the style can be modified when creating new themes. It should be added to style paragraphs containing font, colors or other "styleable" user interfaces. Style paragraphs only containing CSS "logic", like setting the z-index or the display and position types, don't need to (but can of course) themable.</DIV><H3 __wid="V4HaM8dE">Selector Start</H3><DIV __wid="UgWZyYQf">When creating themable style paragraphs, every selector should begin with <CODE __wid="bNYzpFtH">html</CODE>. This is needed for the theme creator to later override it with the respective selector of the theme (see the "Theme Creator" documentation for more information).</DIV><PRE __wid="KnpgLkqj"><CODE __wid="KzQyMkwd">/* Bad */
.myClass {
  color: hotpink;
}

/* Good */
html .myClass {
  color: hotpink;
}</CODE></PRE><H2 __wid="b57e7v75">Material Design</H2><DIV __wid="sujsPAMq">The user interface of Codestrates uses many design guidelines of Google's Material Design (<A href="https://material.io/guidelines/" target="_blank" __wid="c9UF2t9g">link</A>). When creating new user interface elements of Codestrates these should (don't have to of course) be considered.</DIV><H3 __wid="kdgqkYPm">Icons</H3><DIV __wid="khYh2DhB">Codestrates uses the Material Icons (<A href="https://material.io/icons/" target="_blank" __wid="TRebbZXN">link</A>) font to display icons. The icons usually reside inside an element with the <CODE __wid="XScTva9K">material-icons</CODE> class. The font uses ligatures, so setting the content of the element to <CODE __wid="R69h8XMB">info_outline</CODE> for example is enough to display icons.</DIV><H4 __wid="8tcT7AvK">Extended Icons set</H4><DIV __wid="4GCmKEmR">As the icons font of Google lacks some icons, Codestrates also incorporates the open "Material Design Icons" (<A href="https://materialdesignicons.com/" target="_blank" __wid="JQvpQX2j">link</A>)) webfont. Whereas the font from Google uses ligatures, this font uses unicode symbols like <CODE __wid="NiSk4Vxe">\f2fd</CODE> to display icons. To overcome this inconvenience there are CSS variables for all icons. So instead of using the unicode symbol one can use the variable. To use the new font the element also needs to use the <CODE __wid="neJBMcac">Material Design Icons</CODE> font. The example below illustrates how to set the icon of an elment using the <CODE __wid="4t6R53Qz">:after</CODE> selector:</DIV><PRE __wid="cNsGqaPk"><CODE __wid="5rzaDf3d">/* Note: The element still needs the "material-icons" class */

/* Google Material Icons */
.myClass.material-icons:after {
  content: "info_outline";
}

/* Open Material Design Icons */
.myClass.material-icons:after {
  content: var(--information-outline); /* resolves to "\f2fd" */
  font-family: "Material Design Icons";
}</CODE></PRE><H3 __wid="Ya3MYGLm">Fonts</H3><DIV __wid="AJ7F2q8A">Codestrates includes the "Roboto" font for user interfaces, body text and code editors. The following fonts are included in every Codestrate and provided using <CODE __wid="c93g7QcC">@font-face</CODE>:</DIV><DIV __wid="XpD9nkNT"><UL __wid="HRhVCxwU"><LI __wid="hap9XJHR"><B __wid="GCKCF6Zs">Roboto:</B> 300, 300italic, 400, 400italic, 500, 500italic, 700, 700italic</LI><LI __wid="WqLubetA"><B __wid="GzV3idFe">Roboto Mono:</B> 400, 400italic, 700, 700italic</LI></UL><DIV __wid="S7AfBrNa"><B __wid="kUMvBPu4">Note</B>: 400 is regular or normal weight and 700 is bold.</DIV></DIV><H3 __wid="QAfgTPre">Variables</H3><DIV __wid="ePepRJts">Codestrates provides basic variables for some Material Design styles like colors (<A href="https://material.io/guidelines/style/color.html#color-color-palette" target="_blank" __wid="iUP7JTik">link</A>) and shadows (<A href="https://material.io/guidelines/material-design/elevation-shadows.html#elevation-shadows-elevation-android" target="_blank" __wid="k4yXGr22">link</A>).</DIV> These can be used anywhere to get a consistent color scheme and shadows for correct elevations. A list of all variables can be found in the "Material Variables" style paragraph.<H2 __wid="FbFcGe7B">z-Indexes</H2><DIV __wid="xKR4KQT9">In the list below is an overview over the used z-indexes in the user interface of Codestrates:</DIV><UL __wid="6pvNLnQK"><LI __wid="HistLf2R">500: Toast Message</LI><LI __wid="DSKxEz6r">450: Help Dialog</LI><LI __wid="ggRnqydM">400: Dialog</LI><LI __wid="KV5h9ZYW">395: Loading Screen</LI><LI __wid="6YbdU4Fk">375: Snackbar Fullscreen</LI><LI __wid="pYNDgbbL">350: Transient Fullscreen</LI><LI __wid="4iTnB54y">300: Fullscreen</LI><LI __wid="vSL8riub">250: Snackbar Expanded</LI><LI __wid="DCpqbwAe">200: Global Toolbar</LI><LI __wid="RUB2eXAy">100: Global Menu<BR __wid="e3WAG9HV"/></LI><LI __wid="vnU6BKAi">50: Snackbar</LI></UL></DIV></DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" data-id="Cdg8V6VB" name="Properties" style __wid="Q7eejzf2"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="sytk7wyF">{
	"version": "1.3.3",
	"description": "Provides the basic styling of the user interface of Codestrates.",
	"changelog": {
		"1.0": "Initital Release",
		"1.1": "Variables, Roboto and Ripple effects added. Some style adjustments for Material Design.",
		"1.2": "Basic body paragraph content styling.",
		"1.2.1": "Added documentation.",
		"1.2.2": "Material Ripple generic class.",
		"1.3": "New div structure so scrollbar is only under toolbar.",
		"1.3.1": "Adjusted width for pinned notification bar.",
		"1.3.2": "Added info, warning, danger and success boxes to writing class.",
		"1.3.3": "Updated loading and disconnect styles"
	}
}</PRE></DIV>

<DIV class="paragraph style-paragraph collapsed" data-id="2KAEh4pu" draggable="false" style name="Material Font Icons" __wid="XpTK8zSv"><STYLE data-type="content" type="text/css" codemirror="true" __wid="wjgXvnbH">@font-face {
	font-family: 'Material Icons';
	font-style: normal;
	font-weight: 400;
	src: url(MaterialIcons-Regular.eot); /* For IE6-8 */
	src: local('Material Icons'),
		local('MaterialIcons-Regular'),
		url(MaterialIcons-Regular.woff2) format('woff2'),
		url(MaterialIcons-Regular.woff) format('woff'),
		url(MaterialIcons-Regular.ttf) format('truetype');
}

.material-icons {
	font-family: 'Material Icons';
	font-weight: normal;
	font-style: normal;
	font-size: 24px;  /* Preferred icon size */
	display: inline-block;
	line-height: 1;
	text-transform: none;
	letter-spacing: normal;
	word-wrap: normal;
	white-space: nowrap;
	direction: ltr;

	/* Support for all WebKit browsers. */
	-webkit-font-smoothing: antialiased;
	/* Support for Safari and Chrome. */
	text-rendering: optimizeLegibility;

	/* Support for Firefox. */
	-moz-osx-font-smoothing: grayscale;

	/* Support for IE. */
	font-feature-settings: 'liga';
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="ULK9sq3b" name="Material Font Icons Extended" __wid="hEeZ8nr7"><STYLE data-type="content" type="text/css" codemirror="true" __wid="xvpfSB6D">.material-icons {
	display: flex;
}

/* See icons: https://cdn.materialdesignicons.com/2.0.46/ */
@font-face {
	font-family: 'Material Design Icons';
	font-style: normal;
	font-weight: 400;
	src: url(materialdesignicons-webfont.eot); /* For IE6-8 */
	src: local('Material Icons'),
		local('MaterialIcons-Regular'),
		url(materialdesignicons-webfont.woff2) format('woff2'),
		url(materialdesignicons-webfont.woff) format('woff'),
		url(materialdesignicons-webfont.ttf) format('truetype');
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="FdbhNSLi" name="Material Font Icons Extended Variables (do not expand paragraph)" __wid="trLbbxC3"><STYLE data-type="content" type="text/css" codemirror="true" __wid="Mydddy5p">.material-icons {
	--access-point: "\f002";
	--access-point-network: "\f003";
	--account: "\f004";
	--account-alert: "\f005";
	--account-box: "\f006";
	--account-box-outline: "\f007";
	--account-card-details: "\f5d2";
	--account-check: "\f008";
	--account-circle: "\f009";
	--account-convert: "\f00a";
	--account-edit: "\f6bb";
	--account-key: "\f00b";
	--account-location: "\f00c";
	--account-minus: "\f00d";
	--account-multiple: "\f00e";
	--account-multiple-minus: "\f5d3";
	--account-multiple-outline: "\f00f";
	--account-multiple-plus: "\f010";
	--account-network: "\f011";
	--account-off: "\f012";
	--account-outline: "\f013";
	--account-plus: "\f014";
	--account-remove: "\f015";
	--account-search: "\f016";
	--account-settings: "\f630";
	--account-settings-variant: "\f631";
	--account-star: "\f017";
	--account-switch: "\f019";
	--adjust: "\f01a";
	--air-conditioner: "\f01b";
	--airballoon: "\f01c";
	--airplane: "\f01d";
	--airplane-landing: "\f5d4";
	--airplane-off: "\f01e";
	--airplane-takeoff: "\f5d5";
	--airplay: "\f01f";
	--alarm: "\f020";
	--alarm-bell: "\f78d";
	--alarm-check: "\f021";
	--alarm-light: "\f78e";
	--alarm-multiple: "\f022";
	--alarm-off: "\f023";
	--alarm-plus: "\f024";
	--alarm-snooze: "\f68d";
	--album: "\f025";
	--alert: "\f026";
	--alert-box: "\f027";
	--alert-circle: "\f028";
	--alert-circle-outline: "\f5d6";
	--alert-decagram: "\f6bc";
	--alert-octagon: "\f029";
	--alert-octagram: "\f766";
	--alert-outline: "\f02a";
	--all-inclusive: "\f6bd";
	--alpha: "\f02b";
	--alphabetical: "\f02c";
	--altimeter: "\f5d7";
	--amazon: "\f02d";
	--amazon-clouddrive: "\f02e";
	--ambulance: "\f02f";
	--amplifier: "\f030";
	--anchor: "\f031";
	--android: "\f032";
	--android-debug-bridge: "\f033";
	--android-head: "\f78f";
	--android-studio: "\f034";
	--angular: "\f6b1";
	--angularjs: "\f6be";
	--animation: "\f5d8";
	--apple: "\f035";
	--apple-finder: "\f036";
	--apple-ios: "\f037";
	--apple-keyboard-caps: "\f632";
	--apple-keyboard-command: "\f633";
	--apple-keyboard-control: "\f634";
	--apple-keyboard-option: "\f635";
	--apple-keyboard-shift: "\f636";
	--apple-mobileme: "\f038";
	--apple-safari: "\f039";
	--application: "\f614";
	--approval: "\f790";
	--apps: "\f03b";
	--archive: "\f03c";
	--arrange-bring-forward: "\f03d";
	--arrange-bring-to-front: "\f03e";
	--arrange-send-backward: "\f03f";
	--arrange-send-to-back: "\f040";
	--arrow-all: "\f041";
	--arrow-bottom-left: "\f042";
	--arrow-bottom-right: "\f043";
	--arrow-collapse: "\f615";
	--arrow-collapse-all: "\f044";
	--arrow-collapse-down: "\f791";
	--arrow-collapse-left: "\f792";
	--arrow-collapse-right: "\f793";
	--arrow-collapse-up: "\f794";
	--arrow-down: "\f045";
	--arrow-down-bold: "\f72d";
	--arrow-down-bold-box: "\f72e";
	--arrow-down-bold-box-outline: "\f72f";
	--arrow-down-bold-circle: "\f047";
	--arrow-down-bold-circle-outline: "\f048";
	--arrow-down-bold-hexagon-outline: "\f049";
	--arrow-down-box: "\f6bf";
	--arrow-down-drop-circle: "\f04a";
	--arrow-down-drop-circle-outline: "\f04b";
	--arrow-down-thick: "\f046";
	--arrow-expand: "\f616";
	--arrow-expand-all: "\f04c";
	--arrow-expand-down: "\f795";
	--arrow-expand-left: "\f796";
	--arrow-expand-right: "\f797";
	--arrow-expand-up: "\f798";
	--arrow-left: "\f04d";
	--arrow-left-bold: "\f730";
	--arrow-left-bold-box: "\f731";
	--arrow-left-bold-box-outline: "\f732";
	--arrow-left-bold-circle: "\f04f";
	--arrow-left-bold-circle-outline: "\f050";
	--arrow-left-bold-hexagon-outline: "\f051";
	--arrow-left-box: "\f6c0";
	--arrow-left-drop-circle: "\f052";
	--arrow-left-drop-circle-outline: "\f053";
	--arrow-left-thick: "\f04e";
	--arrow-right: "\f054";
	--arrow-right-bold: "\f733";
	--arrow-right-bold-box: "\f734";
	--arrow-right-bold-box-outline: "\f735";
	--arrow-right-bold-circle: "\f056";
	--arrow-right-bold-circle-outline: "\f057";
	--arrow-right-bold-hexagon-outline: "\f058";
	--arrow-right-box: "\f6c1";
	--arrow-right-drop-circle: "\f059";
	--arrow-right-drop-circle-outline: "\f05a";
	--arrow-right-thick: "\f055";
	--arrow-top-left: "\f05b";
	--arrow-top-right: "\f05c";
	--arrow-up: "\f05d";
	--arrow-up-bold: "\f736";
	--arrow-up-bold-box: "\f737";
	--arrow-up-bold-box-outline: "\f738";
	--arrow-up-bold-circle: "\f05f";
	--arrow-up-bold-circle-outline: "\f060";
	--arrow-up-bold-hexagon-outline: "\f061";
	--arrow-up-box: "\f6c2";
	--arrow-up-drop-circle: "\f062";
	--arrow-up-drop-circle-outline: "\f063";
	--arrow-up-thick: "\f05e";
	--assistant: "\f064";
	--asterisk: "\f6c3";
	--at: "\f065";
	--atom: "\f767";
	--attachment: "\f066";
	--audiobook: "\f067";
	--auto-fix: "\f068";
	--auto-upload: "\f069";
	--autorenew: "\f06a";
	--av-timer: "\f06b";
	--baby: "\f06c";
	--baby-buggy: "\f68e";
	--backburger: "\f06d";
	--backspace: "\f06e";
	--backup-restore: "\f06f";
	--bandcamp: "\f674";
	--bank: "\f070";
	--barcode: "\f071";
	--barcode-scan: "\f072";
	--barley: "\f073";
	--barrel: "\f074";
	--basecamp: "\f075";
	--basket: "\f076";
	--basket-fill: "\f077";
	--basket-unfill: "\f078";
	--battery: "\f079";
	--battery-10: "\f07a";
	--battery-20: "\f07b";
	--battery-30: "\f07c";
	--battery-40: "\f07d";
	--battery-50: "\f07e";
	--battery-60: "\f07f";
	--battery-70: "\f080";
	--battery-80: "\f081";
	--battery-90: "\f082";
	--battery-alert: "\f083";
	--battery-charging: "\f084";
	--battery-charging-100: "\f085";
	--battery-charging-20: "\f086";
	--battery-charging-30: "\f087";
	--battery-charging-40: "\f088";
	--battery-charging-60: "\f089";
	--battery-charging-80: "\f08a";
	--battery-charging-90: "\f08b";
	--battery-minus: "\f08c";
	--battery-negative: "\f08d";
	--battery-outline: "\f08e";
	--battery-plus: "\f08f";
	--battery-positive: "\f090";
	--battery-unknown: "\f091";
	--beach: "\f092";
	--beaker: "\f68f";
	--beats: "\f097";
	--beer: "\f098";
	--behance: "\f099";
	--bell: "\f09a";
	--bell-off: "\f09b";
	--bell-outline: "\f09c";
	--bell-plus: "\f09d";
	--bell-ring: "\f09e";
	--bell-ring-outline: "\f09f";
	--bell-sleep: "\f0a0";
	--beta: "\f0a1";
	--bible: "\f0a2";
	--bike: "\f0a3";
	--bing: "\f0a4";
	--binoculars: "\f0a5";
	--bio: "\f0a6";
	--biohazard: "\f0a7";
	--bitbucket: "\f0a8";
	--black-mesa: "\f0a9";
	--blackberry: "\f0aa";
	--blender: "\f0ab";
	--blinds: "\f0ac";
	--block-helper: "\f0ad";
	--blogger: "\f0ae";
	--bluetooth: "\f0af";
	--bluetooth-audio: "\f0b0";
	--bluetooth-connect: "\f0b1";
	--bluetooth-off: "\f0b2";
	--bluetooth-settings: "\f0b3";
	--bluetooth-transfer: "\f0b4";
	--blur: "\f0b5";
	--blur-linear: "\f0b6";
	--blur-off: "\f0b7";
	--blur-radial: "\f0b8";
	--bomb: "\f690";
	--bomb-off: "\f6c4";
	--bone: "\f0b9";
	--book: "\f0ba";
	--book-minus: "\f5d9";
	--book-multiple: "\f0bb";
	--book-multiple-variant: "\f0bc";
	--book-open: "\f0bd";
	--book-open-page-variant: "\f5da";
	--book-open-variant: "\f0be";
	--book-plus: "\f5db";
	--book-secure: "\f799";
	--book-unsecure: "\f79a";
	--book-variant: "\f0bf";
	--bookmark: "\f0c0";
	--bookmark-check: "\f0c1";
	--bookmark-music: "\f0c2";
	--bookmark-outline: "\f0c3";
	--bookmark-plus: "\f0c5";
	--bookmark-plus-outline: "\f0c4";
	--bookmark-remove: "\f0c6";
	--boombox: "\f5dc";
	--bootstrap: "\f6c5";
	--border-all: "\f0c7";
	--border-bottom: "\f0c8";
	--border-color: "\f0c9";
	--border-horizontal: "\f0ca";
	--border-inside: "\f0cb";
	--border-left: "\f0cc";
	--border-none: "\f0cd";
	--border-outside: "\f0ce";
	--border-right: "\f0cf";
	--border-style: "\f0d0";
	--border-top: "\f0d1";
	--border-vertical: "\f0d2";
	--bow-tie: "\f677";
	--bowl: "\f617";
	--bowling: "\f0d3";
	--box: "\f0d4";
	--box-cutter: "\f0d5";
	--box-shadow: "\f637";
	--bridge: "\f618";
	--briefcase: "\f0d6";
	--briefcase-check: "\f0d7";
	--briefcase-download: "\f0d8";
	--briefcase-upload: "\f0d9";
	--brightness-1: "\f0da";
	--brightness-2: "\f0db";
	--brightness-3: "\f0dc";
	--brightness-4: "\f0dd";
	--brightness-5: "\f0de";
	--brightness-6: "\f0df";
	--brightness-7: "\f0e0";
	--brightness-auto: "\f0e1";
	--broom: "\f0e2";
	--brush: "\f0e3";
	--buffer: "\f619";
	--bug: "\f0e4";
	--bulletin-board: "\f0e5";
	--bullhorn: "\f0e6";
	--bullseye: "\f5dd";
	--burst-mode: "\f5de";
	--bus: "\f0e7";
	--bus-articulated-end: "\f79b";
	--bus-articulated-front: "\f79c";
	--bus-double-decker: "\f79d";
	--bus-school: "\f79e";
	--bus-side: "\f79f";
	--cached: "\f0e8";
	--cake: "\f0e9";
	--cake-layered: "\f0ea";
	--cake-variant: "\f0eb";
	--calculator: "\f0ec";
	--calendar: "\f0ed";
	--calendar-blank: "\f0ee";
	--calendar-check: "\f0ef";
	--calendar-clock: "\f0f0";
	--calendar-multiple: "\f0f1";
	--calendar-multiple-check: "\f0f2";
	--calendar-plus: "\f0f3";
	--calendar-question: "\f691";
	--calendar-range: "\f678";
	--calendar-remove: "\f0f4";
	--calendar-text: "\f0f5";
	--calendar-today: "\f0f6";
	--call-made: "\f0f7";
	--call-merge: "\f0f8";
	--call-missed: "\f0f9";
	--call-received: "\f0fa";
	--call-split: "\f0fb";
	--camcorder: "\f0fc";
	--camcorder-box: "\f0fd";
	--camcorder-box-off: "\f0fe";
	--camcorder-off: "\f0ff";
	--camera: "\f100";
	--camera-burst: "\f692";
	--camera-enhance: "\f101";
	--camera-front: "\f102";
	--camera-front-variant: "\f103";
	--camera-gopro: "\f7a0";
	--camera-iris: "\f104";
	--camera-metering-center: "\f7a1";
	--camera-metering-matrix: "\f7a2";
	--camera-metering-partial: "\f7a3";
	--camera-metering-spot: "\f7a4";
	--camera-off: "\f5df";
	--camera-party-mode: "\f105";
	--camera-rear: "\f106";
	--camera-rear-variant: "\f107";
	--camera-switch: "\f108";
	--camera-timer: "\f109";
	--cancel: "\f739";
	--candle: "\f5e2";
	--candycane: "\f10a";
	--cannabis: "\f7a5";
	--car: "\f10b";
	--car-battery: "\f10c";
	--car-connected: "\f10d";
	--car-convertable: "\f7a6";
	--car-estate: "\f7a7";
	--car-hatchback: "\f7a8";
	--car-pickup: "\f7a9";
	--car-side: "\f7aa";
	--car-sports: "\f7ab";
	--car-wash: "\f10e";
	--caravan: "\f7ac";
	--cards: "\f638";
	--cards-outline: "\f639";
	--cards-playing-outline: "\f63a";
	--cards-variant: "\f6c6";
	--carrot: "\f10f";
	--cart: "\f110";
	--cart-off: "\f66b";
	--cart-outline: "\f111";
	--cart-plus: "\f112";
	--case-sensitive-alt: "\f113";
	--cash: "\f114";
	--cash-100: "\f115";
	--cash-multiple: "\f116";
	--cash-usd: "\f117";
	--cast: "\f118";
	--cast-connected: "\f119";
	--cast-off: "\f789";
	--castle: "\f11a";
	--cat: "\f11b";
	--cctv: "\f7ad";
	--ceiling-light: "\f768";
	--cellphone: "\f11c";
	--cellphone-android: "\f11d";
	--cellphone-basic: "\f11e";
	--cellphone-dock: "\f11f";
	--cellphone-iphone: "\f120";
	--cellphone-link: "\f121";
	--cellphone-link-off: "\f122";
	--cellphone-settings: "\f123";
	--certificate: "\f124";
	--chair-school: "\f125";
	--chart-arc: "\f126";
	--chart-areaspline: "\f127";
	--chart-bar: "\f128";
	--chart-bar-stacked: "\f769";
	--chart-bubble: "\f5e3";
	--chart-donut: "\f7ae";
	--chart-donut-variant: "\f7af";
	--chart-gantt: "\f66c";
	--chart-histogram: "\f129";
	--chart-line: "\f12a";
	--chart-line-stacked: "\f76a";
	--chart-line-variant: "\f7b0";
	--chart-pie: "\f12b";
	--chart-scatterplot-hexbin: "\f66d";
	--chart-timeline: "\f66e";
	--check: "\f12c";
	--check-all: "\f12d";
	--check-circle: "\f5e0";
	--check-circle-outline: "\f5e1";
	--checkbox-blank: "\f12e";
	--checkbox-blank-circle: "\f12f";
	--checkbox-blank-circle-outline: "\f130";
	--checkbox-blank-outline: "\f131";
	--checkbox-marked: "\f132";
	--checkbox-marked-circle: "\f133";
	--checkbox-marked-circle-outline: "\f134";
	--checkbox-marked-outline: "\f135";
	--checkbox-multiple-blank: "\f136";
	--checkbox-multiple-blank-circle: "\f63b";
	--checkbox-multiple-blank-circle-outline: "\f63c";
	--checkbox-multiple-blank-outline: "\f137";
	--checkbox-multiple-marked: "\f138";
	--checkbox-multiple-marked-circle: "\f63d";
	--checkbox-multiple-marked-circle-outline: "\f63e";
	--checkbox-multiple-marked-outline: "\f139";
	--checkerboard: "\f13a";
	--chemical-weapon: "\f13b";
	--chevron-double-down: "\f13c";
	--chevron-double-left: "\f13d";
	--chevron-double-right: "\f13e";
	--chevron-double-up: "\f13f";
	--chevron-down: "\f140";
	--chevron-left: "\f141";
	--chevron-right: "\f142";
	--chevron-up: "\f143";
	--chili-hot: "\f7b1";
	--chili-medium: "\f7b2";
	--chili-mild: "\f7b3";
	--chip: "\f61a";
	--church: "\f144";
	--circle: "\f764";
	--circle-outline: "\f765";
	--cisco-webex: "\f145";
	--city: "\f146";
	--clipboard: "\f147";
	--clipboard-account: "\f148";
	--clipboard-alert: "\f149";
	--clipboard-arrow-down: "\f14a";
	--clipboard-arrow-left: "\f14b";
	--clipboard-check: "\f14c";
	--clipboard-flow: "\f6c7";
	--clipboard-outline: "\f14d";
	--clipboard-plus: "\f750";
	--clipboard-text: "\f14e";
	--clippy: "\f14f";
	--clock: "\f150";
	--clock-alert: "\f5ce";
	--clock-end: "\f151";
	--clock-fast: "\f152";
	--clock-in: "\f153";
	--clock-out: "\f154";
	--clock-start: "\f155";
	--close: "\f156";
	--close-box: "\f157";
	--close-box-outline: "\f158";
	--close-circle: "\f159";
	--close-circle-outline: "\f15a";
	--close-network: "\f15b";
	--close-octagon: "\f15c";
	--close-octagon-outline: "\f15d";
	--close-outline: "\f6c8";
	--closed-caption: "\f15e";
	--cloud: "\f15f";
	--cloud-braces: "\f7b4";
	--cloud-check: "\f160";
	--cloud-circle: "\f161";
	--cloud-download: "\f162";
	--cloud-off-outline: "\f164";
	--cloud-outline: "\f163";
	--cloud-print: "\f165";
	--cloud-print-outline: "\f166";
	--cloud-sync: "\f63f";
	--cloud-tags: "\f7b5";
	--cloud-upload: "\f167";
	--code-array: "\f168";
	--code-braces: "\f169";
	--code-brackets: "\f16a";
	--code-equal: "\f16b";
	--code-greater-than: "\f16c";
	--code-greater-than-or-equal: "\f16d";
	--code-less-than: "\f16e";
	--code-less-than-or-equal: "\f16f";
	--code-not-equal: "\f170";
	--code-not-equal-variant: "\f171";
	--code-parentheses: "\f172";
	--code-string: "\f173";
	--code-tags: "\f174";
	--code-tags-check: "\f693";
	--codepen: "\f175";
	--coffee: "\f176";
	--coffee-outline: "\f6c9";
	--coffee-to-go: "\f177";
	--coin: "\f178";
	--coins: "\f694";
	--collage: "\f640";
	--color-helper: "\f179";
	--comment: "\f17a";
	--comment-account: "\f17b";
	--comment-account-outline: "\f17c";
	--comment-alert: "\f17d";
	--comment-alert-outline: "\f17e";
	--comment-check: "\f17f";
	--comment-check-outline: "\f180";
	--comment-multiple-outline: "\f181";
	--comment-outline: "\f182";
	--comment-plus-outline: "\f183";
	--comment-processing: "\f184";
	--comment-processing-outline: "\f185";
	--comment-question-outline: "\f186";
	--comment-remove-outline: "\f187";
	--comment-text: "\f188";
	--comment-text-outline: "\f189";
	--compare: "\f18a";
	--compass: "\f18b";
	--compass-outline: "\f18c";
	--console: "\f18d";
	--console-line: "\f7b6";
	--contact-mail: "\f18e";
	--contacts: "\f6ca";
	--content-copy: "\f18f";
	--content-cut: "\f190";
	--content-duplicate: "\f191";
	--content-paste: "\f192";
	--content-save: "\f193";
	--content-save-all: "\f194";
	--content-save-settings: "\f61b";
	--contrast: "\f195";
	--contrast-box: "\f196";
	--contrast-circle: "\f197";
	--cookie: "\f198";
	--copyright: "\f5e6";
	--corn: "\f7b7";
	--counter: "\f199";
	--cow: "\f19a";
	--creation: "\f1c9";
	--credit-card: "\f19b";
	--credit-card-multiple: "\f19c";
	--credit-card-off: "\f5e4";
	--credit-card-plus: "\f675";
	--credit-card-scan: "\f19d";
	--crop: "\f19e";
	--crop-free: "\f19f";
	--crop-landscape: "\f1a0";
	--crop-portrait: "\f1a1";
	--crop-rotate: "\f695";
	--crop-square: "\f1a2";
	--crosshairs: "\f1a3";
	--crosshairs-gps: "\f1a4";
	--crown: "\f1a5";
	--cube: "\f1a6";
	--cube-outline: "\f1a7";
	--cube-send: "\f1a8";
	--cube-unfolded: "\f1a9";
	--cup: "\f1aa";
	--cup-off: "\f5e5";
	--cup-water: "\f1ab";
	--currency-btc: "\f1ac";
	--currency-chf: "\f7b8";
	--currency-cny: "\f7b9";
	--currency-eth: "\f7ba";
	--currency-eur: "\f1ad";
	--currency-gbp: "\f1ae";
	--currency-inr: "\f1af";
	--currency-jpy: "\f7bb";
	--currency-krw: "\f7bc";
	--currency-ngn: "\f1b0";
	--currency-rub: "\f1b1";
	--currency-sign: "\f7bd";
	--currency-try: "\f1b2";
	--currency-twd: "\f7be";
	--currency-usd: "\f1b3";
	--currency-usd-off: "\f679";
	--cursor-default: "\f1b4";
	--cursor-default-outline: "\f1b5";
	--cursor-move: "\f1b6";
	--cursor-pointer: "\f1b7";
	--cursor-text: "\f5e7";
	--database: "\f1b8";
	--database-minus: "\f1b9";
	--database-plus: "\f1ba";
	--debug-step-into: "\f1bb";
	--debug-step-out: "\f1bc";
	--debug-step-over: "\f1bd";
	--decagram: "\f76b";
	--decagram-outline: "\f76c";
	--decimal-decrease: "\f1be";
	--decimal-increase: "\f1bf";
	--delete: "\f1c0";
	--delete-circle: "\f682";
	--delete-empty: "\f6cb";
	--delete-forever: "\f5e8";
	--delete-sweep: "\f5e9";
	--delete-variant: "\f1c1";
	--delta: "\f1c2";
	--deskphone: "\f1c3";
	--desktop-classic: "\f7bf";
	--desktop-mac: "\f1c4";
	--desktop-tower: "\f1c5";
	--details: "\f1c6";
	--developer-board: "\f696";
	--deviantart: "\f1c7";
	--dialpad: "\f61c";
	--diamond: "\f1c8";
	--dice-1: "\f1ca";
	--dice-2: "\f1cb";
	--dice-3: "\f1cc";
	--dice-4: "\f1cd";
	--dice-5: "\f1ce";
	--dice-6: "\f1cf";
	--dice-d10: "\f76e";
	--dice-d20: "\f5ea";
	--dice-d4: "\f5eb";
	--dice-d6: "\f5ec";
	--dice-d8: "\f5ed";
	--dice-multiple: "\f76d";
	--dictionary: "\f61d";
	--dip-switch: "\f7c0";
	--directions: "\f1d0";
	--directions-fork: "\f641";
	--discord: "\f66f";
	--disk: "\f5ee";
	--disk-alert: "\f1d1";
	--disqus: "\f1d2";
	--disqus-outline: "\f1d3";
	--division: "\f1d4";
	--division-box: "\f1d5";
	--dna: "\f683";
	--dns: "\f1d6";
	--do-not-disturb: "\f697";
	--do-not-disturb-off: "\f698";
	--dolby: "\f6b2";
	--domain: "\f1d7";
	--donkey: "\f7c1";
	--dots-horizontal: "\f1d8";
	--dots-horizontal-circle: "\f7c2";
	--dots-vertical: "\f1d9";
	--dots-vertical-circle: "\f7c3";
	--douban: "\f699";
	--download: "\f1da";
	--download-network: "\f6f3";
	--drag: "\f1db";
	--drag-horizontal: "\f1dc";
	--drag-vertical: "\f1dd";
	--drawing: "\f1de";
	--drawing-box: "\f1df";
	--dribbble: "\f1e0";
	--dribbble-box: "\f1e1";
	--drone: "\f1e2";
	--dropbox: "\f1e3";
	--drupal: "\f1e4";
	--duck: "\f1e5";
	--dumbbell: "\f1e6";
	--ear-hearing: "\f7c4";
	--earth: "\f1e7";
	--earth-box: "\f6cc";
	--earth-box-off: "\f6cd";
	--earth-off: "\f1e8";
	--edge: "\f1e9";
	--eject: "\f1ea";
	--elephant: "\f7c5";
	--elevation-decline: "\f1eb";
	--elevation-rise: "\f1ec";
	--elevator: "\f1ed";
	--email: "\f1ee";
	--email-alert: "\f6ce";
	--email-open: "\f1ef";
	--email-open-outline: "\f5ef";
	--email-outline: "\f1f0";
	--email-secure: "\f1f1";
	--email-variant: "\f5f0";
	--emby: "\f6b3";
	--emoticon: "\f1f2";
	--emoticon-cool: "\f1f3";
	--emoticon-dead: "\f69a";
	--emoticon-devil: "\f1f4";
	--emoticon-excited: "\f69b";
	--emoticon-happy: "\f1f5";
	--emoticon-neutral: "\f1f6";
	--emoticon-poop: "\f1f7";
	--emoticon-sad: "\f1f8";
	--emoticon-tongue: "\f1f9";
	--engine: "\f1fa";
	--engine-outline: "\f1fb";
	--equal: "\f1fc";
	--equal-box: "\f1fd";
	--eraser: "\f1fe";
	--eraser-variant: "\f642";
	--escalator: "\f1ff";
	--ethernet: "\f200";
	--ethernet-cable: "\f201";
	--ethernet-cable-off: "\f202";
	--etsy: "\f203";
	--ev-station: "\f5f1";
	--eventbrite: "\f7c6";
	--evernote: "\f204";
	--exclamation: "\f205";
	--exit-to-app: "\f206";
	--export: "\f207";
	--eye: "\f208";
	--eye-off: "\f209";
	--eye-off-outline: "\f6d0";
	--eye-outline: "\f6cf";
	--eyedropper: "\f20a";
	--eyedropper-variant: "\f20b";
	--face: "\f643";
	--face-profile: "\f644";
	--facebook: "\f20c";
	--facebook-box: "\f20d";
	--facebook-messenger: "\f20e";
	--factory: "\f20f";
	--fan: "\f210";
	--fast-forward: "\f211";
	--fast-forward-outline: "\f6d1";
	--fax: "\f212";
	--feather: "\f6d2";
	--ferry: "\f213";
	--file: "\f214";
	--file-account: "\f73a";
	--file-chart: "\f215";
	--file-check: "\f216";
	--file-cloud: "\f217";
	--file-delimited: "\f218";
	--file-document: "\f219";
	--file-document-box: "\f21a";
	--file-excel: "\f21b";
	--file-excel-box: "\f21c";
	--file-export: "\f21d";
	--file-find: "\f21e";
	--file-hidden: "\f613";
	--file-image: "\f21f";
	--file-import: "\f220";
	--file-lock: "\f221";
	--file-multiple: "\f222";
	--file-music: "\f223";
	--file-outline: "\f224";
	--file-pdf: "\f225";
	--file-pdf-box: "\f226";
	--file-plus: "\f751";
	--file-powerpoint: "\f227";
	--file-powerpoint-box: "\f228";
	--file-presentation-box: "\f229";
	--file-restore: "\f670";
	--file-send: "\f22a";
	--file-tree: "\f645";
	--file-video: "\f22b";
	--file-word: "\f22c";
	--file-word-box: "\f22d";
	--file-xml: "\f22e";
	--film: "\f22f";
	--filmstrip: "\f230";
	--filmstrip-off: "\f231";
	--filter: "\f232";
	--filter-outline: "\f233";
	--filter-remove: "\f234";
	--filter-remove-outline: "\f235";
	--filter-variant: "\f236";
	--find-replace: "\f6d3";
	--fingerprint: "\f237";
	--fire: "\f238";
	--firefox: "\f239";
	--fish: "\f23a";
	--flag: "\f23b";
	--flag-checkered: "\f23c";
	--flag-outline: "\f23d";
	--flag-outline-variant: "\f23e";
	--flag-triangle: "\f23f";
	--flag-variant: "\f240";
	--flash: "\f241";
	--flash-auto: "\f242";
	--flash-off: "\f243";
	--flash-outline: "\f6d4";
	--flash-red-eye: "\f67a";
	--flashlight: "\f244";
	--flashlight-off: "\f245";
	--flask: "\f093";
	--flask-empty: "\f094";
	--flask-empty-outline: "\f095";
	--flask-outline: "\f096";
	--flattr: "\f246";
	--flip-to-back: "\f247";
	--flip-to-front: "\f248";
	--floppy: "\f249";
	--flower: "\f24a";
	--folder: "\f24b";
	--folder-account: "\f24c";
	--folder-download: "\f24d";
	--folder-google-drive: "\f24e";
	--folder-image: "\f24f";
	--folder-lock: "\f250";
	--folder-lock-open: "\f251";
	--folder-move: "\f252";
	--folder-multiple: "\f253";
	--folder-multiple-image: "\f254";
	--folder-multiple-outline: "\f255";
	--folder-open: "\f76f";
	--folder-outline: "\f256";
	--folder-plus: "\f257";
	--folder-remove: "\f258";
	--folder-star: "\f69c";
	--folder-upload: "\f259";
	--font-awesome: "\f03a";
	--food: "\f25a";
	--food-apple: "\f25b";
	--food-croissant: "\f7c7";
	--food-fork-drink: "\f5f2";
	--food-off: "\f5f3";
	--food-variant: "\f25c";
	--football: "\f25d";
	--football-australian: "\f25e";
	--football-helmet: "\f25f";
	--forklift: "\f7c8";
	--format-align-bottom: "\f752";
	--format-align-center: "\f260";
	--format-align-justify: "\f261";
	--format-align-left: "\f262";
	--format-align-middle: "\f753";
	--format-align-right: "\f263";
	--format-align-top: "\f754";
	--format-annotation-plus: "\f646";
	--format-bold: "\f264";
	--format-clear: "\f265";
	--format-color-fill: "\f266";
	--format-color-text: "\f69d";
	--format-float-center: "\f267";
	--format-float-left: "\f268";
	--format-float-none: "\f269";
	--format-float-right: "\f26a";
	--format-font: "\f6d5";
	--format-header-1: "\f26b";
	--format-header-2: "\f26c";
	--format-header-3: "\f26d";
	--format-header-4: "\f26e";
	--format-header-5: "\f26f";
	--format-header-6: "\f270";
	--format-header-decrease: "\f271";
	--format-header-equal: "\f272";
	--format-header-increase: "\f273";
	--format-header-pound: "\f274";
	--format-horizontal-align-center: "\f61e";
	--format-horizontal-align-left: "\f61f";
	--format-horizontal-align-right: "\f620";
	--format-indent-decrease: "\f275";
	--format-indent-increase: "\f276";
	--format-italic: "\f277";
	--format-line-spacing: "\f278";
	--format-line-style: "\f5c8";
	--format-line-weight: "\f5c9";
	--format-list-bulleted: "\f279";
	--format-list-bulleted-type: "\f27a";
	--format-list-checks: "\f755";
	--format-list-numbers: "\f27b";
	--format-page-break: "\f6d6";
	--format-paint: "\f27c";
	--format-paragraph: "\f27d";
	--format-pilcrow: "\f6d7";
	--format-quote-close: "\f27e";
	--format-quote-open: "\f756";
	--format-rotate-90: "\f6a9";
	--format-section: "\f69e";
	--format-size: "\f27f";
	--format-strikethrough: "\f280";
	--format-strikethrough-variant: "\f281";
	--format-subscript: "\f282";
	--format-superscript: "\f283";
	--format-text: "\f284";
	--format-textdirection-l-to-r: "\f285";
	--format-textdirection-r-to-l: "\f286";
	--format-title: "\f5f4";
	--format-underline: "\f287";
	--format-vertical-align-bottom: "\f621";
	--format-vertical-align-center: "\f622";
	--format-vertical-align-top: "\f623";
	--format-wrap-inline: "\f288";
	--format-wrap-square: "\f289";
	--format-wrap-tight: "\f28a";
	--format-wrap-top-bottom: "\f28b";
	--forum: "\f28c";
	--forward: "\f28d";
	--foursquare: "\f28e";
	--fridge: "\f28f";
	--fridge-filled: "\f290";
	--fridge-filled-bottom: "\f291";
	--fridge-filled-top: "\f292";
	--fuel: "\f7c9";
	--fullscreen: "\f293";
	--fullscreen-exit: "\f294";
	--function: "\f295";
	--gamepad: "\f296";
	--gamepad-variant: "\f297";
	--garage: "\f6d8";
	--garage-open: "\f6d9";
	--gas-cylinder: "\f647";
	--gas-station: "\f298";
	--gate: "\f299";
	--gauge: "\f29a";
	--gavel: "\f29b";
	--gender-female: "\f29c";
	--gender-male: "\f29d";
	--gender-male-female: "\f29e";
	--gender-transgender: "\f29f";
	--gesture: "\f7ca";
	--gesture-double-tap: "\f73b";
	--gesture-swipe-down: "\f73c";
	--gesture-swipe-left: "\f73d";
	--gesture-swipe-right: "\f73e";
	--gesture-swipe-up: "\f73f";
	--gesture-tap: "\f740";
	--gesture-two-double-tap: "\f741";
	--gesture-two-tap: "\f742";
	--ghost: "\f2a0";
	--gift: "\f2a1";
	--git: "\f2a2";
	--github-box: "\f2a3";
	--github-circle: "\f2a4";
	--github-face: "\f6da";
	--glass-flute: "\f2a5";
	--glass-mug: "\f2a6";
	--glass-stange: "\f2a7";
	--glass-tulip: "\f2a8";
	--glassdoor: "\f2a9";
	--glasses: "\f2aa";
	--gmail: "\f2ab";
	--gnome: "\f2ac";
	--gondola: "\f685";
	--google: "\f2ad";
	--google-analytics: "\f7cb";
	--google-assistant: "\f7cc";
	--google-cardboard: "\f2ae";
	--google-chrome: "\f2af";
	--google-circles: "\f2b0";
	--google-circles-communities: "\f2b1";
	--google-circles-extended: "\f2b2";
	--google-circles-group: "\f2b3";
	--google-controller: "\f2b4";
	--google-controller-off: "\f2b5";
	--google-drive: "\f2b6";
	--google-earth: "\f2b7";
	--google-glass: "\f2b8";
	--google-keep: "\f6db";
	--google-maps: "\f5f5";
	--google-nearby: "\f2b9";
	--google-pages: "\f2ba";
	--google-photos: "\f6dc";
	--google-physical-web: "\f2bb";
	--google-play: "\f2bc";
	--google-plus: "\f2bd";
	--google-plus-box: "\f2be";
	--google-translate: "\f2bf";
	--google-wallet: "\f2c0";
	--gradient: "\f69f";
	--grease-pencil: "\f648";
	--grid: "\f2c1";
	--grid-large: "\f757";
	--grid-off: "\f2c2";
	--group: "\f2c3";
	--guitar-acoustic: "\f770";
	--guitar-electric: "\f2c4";
	--guitar-pick: "\f2c5";
	--guitar-pick-outline: "\f2c6";
	--hackernews: "\f624";
	--hamburger: "\f684";
	--hand-pointing-right: "\f2c7";
	--hanger: "\f2c8";
	--hangouts: "\f2c9";
	--harddisk: "\f2ca";
	--headphones: "\f2cb";
	--headphones-box: "\f2cc";
	--headphones-off: "\f7cd";
	--headphones-settings: "\f2cd";
	--headset: "\f2ce";
	--headset-dock: "\f2cf";
	--headset-off: "\f2d0";
	--heart: "\f2d1";
	--heart-box: "\f2d2";
	--heart-box-outline: "\f2d3";
	--heart-broken: "\f2d4";
	--heart-half: "\f6de";
	--heart-half-full: "\f6dd";
	--heart-half-outline: "\f6df";
	--heart-off: "\f758";
	--heart-outline: "\f2d5";
	--heart-pulse: "\f5f6";
	--help: "\f2d6";
	--help-box: "\f78a";
	--help-circle: "\f2d7";
	--help-circle-outline: "\f625";
	--help-network: "\f6f4";
	--hexagon: "\f2d8";
	--hexagon-multiple: "\f6e0";
	--hexagon-outline: "\f2d9";
	--high-definition: "\f7ce";
	--highway: "\f5f7";
	--history: "\f2da";
	--hololens: "\f2db";
	--home: "\f2dc";
	--home-assistant: "\f7cf";
	--home-automation: "\f7d0";
	--home-circle: "\f7d1";
	--home-map-marker: "\f5f8";
	--home-modern: "\f2dd";
	--home-outline: "\f6a0";
	--home-variant: "\f2de";
	--hook: "\f6e1";
	--hook-off: "\f6e2";
	--hops: "\f2df";
	--hospital: "\f2e0";
	--hospital-building: "\f2e1";
	--hospital-marker: "\f2e2";
	--hotel: "\f2e3";
	--houzz: "\f2e4";
	--houzz-box: "\f2e5";
	--human: "\f2e6";
	--human-child: "\f2e7";
	--human-female: "\f649";
	--human-greeting: "\f64a";
	--human-handsdown: "\f64b";
	--human-handsup: "\f64c";
	--human-male: "\f64d";
	--human-male-female: "\f2e8";
	--human-pregnant: "\f5cf";
	--humble-bundle: "\f743";
	--image: "\f2e9";
	--image-album: "\f2ea";
	--image-area: "\f2eb";
	--image-area-close: "\f2ec";
	--image-broken: "\f2ed";
	--image-broken-variant: "\f2ee";
	--image-filter: "\f2ef";
	--image-filter-black-white: "\f2f0";
	--image-filter-center-focus: "\f2f1";
	--image-filter-center-focus-weak: "\f2f2";
	--image-filter-drama: "\f2f3";
	--image-filter-frames: "\f2f4";
	--image-filter-hdr: "\f2f5";
	--image-filter-none: "\f2f6";
	--image-filter-tilt-shift: "\f2f7";
	--image-filter-vintage: "\f2f8";
	--image-multiple: "\f2f9";
	--import: "\f2fa";
	--inbox: "\f686";
	--inbox-arrow-down: "\f2fb";
	--inbox-arrow-up: "\f3d1";
	--incognito: "\f5f9";
	--infinity: "\f6e3";
	--information: "\f2fc";
	--information-outline: "\f2fd";
	--information-variant: "\f64e";
	--instagram: "\f2fe";
	--instapaper: "\f2ff";
	--internet-explorer: "\f300";
	--invert-colors: "\f301";
	--itunes: "\f676";
	--jeepney: "\f302";
	--jira: "\f303";
	--jsfiddle: "\f304";
	--json: "\f626";
	--keg: "\f305";
	--kettle: "\f5fa";
	--key: "\f306";
	--key-change: "\f307";
	--key-minus: "\f308";
	--key-plus: "\f309";
	--key-remove: "\f30a";
	--key-variant: "\f30b";
	--keyboard: "\f30c";
	--keyboard-backspace: "\f30d";
	--keyboard-caps: "\f30e";
	--keyboard-close: "\f30f";
	--keyboard-off: "\f310";
	--keyboard-return: "\f311";
	--keyboard-tab: "\f312";
	--keyboard-variant: "\f313";
	--kickstarter: "\f744";
	--kodi: "\f314";
	--label: "\f315";
	--label-outline: "\f316";
	--lambda: "\f627";
	--lamp: "\f6b4";
	--lan: "\f317";
	--lan-connect: "\f318";
	--lan-disconnect: "\f319";
	--lan-pending: "\f31a";
	--language-c: "\f671";
	--language-cpp: "\f672";
	--language-csharp: "\f31b";
	--language-css3: "\f31c";
	--language-go: "\f7d2";
	--language-html5: "\f31d";
	--language-javascript: "\f31e";
	--language-php: "\f31f";
	--language-python: "\f320";
	--language-python-text: "\f321";
	--language-r: "\f7d3";
	--language-swift: "\f6e4";
	--language-typescript: "\f6e5";
	--laptop: "\f322";
	--laptop-chromebook: "\f323";
	--laptop-mac: "\f324";
	--laptop-off: "\f6e6";
	--laptop-windows: "\f325";
	--lastfm: "\f326";
	--launch: "\f327";
	--lava-lamp: "\f7d4";
	--layers: "\f328";
	--layers-off: "\f329";
	--lead-pencil: "\f64f";
	--leaf: "\f32a";
	--led-off: "\f32b";
	--led-on: "\f32c";
	--led-outline: "\f32d";
	--led-strip: "\f7d5";
	--led-variant-off: "\f32e";
	--led-variant-on: "\f32f";
	--led-variant-outline: "\f330";
	--library: "\f331";
	--library-books: "\f332";
	--library-music: "\f333";
	--library-plus: "\f334";
	--lightbulb: "\f335";
	--lightbulb-on: "\f6e7";
	--lightbulb-on-outline: "\f6e8";
	--lightbulb-outline: "\f336";
	--link: "\f337";
	--link-off: "\f338";
	--link-variant: "\f339";
	--link-variant-off: "\f33a";
	--linkedin: "\f33b";
	--linkedin-box: "\f33c";
	--linux: "\f33d";
	--loading: "\f771";
	--lock: "\f33e";
	--lock-open: "\f33f";
	--lock-open-outline: "\f340";
	--lock-outline: "\f341";
	--lock-pattern: "\f6e9";
	--lock-plus: "\f5fb";
	--lock-reset: "\f772";
	--locker: "\f7d6";
	--locker-multiple: "\f7d7";
	--login: "\f342";
	--login-variant: "\f5fc";
	--logout: "\f343";
	--logout-variant: "\f5fd";
	--looks: "\f344";
	--loop: "\f6ea";
	--loupe: "\f345";
	--lumx: "\f346";
	--magnet: "\f347";
	--magnet-on: "\f348";
	--magnify: "\f349";
	--magnify-minus: "\f34a";
	--magnify-minus-outline: "\f6eb";
	--magnify-plus: "\f34b";
	--magnify-plus-outline: "\f6ec";
	--mail-ru: "\f34c";
	--mailbox: "\f6ed";
	--map: "\f34d";
	--map-marker: "\f34e";
	--map-marker-circle: "\f34f";
	--map-marker-minus: "\f650";
	--map-marker-multiple: "\f350";
	--map-marker-off: "\f351";
	--map-marker-outline: "\f7d8";
	--map-marker-plus: "\f651";
	--map-marker-radius: "\f352";
	--margin: "\f353";
	--markdown: "\f354";
	--marker: "\f652";
	--marker-check: "\f355";
	--martini: "\f356";
	--material-ui: "\f357";
	--math-compass: "\f358";
	--matrix: "\f628";
	--maxcdn: "\f359";
	--medical-bag: "\f6ee";
	--medium: "\f35a";
	--memory: "\f35b";
	--menu: "\f35c";
	--menu-down: "\f35d";
	--menu-down-outline: "\f6b5";
	--menu-left: "\f35e";
	--menu-right: "\f35f";
	--menu-up: "\f360";
	--menu-up-outline: "\f6b6";
	--message: "\f361";
	--message-alert: "\f362";
	--message-bulleted: "\f6a1";
	--message-bulleted-off: "\f6a2";
	--message-draw: "\f363";
	--message-image: "\f364";
	--message-outline: "\f365";
	--message-plus: "\f653";
	--message-processing: "\f366";
	--message-reply: "\f367";
	--message-reply-text: "\f368";
	--message-settings: "\f6ef";
	--message-settings-variant: "\f6f0";
	--message-text: "\f369";
	--message-text-outline: "\f36a";
	--message-video: "\f36b";
	--meteor: "\f629";
	--metronome: "\f7d9";
	--metronome-tick: "\f7da";
	--micro-sd: "\f7db";
	--microphone: "\f36c";
	--microphone-off: "\f36d";
	--microphone-outline: "\f36e";
	--microphone-settings: "\f36f";
	--microphone-variant: "\f370";
	--microphone-variant-off: "\f371";
	--microscope: "\f654";
	--microsoft: "\f372";
	--minecraft: "\f373";
	--minus: "\f374";
	--minus-box: "\f375";
	--minus-box-outline: "\f6f1";
	--minus-circle: "\f376";
	--minus-circle-outline: "\f377";
	--minus-network: "\f378";
	--mixcloud: "\f62a";
	--mixer: "\f7dc";
	--monitor: "\f379";
	--monitor-multiple: "\f37a";
	--more: "\f37b";
	--motorbike: "\f37c";
	--mouse: "\f37d";
	--mouse-off: "\f37e";
	--mouse-variant: "\f37f";
	--mouse-variant-off: "\f380";
	--move-resize: "\f655";
	--move-resize-variant: "\f656";
	--movie: "\f381";
	--movie-roll: "\f7dd";
	--multiplication: "\f382";
	--multiplication-box: "\f383";
	--mushroom: "\f7de";
	--mushroom-outline: "\f7df";
	--music: "\f759";
	--music-box: "\f384";
	--music-box-outline: "\f385";
	--music-circle: "\f386";
	--music-note: "\f387";
	--music-note-bluetooth: "\f5fe";
	--music-note-bluetooth-off: "\f5ff";
	--music-note-eighth: "\f388";
	--music-note-half: "\f389";
	--music-note-off: "\f38a";
	--music-note-quarter: "\f38b";
	--music-note-sixteenth: "\f38c";
	--music-note-whole: "\f38d";
	--music-off: "\f75a";
	--nature: "\f38e";
	--nature-people: "\f38f";
	--navigation: "\f390";
	--near-me: "\f5cd";
	--needle: "\f391";
	--nest-protect: "\f392";
	--nest-thermostat: "\f393";
	--netflix: "\f745";
	--network: "\f6f2";
	--new-box: "\f394";
	--newspaper: "\f395";
	--nfc: "\f396";
	--nfc-tap: "\f397";
	--nfc-variant: "\f398";
	--ninja: "\f773";
	--nintendo-switch: "\f7e0";
	--nodejs: "\f399";
	--note: "\f39a";
	--note-multiple: "\f6b7";
	--note-multiple-outline: "\f6b8";
	--note-outline: "\f39b";
	--note-plus: "\f39c";
	--note-plus-outline: "\f39d";
	--note-text: "\f39e";
	--notification-clear-all: "\f39f";
	--npm: "\f6f6";
	--nuke: "\f6a3";
	--null: "\f7e1";
	--numeric: "\f3a0";
	--numeric-0-box: "\f3a1";
	--numeric-0-box-multiple-outline: "\f3a2";
	--numeric-0-box-outline: "\f3a3";
	--numeric-1-box: "\f3a4";
	--numeric-1-box-multiple-outline: "\f3a5";
	--numeric-1-box-outline: "\f3a6";
	--numeric-2-box: "\f3a7";
	--numeric-2-box-multiple-outline: "\f3a8";
	--numeric-2-box-outline: "\f3a9";
	--numeric-3-box: "\f3aa";
	--numeric-3-box-multiple-outline: "\f3ab";
	--numeric-3-box-outline: "\f3ac";
	--numeric-4-box: "\f3ad";
	--numeric-4-box-multiple-outline: "\f3ae";
	--numeric-4-box-outline: "\f3af";
	--numeric-5-box: "\f3b0";
	--numeric-5-box-multiple-outline: "\f3b1";
	--numeric-5-box-outline: "\f3b2";
	--numeric-6-box: "\f3b3";
	--numeric-6-box-multiple-outline: "\f3b4";
	--numeric-6-box-outline: "\f3b5";
	--numeric-7-box: "\f3b6";
	--numeric-7-box-multiple-outline: "\f3b7";
	--numeric-7-box-outline: "\f3b8";
	--numeric-8-box: "\f3b9";
	--numeric-8-box-multiple-outline: "\f3ba";
	--numeric-8-box-outline: "\f3bb";
	--numeric-9-box: "\f3bc";
	--numeric-9-box-multiple-outline: "\f3bd";
	--numeric-9-box-outline: "\f3be";
	--numeric-9-plus-box: "\f3bf";
	--numeric-9-plus-box-multiple-outline: "\f3c0";
	--numeric-9-plus-box-outline: "\f3c1";
	--nut: "\f6f7";
	--nutrition: "\f3c2";
	--oar: "\f67b";
	--octagon: "\f3c3";
	--octagon-outline: "\f3c4";
	--octagram: "\f6f8";
	--octagram-outline: "\f774";
	--odnoklassniki: "\f3c5";
	--office: "\f3c6";
	--oil: "\f3c7";
	--oil-temperature: "\f3c8";
	--omega: "\f3c9";
	--onedrive: "\f3ca";
	--onenote: "\f746";
	--opacity: "\f5cc";
	--open-in-app: "\f3cb";
	--open-in-new: "\f3cc";
	--openid: "\f3cd";
	--opera: "\f3ce";
	--orbit: "\f018";
	--ornament: "\f3cf";
	--ornament-variant: "\f3d0";
	--owl: "\f3d2";
	--package: "\f3d3";
	--package-down: "\f3d4";
	--package-up: "\f3d5";
	--package-variant: "\f3d6";
	--package-variant-closed: "\f3d7";
	--page-first: "\f600";
	--page-last: "\f601";
	--page-layout-body: "\f6f9";
	--page-layout-footer: "\f6fa";
	--page-layout-header: "\f6fb";
	--page-layout-sidebar-left: "\f6fc";
	--page-layout-sidebar-right: "\f6fd";
	--palette: "\f3d8";
	--palette-advanced: "\f3d9";
	--panda: "\f3da";
	--pandora: "\f3db";
	--panorama: "\f3dc";
	--panorama-fisheye: "\f3dd";
	--panorama-horizontal: "\f3de";
	--panorama-vertical: "\f3df";
	--panorama-wide-angle: "\f3e0";
	--paper-cut-vertical: "\f3e1";
	--paperclip: "\f3e2";
	--parking: "\f3e3";
	--passport: "\f7e2";
	--pause: "\f3e4";
	--pause-circle: "\f3e5";
	--pause-circle-outline: "\f3e6";
	--pause-octagon: "\f3e7";
	--pause-octagon-outline: "\f3e8";
	--paw: "\f3e9";
	--paw-off: "\f657";
	--pen: "\f3ea";
	--pencil: "\f3eb";
	--pencil-box: "\f3ec";
	--pencil-box-outline: "\f3ed";
	--pencil-circle: "\f6fe";
	--pencil-circle-outline: "\f775";
	--pencil-lock: "\f3ee";
	--pencil-off: "\f3ef";
	--pentagon: "\f6ff";
	--pentagon-outline: "\f700";
	--percent: "\f3f0";
	--periodic-table-co2: "\f7e3";
	--periscope: "\f747";
	--pharmacy: "\f3f1";
	--phone: "\f3f2";
	--phone-bluetooth: "\f3f3";
	--phone-classic: "\f602";
	--phone-forward: "\f3f4";
	--phone-hangup: "\f3f5";
	--phone-in-talk: "\f3f6";
	--phone-incoming: "\f3f7";
	--phone-locked: "\f3f8";
	--phone-log: "\f3f9";
	--phone-minus: "\f658";
	--phone-missed: "\f3fa";
	--phone-outgoing: "\f3fb";
	--phone-paused: "\f3fc";
	--phone-plus: "\f659";
	--phone-settings: "\f3fd";
	--phone-voip: "\f3fe";
	--pi: "\f3ff";
	--pi-box: "\f400";
	--piano: "\f67c";
	--pig: "\f401";
	--pill: "\f402";
	--pillar: "\f701";
	--pin: "\f403";
	--pin-off: "\f404";
	--pine-tree: "\f405";
	--pine-tree-box: "\f406";
	--pinterest: "\f407";
	--pinterest-box: "\f408";
	--pipe: "\f7e4";
	--pipe-disconnected: "\f7e5";
	--pistol: "\f702";
	--pizza: "\f409";
	--plane-shield: "\f6ba";
	--play: "\f40a";
	--play-box-outline: "\f40b";
	--play-circle: "\f40c";
	--play-circle-outline: "\f40d";
	--play-pause: "\f40e";
	--play-protected-content: "\f40f";
	--playlist-check: "\f5c7";
	--playlist-minus: "\f410";
	--playlist-play: "\f411";
	--playlist-plus: "\f412";
	--playlist-remove: "\f413";
	--playstation: "\f414";
	--plex: "\f6b9";
	--plus: "\f415";
	--plus-box: "\f416";
	--plus-box-outline: "\f703";
	--plus-circle: "\f417";
	--plus-circle-multiple-outline: "\f418";
	--plus-circle-outline: "\f419";
	--plus-network: "\f41a";
	--plus-one: "\f41b";
	--plus-outline: "\f704";
	--pocket: "\f41c";
	--pokeball: "\f41d";
	--polaroid: "\f41e";
	--poll: "\f41f";
	--poll-box: "\f420";
	--polymer: "\f421";
	--pool: "\f606";
	--popcorn: "\f422";
	--pot: "\f65a";
	--pot-mix: "\f65b";
	--pound: "\f423";
	--pound-box: "\f424";
	--power: "\f425";
	--power-plug: "\f6a4";
	--power-plug-off: "\f6a5";
	--power-settings: "\f426";
	--power-socket: "\f427";
	--power-socket-eu: "\f7e6";
	--power-socket-uk: "\f7e7";
	--power-socket-us: "\f7e8";
	--prescription: "\f705";
	--presentation: "\f428";
	--presentation-play: "\f429";
	--printer: "\f42a";
	--printer-3d: "\f42b";
	--printer-alert: "\f42c";
	--printer-settings: "\f706";
	--priority-high: "\f603";
	--priority-low: "\f604";
	--professional-hexagon: "\f42d";
	--projector: "\f42e";
	--projector-screen: "\f42f";
	--publish: "\f6a6";
	--pulse: "\f430";
	--puzzle: "\f431";
	--qqchat: "\f605";
	--qrcode: "\f432";
	--qrcode-scan: "\f433";
	--quadcopter: "\f434";
	--quality-high: "\f435";
	--quicktime: "\f436";
	--radar: "\f437";
	--radiator: "\f438";
	--radio: "\f439";
	--radio-handheld: "\f43a";
	--radio-tower: "\f43b";
	--radioactive: "\f43c";
	--radiobox-blank: "\f43d";
	--radiobox-marked: "\f43e";
	--raspberrypi: "\f43f";
	--ray-end: "\f440";
	--ray-end-arrow: "\f441";
	--ray-start: "\f442";
	--ray-start-arrow: "\f443";
	--ray-start-end: "\f444";
	--ray-vertex: "\f445";
	--rdio: "\f446";
	--react: "\f707";
	--read: "\f447";
	--readability: "\f448";
	--receipt: "\f449";
	--record: "\f44a";
	--record-rec: "\f44b";
	--recycle: "\f44c";
	--reddit: "\f44d";
	--redo: "\f44e";
	--redo-variant: "\f44f";
	--refresh: "\f450";
	--regex: "\f451";
	--relative-scale: "\f452";
	--reload: "\f453";
	--remote: "\f454";
	--rename-box: "\f455";
	--reorder-horizontal: "\f687";
	--reorder-vertical: "\f688";
	--repeat: "\f456";
	--repeat-off: "\f457";
	--repeat-once: "\f458";
	--replay: "\f459";
	--reply: "\f45a";
	--reply-all: "\f45b";
	--reproduction: "\f45c";
	--resize-bottom-right: "\f45d";
	--responsive: "\f45e";
	--restart: "\f708";
	--restore: "\f6a7";
	--rewind: "\f45f";
	--rewind-outline: "\f709";
	--rhombus: "\f70a";
	--rhombus-outline: "\f70b";
	--ribbon: "\f460";
	--rice: "\f7e9";
	--ring: "\f7ea";
	--road: "\f461";
	--road-variant: "\f462";
	--robot: "\f6a8";
	--rocket: "\f463";
	--roomba: "\f70c";
	--rotate-3d: "\f464";
	--rotate-left: "\f465";
	--rotate-left-variant: "\f466";
	--rotate-right: "\f467";
	--rotate-right-variant: "\f468";
	--rounded-corner: "\f607";
	--router-wireless: "\f469";
	--routes: "\f46a";
	--rowing: "\f608";
	--rss: "\f46b";
	--rss-box: "\f46c";
	--ruler: "\f46d";
	--run: "\f70d";
	--run-fast: "\f46e";
	--sale: "\f46f";
	--sass: "\f7eb";
	--satellite: "\f470";
	--satellite-variant: "\f471";
	--saxophone: "\f609";
	--scale: "\f472";
	--scale-balance: "\f5d1";
	--scale-bathroom: "\f473";
	--scanner: "\f6aa";
	--school: "\f474";
	--screen-rotation: "\f475";
	--screen-rotation-lock: "\f476";
	--screwdriver: "\f477";
	--script: "\f478";
	--sd: "\f479";
	--seal: "\f47a";
	--search-web: "\f70e";
	--seat-flat: "\f47b";
	--seat-flat-angled: "\f47c";
	--seat-individual-suite: "\f47d";
	--seat-legroom-extra: "\f47e";
	--seat-legroom-normal: "\f47f";
	--seat-legroom-reduced: "\f480";
	--seat-recline-extra: "\f481";
	--seat-recline-normal: "\f482";
	--security: "\f483";
	--security-home: "\f689";
	--security-network: "\f484";
	--select: "\f485";
	--select-all: "\f486";
	--select-inverse: "\f487";
	--select-off: "\f488";
	--selection: "\f489";
	--selection-off: "\f776";
	--send: "\f48a";
	--send-secure: "\f7ec";
	--serial-port: "\f65c";
	--server: "\f48b";
	--server-minus: "\f48c";
	--server-network: "\f48d";
	--server-network-off: "\f48e";
	--server-off: "\f48f";
	--server-plus: "\f490";
	--server-remove: "\f491";
	--server-security: "\f492";
	--set-all: "\f777";
	--set-center: "\f778";
	--set-center-right: "\f779";
	--set-left: "\f77a";
	--set-left-center: "\f77b";
	--set-left-right: "\f77c";
	--set-none: "\f77d";
	--set-right: "\f77e";
	--settings: "\f493";
	--settings-box: "\f494";
	--shape-circle-plus: "\f65d";
	--shape-plus: "\f495";
	--shape-polygon-plus: "\f65e";
	--shape-rectangle-plus: "\f65f";
	--shape-square-plus: "\f660";
	--share: "\f496";
	--share-variant: "\f497";
	--shield: "\f498";
	--shield-half-full: "\f77f";
	--shield-outline: "\f499";
	--shopping: "\f49a";
	--shopping-music: "\f49b";
	--shovel: "\f70f";
	--shovel-off: "\f710";
	--shredder: "\f49c";
	--shuffle: "\f49d";
	--shuffle-disabled: "\f49e";
	--shuffle-variant: "\f49f";
	--sigma: "\f4a0";
	--sigma-lower: "\f62b";
	--sign-caution: "\f4a1";
	--sign-direction: "\f780";
	--sign-text: "\f781";
	--signal: "\f4a2";
	--signal-2g: "\f711";
	--signal-3g: "\f712";
	--signal-4g: "\f713";
	--signal-hspa: "\f714";
	--signal-hspa-plus: "\f715";
	--signal-off: "\f782";
	--signal-variant: "\f60a";
	--silverware: "\f4a3";
	--silverware-fork: "\f4a4";
	--silverware-spoon: "\f4a5";
	--silverware-variant: "\f4a6";
	--sim: "\f4a7";
	--sim-alert: "\f4a8";
	--sim-off: "\f4a9";
	--sitemap: "\f4aa";
	--skip-backward: "\f4ab";
	--skip-forward: "\f4ac";
	--skip-next: "\f4ad";
	--skip-next-circle: "\f661";
	--skip-next-circle-outline: "\f662";
	--skip-previous: "\f4ae";
	--skip-previous-circle: "\f663";
	--skip-previous-circle-outline: "\f664";
	--skull: "\f68b";
	--skype: "\f4af";
	--skype-business: "\f4b0";
	--slack: "\f4b1";
	--sleep: "\f4b2";
	--sleep-off: "\f4b3";
	--smoking: "\f4b4";
	--smoking-off: "\f4b5";
	--snapchat: "\f4b6";
	--snowflake: "\f716";
	--snowman: "\f4b7";
	--soccer: "\f4b8";
	--sofa: "\f4b9";
	--solid: "\f68c";
	--sort: "\f4ba";
	--sort-alphabetical: "\f4bb";
	--sort-ascending: "\f4bc";
	--sort-descending: "\f4bd";
	--sort-numeric: "\f4be";
	--sort-variant: "\f4bf";
	--soundcloud: "\f4c0";
	--source-branch: "\f62c";
	--source-commit: "\f717";
	--source-commit-end: "\f718";
	--source-commit-end-local: "\f719";
	--source-commit-local: "\f71a";
	--source-commit-next-local: "\f71b";
	--source-commit-start: "\f71c";
	--source-commit-start-next-local: "\f71d";
	--source-fork: "\f4c1";
	--source-merge: "\f62d";
	--source-pull: "\f4c2";
	--soy-sauce: "\f7ed";
	--speaker: "\f4c3";
	--speaker-off: "\f4c4";
	--speaker-wireless: "\f71e";
	--speedometer: "\f4c5";
	--spellcheck: "\f4c6";
	--spotify: "\f4c7";
	--spotlight: "\f4c8";
	--spotlight-beam: "\f4c9";
	--spray: "\f665";
	--square: "\f763";
	--square-inc: "\f4ca";
	--square-inc-cash: "\f4cb";
	--square-outline: "\f762";
	--square-root: "\f783";
	--stackexchange: "\f60b";
	--stackoverflow: "\f4cc";
	--stadium: "\f71f";
	--stairs: "\f4cd";
	--standard-definition: "\f7ee";
	--star: "\f4ce";
	--star-circle: "\f4cf";
	--star-half: "\f4d0";
	--star-off: "\f4d1";
	--star-outline: "\f4d2";
	--steam: "\f4d3";
	--steering: "\f4d4";
	--step-backward: "\f4d5";
	--step-backward-2: "\f4d6";
	--step-forward: "\f4d7";
	--step-forward-2: "\f4d8";
	--stethoscope: "\f4d9";
	--sticker: "\f5d0";
	--sticker-emoji: "\f784";
	--stocking: "\f4da";
	--stop: "\f4db";
	--stop-circle: "\f666";
	--stop-circle-outline: "\f667";
	--store: "\f4dc";
	--store-24-hour: "\f4dd";
	--stove: "\f4de";
	--subdirectory-arrow-left: "\f60c";
	--subdirectory-arrow-right: "\f60d";
	--subway: "\f6ab";
	--subway-variant: "\f4df";
	--summit: "\f785";
	--sunglasses: "\f4e0";
	--surround-sound: "\f5c5";
	--surround-sound-2-0: "\f7ef";
	--surround-sound-3-1: "\f7f0";
	--surround-sound-5-1: "\f7f1";
	--surround-sound-7-1: "\f7f2";
	--svg: "\f720";
	--swap-horizontal: "\f4e1";
	--swap-vertical: "\f4e2";
	--swim: "\f4e3";
	--switch: "\f4e4";
	--sword: "\f4e5";
	--sword-cross: "\f786";
	--sync: "\f4e6";
	--sync-alert: "\f4e7";
	--sync-off: "\f4e8";
	--tab: "\f4e9";
	--tab-plus: "\f75b";
	--tab-unselected: "\f4ea";
	--table: "\f4eb";
	--table-column-plus-after: "\f4ec";
	--table-column-plus-before: "\f4ed";
	--table-column-remove: "\f4ee";
	--table-column-width: "\f4ef";
	--table-edit: "\f4f0";
	--table-large: "\f4f1";
	--table-row-height: "\f4f2";
	--table-row-plus-after: "\f4f3";
	--table-row-plus-before: "\f4f4";
	--table-row-remove: "\f4f5";
	--tablet: "\f4f6";
	--tablet-android: "\f4f7";
	--tablet-ipad: "\f4f8";
	--taco: "\f761";
	--tag: "\f4f9";
	--tag-faces: "\f4fa";
	--tag-heart: "\f68a";
	--tag-multiple: "\f4fb";
	--tag-outline: "\f4fc";
	--tag-plus: "\f721";
	--tag-remove: "\f722";
	--tag-text-outline: "\f4fd";
	--target: "\f4fe";
	--taxi: "\f4ff";
	--teamviewer: "\f500";
	--telegram: "\f501";
	--television: "\f502";
	--television-classic: "\f7f3";
	--television-guide: "\f503";
	--temperature-celsius: "\f504";
	--temperature-fahrenheit: "\f505";
	--temperature-kelvin: "\f506";
	--tennis: "\f507";
	--tent: "\f508";
	--terrain: "\f509";
	--test-tube: "\f668";
	--text-shadow: "\f669";
	--text-to-speech: "\f50a";
	--text-to-speech-off: "\f50b";
	--textbox: "\f60e";
	--textbox-password: "\f7f4";
	--texture: "\f50c";
	--theater: "\f50d";
	--theme-light-dark: "\f50e";
	--thermometer: "\f50f";
	--thermometer-lines: "\f510";
	--thought-bubble: "\f7f5";
	--thought-bubble-outline: "\f7f6";
	--thumb-down: "\f511";
	--thumb-down-outline: "\f512";
	--thumb-up: "\f513";
	--thumb-up-outline: "\f514";
	--thumbs-up-down: "\f515";
	--ticket: "\f516";
	--ticket-account: "\f517";
	--ticket-confirmation: "\f518";
	--ticket-percent: "\f723";
	--tie: "\f519";
	--tilde: "\f724";
	--timelapse: "\f51a";
	--timer: "\f51b";
	--timer-10: "\f51c";
	--timer-3: "\f51d";
	--timer-off: "\f51e";
	--timer-sand: "\f51f";
	--timer-sand-empty: "\f6ac";
	--timer-sand-full: "\f78b";
	--timetable: "\f520";
	--toggle-switch: "\f521";
	--toggle-switch-off: "\f522";
	--tooltip: "\f523";
	--tooltip-edit: "\f524";
	--tooltip-image: "\f525";
	--tooltip-outline: "\f526";
	--tooltip-outline-plus: "\f527";
	--tooltip-text: "\f528";
	--tooth: "\f529";
	--tor: "\f52a";
	--tower-beach: "\f680";
	--tower-fire: "\f681";
	--trackpad: "\f7f7";
	--traffic-light: "\f52b";
	--train: "\f52c";
	--tram: "\f52d";
	--transcribe: "\f52e";
	--transcribe-close: "\f52f";
	--transfer: "\f530";
	--transit-transfer: "\f6ad";
	--translate: "\f5ca";
	--treasure-chest: "\f725";
	--tree: "\f531";
	--trello: "\f532";
	--trending-down: "\f533";
	--trending-neutral: "\f534";
	--trending-up: "\f535";
	--triangle: "\f536";
	--triangle-outline: "\f537";
	--trophy: "\f538";
	--trophy-award: "\f539";
	--trophy-outline: "\f53a";
	--trophy-variant: "\f53b";
	--trophy-variant-outline: "\f53c";
	--truck: "\f53d";
	--truck-delivery: "\f53e";
	--truck-fast: "\f787";
	--truck-trailer: "\f726";
	--tshirt-crew: "\f53f";
	--tshirt-v: "\f540";
	--tumblr: "\f541";
	--tumblr-reblog: "\f542";
	--tune: "\f62e";
	--tune-vertical: "\f66a";
	--twitch: "\f543";
	--twitter: "\f544";
	--twitter-box: "\f545";
	--twitter-circle: "\f546";
	--twitter-retweet: "\f547";
	--uber: "\f748";
	--ubuntu: "\f548";
	--ultra-high-definition: "\f7f8";
	--umbraco: "\f549";
	--umbrella: "\f54a";
	--umbrella-outline: "\f54b";
	--undo: "\f54c";
	--undo-variant: "\f54d";
	--unfold-less-horizontal: "\f54e";
	--unfold-less-vertical: "\f75f";
	--unfold-more-horizontal: "\f54f";
	--unfold-more-vertical: "\f760";
	--ungroup: "\f550";
	--unity: "\f6ae";
	--untappd: "\f551";
	--update: "\f6af";
	--upload: "\f552";
	--upload-network: "\f6f5";
	--usb: "\f553";
	--van-passenger: "\f7f9";
	--van-utility: "\f7fa";
	--vanish: "\f7fb";
	--vector-arrange-above: "\f554";
	--vector-arrange-below: "\f555";
	--vector-circle: "\f556";
	--vector-circle-variant: "\f557";
	--vector-combine: "\f558";
	--vector-curve: "\f559";
	--vector-difference: "\f55a";
	--vector-difference-ab: "\f55b";
	--vector-difference-ba: "\f55c";
	--vector-intersection: "\f55d";
	--vector-line: "\f55e";
	--vector-point: "\f55f";
	--vector-polygon: "\f560";
	--vector-polyline: "\f561";
	--vector-radius: "\f749";
	--vector-rectangle: "\f5c6";
	--vector-selection: "\f562";
	--vector-square: "\f001";
	--vector-triangle: "\f563";
	--vector-union: "\f564";
	--verified: "\f565";
	--vibrate: "\f566";
	--video: "\f567";
	--video-3d: "\f7fc";
	--video-off: "\f568";
	--video-switch: "\f569";
	--view-agenda: "\f56a";
	--view-array: "\f56b";
	--view-carousel: "\f56c";
	--view-column: "\f56d";
	--view-dashboard: "\f56e";
	--view-day: "\f56f";
	--view-grid: "\f570";
	--view-headline: "\f571";
	--view-list: "\f572";
	--view-module: "\f573";
	--view-parallel: "\f727";
	--view-quilt: "\f574";
	--view-sequential: "\f728";
	--view-stream: "\f575";
	--view-week: "\f576";
	--vimeo: "\f577";
	--vine: "\f578";
	--violin: "\f60f";
	--visualstudio: "\f610";
	--vk: "\f579";
	--vk-box: "\f57a";
	--vk-circle: "\f57b";
	--vlc: "\f57c";
	--voice: "\f5cb";
	--voicemail: "\f57d";
	--volume-high: "\f57e";
	--volume-low: "\f57f";
	--volume-medium: "\f580";
	--volume-minus: "\f75d";
	--volume-mute: "\f75e";
	--volume-off: "\f581";
	--volume-plus: "\f75c";
	--vpn: "\f582";
	--walk: "\f583";
	--wall: "\f7fd";
	--wallet: "\f584";
	--wallet-giftcard: "\f585";
	--wallet-membership: "\f586";
	--wallet-travel: "\f587";
	--wan: "\f588";
	--washing-machine: "\f729";
	--watch: "\f589";
	--watch-export: "\f58a";
	--watch-import: "\f58b";
	--watch-vibrate: "\f6b0";
	--water: "\f58c";
	--water-off: "\f58d";
	--water-percent: "\f58e";
	--water-pump: "\f58f";
	--watermark: "\f612";
	--waves: "\f78c";
	--weather-cloudy: "\f590";
	--weather-fog: "\f591";
	--weather-hail: "\f592";
	--weather-lightning: "\f593";
	--weather-lightning-rainy: "\f67d";
	--weather-night: "\f594";
	--weather-partlycloudy: "\f595";
	--weather-pouring: "\f596";
	--weather-rainy: "\f597";
	--weather-snowy: "\f598";
	--weather-snowy-rainy: "\f67e";
	--weather-sunny: "\f599";
	--weather-sunset: "\f59a";
	--weather-sunset-down: "\f59b";
	--weather-sunset-up: "\f59c";
	--weather-windy: "\f59d";
	--weather-windy-variant: "\f59e";
	--web: "\f59f";
	--webcam: "\f5a0";
	--webhook: "\f62f";
	--webpack: "\f72a";
	--wechat: "\f611";
	--weight: "\f5a1";
	--weight-kilogram: "\f5a2";
	--whatsapp: "\f5a3";
	--wheelchair-accessibility: "\f5a4";
	--white-balance-auto: "\f5a5";
	--white-balance-incandescent: "\f5a6";
	--white-balance-iridescent: "\f5a7";
	--white-balance-sunny: "\f5a8";
	--widgets: "\f72b";
	--wifi: "\f5a9";
	--wifi-off: "\f5aa";
	--wii: "\f5ab";
	--wiiu: "\f72c";
	--wikipedia: "\f5ac";
	--window-close: "\f5ad";
	--window-closed: "\f5ae";
	--window-maximize: "\f5af";
	--window-minimize: "\f5b0";
	--window-open: "\f5b1";
	--window-restore: "\f5b2";
	--windows: "\f5b3";
	--wordpress: "\f5b4";
	--worker: "\f5b5";
	--wrap: "\f5b6";
	--wrench: "\f5b7";
	--wunderlist: "\f5b8";
	--xaml: "\f673";
	--xbox: "\f5b9";
	--xbox-controller: "\f5ba";
	--xbox-controller-battery-alert: "\f74a";
	--xbox-controller-battery-empty: "\f74b";
	--xbox-controller-battery-full: "\f74c";
	--xbox-controller-battery-low: "\f74d";
	--xbox-controller-battery-medium: "\f74e";
	--xbox-controller-battery-unknown: "\f74f";
	--xbox-controller-off: "\f5bb";
	--xda: "\f5bc";
	--xing: "\f5bd";
	--xing-box: "\f5be";
	--xing-circle: "\f5bf";
	--xml: "\f5c0";
	--xmpp: "\f7fe";
	--yammer: "\f788";
	--yeast: "\f5c1";
	--yelp: "\f5c2";
	--yin-yang: "\f67f";
	--youtube-play: "\f5c3";
	--zip-box: "\f5c4";
	--blank: "\f68c";
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="8cVA4B8t" name="Material Font Roboto" draggable="false" style __wid="ztsJaqgP"><STYLE data-type="content" type="text/css" codemirror="true" __wid="B7APd9MU">@font-face {
	font-family: "Roboto";
	font-style: normal;
	font-weight: 300;
	src: local("Roboto Light"), local("Roboto-Light"),
		url("roboto-300.woff2") format("woff2"),
		url("roboto-300.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: italic;
	font-weight: 300;
	src: local("Roboto Light Italic"), local("Roboto-LightItalic"),
		url("roboto-300-italic.woff2") format("woff2"),
		url("roboto-300-italic.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: normal;
	font-weight: 400;
	src: local("Roboto"), local("Roboto-Regular"),
		url("roboto-400.woff2") format("woff2"),
		url("roboto-400.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: italic;
	font-weight: 400;
	src: local("Roboto Italic"), local("Roboto-Italic"),
		url("roboto-400-italic.woff2") format("woff2"),
		url("roboto-400-italic.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: normal;
	font-weight: 500;
	src: local("Roboto Medium"), local("Roboto-Medium"),
		url("roboto-500.woff2") format("woff2"),
		url("roboto-500.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: italic;
	font-weight: 500;
	src: local("Roboto Medium Italic"), local("Roboto-MediumItalic"),
		url("roboto-500-italic.woff2") format("woff2"),
		url("roboto-500-italic.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: normal;
	font-weight: 700;
	src: local("Roboto Bold"), local("Roboto-Bold"),
		url("roboto-700.woff2") format("woff2"),
		url("roboto-700.woff") format("woff");
}

@font-face {
	font-family: "Roboto";
	font-style: italic;
	font-weight: 700;
	src: local("Roboto Bold Italic"), local("Roboto-BoldItalic"),
		url("roboto-700-italic.woff2") format("woff2"),
		url("roboto-700-italic.woff") format("woff");
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="wqQCqxEH" name="Material Font Roboto Mono" __wid="MTZgHfNx"><STYLE data-type="content" type="text/css" codemirror="true" __wid="9QJearz7">@font-face {
	font-family: "Roboto Mono";
	font-style: normal;
	font-weight: 400;
	src: local("Roboto Mono"), local("RobotoMono"),
		url("roboto-mono-400.woff2") format("woff2"),
		url("roboto-mono-400.woff") format("woff");
}

@font-face {
	font-family: "Roboto Mono";
	font-style: italic;
	font-weight: 400;
	src: local("Roboto Mono Italic"), local("RobotoMono-Italic"),
		url("roboto-mono-400-italic.woff2") format("woff2"),
		url("roboto-mono-400-italic.woff") format("woff");
}

@font-face {
	font-family: "Roboto Mono";
	font-style: normal;
	font-weight: 700;
	src: local("Roboto Mono Bold"), local("RobotoMono-Bold"),
		url("roboto-mono-700.woff2") format("woff2"),
		url("roboto-mono-700.woff") format("woff");
}

@font-face {
	font-family: "Roboto Mono";
	font-style: italic;
	font-weight: 700;
	src: local("Roboto Mono Bold Italic"), local("RobotoMono-BoldItalic"),
		url("roboto-mono-700-italic.woff2") format("woff2"),
		url("roboto-mono-700-italic.woff") format("woff");
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="V2izxPgv" draggable="false" style name="Material Variables" __wid="Xe6QPNxv"><STYLE data-type="content" type="text/css" codemirror="true" __wid="2uh4FmBQ">:root {

	/* Material Colors */
	--material-color-red: #F44336;
	--material-color-pink: #E91E63;
	--material-color-purple: #9C27B0;
	--material-color-deep-purple: #673AB7;
	--material-color-indigo: #3F51B5;
	--material-color-blue: #2196F3;
	--material-color-light-blue: #03A9F4;
	--material-color-cyan: #00BCD4;
	--material-color-teal: #009688;
	--material-color-green: #4CAF50;
	--material-color-light-green: #8BC34A;
	--material-color-lime: #CDDC39;
	--material-color-yellow: #FFEB3B;
	--material-color-amber: #FFC107;
	--material-color-orange: #FF9800;
	--material-color-deep-orange: #FF5722;
	--material-color-brown: #795548;
	--material-color-grey: #9E9E9E;
	--material-color-blue-grey: #607D8B;
	--material-color-white: #FFFFFF;
	--material-color-black: #000000;

	--material-color-grey-50: #FAFAFA;
	--material-color-grey-100: #F5F5F5;
	--material-color-grey-200: #EEEEEE;
	--material-color-grey-300: #E0E0E0;
	--material-color-grey-400: #BDBDBD;
	--material-color-grey-500: #9E9E9E;
	--material-color-grey-600: #757575;
	--material-color-grey-700: #616161;
	--material-color-grey-800: #424242;
	--material-color-grey-850: #303030;
	--material-color-grey-900: #212121;

	/* Material Colors RGB */
	--material-color-red-rgb: 244, 67, 54;
	--material-color-pink-rgb: 233, 30, 99;
	--material-color-purple-rgb: 156, 39, 176;
	--material-color-deep-purple-rgb: 103, 58, 183;
	--material-color-indigo-rgb: 63, 81, 181;
	--material-color-blue-rgb: 33, 150, 243;
	--material-color-light-blue-rgb: 3, 169, 244;
	--material-color-cyan-rgb: 0, 188, 212;
	--material-color-teal-rgb: 0, 150, 136;
	--material-color-green-rgb: 76, 175, 80;
	--material-color-light-green-rgb: 139, 195, 74;
	--material-color-lime-rgb: 205, 220, 57;
	--material-color-yellow-rgb: 255, 235, 59;
	--material-color-amber-rgb: 255, 193, 7;
	--material-color-orange-rgb: 255, 152, 0;
	--material-color-deep-orange-rgb: 255, 87, 34;
	--material-color-brown-rgb: 121, 85, 72;
	--material-color-grey-rgb: 158, 158, 158;
	--material-color-blue-grey-rgb: 96, 125, 139;
	--material-color-white-rgb: 255, 255, 255;
	--material-color-black-rgb: 0, 0, 0;

	--material-color-grey-50-rgb: 250, 250, 250;
	--material-color-grey-100-rgb: 245, 245, 245;
	--material-color-grey-200-rgb: 238, 238, 238;
	--material-color-grey-300-rgb: 224, 224, 224;
	--material-color-grey-400-rgb: 189, 189, 189;
	--material-color-grey-500-rgb: 158, 158, 158;
	--material-color-grey-600-rgb: 117, 117, 117;
	--material-color-grey-700-rgb: 97, 97, 97;
	--material-color-grey-800-rgb: 66, 66, 66;
	--material-color-grey-850-rgb: 48, 48, 48;
	--material-color-grey-900-rgb: 33, 33, 33;

	/* Material Shadows */
	--material-shadow-z1: 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z2: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z3: 0px 3px 3px -2px rgba(0, 0, 0, 0.2), 0px 3px 4px 0px rgba(0, 0, 0, 0.14), 0px 1px 8px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z4: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z5: 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 5px 8px 0px rgba(0, 0, 0, 0.14), 0px 1px 14px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z6: 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);
	--material-shadow-z7:0px 4px 5px -2px rgba(0, 0, 0, 0.2), 0px 7px 10px 1px rgba(0, 0, 0, 0.14), 0px 2px 16px 1px rgba(0, 0, 0, 0.12);
	--material-shadow-z8: 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);
	--material-shadow-z9: 0px 5px 6px -3px rgba(0, 0, 0, 0.2), 0px 9px 12px 1px rgba(0, 0, 0, 0.14), 0px 3px 16px 2px rgba(0, 0, 0, 0.12);
	--material-shadow-z10: 0px 6px 6px -3px rgba(0, 0, 0, 0.2), 0px 10px 14px 1px rgba(0, 0, 0, 0.14), 0px 4px 18px 3px rgba(0, 0, 0, 0.12);
	--material-shadow-z11: 0px 6px 7px -4px rgba(0, 0, 0, 0.2), 0px 11px 15px 1px rgba(0, 0, 0, 0.14), 0px 4px 20px 3px rgba(0, 0, 0, 0.12);
	--material-shadow-z12: 0px 7px 8px -4px rgba(0, 0, 0, 0.2), 0px 12px 17px 2px rgba(0, 0, 0, 0.14), 0px 5px 22px 4px rgba(0, 0, 0, 0.12);
	--material-shadow-z13: 0px 7px 8px -4px rgba(0, 0, 0, 0.2), 0px 13px 19px 2px rgba(0, 0, 0, 0.14), 0px 5px 24px 4px rgba(0, 0, 0, 0.12);
	--material-shadow-z14: 0px 7px 9px -4px rgba(0, 0, 0, 0.2), 0px 14px 21px 2px rgba(0, 0, 0, 0.14), 0px 5px 26px 4px rgba(0, 0, 0, 0.12);
	--material-shadow-z15: 0px 8px 9px -5px rgba(0, 0, 0, 0.2), 0px 15px 22px 2px rgba(0, 0, 0, 0.14), 0px 6px 28px 5px rgba(0, 0, 0, 0.12);
	--material-shadow-z16: 0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);
	--material-shadow-z17: 0px 8px 11px -5px rgba(0, 0, 0, 0.2), 0px 17px 26px 2px rgba(0, 0, 0, 0.14), 0px 6px 32px 5px rgba(0, 0, 0, 0.12);
	--material-shadow-z18: 0px 9px 11px -5px rgba(0, 0, 0, 0.2), 0px 18px 28px 2px rgba(0, 0, 0, 0.14), 0px 7px 34px 6px rgba(0, 0, 0, 0.12);
	--material-shadow-z19: 0px 9px 12px -6px rgba(0, 0, 0, 0.2), 0px 19px 29px 2px rgba(0, 0, 0, 0.14), 0px 7px 36px 6px rgba(0, 0, 0, 0.12);
	--material-shadow-z20: 0px 10px 13px -6px rgba(0, 0, 0, 0.2), 0px 20px 31px 3px rgba(0, 0, 0, 0.14), 0px 8px 38px 7px rgba(0, 0, 0, 0.12);
	--material-shadow-z21: 0px 10px 13px -6px rgba(0, 0, 0, 0.2), 0px 21px 33px 3px rgba(0, 0, 0, 0.14), 0px 8px 40px 7px rgba(0, 0, 0, 0.12);
	--material-shadow-z22: 0px 10px 14px -6px rgba(0, 0, 0, 0.2), 0px 22px 35px 3px rgba(0, 0, 0, 0.14), 0px 8px 42px 7px rgba(0, 0, 0, 0.12);
	--material-shadow-z23: 0px 11px 14px -7px rgba(0, 0, 0, 0.2), 0px 23px 36px 3px rgba(0, 0, 0, 0.14), 0px 9px 44px 8px rgba(0, 0, 0, 0.12);
	--material-shadow-z24:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" name="Animations (@keyframes)" style data-id="ia4CUjdL" __wid="hVpE85XQ"><STYLE data-type="content" type="text/css" codemirror="true" __wid="NFsBteB4">/* The animation code */
@keyframes blink-cursor {
	from { opacity: 1.0; }
	to { opacity: 0.0; }
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="Z2h2eCWM" draggable="false" style name="Theme Variables" __wid="PLCrsHw8"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="sjds3wC8">html:root {

	/* Fonts */
	--font-primary: "Roboto", "Avenir", sans-serif;
	--font-secondary: "Roboto", "Avenir", sans-serif;
	--font-monospace: "Roboto Mono", "Menlo", monospace;

	/* Colors */
	--color-primary: var(--material-color-black);
	--color-primary-shade-1: var(--material-color-grey-900);
	--color-primary-shade-2: var(--material-color-grey-850);
	--color-primary-shade-3: var(--material-color-grey-800);

	--color-primary-text: var(--material-color-grey-100);
	--color-secondary-text: var(--material-color-grey-300);
	--color-tertiary-text: var(--material-color-grey-500);

	--color-accent: var(--material-color-orange);
	--color-accent-text: var(--material-color-black);

		/* Colors RGB */
	--color-primary-rgb: var(--material-color-black-rgb);
	--color-primary-shade-1-rgb: var(--material-color-grey-900-rgb);
	--color-primary-shade-2-rgb-rgb: var(--material-color-grey-850-rgb);
	--color-primary-shade-3-rgb: var(--material-color-grey-800-rgb);

	--color-primary-text-rgb: var(--material-color-grey-100-rgb);
	--color-secondary-text-rgb: var(--material-color-grey-300-rgb);
	--color-tertiary-text-rgb: var(--material-color-grey-500-rgb);

	--color-accent-rgb: var(--material-color-orange-rgb);
	--color-accent-text-rgb: var(--material-color-black-rgb);

	/* Transitions */
	--navigation-transition: 250ms cubic-bezier(0.4, 0.0, 0.2, 1);
}</STYLE></DIV>
<DIV class="paragraph style-paragraph collapsed" data-id="s3RFq8qg" name="Material Ripple" draggable="false" style __wid="CgDh2uxZ"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="4KdmPrX4">html .material-ripple-primary-text,
html .material-ripple-accen-text,
html .dialog .actions .button,
html #global-toolbar .toolbar-button,
html #snackbar .snackbar-button,
html #snackbar .action,
html #global-menu .menu-button,
html #global-menu .sub-menu > .label {
	position: relative;
	overflow: hidden;
	transform: translate3d(0, 0, 0);
}

html .material-ripple-primary-text:after,
html .material-ripple-accent-text:after,
html .dialog .actions .button:after,
html #global-toolbar .toolbar-button:after,
html #snackbar .snackbar-button:after,
html #snackbar .action:after,
html #global-menu .menu-button:after,
html #global-menu .sub-menu > .label:after {
	content: "";
	display: block;
	position: absolute;
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	pointer-events: none;
	background-repeat: no-repeat;
	background-position: 50%;
	transform: scale(10, 10);
	opacity: 0;
	transition: transform 0.5s, opacity 1s;
}

html .material-ripple-primary-text:after,
html .dialog .actions .button:after,
html #global-toolbar .toolbar-button:after,
html #global-menu .menu-button:after,
html #global-menu .sub-menu > .label:after {
	background-image: radial-gradient(circle, var(--color-primary-text) 10%, transparent 10.01%);
}

html .material-ripple-accent-text:after,
html #snackbar .snackbar-button:after,
html #snackbar .action:after {
	background-image: radial-gradient(circle, var(--color-accent-text) 10%, transparent 10.01%);
}

html .material-ripple-primary-text:active:after,
html .material-ripple-accent-text:active:after,
html .dialog .actions .button:active:after,
html #global-toolbar .toolbar-button:active:after,
html #snackbar .snackbar-button:active:after,
html #snackbar .action:active:after,
html #global-menu .menu-button:active:after,
html #global-menu .sub-menu > .label:active:after {
	transform: scale(0, 0);
	opacity: 0.2;
	transition: 0s;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Main" draggable="false" style data-id="5uBKHKzL" __wid="gaNrHtV2"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" contenteditable="true" __wid="EiJvfGih">html,
html * {
	box-sizing: border-box;
}

html,
html input,
html button {
	font-family: var(--font-primary);
}

html,
html body {
	width: 100%;
	height: 100%;
	margin: 0;
	overflow-x: hidden;
	overflow-y: hidden;
}

html {
	background-color: var(--color-primary-shade-2);
	color: var(--color-primary-text);
}

html body #sections {
	width: 100%;
	height: calc(100% - 64px);
	margin: 0;
	margin-top: 64px;
	padding: 16px;
	padding-bottom: calc(25vh + 16px); /* For Snackbar */
	overflow: hidden;
	overflow-y: auto;
	transition: margin var(--navigation-transition),
							width var(--navigation-transition);
}

html body #sections .section {
	width: 60em;
	margin: 0 auto;
	margin-bottom: 10px;
	max-width: 100%;
}

html body[transient-menu-pinned="true"] #sections {
	width: calc(100% - 288px);
	margin-left: 288px;
}

html body[transient-notification-pinned="true"] #sections {
	width: calc(100% - 384px);
	margin-right: 384px;
}

html body[transient-menu-pinned="true"][transient-notification-pinned="true"] #sections {
	width: calc(100% - 672px);
}

/* Fix Chrome setting h1 font-size to 1.17em in paragraphs within sections */
html h1 {
	font-size: 2em;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" name="Loading / Disconnected" style data-id="c8dz5get" __wid="3tq4hKiw"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="WK9ARRBp">@-webkit-keyframes rotateplane {
	0% {
		-webkit-transform: perspective(120px);
	}
	50% {
		-webkit-transform: perspective(120px) rotateY(180deg);
	}
	100% {
		-webkit-transform: perspective(120px) rotateY(180deg) rotateX(180deg);
	}
}

@-moz-keyframes rotateplane {
	0% {
		-moz-transform: perspective(120px);
	}
	50% {
		-moz-transform: perspective(120px) rotateY(180deg);
	}
	100% {
		-moz-transform: perspective(120px) rotateY(180deg) rotateX(180deg);
	}
}

@-o-keyframes rotateplane {
	0% {
		-o-transform: perspective(120px);
	}
	50% {
		-o-transform: perspective(120px) rotateY(180deg);
	}
	100% {
		-o-transform: perspective(120px) rotateY(180deg) rotateX(180deg);
	}
}

@keyframes rotateplane {
	0% {
		-webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg);
		-moz-transform: perspective(120px) rotateX(0deg) rotateY(0deg);
		-o-transform: perspective(120px) rotateX(0deg) rotateY(0deg);
		transform: perspective(120px) rotateX(0deg) rotateY(0deg);
	}
	50% {
		-webkit-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg);
		-moz-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg);
		-o-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg);
		transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg);
	}
	100% {
		-webkit-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);
		-moz-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);
		-o-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);
		transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);
	}
}

html .overlay {
	position: fixed;
	display: block;
	top: 0;
	left: 0;
	bottom: 0;
	right: 0;
	background-color: var(--color-primary-shade-2);
	width: 100vw;
	height: 100vh;
	z-index: 395;
}

html .overlay > div.center-piece {
	position: fixed;
	display: inline-block;
	left: 50%;
	top: 50%;
	transform: translate(-50%, -50%);
}

html .overlay > div.center-piece:after {
	position: absolute;
	top: 100%;
	left: 50%;
	width: 200px;
	transform: translate(-50%, 0);
	text-align: center;
}

html .overlay > div.center-piece > div.loading-indicator {
	position: relative;
	display: inline-block;
	top: 0;
	left: 0;
	width: 50px;
	height: 50px;
	border-radius: 2px;
	background: rgba(255, 255, 255, .5);
	-webkit-animation: rotateplane 1.2s infinite ease-in-out;
	-moz-animation: rotateplane 1.2s infinite ease-in-out;
	-o-animation: rotateplane 1.2s infinite ease-in-out;
	animation: rotateplane 1.2s infinite ease-in-out;
}

html .overlay > div.close {
	position: fixed;
	top: 10px;
	right: 10px;
	cursor: pointer;
	border-radius: 50%;
}

html .overlay > div.close:hover {
	color: black;
	background-color: white;
}

html .overlay.loading > div.center-piece:after {
	margin-top: 8px;
	content: "Loading";
}

html .overlay.disconnected > div.center-piece:after {
	content: "Disconnected";
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" name="Scrollbars" data-id="aReAMqZa" style __wid="FYYcKtRi"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="phPadC98">html *::-webkit-scrollbar {
	width: 5px;
	height: 5px;
	background: transparent;
}

html *::-webkit-scrollbar-track {
	background-color: var(--color-primary-shade-1);
}

html *::-webkit-scrollbar-thumb {
	border-radius: 1px;
	background-color: var(--color-secondary-text);
}

html *::-webkit-scrollbar-thumb:hover {
	background-color: var(--color-primary-text);
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Tooltip" draggable="false" data-id="ekcWCgH9" style __wid="d6S7Vmnj"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="5NHkk8ay">html .section-visible *[tooltip]:after {
	font-size: 1rem;
	font-family: var(--font-primary);
	position: absolute;
	bottom: 0px;
	left: 50%;
	z-index: 98;
	padding: 5px 15px;
	color: white;
	background-color: rgba(0, 0, 0, 0.8);
	border-radius: 2px;
	display: inline;
	width: 200px;
	text-align: center;
	transform: translate3d(-50%, -36px, 0);
	opacity: 0;
	pointer-events: none;
	-webkit-font-smoothing: antialiased; /* webkit text rendering fix */
}

/* Match all tooltip headers and move them down 60px */
html .section-visible .section-header *[tooltip]:after {
	bottom: -63px;
}
/* Match all tooltips except the first and move them back up, effectively making
the selector only match the first tooltip header. */
html .section-visible ~ .section-visible *[tooltip]:after {
	bottom: 0;
}

html *[tooltip]:before {
	content: "";
	border: solid;
	bottom: 0;
	border-color: rgba(0, 0, 0, 0.8) transparent;
	border-width: 6px 6px 0px 6px;
	left: 50%;
	transform: translate3d(-50%, -30px, 0);
	position: absolute;
	z-index: 99;
	opacity: 0;
	pointer-events: none;
	-webkit-font-smoothing: antialiased; /* Webkit text rendering fix */
}

/* Same principle as above, except this is for the tooltip triangle which needs
to be reversed. */
html .section-visible .section-header *[tooltip]:before {
	transform: translate3d(-50%, 0px, 0);
	border-width: 0px 6px 6px 6px;
}
html .section-visible ~ .section-visible *[tooltip]:before {
	transform: translate3d(-50%, -30px, 0);
	border-width: 6px 6px 0px 6px;
}

html *[tooltip]:hover:after,
html *[tooltip]:hover:before {
	opacity: 1.0;
	transition: opacity 200ms ease-in-out 300ms;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Section Style" draggable="false" data-id="Biib7BSP" style __wid="bGHAZm76"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="BGuqXyQg">html .section {
	margin-bottom: 10px;
	position: relative;
}

html .section.section-hidden,
html .section.section-hidden * {
	display: none;
}

html .section[transient-focussed]:before {
	content: "";
	position: absolute;
	height: 100%;
	width: 0;
	left: -10px;
	border-left: 4px solid rgba(var(--color-accent-rgb), 0.3);
	border-radius: 4px;
}

/******************************************************************************/

html .section .section-header {
	display: block;
	height: 40px;
	padding-top: 8px;
	padding-left: 8px;
	background: var(--color-primary);
	font-size: 1.2em;
	margin-bottom: 10px;
	border-radius: 2px;
}

html .section .section-header:before {
	font-family: "Material Icons";
	font-weight: normal;
	font-style: normal;
	display: inline-block;
	line-height: 1;
	text-transform: none;
	letter-spacing: normal;
	word-wrap: normal;
	white-space: nowrap;
	direction: ltr;
	text-rendering: optimizeLegibility;
	font-feature-settings: "liga";

	position: relative;
	top: 2px;
}

html .section .section-header:before {
	content: "label";
}

html .section .section-header .action {
	position: relative;
	float: right;
	margin-right: 10px;
	cursor: pointer;
	font-size: .6em;
	opacity: 0.25;
	pointer-events: none;
}

html .section .section-header:hover .action {
	opacity: 1.0;
	pointer-events: all;
}

html .section .section-header .action:hover {
	color: var(--color-accent);
}

/******************************************************************************/

html .section .section-header .name-input {
	position: absolute;
	cursor: text;
	left: 32px;
}

html .section .section-header .name-input:focus {
	outline: none;
}

html .section .section-header .name-input:empty:focus {
	outline: 1px solid var(--color-primary-text);
	opacity: 1.0;
	animation-name: blink-cursor;
	animation-duration: 500ms;
	animation-direction: alternate;
	animation-iteration-count: infinite;
	animation-timing-function: ease-in-out;
}

html .section .section-header .name-input:empty:before {
	content: "No Name";
	opacity: 0.5;
}

html .section .section-header .name-input:empty:focus:before {
	content: "";
}

/******************************************************************************/

html .section .section-header .data-id-label {
	position: relative;
	float: right;
	user-select: all;
	background-color: rgba(var(--material-color-light-green-rgb), 0.75);
	font-size: 0.75em;
	font-family: var(--font-monospace);
	line-height: 20px;
	color: var(--color-primary);
	border-radius: 2px;
	padding: 2px 4px;
	font-weight: 700;
	margin-right: 10px;
	cursor: default;
}

html .section.uninstalled .section-header .data-id-label {
	background-color: rgba(var(--material-color-red-rgb), 0.75);
}

html .section .section-header .data-id-label:after {
	content: "Package ID";
}

html .section:not([data-type="package"]) .section-header .data-id-label {
	display: none;
}

/******************************************************************************/

html .section .section-header .delete-section:hover {
	color: var(--material-color-red);
}

/* Icon Delete */
html .section .section-header .delete-section i:after {
	content: "delete";
}

/* Tooltip Delete */
html .section .section-header .delete-section:after {
	content: "Delete";
}

/******************************************************************************/

/* Hide Collapsed Sections */
html .section.hide-collapsed-paragraphs .paragraph.collapsed {
	display: none;
}

html .section.hide-collapsed-paragraphs .hide-collapsed-paragraphs2 {
	opacity: 1.0;
}

/* Icon Show Collapsed Paragraphs */
html .section.hide-collapsed-paragraphs .hide-collapsed-paragraphs2 i:after {
	content: "visibility_off";
}

/* Tooltip Show Collapsed Paragraphs */
html .section.hide-collapsed-paragraphs .hide-collapsed-paragraphs2:after {
	content: "Show Collapsed Paragraphs";
}

/* Icon Hide Collapsed Paragraphs */
html .section:not(.hide-collapsed-paragraphs) .hide-collapsed-paragraphs2 i:after {
	content: "visibility";
}

/* Tooltip Hide Collapsed Paragraphs */
html .section:not(.hide-collapsed-paragraphs) .hide-collapsed-paragraphs2:after {
	content: "Hide Collapsed Paragraphs";
}

/******************************************************************************/

/* Icon Not System Section */
html .section .toggle-system-section i:after {
	content: var(--settings);
	font-family: "Material Design Icons";
}

/* Tooltip Not System Section */
html .section .toggle-system-section:after {
	content: "Activate System Section";
}

/* System Section */
html .section[data-type="system"] .toggle-system-section {
	color: var(--material-color-light-green);
	opacity: 1.0 !important;
}

/* Tooltip Not System Section */
html .section[data-type="system"] .toggle-system-section:after {
	content: "Deactivate System Section";
}

/******************************************************************************/

/* Icon Not Package Section */
html .section .toggle-package-section i:after {
	content: var(--cube-outline);
	font-family: "Material Design Icons";
}

/* Tooltip Not Package Section */
html .section .toggle-package-section:after {
	content: "Activate Package Section";
}

/* Package Section */
html .section[data-type="package"] .toggle-package-section {
	color: var(--material-color-light-green);
	opacity: 1.0 !important;
}

/* Tooltip Not Package Section */
html .section[data-type="package"] .toggle-package-section:after {
	content: "Deactivate Package Section";
}

/******************************************************************************/

/* Collapse Section */
html .section.collapsed .paragraph {
	display: none;
}

html .section .toggle-collapse i:after {
	content: "expand_less";
}

html .section .toggle-collapse:after {
	content: "Collapse";
}

html .section.collapsed .toggle-collapse i:after {
	content: "expand_more";
}

html .section.collapsed .toggle-collapse:after {
	content: "Expand";
}

/******************************************************************************/

/* Hide Section */
html .section .toggle-visibility-section i:after {
	content: "clear";
}

html .section .toggle-visibility-section:after {
	content: "Hide Section";
}

/******************************************************************************/

/* Spacing */
html .section .hide-collapsed-paragraphs2,
html .section .toggle-package-section {
	margin-left: 20px;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" data-id="ZVLeTEZN" name="Paragraph Style" style __wid="W9UbEmCG"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="yPcatE7D">html .paragraph {
	clear: both;
	position: relative;
	margin-top: 10px;
}

html .paragraph div:focus {
	outline: none;
}

html .paragraph pre {
	margin: 0px;
	padding: 0px;
}

html .paragraph pre[type]  {
	display: none;
}

html .paragraph[transient-focussed]:before {
	content: "";
	position: absolute;
	height: 100%;
	width: 0;
	left: -18px;
	border-left: 4px solid rgba(var(--color-accent-rgb), 0.45);
	border-radius: 4px;
}

/******************************************************************************/

html .paragraph .paragraph-header {
	display: block;
	position: relative;
	display: block;
	background: var(--color-primary-shade-1);
	width: 100%;
	height: 30px;
	border-radius: 2px;
}

html .paragraph.body-paragraph [data-type="content"] {
	overflow: hidden;
}

/* Reset box-sizing of content paragraphs to their initial value */
html .paragraph.body-paragraph [data-type="content"] * {
	box-sizing: initial;
}

/******************************************************************************/

html .paragraph .paragraph-header .action {
	position: relative;
	float: right;
	height: 100%;
	cursor: pointer;
	margin-right: 10px;
	opacity: 0.25;
	pointer-events: none;
}

html .paragraph .paragraph-header .action:hover {
	color: var(--color-accent);
}

html .paragraph .paragraph-header:hover .action {
	pointer-events: initial;
	opacity: 1.0;
}

html .paragraph .paragraph-header .action .material-icons {
	position: relative;
	top: 50%;
	transform: translate3d(0, -50%, 0);
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="zRGMQcXU" name="Paragraph Writing Style  " __wid="6gSBbG8j"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="xWkqQvF8">html .paragraph.body-paragraph .writing[data-type="content"],
html .paragraph.body-paragraph .section-documentation[data-type="content"] {
	position: inherit;
	font-family: var(--font-secondary);
	color: var(--color-secondary-text);
	font-size: 1rem;
	line-height: 1.5;
	box-sizing: border-box;
	margin: 4px;
	z-index: 0;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] h1,
html .paragraph.body-paragraph .writing[data-type="content"] h2,
html .paragraph.body-paragraph .writing[data-type="content"] h3,
html .paragraph.body-paragraph .writing[data-type="content"] h4,
html .paragraph.body-paragraph .writing[data-type="content"] h5,
html .paragraph.body-paragraph .writing[data-type="content"] h6,
html .paragraph.body-paragraph .writing[data-type="content"] div:not([class]),
html .paragraph.body-paragraph .writing[data-type="content"] blockquote,
html .paragraph.body-paragraph .writing[data-type="content"] pre,
html .paragraph.body-paragraph .writing[data-type="content"] table,
html .paragraph.body-paragraph .writing[data-type="content"] ul,
html .paragraph.body-paragraph .writing[data-type="content"] ol,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h1,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h2,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h3,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h4,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h5,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h6,
html .paragraph.body-paragraph .section-documentation[data-type="content"] div:not([class]),
html .paragraph.body-paragraph .section-documentation[data-type="content"] blockquote,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table,
html .paragraph.body-paragraph .section-documentation[data-type="content"] ul,
html .paragraph.body-paragraph .section-documentation[data-type="content"] ol {
	margin-top: 0;
	margin-bottom: 16px;
}

html .paragraph.body-paragraph .writing[data-type="content"] li,
html .paragraph.body-paragraph .section-documentation[data-type="content"] li {
	margin-bottom: 4px;
}

html .paragraph.body-paragraph .writing[data-type="content"] > *:first-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] > *:first-child {
	margin-top: 0;
}

html .paragraph.body-paragraph .writing[data-type="content"] a,
html .paragraph.body-paragraph .section-documentation[data-type="content"] a {
	color: var(--color-accent);
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] h1,
html .paragraph.body-paragraph .writing[data-type="content"] h2,
html .paragraph.body-paragraph .writing[data-type="content"] h3,
html .paragraph.body-paragraph .writing[data-type="content"] h4,
html .paragraph.body-paragraph .writing[data-type="content"] h5,
html .paragraph.body-paragraph .writing[data-type="content"] h6,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h1,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h2,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h3,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h4,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h5,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h6 {
	color: var(--color-primary-text);
	font-weight: 500;
	letter-spacing: 0.02rem;
}

html .paragraph.body-paragraph .writing[data-type="content"] h1,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h1 {
	font-size: 2em;
	border-bottom: 4px solid var(--color-secondary-text);
	margin-top: 48px;
}

html .paragraph.body-paragraph .writing[data-type="content"] h2,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h2 {
	font-size: 1.5em;
	border-bottom: 2px solid var(--color-secondary-text);
	margin-top: 32px;
}

html .paragraph.body-paragraph .writing[data-type="content"] h3,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h3 {
	font-size: 1.25em;
	margin-top: 32px;
}

html .paragraph.body-paragraph .writing[data-type="content"] h4,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h4 {
	font-size: 1.125em;
	margin-top: 24px;
}

html .paragraph.body-paragraph .writing[data-type="content"] h5,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h5 {
	font-size: 1em;
	margin-top: 24px;
}

html .paragraph.body-paragraph .writing[data-type="content"] h6,
html .paragraph.body-paragraph .section-documentation[data-type="content"] h6 {
	font-size: 0.875em;
	margin-top: 16px;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] hr,
html .paragraph.body-paragraph .section-documentation[data-type="content"] hr {
	height: 1px;
	padding: 0;
	margin: 16px 0;
	background-color: var(--color-tertiary-text);
	border: 0;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] kbd,
html .paragraph.body-paragraph .section-documentation[data-type="content"] kbd {
	margin: 0 2px;
	color: #eee;
	border-radius: 3px;
	padding: 3px 7px;
	min-width: 1em;
	box-shadow: inset 0 0 2px #5a5a5a, 0 0.1em 0.11em rgba(0, 0, 0, 0.9);
	cursor: default;
	background: #000;
	text-align: center;
	text-shadow: none;
	background-color: #101010;
	background-repeat: repeat-x;
	font-family: monospace;
	font-size: 14px;
}

/******************************************************************************/


html .paragraph.body-paragraph .writing[data-type="content"] blockquote,
html .paragraph.body-paragraph .section-documentation[data-type="content"] blockquote {
	padding: 0 1em;
	border-left: 0.25em solid var(--color-secondary-text);
}

html .paragraph.body-paragraph .writing[data-type="content"] blockquote>:first-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] blockquote>:first-child {
	margin-top: 0;
}

html .paragraph.body-paragraph .writing[data-type="content"] blockquote>:last-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] blockquote>:last-child {
	margin-bottom: 0;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] table,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table {
	display: block;
	width: 100%;
	overflow: auto;
	border-collapse: collapse;
}

html .paragraph.body-paragraph .writing[data-type="content"] table th,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table th {
	font-weight: 700;
	background: var(--color-primary-shade-3);
}

html .paragraph.body-paragraph .writing[data-type="content"] table th,
html .paragraph.body-paragraph .writing[data-type="content"] table td,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table th,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table td {
	padding: 8px;
}

html .paragraph.body-paragraph .writing[data-type="content"] table tr,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table tr{
	background: var(--color-primary-shade-2);
}

html .paragraph.body-paragraph .writing[data-type="content"] table tr:nth-child(2n),
html .paragraph.body-paragraph .section-documentation[data-type="content"] table tr:nth-child(2n) {
	background: var(--color-primary-shade-3);
}

html .paragraph.body-paragraph .writing[data-type="content"] table img,
html .paragraph.body-paragraph .section-documentation[data-type="content"] table img {
	background-color: transparent;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] code,
html .paragraph.body-paragraph .writing[data-type="content"] tt,
html .paragraph.body-paragraph .section-documentation[data-type="content"] code,
html .paragraph.body-paragraph .section-documentation[data-type="content"] tt {
	color: var(--color-primary-text);
	padding: 1px 4px;
	margin: 0;
	font-size: 0.9em;
	background-color: var(--color-primary-shade-3);
	border-radius: 3px;
	font-family: var(--font-monospace);
}

html .paragraph.body-paragraph .writing[data-type="content"] code br,
html .paragraph.body-paragraph .writing[data-type="content"] tt br,
html .paragraph.body-paragraph .section-documentation[data-type="content"] code br,
html .paragraph.body-paragraph .section-documentation[data-type="content"] tt br {
	display: none
}

html .paragraph.body-paragraph .writing[data-type="content"] del code,
html .paragraph.body-paragraph .section-documentation[data-type="content"] del code {
	text-decoration: inherit
}

html .paragraph.body-paragraph .writing[data-type="content"] pre,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre {
	word-wrap: normal
}

html .paragraph.body-paragraph .writing[data-type="content"] pre > code,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre > code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0
}

html .paragraph.body-paragraph .writing[data-type="content"] .highlight,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .highlight {
	margin-bottom: 16px
}

html .paragraph.body-paragraph .writing[data-type="content"] .highlight pre,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .highlight pre {
	margin-bottom: 0;
	word-break: normal
}

html .paragraph.body-paragraph .writing[data-type="content"] .highlight pre,
html .paragraph.body-paragraph .writing[data-type="content"] pre,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .highlight pre,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: var(--color-primary-shade-3);
	border-radius: 3px;
}

html .paragraph.body-paragraph .writing[data-type="content"] pre code,
html .paragraph.body-paragraph .writing[data-type="content"] pre tt,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre code,
html .paragraph.body-paragraph .section-documentation[data-type="content"] pre tt {
	display: inline;
	max-width: auto;
	padding: 0;
	margin: 0;
	overflow: visible;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

/******************************************************************************/

html .paragraph.body-paragraph .writing[data-type="content"] .info,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .info,
html .paragraph.body-paragraph .writing[data-type="content"] .warning,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .warning,
html .paragraph.body-paragraph .writing[data-type="content"] .danger,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .danger,
html .paragraph.body-paragraph .writing[data-type="content"] .success,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .success {
	display: block;
	font-size: 14px;
	margin: 16px 0;
	padding: 12px 24px 12px 60px;
	border-radius: 2px;
}

html .paragraph.body-paragraph .writing[data-type="content"] .info > *:last-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .info > *:last-child,
html .paragraph.body-paragraph .writing[data-type="content"] .warning > *:last-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .warning > *:last-child,
html .paragraph.body-paragraph .writing[data-type="content"] .danger > *:last-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .danger > *:last-child,
html .paragraph.body-paragraph .writing[data-type="content"] .success > *:last-child,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .success > *:last-child {
	margin-bottom: 0;
}

html .paragraph.body-paragraph .writing[data-type="content"] .info:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .info:before,
html .paragraph.body-paragraph .writing[data-type="content"] .warning:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .warning:before,
html .paragraph.body-paragraph .writing[data-type="content"] .danger:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .danger:before,
html .paragraph.body-paragraph .writing[data-type="content"] .success:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .success:before {
	float: left;
	font: normal normal normal 24px/1 'Material Icons';
	font-feature-settings: 'liga';
	text-rendering: optimizeLegibility;
	word-wrap: normal;
	margin-left: -36px;
}

html .paragraph.body-paragraph .writing[data-type="content"] .info,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .info {
	background: #e1f5fe;
	color: #0288d1;
}

html .paragraph.body-paragraph .writing[data-type="content"] .info:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .info:before {
	color: #039be5;
	content: 'star';
}

html .paragraph.body-paragraph .writing[data-type="content"] .warning,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .warning {
	background: #fff3e0;
	color: #dd2c00;
}

html .paragraph.body-paragraph .writing[data-type="content"] .warning:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .warning:before {
	color: #ff6e40;
	content: 'error';
}

html .paragraph.body-paragraph .writing[data-type="content"] .danger,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .danger {
	background: #fbe9e7;
	color: #d50000;
}

html .paragraph.body-paragraph .writing[data-type="content"] .danger:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .danger:before {
	color: #ff1744;
	content: 'warning';
}

html .paragraph.body-paragraph .writing[data-type="content"] .success,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .success {
	background: #e0f2f1;
	color: #00897b;
}

html .paragraph.body-paragraph .writing[data-type="content"] .success:before,
html .paragraph.body-paragraph .section-documentation[data-type="content"] .success:before {
	color: #00bfa5;
	content: 'check_circle';
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Paragraph Title Style" draggable="false" data-id="n64A599U" __wid="p6D4EV7a"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="v7CgYLJ8">html .paragraph .paragraph-header:before {
	font-family: "Material Icons";
	font-weight: normal;
	font-style: normal;
	display: inline-block;
	line-height: 1;
	text-transform: none;
	letter-spacing: normal;
	word-wrap: normal;
	white-space: nowrap;
	direction: ltr;
	text-rendering: optimizeLegibility;
	font-feature-settings: "liga";

	position: relative;
	top: 7px;
	left: 7px;
}

/******************************************************************************/

html .paragraph.body-paragraph .paragraph-header:before {
	content: "text_fields";
}

html .paragraph.code-paragraph .paragraph-header:before {
	content: "code";
}

html .paragraph.style-paragraph .paragraph-header:before {
	content: "brush";
}

html .paragraph.data-paragraph .paragraph-header:before {
	content: "storage";
}

/******************************************************************************/

html .paragraph .paragraph-header .input {
	position: relative;
	top: 5px;
	font-size: 0.9em;
	z-index: 1;
	display: inline-block;
	left: 15px;
	margin-right: 15px;
}

html .paragraph .paragraph-header .input:before {
	color: var(--color-accent);
}

html .paragraph .paragraph-header .input:focus {
	outline: none;
}

html .paragraph .paragraph-header .input:empty:focus {
	outline: 1px solid var(--color-primary-text);
	opacity: 1.0;
	animation-name: blink-cursor;
	animation-duration: 500ms;
	animation-direction: alternate;
	animation-iteration-count: infinite;
	animation-timing-function: ease-in-out;
}

html .paragraph .paragraph-header .input:empty:focus:before {
	content: "";
}

html .paragraph .paragraph-header .input:empty:before {
	opacity: 0;
	pointer-events: none;
}

html .paragraph .paragraph-header:hover .input:empty:before {
	opacity: 1.0;
	pointer-events: all;
}

/******************************************************************************/

html .paragraph .paragraph-header .name-input:empty:before {
	content: "name";
}

html .paragraph .paragraph-header .id-input:not(:empty):before {
	content: "#";
}

html .paragraph .paragraph-header .id-input:empty:before {
	content: "#id";
}

html .paragraph .paragraph-header .class-input:before {
	content: "class: ";
}

html .paragraph .paragraph-header select {
  border: 0;
  font-family: var(--font-primary);
	text-align-last: right;
  outline: 0;
  opacity: 0;

  color: white;
  background: transparent;
}

html .paragraph .paragraph-header:hover select {
  opacity: 1;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Paragraph Collapse Style" draggable="false" data-id="gKnfCRJB" __wid="JUCbqnfM"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="nv6MUVbE">/* Icon expanded */
html .collapse-expand i:after {
	content: "expand_less";
}

/* Tooltip expanded */
html .collapse-expand:after {
	content: "Collapse";
}

/* Icon collapsed */
html .paragraph.collapsed .collapse-expand i:after {
	content: "expand_more";
}

/* Tooltip collapsed */
html .paragraph.collapsed .collapse-expand:after {
	content: "Expand";
}

/* Hide all content of a paragraph except the paragraph header */
html .paragraph.collapsed > *:not(.paragraph-header) {
	display: none;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Lock Paragraph Style" draggable="false" data-id="LM22iaJk" style __wid="RtmTYi6q"><STYLE data-type="content" type="text/css" codemirror="true" contenteditable="true" class="themable" __wid="gV52fhyh">html .paragraph:not(:hover):not(.locked) .paragraph-header .lock-content {
	opacity: 0.25;
	pointer-events: none;
}

html .paragraph.locked .paragraph-header .lock-content {
	opacity: 1.0;
}

html .paragraph.locked .text-tools {
	display: none;
}

/* Icon Lock */
html .paragraph .paragraph-header .lock-content i:after {
	content: "lock_open";
}

/* Tooltip Lock */
html .paragraph .paragraph-header .lock-content:after {
	content: "Lock";
}

/* Icon Unlock */
html .paragraph.locked .paragraph-header .lock-content i:after {
	content: "lock_outline";
}

/* Tooltip Unlock */
html .paragraph.locked .paragraph-header .lock-content:after {
	content: "Unlock";
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Paragraph Delete Action Style" draggable="false" data-id="8vZywFM8" __wid="xrHRdsM2"><STYLE data-type="content" type="text/css" codemirror="true" contenteditable="true" class="themable" __wid="9vCUsWit">html .paragraph .delete-paragraph {
	margin-right: 10px;
}

/* Icon Delete */
html .paragraph .delete-paragraph i:after {
	content: "delete";
}

/* Tooltip Delete */
html .paragraph .delete-paragraph:after {
	content: "Delete";
}

html .paragraph .delete-paragraph:hover i:after {
	color: var(--material-color-red);
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Paragraph Sortable Style" draggable="false" data-id="C6eX72vd" style __wid="2UsEdRQZ"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="5enK2Wqe">html .paragraph .drag-handle {
	cursor: -webkit-grabbing;
	cursor: move;
	opacity: 0;
	pointer-events: none;
}

html .paragraph.dragging > * {
	pointer-events: none;
}

html .paragraph.dragging {
	opacity: 0.5;
}

/* Icon Drag Handle */
html .paragraph .drag-handle i:after {
	content: "drag_handle";
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" name="Variable Style" draggable="false" data-id="LWYEJJ2X" style __wid="LBHhgyri"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="8y7EGA4r">html .variable {
	position: relative;
	display: inline;
	color: var(--material-color-light-blue);
}

html .variable:empty:before {
	content: attr(data-name) " (unset)";
}

html .variable:before {
	content: attr(data-name) " = ";
	color: var(--color-accent);
	opacity: .5;
}

html .hide-variable-names .variable:not(:empty):before {
	display: none;
}

html .hide-variable-names .variable:not(:empty):hover:before {
	content: attr(data-name);
	position: absolute;
	top: 0;
	left: 0;
	transform: translate3d(0, -100%, 0);
	display: inline-block;
	border-radius: 2px;
	font-size: .8em;
	padding: 2px;
	color: white;
	background: rgb(135, 135, 129);
	opacity: 1.0;
	/* border: 5px solid transparent; */
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-id="UnbAUgSD" name="Persistent Log" data-type="system" __wid="SQd93WBh"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="CPbsSvPY" __wid="qHHDhe5m"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="iwKcQAJw"><H2 __wid="hYuvhFF9">Description</H2>
<DIV __wid="EWLh6tTY">Provides a simple logging functionality for events. It is persistent over reloads and system section updates as it is written directly to the DOM.</DIV>
<H2 __wid="KXseeZkh">Usage</H2>
<DIV __wid="L9jwBvEN">The section provides the following functions:</DIV>
<UL __wid="djAVSvEp">
	<LI __wid="JtefTuSE"><CODE __wid="MKdKGm6f">Codestrate.persistentLog.log(message[, logName = "Default", rootDocument = document])</CODE></LI><LI __wid="zWdp5eGT"><CODE __wid="4JgXHgRS">Codestrate.persistentLog.debug(message[, logName = "Default", rootDocument = document])</CODE></LI>
	<LI __wid="pBfj5hyJ"><CODE __wid="MPUuPNvv">Codestrate.persistentLog.info(message[, logName = "Default", rootDocument = document])</CODE></LI>
	<LI __wid="PsUvd6uW"><CODE __wid="ykU3P7vj">Codestrate.persistentLog.warn(message[, logName = "Default", rootDocument = document])</CODE></LI>
	<LI __wid="ceQ472L3"><CODE __wid="jar76AAG">Codestrate.persistentLog.error(message[, logName = "Default", rootDocument = document])</CODE></LI>
</UL>
<H2 __wid="rgT4rATC">Parameters</H2>
<UL __wid="XnaeDCXX">
	<LI __wid="gj9BivEE">The content of the <CODE __wid="DVC6KZSd">message</CODE> will be written into a body paragraph in a section with the name "Codestrate Log".</LI>
	<LI __wid="HysF2CED">The optional <CODE __wid="FFfNXs5y">logName</CODE> parameter can be used to create multiple logging paragraphs (e.g. for different uses).</LI>
	<LI __wid="ZBcb684D">The other optional parameter <CODE __wid="kBLcVmtb">rootDocument</CODE> allows to set a different rootDocument to be used for logging (e.g. setting it <CODE __wid="fCLKHay4">iframe.contentWindow.document</CODE> allows for logging into other Codestrates).</LI>
</UL></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="FuYkaiEG" __wid="HNxSMFJE"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="HFCzFvNk">{
	"version": "1.1",
	"description": "A log, which persists reloads and system section updates.",
	"changelog":
	{
		"1.1": "Renamed Log Output, added trimming of entries, added description.",
		"1.0.1": "Updated documentation.",
		"1.0": "Initial Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="9X8hhTX2" name="Persistent Log" run-on-load="true" style draggable="false" last-execution-state="success" __wid="NpwxkMHQ"><PRE data-type="content" type="text/javascript" __wid="GTFXmGeu">const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

const persistentLogSectionName = "Codestrate Log";
const maxEntryCount = 1000;

/******************************************************************************/

Codestrate.persistentLog = {
	log: (message, logName, rootDocument) => addLogEntry(message, logName, rootDocument),
	debug: (message, logName, rootDocument) => addLogEntry(message, logName, rootDocument, "debug"),
	info: (message, logName, rootDocument) => addLogEntry(message, logName, rootDocument, "info"),
	warn: (message, logName, rootDocument) => addLogEntry(message, logName, rootDocument, "warn"),
	error: (message, logName, rootDocument) => addLogEntry(message, logName, rootDocument, "error")
};

/******************************************************************************/

// Computes an ID out of a log name
const logId = (logName) => {
	return `-${logName.toLowerCase().replace(/ /g,"-")}`;
};

// Creates a new log paragraph
const createLogParagraph = (logName) => {
	const bodyParagraph = ParagraphUtils.createBodyParagraph();
	bodyParagraph.setAttribute("name", `Persistent Log ${logName}`);
	bodyParagraph.classList.add("locked");

	const content = bodyParagraph.querySelector("[data-type='content']");
	content.setAttribute("contenteditable", "false");
	content.id = `persistent-log${logId(logName)}`;
	content.classList.add("persistent-log");

	return bodyParagraph;
};

// Creates the log section
const createLogSection = () => {
	const section = document.createElement("div");
	section.classList.add("section");
	section.classList.add("section-hidden");
	section.setAttribute("name", persistentLogSectionName);

	const description = ParagraphUtils.createBodyParagraph();
	description.setAttribute("name", "Documentation");
	description.classList.add("locked");

	const content = description.querySelector("[data-type='content']");
	content.setAttribute("contenteditable", "false");
	content.classList.add("section-documentation");

	content.innerHTML = `&lt;h2>Description&lt;/h2>
&lt;div>The &lt;b>Codestrate Log&lt;/b> logs acitivies like updates of system sections or packages.&lt;/div>
&lt;div>It can be removed at any time by the user. This section will be newly created automatically if it is not available.&lt;/div>`;

	section.appendChild(description);
	return section;
};

// Adds new entries to a log
const addLogEntry = (message, logName = "Default", rootDocument = false, logClass = false) => {

	if (!rootDocument) rootDocument = document;

	let persistentLogParagraph = rootDocument.getElementById(`persistent-log${logId(logName)}`);

	// Check if paragraph is already available
	if (!persistentLogParagraph) {
		let persistentLogSection = rootDocument.querySelector(`.section[name="${persistentLogSectionName}"]`);

		// Check if section is already available
		if (!persistentLogSection) {
			persistentLogSection = createLogSection();
			const sections = rootDocument.getElementById("sections");
			sections.insertBefore(persistentLogSection, sections.firstChild);
		}

		persistentLogParagraph = createLogParagraph(logName);
		persistentLogSection.appendChild(persistentLogParagraph);

		persistentLogParagraph = rootDocument.getElementById(`persistent-log${logId(logName)}`);
	}

	// Create new entry and add it to the log
	const entry = rootDocument.createElement("p");
	entry.innerHTML = `[${new Date().toISOString()}] ${message}`;
	if (logClass) entry.classList.add(logClass);

	persistentLogParagraph.insertBefore(entry, persistentLogParagraph.firstChild);

	// Trim lines
	while (persistentLogParagraph.childElementCount > maxEntryCount) {
		persistentLogParagraph.lastElementChild.remove();
	}

	return true;
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="eGQSiWkH" name="Persistent Log Style" __wid="ZX8hmzB2"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="TJN4Qgzp">html .paragraph .persistent-log[data-type="content"] {
	font-family: var(--font-monospace);
	font-size: 0.875rem;
}

html .paragraph .persistent-log[data-type="content"] p {
	color: var(--color-primary-text);
	margin-top: 0;
	margin-bottom: 0;
}

html .paragraph .persistent-log[data-type="content"] p.debug {
	color: var(--color-tertiary-text);
}

html .paragraph .persistent-log[data-type="content"] p.info {
	color: var(--material-color-light-blue);
}

html .paragraph .persistent-log[data-type="content"] p.warn {
	color: var(--material-color-orange);
}

html .paragraph .persistent-log[data-type="content"] p.error {
	color: var(--material-color-red);
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-id="LCcYNngp" name="Section Pulling" data-type="system" data-group="editing" __wid="JjcisXus"><DIV class="paragraph body-paragraph locked collapsed" data-id="kLGMzKFm" name="Documentation" __wid="mgcUb76H"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="Czxi5xpp"><H2 __wid="AAT73ZK7">Description</H2><DIV __wid="keM4rE8r">Helper functions for package and system section pulling and updating.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" data-id="SMDkHRJ6" name="Properties" style __wid="vpF3M3pd"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="N6NySX3H">{
	"version": "1.1.4",
	"description": "Helper functions for package and system section pulling.",
	"changelog":
	{
		"1.1.4": "Added 'tags' to package property template.",
		"1.1.3": "Added 'github' to package property template.",
		"1.1.2": "Added the 'usage' property for optional dependencies.",
		"1.1.1": "Added the 'optional' dependency attribute to the package properties template.",
		"1.1": "Updated section pulling dialog.",
		"1.0": "Initial Release"
	}
}</PRE></DIV><DIV class="paragraph body-paragraph locked collapsed" data-id="xVvLC9p6" name="Documentation Template" __wid="ZyLrAF6k"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" id="section-documentation-template" __wid="mvh83nHP"><H2 __wid="dW8mGtXD">Description</H2><DIV __wid="KX5MPHfU">Your description...</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" data-id="bcEm6CE3" name="System Section Properties Template" __wid="XxgngvXq"><PRE data-type="content" type="application/json" contenteditable="false" id="system-section-properties-template" __wid="d39Qkh2U">{
	"version": "1.0",
	"description": "Your short description.",
	"changelog":
	{
		"1.0": "Initial version."
	}
}</PRE></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Package Section Properties Template" data-id="wN79wgzT" __wid="jWVWZJ6L"><PRE data-type="content" type="application/json" contenteditable="false" id="package-section-properties-template" __wid="PedUucBa">{
	"version": "1.0",
	"icon": "your_material_icon_string",
	"description": "Your short description.",
	"tags": [
		"Your tags"
	],
	"assets": [
		"yourAssets.js"
	],
	"dependencies": [
		{
			"id": "Dependency section-id",
			"name": "Dependency Name",
			"optional": false,
			"usage": "Short explanation for what features a optional dependeny is used."
		}
	],
	"changelog":
	{
		"1.0": "Initial version."
	},
	"github": {
		"url": "https://github.com/UserName/Repository",
		"folder": "optional/path/to/package"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Section Pulling Utils" data-id="S3da4Svm" draggable="false" style __wid="eMBCPvpW"><PRE data-type="content" type="text/javascript" id="section-pulling-utils" __wid="qzuYiBMw">/**
 * Gets the properties of a system section or package.
 *
 * @param sectionElement Section HTML element.
 *
 * @return Properties of the section as an object.
 */
exports.getSectionProperties = (sectionElement) => {
	const name = sectionElement.getAttribute("name") || "";
	const id = sectionElement.getAttribute("data-id") || "";
	const uninstalled = sectionElement.classList.contains("uninstalled");

	if (!name) console.warn("There are sections without an 'name' attribute!");
	if (!id) console.error("There are sections without an 'data-id' attribute!");

	const propertiesElement = sectionElement.querySelector(".section-properties");

	if (propertiesElement) {
		try {
			const properties = JSON.parse(propertiesElement.innerHTML);
			if (properties && typeof properties === "object") {
				properties.name = name;
				properties.id = id;
				properties.uninstalled = uninstalled;
				return properties;
			}
		} catch (e) {
			console.error(`Could not parse section properties for section "${name}" with id "${id}"!`);
		}
	} else {
		console.warn(`Could not find section properties for section "${name}" with id "${id}"!`);
	}

	return { name: name, id: id, uninstalled: uninstalled };
};

/******************************************************************************/

/**
 * Gets the properties of a multiple system sections or packages.
 *
 * @param sectionElements Array of section HTML elements.
 *
 * @return Properties of the section as an object.
 */
exports.getMultipleSectionProperties = (sectionElements) => {
	return sectionElements.map(sectionElement => exports.getSectionProperties(sectionElement));
};

/******************************************************************************/

/**
 * Extends the properties by getting information about the currently installed version.
 *
 * @param prototypeSectionProperties Properties of the sections of the prototype.
 * @param localSectionProperties     Properties of the sections of the local Codestrate.
 *
 * @return Comined section stati.
 */
exports.getSectionStati = (prototypeSectionProperties, localSectionProperties) => {
	const sectionStati = [];

	const prototypePropertiesCopy = [...prototypeSectionProperties];
	const localPropertiesCopy = [...localSectionProperties];

	while (prototypePropertiesCopy.length !== 0 ||
				 localPropertiesCopy.length !== 0) {

		// Get new properties pair
		let prototypeProperties;
		let localProperties;

		if (prototypePropertiesCopy.length !== 0) {
			prototypeProperties = prototypePropertiesCopy.shift();
			localProperties = localPropertiesCopy.find(properties => (properties.id === prototypeProperties.id));
			if (localProperties) {
				localProperties = localPropertiesCopy.splice(localPropertiesCopy.indexOf(localProperties), 1)[0];
			}
		} else {
			localProperties = localPropertiesCopy.shift();
		}

		// Set general status properties
		const sectionStatus = {};

		if (prototypeProperties) {
			sectionStatus.prototype = true;
			sectionStatus.prototypeProperties = prototypeProperties;
			sectionStatus.id = prototypeProperties.id;
			sectionStatus.name = prototypeProperties.name;
			if (prototypeProperties.icon) {
				sectionStatus.icon = prototypeProperties.icon;
			}
		} else {
			sectionStatus.prototype = false;
		}

		if (localProperties) {
			sectionStatus.local = true;
			sectionStatus.localProperties = localProperties;
			sectionStatus.id = localProperties.id;
			sectionStatus.name = localProperties.name;
			if (localProperties.icon) {
				sectionStatus.icon = localProperties.icon;
			}
		} else {
			sectionStatus.local = false;
		}

		// Compute new dependencies
		if (sectionStatus.prototype && sectionStatus.local) {
			sectionStatus.both = true;

			if (prototypeProperties.version && localProperties.version) {
				sectionStatus.versionChanged = (prototypeProperties.version !== localProperties.version);
			}
		} else {
			sectionStatus.both = false;
		}

		if (!sectionStatus.icon) {
			sectionStatus.icon = "";
		}

		sectionStati.push(sectionStatus);
	}

	return sectionStati;
};

/******************************************************************************/

/**
 * Helper function for finding sections with an specific ID.
 *
 * @param sections Section HTML elements to search from.
 * @param id       ID of the section to search.
 *
 * @return Found section element
 */
exports.findSection = (sections, id) => {
	return sections.find(section => (section.getAttribute("data-id") === id));
};

/******************************************************************************/

/**
 * Opens a dialog to select a Codestrate and version to pull from.
 *
 * @param defaultPullFrom    Default Codestrate to pull from.
 * @param defaultPullVersion Default version of Codestrate to pull from.
 * @param dialogTitle        The title of the dialog.
 * @param pullDataList       A list of commbinations of names and versions. Has
 *                           to be an array of pullData objects.
 *
 * @return User selected parent and version or false.
 */
exports.showPullSectionsDialog =
	(defaultPullFrom = "", defaultPullVersion = "HEAD", dialogTitle = "Pull Sections", pullDataList = false) => {

	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: dialogTitle,
			message: `${pullDataList ? `&lt;select class="pull-data-list">${pullDataList.map(pullData => `&lt;option value="${pullData.pullFrom};${pullData.pullVersion}">${pullData.pullFrom} ${pullData.pullVersion}&lt;/option>`).join("")}
&lt;/select>` : ""}
&lt;div>From what codestrate do you want to pull/push?&lt;/div>
&lt;input class="pull-from" value="${defaultPullFrom}" placeholder="Codestrate Name" required>
&lt;div>From what version do you want to pull/push?&lt;/div>
&lt;input class="pull-version" value="${defaultPullVersion}" placeholder="Codestrate Version or Tag" required>`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: ""
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");
		const pullDataListSelect = transient.querySelector(".pull-data-list");
		const pullFromInput = transient.querySelector(".pull-from");
		const pullVersionInput = transient.querySelector(".pull-version");

		const updateSelect = () => {
			if (pullDataListSelect) pullDataListSelect.value = pullFromInput.value + ";" + pullVersionInput.value;
		};

		const updateInputs = () => {
			const pullData = pullDataListSelect.value.split(";");
			pullFromInput.value = pullData[0];
			pullVersionInput.value = pullData[1];
		};

		if (pullDataListSelect) pullDataListSelect.addEventListener("change", () => updateInputs());
		pullFromInput.addEventListener("change", () => updateSelect());
		pullVersionInput.addEventListener("change", () => updateSelect());

		updateSelect();

		const ok = () => {
			const pullFrom = pullFromInput.value;
			const pullVersion = pullVersionInput.value;

			transient.remove();

			resolve({
				pullFrom,
				pullVersion
			});
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		const inputEventHandler = (e) => {
			e.stopPropagation();

			if (e.keyCode === 13) {
				e.preventDefault();
				ok();
			}
			else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		};

		pullFromInput.addEventListener("keydown", inputEventHandler);
		pullVersionInput.addEventListener("keydown", inputEventHandler);

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);

		pullFromInput.focus();
	});
};

/******************************************************************************/

/**
 * Generates URL to pull from using parent and version.
 *
 * @param pullFrom    Codestrate to pull from.
 * @param pullVersion Version of Codestrate to pull from.
 *
 * @return URL to the Codestrate.
 */
exports.generatePullUrl = (pullFrom, pullVersion) => {
	let versionOrTag = pullVersion;
	if (versionOrTag === "HEAD") {
		versionOrTag = null;
	}

	return versionOrTag ? `/${pullFrom}/${versionOrTag}/` : `/${pullFrom}/`;
};

/******************************************************************************/

/**
 * Loads a webstrate into an transient iframe for section pulling.
 *
 * @param url URL to the prototype.
 *
 * @return iFrame with prototype.
 */
exports.loadPrototype = (url) => {

	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		// Transclude prototype webstrate only once
		let iframe = document.querySelector(`iframe[src="${url}"]`);
		if (iframe) {
			if (iframe.webstrate.transcluded) {
				resolve(iframe);
				return;
			}
		} else {
			iframe = document.createElement("iframe");
			iframe.setAttribute("src", url);
			iframe.style.display = "none";
			transient.appendChild(iframe);
			document.body.appendChild(transient);
		}

		const timeout = setTimeout(() => {
			alert(`Failed to load prototype Codestrate from URL "${url}".`, "Prototype URL Error");
			resolve(iframe);
		}, 10000);

		iframe.webstrate.on("transcluded", (webstrateId) => {
			clearTimeout(timeout);
			resolve(iframe);
			return;
		});
	});
};</PRE></DIV></DIV><DIV name="Pull System Section" class="section section-hidden" data-group="editing" data-id="g7rZgJGd" data-type="system" __wid="hRXAd7Rv"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="Yr4Nz8dH" __wid="XGsb7FNf"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="GKPdAn49"><H2 __wid="qVdk3tJs">Description</H2><DIV __wid="2zC9eUn8">Adds the functionality to update and overwrite system sections with the ones of other Codestrates. It adds the following entries to the global menu:</DIV><H3 __wid="G9WxvJqQ">Update System Sections</H3><DIV __wid="eBnagaXR">This action let's the user update selected system sections. It will only add or overwrite the <B __wid="rsD3czCf">selected </B>system sections.</DIV><H3 __wid="zDgK9ULn">Update All System Sections</H3><DIV __wid="umPuZhxB">This action updates all system sections, which are available <B __wid="FuEe39kg">both </B>locally and on the remote Codestrate.</DIV><H3 __wid="HZc9zpGF">Overwrite System Sections</H3><DIV __wid="KesTZjdw">This action will overwrite <B __wid="JQfBhC3x">all </B>local system sections with <B __wid="BxbS632J">all </B>system sections of the remote Codestrate.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="prBhRkPf" __wid="UFewnGth"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="PWSMrau3">{
	"version": "1.2.3",
	"description": "Functionality to update system sections.",
	"changelog":
	{
		"1.2.3": "Commands API used.",
		"1.2.2": "Better section selection usability in dialog.",
		"1.2.1": "Added webstrate version to persistent logging.",
		"1.2": "Updated 'Update System Sections' dialog.",
		"1.1": "Added documentation and fixed bug in 'Update All System Sections.",
		"1.0": "Initial Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="FJ9J8xCG" name="Parent of Codestrate Property" last-execution-state="success" draggable="false" style __wid="AegMPsiU"><PRE data-type="content" type="text/javascript" __wid="vv8yxjCc">let fetched = false;
let parentId;

Object.defineProperty(Codestrate, "parent", {
	get: () => {
		if (!fetched) {
			return new Promise((resolve, reject) => {
				(async() => {
					let opsData = await fetch(`/${webstrate.webstrateId}/?ops`, { credentials: "same-origin" });
					let ops = await opsData.json();

					// Fetched flag is needed because webstrates create without the copy command do not have
					// the create id value causing the parent id always to be undefined
					fetched = true;
					parentId = ops[0].create.id;

					resolve(parentId);
				})();
			});
		}
		return parentId;
	}
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Global Menu Entries" data-id="XhRtR9qf" last-execution-state="success" style run-on-load="true" __wid="nABfwRnD"><PRE data-type="content" type="text/javascript" __wid="2D5TyFd7">const GlobalMenuUtils = require("#global-menu-utils");
const PullSystemSectionsCode = require("#pull-system-sections-code");

/******************************************************************************/

Codestrate.addCommand("systemSections.udpateSystemSections", "Update System Sections", () => {
	PullSystemSectionsCode.updateSystemSections();
});
const updateSystemSectionsAction = GlobalMenuUtils.createButton("Update System Sections", null, event => {
	Codestrate.executeCommand("systemSections.udpateSystemSections");
});

Codestrate.addCommand("systemSections.udpateAllSystemSections", "Update All System Sections", () => {
	PullSystemSectionsCode.updateAllSystemSections();

});
const updateAllSystemSectionsAction = GlobalMenuUtils.createButton("Update All System Sections", null, event => {
	Codestrate.executeCommand("systemSections.udpateAllSystemSections");
});

Codestrate.addCommand("systemSections.overwriteSystemSections", "Overwrite System Sections", () => {
	PullSystemSectionsCode.overwriteSystemSections();
});
const overwriteSystemSectionsAction = GlobalMenuUtils.createButton("Overwrite System Sections", null, event => {
	Codestrate.executeCommand("systemSections.overwriteSystemSections");
});

/******************************************************************************/

const subMenuName = "System Sections";

GlobalMenuUtils.addMenuItemToSubMenu(updateSystemSectionsAction, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(updateAllSystemSectionsAction, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(overwriteSystemSectionsAction, subMenuName);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Pull System Sections Code" data-id="SNwmebNQ" style last-execution-state="success" __wid="dRqVhpgQ"><PRE data-type="content" type="text/javascript" id="pull-system-sections-code" __wid="HdT2TtGR">const SectionPullingUtils = require("#section-pulling-utils");

const PullSystemSectionsLogger = require("#pull-system-sections-logger");
const PullSystemSectionsDialog = require("#pull-system-sections-dialog");

/******************************************************************************/

const systemSectionQuerySelector = ".section[data-type='system']";

let defaultParent = "Codestrate";
(async() => {
	defaultParent = await Codestrate.parent || defaultParent;
})();

/******************************************************************************/

/**
 * Shows a dialog to update only some system section and check for updates. Also makes it possible
 * to install individual system sections.
 */
exports.updateSystemSections = async() => {
	const dialogTitle = "Updating system sections";

	const data = await PullSystemSectionsDialog.updateSystemSectionsDialog();

	if (!data.selectedSectionIds) return;

	if (data.selectedSectionIds.length === 0) {
		alert("No system sections selected.", dialogTitle);
		return;
	}

	// Inform user and tag codestrate before update.
	toast(dialogTitle);
	webstrate.tag(`Tag of version ${webstrate.version} before update to "${data.url}"`);

	PullSystemSectionsLogger.actionStarted(`${dialogTitle} from ${data.url}`);

	const sectionRoot = document.querySelector("#sections");

	data.selectedSectionIds.forEach(selectedSectionId => {
		const currentStatus = data.sectionStati.find(systemStatus => (systemStatus.id === selectedSectionId));
		const currentSection = SectionPullingUtils.findSection(data.prototypeSystemSections, currentStatus.id);
		const newSection = document.importNode(currentSection, true);
		newSection.classList.remove("section-visible");
		newSection.classList.add("section-hidden");

		if (currentStatus.local) {
			const currentLocalSection = SectionPullingUtils.findSection(data.localSystemSections, currentStatus.id);
			currentLocalSection.replaceWith(newSection);
			PullSystemSectionsLogger.updatedSystemSection(selectedSectionId);
		} else {
			let entryPoint;

			// Find correct position of system section
			let index = data.sectionStati.indexOf(currentStatus) + 1;

			if (index &lt; data.sectionStati.length) {
				let notFound = true;
				while (!entryPoint && (index &lt; data.sectionStati.length)) {
					entryPoint = SectionPullingUtils.findSection(data.localSystemSections, data.sectionStati[index].id);
					index++;
				}
			}

			// Place in end of system sections otherwise
			if (!entryPoint) {
				const currentLocalSystemSections = Array.from(document.querySelectorAll(systemSectionQuerySelector));
				entryPoint = currentLocalSystemSections[currentLocalSystemSections.length - 1].nextSibling;
			}

			if (entryPoint) {
				sectionRoot.insertBefore(newSection, entryPoint);
			} else {
				sectionRoot.appendChild(newSection);
			}
			PullSystemSectionsLogger.installedNewSystemSection(selectedSectionId);
		}
	});

	PullSystemSectionsLogger.actionFinished(`${dialogTitle} from ${data.url}`);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
	Codestrate.reloadAll("System sections updated. Therefore, the codestrate will reload after updating is completed.");
};

/******************************************************************************/

/**
 * Updates all installed system sections, which are also available on the selected codestrate.
 */
exports.updateAllSystemSections = async() => {
	const dialogTitle = "Updating all system sections";

	// Open dialog for codestrate selection
	const pullData = await SectionPullingUtils.showPullSectionsDialog(defaultParent, "HEAD", dialogTitle);
	if (!pullData) return;

	// Inform user and tag codestrate before update.
	toast(dialogTitle);

	// Pull Codestrate in iFrame
	const url = SectionPullingUtils.generatePullUrl(pullData.pullFrom, pullData.pullVersion);
	const iframe = await SectionPullingUtils.loadPrototype(url + "?exec=no");
	if (!iframe) return;

	// Tag codestrate before update.
	webstrate.tag(`Tag of version ${webstrate.version} before update to "${url}"`);

	PullSystemSectionsLogger.actionStarted(`${dialogTitle} from ${url}`);

	const prototypeSystemSections =
				Array.from(iframe.contentWindow.document.querySelectorAll(systemSectionQuerySelector));
	const transient = iframe.parentNode;
	transient.remove();

	const localSystemSections = Array.from(document.querySelectorAll(systemSectionQuerySelector));

	localSystemSections.forEach(localSystemSection => {
		const id = localSystemSection.getAttribute("data-id");
		const currentSection = SectionPullingUtils.findSection(prototypeSystemSections, id);

		if (!currentSection) {
			PullSystemSectionsLogger.updateSystemSectionFailed(id);
			return;
		}

		const newSection = document.importNode(currentSection, true);
		newSection.classList.remove("section-visible");
		newSection.classList.add("section-hidden");

		localSystemSection.replaceWith(newSection);
		PullSystemSectionsLogger.updatedSystemSection(id);
	});

	PullSystemSectionsLogger.actionFinished(`${dialogTitle} from ${url}`);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
	Codestrate.reloadAll("All system sections updated. Therefore, the codestrate will reload after updating is completed.");
};

/******************************************************************************/

/**
 * Overwrites all local installed system sections with the one of the selected codestrate. Like the
 * old "Pull System Sections" action.
 */
exports.overwriteSystemSections = async() => {
	const dialogTitle = "Overwriting system sections";

	// Open dialog for codestrate selection
	const pullData = await SectionPullingUtils.showPullSectionsDialog(defaultParent, "HEAD", dialogTitle);
	if (!pullData) return;

	// Inform user and tag codestrate before update.
	toast(dialogTitle);

	// Pull Codestrate in iFrame
	const url = SectionPullingUtils.generatePullUrl(pullData.pullFrom, pullData.pullVersion);
	const iframe = await SectionPullingUtils.loadPrototype(url + "?exec=no");
	if (!iframe) return;

	// Tag codestrate before update.
	webstrate.tag(`Tag of version ${webstrate.version} before update to "${url}"`);

	PullSystemSectionsLogger.actionStarted(`${dialogTitle} from "${url}"`);

	let oldSections = Array.from(document.querySelectorAll(systemSectionQuerySelector));
	let newSections = Array.from(iframe.contentWindow.document.querySelectorAll(systemSectionQuerySelector));
	const transient = iframe.parentNode;
	transient.remove();

	let lastSectionInserted;

	// Replace old sections with new sections
	oldSections.forEach(oldSection => {

		// Replace new section with an old section as long as there are new sections left.
		// Otherwise, remove remaining old sections.
		if (newSections.length > 0) {
			// Create a clone of section!!!
			let section = newSections.splice(0, 1)[0];
			let newSection = document.importNode(section, true);
			newSection.classList.remove("section-visible");
			newSection.classList.add("section-hidden");
			oldSection.replaceWith(newSection);
			lastSectionInserted = newSection;
		} else {
			oldSection.remove();
		}
	});

	// Append all remaining new sections
	newSections.forEach(section => {

		// Create a clone of section!!!
		let newSection = document.importNode(section, true);
		newSection.classList.remove("section-visible");
		newSection.classList.add("section-hidden");

		// If no section was inserted then find the last system section in the document
		// to append the remaining new sections
		if (!lastSectionInserted) {
			let systemSections = document.querySelectorAll(systemSectionQuerySelector);
			if (systemSections.length > 0) {
				lastSectionInserted = systemSections[systemSections.length - 1];
			} else {
				lastSectionInserted = document.body.firstElementChild;
			}
		}

		let parentElement = lastSectionInserted.parentElement;
		parentElement.insertBefore(newSection, lastSectionInserted.nextSibling);
		lastSectionInserted = newSection;
	});

	PullSystemSectionsLogger.actionFinished(`${dialogTitle} from ${url}`);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
	Codestrate.reloadAll("All system sections overwritten. Therefore, the codestrate will reload after updating is completed.");
};</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" name="Pull System Sections Logger" data-id="pqctX5YK" __wid="Uyq5sbWb"><PRE data-type="content" type="text/javascript" id="pull-system-sections-logger" __wid="FXsfjwNv">exports.logName = "Pull System Sections";

/******************************************************************************/

exports.actionStarted = (action) => {
	Codestrate.persistentLog.info(`${action} started (version ${webstrate.version}).`, exports.logName);
};

exports.actionFinished = (action) => {
	Codestrate.persistentLog.info(`${action} finished (version ${webstrate.version}).`, exports.logName);
};

/******************************************************************************/

exports.installedNewSystemSection = (id) => {
	Codestrate.persistentLog.log(`Added new system section "${id}".`, exports.logName);
};

exports.updatedSystemSection = (id) => {
	Codestrate.persistentLog.log(`Updated system section "${id}".`, exports.logName);
};

exports.updateSystemSectionFailed = (id) => {
	Codestrate.persistentLog.warn(`Could not update system section "${id}".`, exports.logName);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Pull System Sections Dialog" last-execution-state="success" style data-id="AN2dAc9A" __wid="xLjFzt6L"><PRE data-type="content" type="text/javascript" id="pull-system-sections-dialog" __wid="QfGzk7fm">const SectionPullingUtils = require("#section-pulling-utils");

/******************************************************************************/

const systemSectionQuerySelector = ".section[data-type='system']";

/******************************************************************************/

exports.updateSystemSectionsDialog = (defaultName = "Codestrate", defaultTag = "HEAD") => {

	return new Promise((resolve, reject) => {

		const data = {};

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: "Update System Sections",
			message: `&lt;div>Select the Codestrate you want to update system sections from:&lt;/div>
&lt;div class="pullData">
	&lt;input type="text" class="codestrate-name" placeholder="Codestrate Name" name="codestrate-name" title="Codestrate Name" required>
	&lt;input type="text" class="codestrate-tag" placeholder="Codestrate Tag" name="codestrate-tag" title="Codestrate Tag" required>
	&lt;div class="update-section-list button">Update List&lt;/div>
&lt;/div>
&lt;div>Select the system sections you want to install or update from &lt;b>&lt;span class="current-codestrate">&lt;/span>&lt;/b>:&lt;/div>
&lt;table class="update-system-sections">
	&lt;thead>
		&lt;tr>
			&lt;th>&lt;i class="material-icons" id="checkbox-all">&lt;/th>
			&lt;th>Status&lt;/th>
			&lt;th>Installed Version&lt;/th>
			&lt;th>Parent Version&lt;/th>
			&lt;th>Name&lt;/th>
			&lt;th>Description&lt;/th>
			&lt;th>Changelog&lt;/th>
		&lt;/tr>
	&lt;/thead>
	&lt;tbody>&lt;/tbody>
&lt;/table>`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: "update-system-sections"
		});

		elements.forEach(e => transient.appendChild(e));

		const codestrateNameInput = transient.querySelector(".codestrate-name");
		const codestrateTagInput = transient.querySelector(".codestrate-tag");
		const updateSectionListButton = transient.querySelector(".update-section-list");
		const currentCodestrateSpan = transient.querySelector(".current-codestrate");
		const checkboxAll = transient.querySelector("#checkbox-all");
		const tbody = transient.querySelector("table.update-system-sections tbody");

		const updateButton = () => {
			if (data.pullData && (data.pullData.pullFrom !== codestrateNameInput.value || data.pullData.pullVersion !== codestrateTagInput.value)) {
				updateSectionListButton.classList.add("update-needed");
			} else {
				updateSectionListButton.classList.remove("update-needed");
			}

			if (codestrateNameInput.value === "" || codestrateTagInput.value === "") {
				updateSectionListButton.classList.add("invalid");
			} else {
				updateSectionListButton.classList.remove("invalid");
			}
		};

		const updateTable = async() => {

			// Open dialog for Codestrate selection
			if (codestrateNameInput.value === "" || codestrateTagInput.value === "") return;

			data.pullData = {
				pullFrom: codestrateNameInput.value,
				pullVersion: codestrateTagInput.value
			};

			tbody.innerHTML = "";
			updateButton();

			// Pull Codestrate in iFrame
			data.url = SectionPullingUtils.generatePullUrl(data.pullData.pullFrom, data.pullData.pullVersion);
			const iframe = await SectionPullingUtils.loadPrototype(data.url + "?exec=no");
			if (!iframe) return;

			// Extract system sections from pulled Codestrate and remove it
			data.prototypeSystemSections = Array.from(iframe.contentWindow.document.querySelectorAll(systemSectionQuerySelector));
			const transient = iframe.parentNode;
			transient.remove();

			data.localSystemSections = Array.from(document.querySelectorAll(systemSectionQuerySelector));

			// Get stati of system sections
			data.sectionStati = SectionPullingUtils.getSectionStati(
				SectionPullingUtils.getMultipleSectionProperties(data.prototypeSystemSections),
				SectionPullingUtils.getMultipleSectionProperties(data.localSystemSections));

			currentCodestrateSpan.innerText = data.pullData.pullFrom + " " + data.pullData.pullVersion;

			updateTableBody();
		};

		const updateTableBody = () => {
			tbody.innerHTML = "";
			tbody.innerHTML = `${data.sectionStati.filter(x => x.prototype).map(status => `&lt;tr local="${status.local}" version-changed="${status.versionChanged}" data-id="${status.id}">
			&lt;td>&lt;i class="material-icons checkbox">&lt;/td>
			&lt;td>${status.local ? (status.versionChanged !== null ? (status.versionChanged ? "Version changed" : "Up to date") : "Unknown version installed") : "Not installed"}&lt;/td>
			&lt;td>${status.local ? (status.localProperties.version || "-") : "-"}&lt;/td>
			&lt;td>${status.prototypeProperties.version || "-"}&lt;/td>
			&lt;td>${status.prototypeProperties.name || "-"}&lt;/td>
			&lt;td>${status.prototypeProperties.description || "-"}&lt;/td>
			&lt;td>${status.prototypeProperties.changelog ? (status.prototypeProperties.changelog[status.prototypeProperties.version] || "-") : "-"}&lt;/td>
		&lt;/tr>`).join("")}`;
			updateCheckboxAll();
		};

		const updateCheckboxAll = () => {
			const checked = (tbody.querySelector("tr.selected") !== null);
			const unchecked = (tbody.querySelector("tr:not(.selected)") !== null);

			if (checked) {
				if (unchecked) {
					checkboxAll.classList.add("indeterminate");
					checkboxAll.classList.remove("checked");
				} else {
					checkboxAll.classList.remove("indeterminate");
					checkboxAll.classList.add("checked");
				}
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
			}
		};

		// System section list events
		codestrateNameInput.addEventListener("change", () => {
			updateButton();
		});
		codestrateTagInput.addEventListener("change", () => {
			updateButton();
		});

		codestrateNameInput.addEventListener("keydown", e => {
			e.stopPropagation();
			if (e.keyCode === 13) {
				e.preventDefault();
				updateTable();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		});

		codestrateTagInput.addEventListener("keydown", e => {
			e.stopPropagation();
			if (e.keyCode === 13) {
				e.preventDefault();
				updateTable();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		});

		updateSectionListButton.addEventListener("click", () => updateTable());

		// Checkbox events
		checkboxAll.addEventListener("click", () => {
			let selected;
			if (checkboxAll.classList.contains("checked")) {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
				selected = false;
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.add("checked");
				selected = true;
			}
			Array.from(tbody.querySelectorAll("tr")).forEach(tr => {
				if (selected) {
					tr.classList.add("selected");
				} else {
					tr.classList.remove("selected");
				}
			});
		});

		tbody.addEventListener("click", e => {
			if (e.target === null || e.target.closest("tr") === null) return;
			e.target.closest("tr").classList.toggle("selected");
			updateCheckboxAll();
		});

		codestrateNameInput.value = defaultName;
		codestrateTagInput.value = defaultTag;
		updateTable();

		// Dialog actions
		const okBtn = transient.querySelector('.ok');
		const cancelBtn = transient.querySelector('.cancel');

		const ok = () => {
			data.selectedSectionIds = Array.from(
					tbody.querySelectorAll("tr.selected")).map(tr => tr.getAttribute("data-id"));
			transient.remove();
			resolve(data);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);

		codestrateNameInput.focus();
	});
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Pull System Sections Dialog Style" data-id="GNFbi7e6" __wid="8SFKqDQP"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="aNVM4NcG">html .update-system-sections .body {
	max-width: 90vw;
}

html table.update-system-sections {
	width: 85vw;
	border-collapse: collapse;
	margin-top: 16px;
}

html table.update-system-sections td,
html table.update-system-sections th {
	padding: 8px;
}

html table.update-system-sections .checkbox:before,
html table.update-system-sections #checkbox-all:before {
	content: "check_box_outline_blank";
}

html table.update-system-sections .selected .checkbox:before,
html table.update-system-sections #checkbox-all.checked:before {
	content: "check_box";
}

html table.update-system-sections #checkbox-all.indeterminate:before {
	content: "indeterminate_check_box";
}

html table.update-system-sections td,
html table.update-system-sections #checkbox-all {
	cursor: pointer;
}

/******************************************************************************/

html .update-system-sections .pullData {
	display: flex;
	margin-bottom: 32px;
	margin-top: 16px;
	flex-direction: row;
	align-items: center;
	justify-content: space-between;
	height: 48px;
	background: var(--color-primary-shade-2);
	padding: 8px;
	width: 100%;
}

html .update-system-sections .pullData > * {
	flex: 0 1 auto;
	height: 32px;
	margin: 0 !important;
}

html .update-system-sections .pullData > * + * {
	margin-left: 32px !important;
}

html .update-system-sections .pullData .update-section-list {
	flex: 0 0 auto;
}

html .update-system-sections .pullData .update-section-list:hover {
	background: var(--color-primary-shade-3);
}

html .update-system-sections .pullData .update-section-list.update-needed {
	background: rgba(var(--material-color-green-rgb), 0.75);
}

html .update-system-sections .pullData .update-section-list.update-needed:hover {
	background: var(--material-color-green);
}

html .update-system-sections .pullData .update-section-list.invalid {
	background: var(--material-color-grey) !important;
	cursor: default;
}

/******************************************************************************/

html table.update-system-sections tr:nth-child(even) {
	background: var(--color-primary-shade-2);
}

html table.update-system-sections tr[local="true"][version-changed="true"] {
	background: var(--material-color-orange);
	color: var(--material-color-grey-100);
}

html table.update-system-sections tr[local="true"][version-changed="false"] {
	background: var(--material-color-green);
	color: var(--material-color-grey-100);
}

html table.update-system-sections tr[local="true"][version-changed="undefined"] {
	background: var(--material-color-teal);
	color: var(--material-color-grey-100);
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-type="system" data-group="editing" data-id="VKHriGtH" name="Package Management" __wid="sAGtWQtz"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="juE5JLby" __wid="UYzLFa29"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="fpkCBphs"><H2 __wid="8sPVwUVs">Packages</H2><DIV __wid="usDCGNBp">A package is a extension of the functionality of a codestrate. A package thereby consists of a single section in a codestrate. All functionality needs to reside in that section. In addition to that a package can have dependencies and assets. These are defined in the properties of a package, besides some other meta information like the version or a description.</DIV><DIV __wid="c59LvwEr">A user section can be toggled as a package by using the "Activate Package Section" button in the section-header.</DIV><H3 __wid="XtQPrMLj">Package ID</H3><DIV __wid="75q6D6t4">A package is identified by a unique data-id. The ID of a package is the value of the <CODE __wid="wEicC4tq">data-id</CODE>-attribute of the respective section. The name of a package section is not used to identify a package, so it may be changed.</DIV><DIV __wid="ZHwaFBBH"><B __wid="ttZ4be5T">Hint</B>: When a section is a package the data-id will be displayed in a box in the section-header.</DIV><H3 __wid="LeBRnQud">Documentation</H3><DIV __wid="ZxKHcbPp">The first paragraph in every package should be the "Documentation" body-paragraph (<CODE __wid="75wgCcCY">.section-documentation</CODE>). The functionality and usage of a package should be documented in that paragraph. Also shortcuts and other information can be added here.</DIV><H3 __wid="7gEtG9Cw">Properties</H3><DIV __wid="CApkKj8z">The second paragraph after the documentation is the "Propterties" data-paragraph (<CODE __wid="E4Mt7tZP">.section-properties</CODE>). In this paragraph meta information and alike should be added. A template with all available properties of a package can be found in the "Section Pulling" system section.</DIV><DIV __wid="bdGmNeg2">An example of properties can be seen here:</DIV><PRE __wid="GMGaCQ5R"><CODE __wid="dtbFYmTX">{
  "version": "1.1",
  "icon": "example_icon",
  "description": "This is an example.",
  "changelog":
  {
    "1.1": "Changed something in the code.",
    "1.0": "Initial version."
  }
}</CODE></PRE><DIV __wid="2Xay2RPk"><B __wid="utkcaezw">Hint</B>: When toggling an user section without properties as a package, Codestrates will offer to copy the templates into the new package. The template can then be adjusted to the own needs.</DIV><H3 __wid="Y7ZqgguW">Dependencies</H3><DIV __wid="MtFtWwNr">Packages can depend on the functionality of other packages. When an package gets installed, the dependencies will also be installed. If there are optional dependencies, the user will be asked, if he wants to install them.</DIV><DIV __wid="uLAQabZD">Dependencies can be defined in the properties of a package. An example of a dependency can be seen here:</DIV><PRE __wid="6RaFwMpr"><CODE __wid="RdGxnYBQ">"dependencies": [
  {
    "id": "MaIHJaI9",
    "name": "Dependency Example (will always be installed)"
  },
  {
    "id": "VKHriGtH",
    "name": "Optional Dependency Example",
    "optional": true,
    "usage": "This dependency is needed to user the extended feature xyz."
  }
]</CODE></PRE><DIV __wid="UecEJ6Px">A dependency consists of the following parts:</DIV><DIV __wid="vQaxXv6W"><UL __wid="Aut7td4a"><LI __wid="Mc4Nwts3"><CODE __wid="Btav9nTt">id</CODE>: The package ID of the dependency (used to identify the dependency).</LI><LI __wid="78h9LZpm"><CODE __wid="gMrMA5i4">name</CODE>: Human readable name of the dependency.</LI><LI __wid="HbWbPSDj"><CODE __wid="kkwcstin">optional</CODE>: Sets whether the dependency is optional or mandatory (default: <CODE __wid="3dkrXn7a">false</CODE>).</LI><LI __wid="rNCHKStN"><CODE __wid="ETj8xQpi">usage</CODE>: Short explanation what the dependency is used for. If the dependency is optional, this message will be shown to a user in the dialog while installation.</LI></UL></DIV><H3 __wid="dv8J9vYT">Assets</H3><DIV __wid="wDKkrAPP">Besides depending on other packages, a package can also have assets like images or JavaScript libraries. Assets will be stored as Webstrates assets. When installing or pushing packages, assets will also be pulled or pushed in the other codestrate.</DIV><DIV __wid="HL3XFS9z">Like dependencies assets are defined in the properties. An example can be seen below:</DIV><PRE __wid="2M6CLiTf"><CODE __wid="Y2x3V4B5">"assets": [
  "myLibrary.min.js",
  "myImage.png"
]</CODE></PRE><H3 __wid="U7JuHNJM">Persistent Paragraphs</H3><DIV __wid="AwvPrSzE">Sometimes packages need a CSS style to give a proper representation of their content (like slides in the "Presentations" package or a canvas in the "Drawing" package). These styles are still needed after a package has been removed (to for example have a canvas but without the drawing tools). To tackle this it is possible to set the class of paragraphs to <CODE __wid="mWijU7mF">persistent</CODE>.</DIV><DIV __wid="a4yKpuJt">Paragraphs of a package, which have the class <CODE __wid="ym2LmJyJ">persistent</CODE> will remain in a codestrate after the package has been removed, so the functionality of a package can be removed, while being sure the created content is still correctly displayed inside the Codestrate.</DIV><DIV __wid="qWPvW3Jq"><B __wid="uA75Gj6p">Hint</B>: Removing a package with only persistent parts left a second time, will also remove the persistent parts of it.</DIV><H2 __wid="HPkG5MpN">Repositories</H2><DIV __wid="hqJatacS">A repository is a codestrate, which contains and distributes packages, that can be pulled into another codestrate. In Codestrates packages can be pulled from <B __wid="Xkv2TpnT">any </B>codestrate and can be pushed into <B __wid="UhDaCTHQ">any </B>codestrate (given the user has read and write rights). Usually it makes sense to pull and push from/to a shared codestrate, the repository.</DIV><DIV __wid="dyZMWxev">One can for example create multiple repositories for different groups of packages (e.g. collaboration packages).</DIV><H3 __wid="D5av69U5">Managing Repositories</H3><DIV __wid="G2w2JwJH">The default repository is the codestrate with the name "Codestrate-Packages" and the tag "HEAD" (so the most recent version). But it is also possible to add new repositories and tags, which are then available in the select-box in the Packages dialogs.</DIV><DIV __wid="6FGB56tt">When pulling or pushing packages to a repository, which is not in the list, it will automatically be added. The entries can be modified or removed using the "Manage Package Repositories" button in the global menu.</DIV><H3 __wid="r6zCS73f">Repository List</H3><DIV __wid="Fsv4Qnud">The list of repositories is stored inside a Webstrates "anywhere cookie". So it will be available across all codestrates when the user is logged in and even across devices and web browsers. If the user is not logged in, the list will be stored inside the local storage of the web browser.</DIV><H2 __wid="L6e7nrFY">Package Management</H2><H3 __wid="pZcnZpaC">Installation</H3><DIV __wid="J6GKvtPZ">To install packages one can use the "Install and Update Packages" button in the global menu. Installing a package will copy the section of the package to the current codestrate, copy the assets and also install the dependencies (for optional dependencies a dialog will be shown).</DIV><DIV __wid="g3U2ZxBH">The installation dialog will show all packages available in the repository. The colors in the dialog have the following meanings:</DIV><DIV __wid="zsnqNcjU"><UL __wid="kTagMrfe"><LI __wid="zGC3Ss4Y"><B __wid="YCUruYjt">Uncolored</B>: The package is not installed.</LI><LI __wid="xx3v7rSM"><B style="color: var(--material-color-green);" __wid="9Dkj8UHG">Green</B>: The package is installed and has the same version as the one in the repository.</LI><LI __wid="7XpYpFJg"><B style="color: var(--material-color-orange);" __wid="8XBcnNmh">Orange</B>: The package is installed, but has a different version as the one in the repository.</LI><LI __wid="SqNHth75"><B style="color: var(--material-color-red);" __wid="kKWYJahj">Red</B>: The package is uninstalled (only the persistent paragraphs of the package are left in the codestrate).</LI><LI __wid="4SYiWG2C"><B style="color: var(--material-color-teal);" __wid="x5rsZ5ez">Teal</B>: The package is installed, but either the installed package or the package in the repository has no version or properties to match the version of the packages.</LI></UL></DIV><H3 __wid="GfyBzBtR">Updates</H3><DIV __wid="i7iG45ai">To update installed packages one can use either the "Install and Update Packages" button to update individual packages or the "Update All Packages" button to update all packages. Updating a package will overwrite the installed package with the one from the repository, so <B __wid="jZXsGFEs">local changes inside the package section will be overwritten</B>.</DIV><DIV __wid="4kXEqymX">Assets will also be updated when updating a package. Dependencies will not be updated, if they are already installed, but will be pulled again if they are not available anymore in the codestrate.</DIV><H3 __wid="DNtm39ZF">Pushing</H3><DIV __wid="H5BBBr3g">To push package to a repository one can use the "Push Packages" button in the global menu. Pushing a package will technically install or update the package on the repository with the locally installed one. When pushing a package it always needs to be pushed to the "HEAD" tag of a codestrate.</DIV><DIV __wid="u6TZpjaX"><B __wid="djnvfMmU">Hint</B>: Uninstalled packages (packages with only persistent paragraphs left) cannot be pushed.</DIV><H3 __wid="ndy8snQd">Removing</H3><DIV __wid="CsJMFT75">To remove packages one can use the "Remove Packages" button in the global menu. By removing packages the section will be removed from the codestrate (except when having persistent paragraphs, see above). Assets and dependencies stay in the codestrate.</DIV><DIV __wid="Pp9CiG9t"><B __wid="ddXG9Bk2">Hint</B>: Packages should always be removed using the "Remove Packages" dialog and not by removing the section manually.</DIV><H2 __wid="LQCStbsn">Export and Import</H2><DIV __wid="yRhpcw2X">Packages can be ex- and imported from/to a codestrate. An exported package consists is a zip-file containing the section of a paragraph, a generated readme file (out of section-documentation and section-properties) and the assets of the package. This zip-file can be uploaded to a codestrate to import the packages, i.e. installing them.</DIV><DIV __wid="y6zLHg7w">Exporting packages allows to easily share packages between different webstrates servers or in case one doesn't want to grant other people access to whole codestrates.</DIV><H3 __wid="UFkc7PT7">Export</H3><DIV __wid="fzUV9BrE">Packages can either be exported indivually using the icon in the section-header of a package or using a the "Export Packages" button in the global menu. When selecting multiple packages each package will be exported ina separate folder inside the zip-file.</DIV><DIV __wid="P6kFcdJg"><B __wid="zAUfwACG">Hint</B>: Dependencies have to be selected manually when exporting packages.</DIV><H3 __wid="SFD6k5Pu">Import</H3><DIV __wid="Hvfedqys">Packages can be imported using the "Import Packages" button in the global menu. Importing packages technically installs or updates them in the codestrate. So the package section will be copied into the codestrate (or replaces the section if the package is already installed) and assets will be imported. It is possible to provide the zip-file via file upload or by providing a link.</DIV><DIV __wid="hVPrXugx"><B __wid="tELWT8nY">Hint</B>: Because of cross-origin policies the zip-file has to be on the same server as the codestrate when providing it as a link.</DIV><H2 __wid="7mXyqkxs">GitHub Export and Import</H2><DIV __wid="4Vu4k8Xi">Besides exporting packages as zip-files it is also possible to push them directly to a GitHub repository or pull them from there.</DIV><H3 __wid="kHTcFU4F">Access Token</H3><DIV __wid="fqkFUBAk">Codestrates uses the GitHub Contents API (<A href="https://developer.github.com/v3/repos/contents/" target="_blank" __wid="9AyzegS7">link</A>) to pull or push packages from/to GitHub. The API only allows 60 REST calls per hour without an access token. This is not enough, if many packages are pulled at once. Therefore it is advised to provide an access token, which increases the REST call limit to 5000.</DIV><DIV __wid="7RSDAngZ">For imports from GitHub the access token needs no additional permission. For exporting to GitHub the token needs to have repository permissions. As for security the token is not stored inside a codestrate or cookie and needs to be re-entered on every page load.</DIV><H3 __wid="xgqxktfM">Export to GitHub</H3><DIV __wid="UWURHxZg">To export packages to GitHub one can use the button in the section-header of packages. When exporting a package a user needs to fill in the usual commit information: a commit message, a name and a email address. In addition a link to a repository needs to be provided and optionally a folder in which the package should be exported to. Every file changed will appear as a separate commit in the git log.</DIV><DIV __wid="ej9WRYe8">The option "Cleanup repository" allows to cleanup the repository (e.g. when assets were removed from a package). The cleanup will remove all files from the repository or the respective folder (if a folder is set) before the commit.</DIV><H3 __wid="fhk6pJbb">Import from GitHub</H3><DIV __wid="6yRSKV3V">To import packages from GitHub one can use the "Import Packages" dialog in the global menu. Instead of providing a URL to a zip-file one simply has to enter the URL of the GitHub repository (the root URL to the repository, e.g. <CODE __wid="GdZZiVDJ">https://github.com/UserName/RepositoryName</CODE>).</DIV><H3 __wid="DJRgsf5k">Compatiblity with ZIP-Files</H3><DIV __wid="NCAnJEW4">The structure of a GitHub export and zip-file export is the same. So it is possible to export a package as a zip-file and upload it's contents to a GitHub repository and later import it directly off the repository or vice-versa.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="iy5QSnEW" __wid="4bvE3qd5"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="AtscYAFR">{
	"version": "1.6.2",
	"description": "Functionality to pull and manage packages.",
	"changelog":
	{
		"1.6.2": "Commands API used.",
		"1.6.1": "Updated export to export tags and removed 'package-' from export name.",
		"1.6": "Added tag filtering and package search and updated usability of package selection.",
		"1.5": "Added dependency graph generation and automatically run installed packages (no reload on install).",
		"1.4.2": "Updated cleanup to only cleanup the prefixed folder and allowed prefix on import.",
		"1.4.1": "Added documentation.",
		"1.4": "Added GitHub export and import capabilities.",
		"1.3": "Exporting packages generates a 'README.md'.",
		"1.2.3": "Fixed the dependency warning on removing packages.",
		"1.2.2": "Added the 'usage' property for optional dependencies.",
		"1.2.1": "Added prompt for optional dependencies and updated tag and logging strings.",
		"1.2": "Updated dialogs.",
		"1.1": "Added export and import functionality.",
		"1.0": "Initial Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Global Menu Entries" run-on-load="true" last-execution-state="success" data-id="iTmARxY2" __wid="2MvhHjLv"><PRE data-type="content" type="text/javascript" __wid="H9uyV6py">const GlobalMenuUtils = require("#global-menu-utils");
const PackageManagementCode = require("#package-management-code");
const PackageRepositoryManager = require("#package-repository-manager");

/******************************************************************************/

Codestrate.addCommand("packages.installAndUpdatePackages", "Install and Update Packages", () => {
	PackageManagementCode.installAndUpdatePackages();
});
const installAndUpdatePackagesButton = GlobalMenuUtils.createButton("Install and Update Packages", null, event => {
	Codestrate.executeCommand("packages.installAndUpdatePackages");
});

Codestrate.addCommand("packages.updateAllPackages", "Update All Packages", () => {
	PackageManagementCode.updateAllPackages();
});
const updateAllPackagesButton = GlobalMenuUtils.createButton("Update All Packages", null, event => {
	Codestrate.executeCommand("packages.updateAllPackages");
});

Codestrate.addCommand("packages.pushPackages", "Push Packages", () => {
	PackageManagementCode.pushPackages();
});
const pushPackagesButton = GlobalMenuUtils.createButton("Push Packages", null, event => {
	Codestrate.executeCommand("packages.pushPackages");
});

Codestrate.addCommand("packages.removePackages", "Remove Packages", () => {
	PackageManagementCode.removePackages();
});
const removePackagesButton = GlobalMenuUtils.createButton("Remove Packages", null, event => {
	Codestrate.executeCommand("packages.removePackages");
});

Codestrate.addCommand("packages.exportPackages", "Export Packages", () => {
	PackageManagementCode.exportPackages();
});
const exportPackagesButton = GlobalMenuUtils.createButton("Export Packages", null, event => {
	Codestrate.executeCommand("packages.exportPackages");
});

Codestrate.addCommand("packages.importPackages", "Import Packages", () => {
	PackageManagementCode.importPackages();
});
const importPackagesButton = GlobalMenuUtils.createButton("Import Packages", null, event => {
	Codestrate.executeCommand("packages.importPackages");
});

Codestrate.addCommand("packages.managePackageRepositories", "Manage Package Repositories", () => {
	PackageRepositoryManager.openPackageRepositoryManagerDialog();
});
const managePackageRepositoriesButton = GlobalMenuUtils.createButton("Manage Package Repositories", null, event => {
	Codestrate.executeCommand("packages.managePackageRepositories");
});

/******************************************************************************/

const subMenuName = "Package Management";

GlobalMenuUtils.addMenuItemToSubMenu(installAndUpdatePackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(updateAllPackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(pushPackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(removePackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(exportPackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(importPackagesButton, subMenuName);
GlobalMenuUtils.addMenuItemToSubMenu(managePackageRepositoriesButton, subMenuName);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="qLQeREve" name="Dependency Graph Utils" __wid="j5a2YtiL"><PRE data-type="content" type="text/javascript" id="dependency-graph-utils" __wid="mqpu9D4M">/**
 * A simple dependency graph
 *
 * Borrowed from:
 * @see https://raw.githubusercontent.com/jriecken/dependency-graph/master/lib/dep_graph.js
 */

/**
 * Helper for creating a Depth-First-Search on
 * a set of edges.
 *
 * Detects cycles and throws an Error if one is detected.
 *
 * @param edges The set of edges to DFS through
 * @param leavesOnly Whether to only return "leaf" nodes (ones who have no edges)
 * @param result An array in which the results will be populated
 * @param circular A boolean to allow circular dependencies
 */
function createDFS(edges, leavesOnly, result, circular) {
  var currentPath = [];
  var visited = {};
  return function DFS(currentNode) {
    visited[currentNode] = true;
    currentPath.push(currentNode);
    edges[currentNode].forEach(function (node) {
      if (!visited[node]) {
        DFS(node);
      } else if (currentPath.indexOf(node) >= 0) {
        currentPath.push(node);
        if (!circular) {
          throw new Error('Dependency Cycle Found: ' + currentPath.join(' -> '));
        }
      }
    });
    currentPath.pop();
    if ((!leavesOnly || edges[currentNode].length === 0) && result.indexOf(currentNode) === -1) {
      result.push(currentNode);
    }
  };
}

/**
 * Simple Dependency Graph
 */
var DepGraph = exports.DepGraph = function DepGraph(opts) {
  this.nodes = {}; // Node -> Node/Data (treated like a Set)
  this.outgoingEdges = {}; // Node -> [Dependency Node]
  this.incomingEdges = {}; // Node -> [Dependant Node]
  this.circular = opts && !!opts.circular; // Allows circular deps
};

DepGraph.prototype = {
  /**
   * The number of nodes in the graph.
   */
  size:function () {
    return Object.keys(this.nodes).length;
  },
  /**
   * Add a node to the dependency graph. If a node already exists, this method will do nothing.
   */
  addNode:function (node, data) {
    if (!this.hasNode(node)) {
      // Checking the arguments length allows the user to add a node with undefined data
      if (arguments.length === 2) {
        this.nodes[node] = data;
      } else {
        this.nodes[node] = node;
      }
      this.outgoingEdges[node] = [];
      this.incomingEdges[node] = [];
    }
  },
  /**
   * Remove a node from the dependency graph. If a node does not exist, this method will do nothing.
   */
  removeNode:function (node) {
    if (this.hasNode(node)) {
      delete this.nodes[node];
      delete this.outgoingEdges[node];
      delete this.incomingEdges[node];
      [this.incomingEdges, this.outgoingEdges].forEach(function (edgeList) {
        Object.keys(edgeList).forEach(function (key) {
          var idx = edgeList[key].indexOf(node);
          if (idx >= 0) {
            edgeList[key].splice(idx, 1);
          }
        }, this);
      });
    }
  },
  /**
   * Check if a node exists in the graph
   */
  hasNode:function (node) {
    return this.nodes.hasOwnProperty(node);
  },
  /**
   * Get the data associated with a node name
   */
  getNodeData:function (node) {
    if (this.hasNode(node)) {
      return this.nodes[node];
    } else {
      throw new Error('Node does not exist: ' + node);
    }
  },
  /**
   * Set the associated data for a given node name. If the node does not exist, this method will throw an error
   */
  setNodeData:function (node, data) {
    if (this.hasNode(node)) {
      this.nodes[node] = data;
    } else {
      throw new Error('Node does not exist: ' + node);
    }
  },
  /**
   * Add a dependency between two nodes. If either of the nodes does not exist,
   * an Error will be thrown.
   */
  addDependency:function (from, to) {
    if (!this.hasNode(from)) {
      throw new Error('Node does not exist: ' + from);
    }
    if (!this.hasNode(to)) {
      throw new Error('Node does not exist: ' + to);
    }
    if (this.outgoingEdges[from].indexOf(to) === -1) {
      this.outgoingEdges[from].push(to);
    }
    if (this.incomingEdges[to].indexOf(from) === -1) {
      this.incomingEdges[to].push(from);
    }
    return true;
  },
  /**
   * Remove a dependency between two nodes.
   */
  removeDependency:function (from, to) {
    var idx;
    if (this.hasNode(from)) {
      idx = this.outgoingEdges[from].indexOf(to);
      if (idx >= 0) {
        this.outgoingEdges[from].splice(idx, 1);
      }
    }

    if (this.hasNode(to)) {
      idx = this.incomingEdges[to].indexOf(from);
      if (idx >= 0) {
        this.incomingEdges[to].splice(idx, 1);
      }
    }
  },
  /**
   * Return a clone of the dependency graph. If any custom data is attached
   * to the nodes, it will only be shallow copied.
   */
  clone:function () {
    var source = this;
    var result = new DepGraph();
    var keys = Object.keys(source.nodes);
    keys.forEach(function (n) {
      result.nodes[n] = source.nodes[n];
      result.outgoingEdges[n] = source.outgoingEdges[n].slice(0);
      result.incomingEdges[n] = source.incomingEdges[n].slice(0);
    });
    return result;
  },
  /**
   * Get an array containing the nodes that the specified node depends on (transitively).
   *
   * Throws an Error if the graph has a cycle, or the specified node does not exist.
   *
   * If `leavesOnly` is true, only nodes that do not depend on any other nodes will be returned
   * in the array.
   */
  dependenciesOf:function (node, leavesOnly) {
    if (this.hasNode(node)) {
      var result = [];
      var DFS = createDFS(this.outgoingEdges, leavesOnly, result, this.circular);
      DFS(node);
      var idx = result.indexOf(node);
      if (idx >= 0) {
        result.splice(idx, 1);
      }
      return result;
    }
    else {
      throw new Error('Node does not exist: ' + node);
    }
  },
  /**
   * get an array containing the nodes that depend on the specified node (transitively).
   *
   * Throws an Error if the graph has a cycle, or the specified node does not exist.
   *
   * If `leavesOnly` is true, only nodes that do not have any dependants will be returned in the array.
   */
  dependantsOf:function (node, leavesOnly) {
    if (this.hasNode(node)) {
      var result = [];
      var DFS = createDFS(this.incomingEdges, leavesOnly, result, this.circular);
      DFS(node);
      var idx = result.indexOf(node);
      if (idx >= 0) {
        result.splice(idx, 1);
      }
      return result;
    } else {
      throw new Error('Node does not exist: ' + node);
    }
  },
  /**
   * Construct the overall processing order for the dependency graph.
   *
   * Throws an Error if the graph has a cycle.
   *
   * If `leavesOnly` is true, only nodes that do not depend on any other nodes will be returned.
   */
  overallOrder:function (leavesOnly) {
    var self = this;
    var result = [];
    var keys = Object.keys(this.nodes);
    if (keys.length === 0) {
      return result; // Empty graph
    } else {
      // Look for cycles - we run the DFS starting at all the nodes in case there
      // are several disconnected subgraphs inside this dependency graph.
      var CycleDFS = createDFS(this.outgoingEdges, false, [], this.circular);
      keys.forEach(function(n) {
        CycleDFS(n);
      });

      var DFS = createDFS(this.outgoingEdges, leavesOnly, result, this.circular);
      // Find all potential starting points (nodes with nothing depending on them) an
      // run a DFS starting at these points to get the order
      keys.filter(function (node) {
        return self.incomingEdges[node].length === 0;
      }).forEach(function (n) {
        DFS(n);
      });

      return result;
    }
  }
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Package Management Code" data-id="X3n8WYiT" __wid="bGx7YaEB"><PRE data-type="content" type="text/javascript" id="package-management-code" __wid="ziGPJfVq">const SectionPullingUtils = require("#section-pulling-utils");

const PackageManagementHelper = require("#package-management-helper");
const PackageExportImport = require("#package-export-import");
const PackageManagementDialogs = require("#package-management-dialogs");
const PackageRepositoryManager = require("#package-repository-manager");

/******************************************************************************/

const packageSectionQuerySelector = ".section[data-type='package']";

/******************************************************************************/

/**
 * Makes it possible to install new packages or update installed packages by selecting them in a
 * dialog.
 */
exports.installAndUpdatePackages = async() => {
	const dialogTitle = "Install and Update Packages";

	// Open package selection dialog
	const data = await PackageManagementDialogs.installAndUpdatePackagesDialog();

	if (!data.selectedPackageIds) return;

	if (data.selectedPackageIds.length === 0) {
		alert("No packages selected.", dialogTitle);
		return;
	}

	// Install and update packages
	PackageManagementHelper.installAndUpdateSelectedPackages(data.prototypePackageSections,
																													 data.localPackageSections,
																													 data.selectedPackageIds,
																													 data.url);
};

/******************************************************************************/

/**
 * Updates all installed packages, which are available on the selected prototype.
 */
exports.updateAllPackages = async() => {
	const dialogTitle = "Update All Packages";

	// Check if any packages are installed
	const localPackageSections = Array.from(document.querySelectorAll(packageSectionQuerySelector));

	if (!localPackageSections || localPackageSections.length === 0) {
		alert("No packages are installed.", dialogTitle);
		return;
	}

	// Select installed packages
	const selectedPackageIds = localPackageSections.filter(x => !x.classList.contains("uninstalled")).map(
		packageSection => packageSection.getAttribute("data-id"));

	// Open dialog for repository selection
	const pullDataList = PackageRepositoryManager.packageRepositories.map(packageRepository => {
		return {pullFrom: packageRepository.packageRepositoryName,
						pullVersion: packageRepository.packageRepositoryTag};
	});

	const pullData = await SectionPullingUtils.showPullSectionsDialog(PackageRepositoryManager.currentPackageRepositoryName, PackageRepositoryManager.currentPackageRepositoryTag, dialogTitle, pullDataList);
	if (!pullData) return;

	PackageRepositoryManager.selectPackageRepository(pullData.pullFrom, pullData.pullVersion);
	PackageRepositoryManager.addPackageRepository(pullData.pullFrom, pullData.pullVersion);

	// Pull Codestrate in iFrame
	const url = SectionPullingUtils.generatePullUrl(pullData.pullFrom, pullData.pullVersion);
	const iframe = await SectionPullingUtils.loadPrototype(url + "?exec=no");
	if (!iframe) return;

	// Extract packages from pulled Codestrate and remove it
	const prototypePackageSections = Array.from(
		iframe.contentWindow.document.querySelectorAll(packageSectionQuerySelector));
	const transient = iframe.parentNode;
	transient.remove();

	// Update all packages
	PackageManagementHelper.installAndUpdateSelectedPackages(prototypePackageSections,
																													 localPackageSections,
																													 selectedPackageIds,
																													 url);
};

/******************************************************************************/

/**
 * Makes it possible to push selected packages to another Codestrate.
 */
exports.pushPackages = async() => {
	const dialogTitle = "Push Packages";

	// Check if any packages are installed
	const localPackageSections = Array.from(document.querySelectorAll(packageSectionQuerySelector));

	if (!localPackageSections || localPackageSections.length === 0) {
		alert("No packages are installed.", dialogTitle);
		return;
	}

	// Get properties
	const packageProperties = SectionPullingUtils.getMultipleSectionProperties(localPackageSections);

	// Open package selection dialog
	const data = await PackageManagementDialogs.selectPackagesDialog(packageProperties, false, "Select the packages you want to push:", dialogTitle, true, "Select the repository you want to push to:");

	if (!data.selectedPackageIds) return;

	if (data.selectedPackageIds.length === 0) {
		alert("No packages selected.", dialogTitle);
		return;
	}

	PackageRepositoryManager.selectPackageRepository(data.pullData.pullFrom, data.pullData.pullVersion);
	PackageRepositoryManager.addPackageRepository(data.pullData.pullFrom, data.pullData.pullVersion);

	if (data.pullData.pullVersion !== "HEAD") {
		alert("It is only possible to push to a HEAD of a Codestrate!", dialogTitle);
		return;
	}

	// Pull Codestrate in iFrame
	const url = SectionPullingUtils.generatePullUrl(data.pullData.pullFrom, data.pullData.pullVersion);
	const iframe = await SectionPullingUtils.loadPrototype(url + "?exec=no");
	if (!iframe) return;

	// Push packages
	PackageManagementHelper.pushPackages(localPackageSections, data.selectedPackageIds, iframe, url);
};

/******************************************************************************/

/**
 * Makes it possible to select and remove packages. If a package contains
 * persistent paragraphs it will be marked with the "uninstalled" class.
 * Removing these packages again removes also the persistent paragraphs.
 */
exports.removePackages = async() => {
	const dialogTitle = "Remove Packages";

	// Check if any packages are installed
	const localPackageSections = Array.from(document.querySelectorAll(packageSectionQuerySelector));

	if (!localPackageSections || localPackageSections.length === 0) {
		alert("No packages are installed.", dialogTitle);
		return;
	}

	// Get properties
	const packageProperties = SectionPullingUtils.getMultipleSectionProperties(localPackageSections);

	// Open package selection dialog
	const data = await PackageManagementDialogs.selectPackagesDialog(packageProperties, true, "Select the packages you want to remove:", dialogTitle);

	if (!data.selectedPackageIds) return;

	if (data.selectedPackageIds.length === 0) {
		alert("No packages selected.", dialogTitle);
		return;
	}

	// Remove selected packages
	PackageManagementHelper.removePackages(localPackageSections, data.selectedPackageIds);
};

/******************************************************************************/

/**
 * Makes it possible to export packages as a zip-file.
 */
exports.exportPackages = async() => {
	const dialogTitle = "Export Packages";

	// Check if any packages are installed
	const localPackageSections = Array.from(document.querySelectorAll(packageSectionQuerySelector));

	if (!localPackageSections || localPackageSections.length === 0) {
		alert("No packages are installed.", dialogTitle);
		return;
	}

	// Get properties
	const packageProperties = SectionPullingUtils.getMultipleSectionProperties(localPackageSections);

	// Open package selection dialog
	const data = await PackageManagementDialogs.selectPackagesDialog(packageProperties, false, "Select the packages you want to export:", dialogTitle);

	if (!data.selectedPackageIds) return;

	if (data.selectedPackageIds.length === 0) {
		alert("No packages selected.", dialogTitle);
		return;
	}

	PackageExportImport.exportByDataId(data.selectedPackageIds);
};

/**
 * Makes it possible to import packages from a zip-file.
 */
exports.importPackages = async() => {
	const dialogTitle = "Import Packages";

	const result = await PackageManagementDialogs.importPackagesDialog();

	if (typeof result === "undefined") {
		alert("No zip-file or GitHub repository provided.", dialogTitle);
	}

	if (!result) return;

	if (typeof result === "string") {
		PackageExportImport.importByUrl(result);
	} else if (typeof result.url === "string" && result.url !== "") {
		PackageExportImport.importByGitHub(result.url, result.folder);
	} else {
		PackageExportImport.importByBlob(result);
	}
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Package Management Helper" data-id="RcAdaK3d" style __wid="KhPmV6FF"><PRE data-type="content" type="text/javascript" id="package-management-helper" __wid="i4haMHiu">const SectionPullingUtils = require("#section-pulling-utils");
const AssetUtils = require("#asset-utils");
const DepGraph = require('#dependency-graph-utils').DepGraph;

const PackageManagementLogger = require("#package-management-logger");

/******************************************************************************/

const packageSectionQuerySelector = ".section[data-type='package']";
const systemSectionQuerySelector = ".section[data-type='system']";

/******************************************************************************/

const fetchAssets = async(url, packageToInstall, assets) => {
	// Fetch assets
	if (Array.isArray(assets)) {
		for (let i = 0; i &lt; assets.length; i++) {
			let assetName = url + assets[i];
			let response = await fetch(assetName, {
				credentials: "include"
			});
			let blob = await response.blob();
			let asset = await AssetUtils.uploadBlob(assetName, blob);

			PackageManagementLogger.pulledAsset(packageToInstall, assetName);
		}
	}
};

const addDependencyToGraph = (depGraph, id, dependencyId, packagesToBuildGraph) => {
	if (!depGraph.hasNode(dependencyId)) {
		packagesToBuildGraph.push(dependencyId);
	}

	depGraph.addNode(dependencyId);
	depGraph.addDependency(id, dependencyId);
}

/**
 * Build dependency graph for packages to install including its dependencies and dependencies of
 * dependencies.
 */
const buildDependencyGraph = async(selectedPackageIds, packageStati, dialogTitle) => {

	const depGraph = new DepGraph();

	let packagesToBuildGraph = [...selectedPackageIds];

	while (packagesToBuildGraph.length !== 0) {
		let packageToInstall = packagesToBuildGraph.pop();

		// Add the "main" id package as root node to the dependency graph
		depGraph.addNode(packageToInstall);

		const currentStatus = packageStati.find(status => (status.id === packageToInstall));

		// Add dependencies to install
		if (Array.isArray(currentStatus.prototypeProperties.dependencies)) {
			for (let i = 0; i &lt; currentStatus.prototypeProperties.dependencies.length; i++) {
				const dependency = currentStatus.prototypeProperties.dependencies[i];
				if (dependency.optional) {
					const result = await confirm(`The package "${currentStatus.name}" (${packageToInstall}) has an optional dependency "${dependency.name}" (${dependency.id}).${dependency.usage ? ` The dependency is needed for the following features:&lt;br>&lt;br>"${dependency.usage}"` : ""}&lt;br>&lt;br>Do you want to install it?`, dialogTitle);
					if (result) {
						addDependencyToGraph(depGraph, packageToInstall, dependency.id, packagesToBuildGraph);
					}
				} else {
					addDependencyToGraph(depGraph, packageToInstall, dependency.id, packagesToBuildGraph);
				}
			}
		}
	}

	return depGraph.overallOrder();
};

/**
 * Function to install or update selected packages.
 *
 * @param (Array) Packages installed on prototype
 * @param (Array) Locally installed package section elements
 * @param (Array) Ids of packages to be installed or updated
 * @param (String) URL of prototype to push to
 */
exports.installAndUpdateSelectedPackages =
	async(prototypePackageSections, localPackageSections, selectedPackageIds, url) => {

	let hasUpdatedPackage = false;

	const dialogTitle = "Install and Update Packages";

	// Get stati of packages
	const packageStati = SectionPullingUtils.getSectionStati(
		SectionPullingUtils.getMultipleSectionProperties(prototypePackageSections),
		SectionPullingUtils.getMultipleSectionProperties(localPackageSections));

	webstrate.tag(`Tag of version ${webstrate.version} before update of packages "${selectedPackageIds.join(", ")}" from "${url}"`);
	PackageManagementLogger.actionStarted(`${dialogTitle} from ${url}`);

	// Get point to paste new packages
	const sectionRoot = document.querySelector("#sections");

	let packagesToInstall;
	try {
		// Repository installed packages for dependency management
		packagesToInstall = await buildDependencyGraph(selectedPackageIds, packageStati, dialogTitle);
	} catch (error) {
		// Dependency graph may have detected a cycle
		alert(`Coult not install packages because ${error.message}`, dialogTitle);
		return false;
	}

	// Install packages and dependencies
	for (let i = 0; i &lt; packagesToInstall.length; i++) {

		let packageToInstall = packagesToInstall[i];

		// Get the status of the locally installed package and the remote package, which allows to check
		// if the package already exists locally and if it needs to be replaced with a newer remote
		// version.
		const currentStatus = packageStati.find(status => (status.id === packageToInstall));

		if (!currentStatus) {
			Codestrate.persistentLog.warn(`Could not find package "${packageToInstall}"!`, PackageManagementLogger.logName);
			continue;
		}

		// Get package section to be installed or updated
		const currentPrototypeSection = SectionPullingUtils.findSection(prototypePackageSections, currentStatus.id);

		if (currentPrototypeSection) {

			// Get/install all assets for the dependency
			await fetchAssets(url, packageToInstall, currentStatus.prototypeProperties.assets);

			// Import section from packages codestrate
			const newSection = document.importNode(currentPrototypeSection, true);
			newSection.classList.remove("section-visible");
			newSection.classList.add("section-hidden");

			// Paste section into codestrate
			if (currentStatus.local) {
				const currentLocalSection = SectionPullingUtils.findSection(localPackageSections, currentStatus.id);
				currentLocalSection.replaceWith(newSection);
				if (currentStatus.localProperties.uninstalled) {
					PackageManagementLogger.installedNonPersistent(packageToInstall);
				} else {
					PackageManagementLogger.updatedPackage(packageToInstall);
					hasUpdatedPackage = true;
				}
			} else {
				let entryPoint;

				// Find correct position of package
				let index = packageStati.indexOf(currentStatus) + 1;
				const currentPackagesAndSystemSections = Array.from(
					document.querySelectorAll('.section[data-type="package"], .section[data-type="system"]'));

				if (index &lt; packageStati.length) {
					let notFound = true;
					while (!entryPoint && (index &lt; packageStati.length)) {
						entryPoint = SectionPullingUtils.findSection(currentPackagesAndSystemSections,
																												 packageStati[index].id);
						index++;
					}
				}

				// Place in end of packages or system sections otherwise
				if (!entryPoint) {
					entryPoint = currentPackagesAndSystemSections[currentPackagesAndSystemSections.length - 1].nextSibling;
				}

				if (entryPoint) {
					sectionRoot.insertBefore(newSection, entryPoint);
				} else {
					sectionRoot.appendChild(newSection);
				}
				PackageManagementLogger.installedPackage(packageToInstall);
			}
		} else {
			Codestrate.persistentLog.warn(`Could not install package "${packageToInstall}"!`, PackageManagementLogger.logName);
		}
	}

	// Log finish
	PackageManagementLogger.actionFinished(`${dialogTitle} from ${url}`);

	// Reload of codestrate is required because at least one package was updated
	if (hasUpdatedPackage) {

		// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
		Codestrate.reloadAll("At least one package was updated. Therefore, the codestrate will reload after updating is completed.");
	}
};

/******************************************************************************/

/**
 * Function for pushing packages.
 *
 * @param (Array) Locally installed package section elements
 * @param (Array) Ids of packages to be removed
 * @param (Element) iFrame with prototype to push to
 * @param (String) URL of prototype to push to
 */
exports.pushPackages = async(localPackageSections, selectedPackageIds, iframe, url) => {
	const dialogTitle = "Push Packages";

	const iframeDoc = iframe.contentWindow.document;

	// Tag and log start
	iframe.contentWindow.webstrate.tag(`Tag of version ${iframe.contentWindow.webstrate.version} before push of packages "${selectedPackageIds.join(", ")}" from "${location.pathname}"`);
	PackageManagementLogger.actionStarted(`${dialogTitle} to ${url}`);
	PackageManagementLogger.actionStarted(`${dialogTitle} from ${window.location.pathname} by "${webstrate.user.username}"`, iframeDoc, iframe.contentWindow.webstrate.version);

	// Get properties
	const packageProperties = SectionPullingUtils.getMultipleSectionProperties(localPackageSections);

	// Extract packages from pulled Codestrate
	const prototypePackageSections = Array.from(iframeDoc.querySelectorAll(packageSectionQuerySelector));

	// Get point to paste new packages
	const sectionRoot = iframeDoc.querySelector("#sections");
	let entryPoint = iframeDoc.querySelectorAll(".section[data-type='package']");
	if (entryPoint.length === 0) {
		entryPoint = iframeDoc.querySelectorAll(".section[data-type='system']");
	}
	entryPoint = entryPoint[entryPoint.length - 1];

	// Push packages
	while (selectedPackageIds.length !== 0) {
		const selectedPackageId = selectedPackageIds.shift();

		const prototypePackageSection =
					SectionPullingUtils.findSection(prototypePackageSections, selectedPackageId);
		const localPackageSection =
					SectionPullingUtils.findSection(localPackageSections, selectedPackageId);

		if (localPackageSection) {

			const newSection = iframeDoc.importNode(localPackageSection, true);
			newSection.classList.remove("section-visible");
			newSection.classList.add("section-hidden");

			if (prototypePackageSection) {
				prototypePackageSection.replaceWith(newSection);
				PackageManagementLogger.pushedPackageUpdate(selectedPackageId, iframeDoc);
			} else {
				sectionRoot.insertBefore(newSection, entryPoint.nextSibling);
				PackageManagementLogger.pushedNewPackage(selectedPackageId, iframeDoc);
			}

			// Push assets
			const assets = packageProperties.find(p => p.id === selectedPackageId).assets;
			if (Array.isArray(assets)) {
				for (let i = 0; i &lt; assets.length; i++) {
					let assetName = assets[i];
					let response = await fetch(window.location.pathname + assetName, {
						credentials: "include"
					});
					let blob = await response.blob();
					let asset = await AssetUtils.uploadBlob(url + assetName, blob, false, url);
					PackageManagementLogger.pushedAsset(selectedPackageId, assetName, iframeDoc);
				}
			}
		} else {
			Codestrate.persistentLog.warn(`Could not push package "${selectedPackageId}"!`, PackageManagementLogger.logName);
		}
	}

	// Log end, send refresh signal and remove iframe
	PackageManagementLogger.actionFinished(`${dialogTitle} to ${url}`);
	PackageManagementLogger.actionFinished(`${dialogTitle} from ${window.location.pathname} by "${webstrate.user.username}"`, iframeDoc, iframe.contentWindow.webstrate.version);
	toast(`Pushed packages to ${url}`);

	(async() => {
		await iframe.contentWindow.webstrate.dataSaved();

		// Reload all clients that have the transcluded codestrate open to reinitialize the codestrate
		// environment.
		// FIXME: reloadAll not working on ?exec=no codestrate
		//iframe.contentWindow.Codestrate.reloadAll("Packages pushed to codestrate. It will reload automatically.");

		// Give the transcluded codestrate some time to send signals to other clients of the same
		// codestrate.
		setTimeout(() => {
			const transient = iframe.parentNode;
			transient.remove();
		}, 5000);
	})();
};

/******************************************************************************/

/**
 * Function for removing packages.
 *
 * @param (Array) Locally installed package section elements
 * @param (Array) Ids of packages to be removed
 * @param (bool) Set true if persistent paragraphs should be removed also
 */
exports.removePackages =
	async(localPackageSections, selectedPackageIds, removePersistent = false) => {

	const dialogTitle = "Remove Packages";

	// Warn user, create tag and log start
	webstrate.tag(`Tag of version ${webstrate.version} before removal of packages "${selectedPackageIds.join(", ")}"`);
	PackageManagementLogger.actionStarted(dialogTitle);

	// Setup for warning about dependencies
	let localPackageProperties = SectionPullingUtils.getMultipleSectionProperties(localPackageSections);
	localPackageProperties = localPackageProperties.filter(properties => !selectedPackageIds.includes(properties.id))

	let remainingDependencies = [];
	localPackageProperties.forEach(properties => {
		if (Array.isArray(properties.dependencies)) {
			remainingDependencies.push(...properties.dependencies);
		}
	});

	// Loop over selected ids
	let packagesToRemove = [...selectedPackageIds];

	while (packagesToRemove.length !== 0) {
		let selectedPackageId = packagesToRemove.shift();

		let remainingDependency = remainingDependencies.filter(dependency => dependency.id === selectedPackageId);

		if (remainingDependency.length > 0) {
			const result = await confirm(`The package "${remainingDependency[0].name}" (${selectedPackageId}) is  a dependency of another installed package.&lt;br>&lt;br>Do you want to remove it anyway?`, dialogTitle);
			if (!result) continue;
		}

		const packageSection = SectionPullingUtils.findSection(localPackageSections, selectedPackageId);

		if (packageSection) {

			// If only persistent parts left, it will also remove these
			const uninstalled = packageSection.classList.contains("uninstalled");
			const hasPersistent = packageSection.querySelector(".persistent[data-type='content']");

			// Check for persistent paragraphs
			if (!removePersistent && !uninstalled && hasPersistent) {
				packageSection.querySelectorAll(".paragraph").forEach(paragraph => {
					const content = paragraph.querySelector("[data-type='content']");
					if (!content.classList.contains("persistent") &&
							!content.classList.contains("section-documentation") &&
							!content.classList.contains("section-properties")) {
						paragraph.remove();
					}
				});
				packageSection.classList.add("uninstalled");
				PackageManagementLogger.removedPackage(selectedPackageId);
			} else {
				packageSection.remove();
				PackageManagementLogger.removedPackagePersistent(selectedPackageId, hasPersistent);
			}
		} else {
			Codestrate.persistentLog.warn(`Could not remove package "${selectedPackageId}"!`, PackageManagementLogger.logName);
		}
	}

	// Log end and send refresh signal
	PackageManagementLogger.actionFinished(dialogTitle);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
	Codestrate.reloadAll("At least one package was removed. Therefore, the codestrate will reload after removing is completed.");
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="ikbGVj8X" name="Package Export and Import" style __wid="NvufniyZ"><PRE data-type="content" type="text/javascript" id="package-export-import" __wid="f6FarbU2">const SectionPullingUtils = require("#section-pulling-utils");
const PackageExportImportHelper = require("#package-export-import-helper");
const PackageManagementDialogs = require("#package-management-dialogs");
const PackageManagementLogger = require("#package-management-logger");
const AssetUtils = require("#asset-utils");
const AssetMimeType = require("#asset-mime-type");

/******************************************************************************/

const packageSectionQuerySelector = ".section[data-type='package']";
const packageFileExtension = "csp";

// GitHub
const apiPath = "https://api.github.com/repos";
const contentPath = "contents";

/******************************************************************************/

importLib([
	"FileSaver.min.js",
	"jszip.min.js"
]).then(() => {

	exports.exportByDataId = (dataIds) => {
		const sections = [];
		let dataIdsArray = dataIds;
		if (!Array.isArray(dataIdsArray)) dataIdsArray = [dataIds];

		dataIdsArray.forEach(dataId => {
			const section = document.querySelector(`.section[data-id="${dataId}"]`);
			if (section) {
				sections.push(section);
			} else {
				console.warn(`Could not find section "${dataId}" for export!`);
			}
		});

		exports.exportBySection(sections);
	};

/******************************************************************************/

	const addPackageToZip = (zip, section, prefix = "") => {
		return new Promise(async(resolve, reject) => {
			const exportSection = section.cloneNode(true);
			const properties = SectionPullingUtils.getSectionProperties(exportSection);

			// Remove transients
			const transients = Array.from(exportSection.querySelectorAll("transient"));
			transients.forEach(transient => transient.remove());

			// Add file
			zip.file(prefix + PackageExportImportHelper.packageFileName(section) + "." + packageFileExtension, exportSection.outerHTML);

			// Add README.md
			const readMe = PackageExportImportHelper.generateReadMe(exportSection, properties);
			zip.file(prefix + "README.md", readMe);

			// Get assets list
			if (properties) {
				const assets = properties.assets;

				// Add assets
				if (assets && Array.isArray(assets)) {
					for (let i = 0; i &lt; assets.length; i++) {
						let assetName = assets[i];
						let assetPath = window.location.origin + window.location.pathname + assetName;
						let response = await fetch(assetPath, { credentials: "include" });
						let blob = await response.blob();
						zip.file(prefix + "assets/" + assetName, blob);
					}
				}
			}

			resolve(true);
		});
	};

	exports.exportBySection = async(sections) => {
		const zip = new JSZip();
		let zipName = "packages";

		if (Array.isArray(sections) && sections.length > 1) {
			for (let i = 0; i &lt; sections.length; i++) {
				let prefix = i + 1 + "_";
				while (prefix.length &lt; (sections.length + 1 + "_").length) prefix = "0" + prefix;
				await addPackageToZip(zip, sections[i], prefix + PackageExportImportHelper.packageFileName(sections[i]) + "/");
			}
		} else if (Array.isArray(sections)) {
			await addPackageToZip(zip, sections[0]);
			zipName = PackageExportImportHelper.packageFileName(sections[0]);
		} else {
			await addPackageToZip(zip, sections);
			zipName = PackageExportImportHelper.packageFileName(sections);
		}

		// Create file for download
		zip.generateAsync({type:"blob"}).then(function (blob) {
			saveAs(blob, zipName + ".zip");
		}, function (err) {
			console.error(err);
		});
	};

/******************************************************************************/

	exports.importByUrl = async(url) => {
		const response = await fetch(url, { credentials: "include" });
		const blob = await response.blob();
		exports.importByBlob(blob);
	};

/******************************************************************************/

	exports.importByBlob = async(blob) => {
		const dialogTitle = "Import Packages";
		let zip;

		try {
			zip = await JSZip.loadAsync(blob);
		} catch (e){
			alert("Parsing of zip-file failed!", dialogTitle);
			console.error(e);
			return;
		}

		webstrate.tag(`Tag of version ${webstrate.version} before package import`);
		PackageManagementLogger.actionStarted(dialogTitle);

		const files = zip.file(/.*/);

		for (let i = 0; i &lt; files.length; i++) {
			let file = files[i];
			let relativePath = file.name;

			if (relativePath.endsWith("." + packageFileExtension)) {

				// Extract and generate section
				const packageContent = await file.async("text");
				const template = document.createElement("template");
				template.innerHTML = packageContent;

				const newSection = template.content.firstChild;
				newSection.classList.remove("section-visible");
				newSection.classList.add("section-hidden");
				const dataId = newSection.getAttribute("data-id");

				// Replace or insert section
				const oldSection = document.querySelector(`.section[data-id="${dataId}"]`);

				if (oldSection) {
					oldSection.replaceWith(newSection);
				} else {
					const sections = document.querySelector("#sections");
					const packagesAndSystemSections = Array.from(sections.querySelectorAll(".section[data-type='package'], .section[data-type='system']"));
					const lastSection = packagesAndSystemSections[packagesAndSystemSections.length - 1];
					sections.insertBefore(newSection, lastSection.nextSibling);
				}

				PackageManagementLogger.importedPackage(dataId);
			} else if (relativePath.endsWith("README.md")) {
				// Don't import readme
			} else {

				// Import assets
				let arraybuffer = await file.async("arraybuffer");
				let blob = await new Blob([arraybuffer], {type : AssetMimeType.getMimeType(relativePath)});
				let asset = await AssetUtils.uploadBlob(relativePath, blob);
				PackageManagementLogger.importedAsset(relativePath);
			}
		}

		PackageManagementLogger.actionFinished(dialogTitle);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
		Codestrate.reloadAll("Packages were imported. Therefore, the codestrate will reload after import is completed.");
	};
});

/******************************************************************************/

const importContents = (contents) => {
	return new Promise(async(resolve, reject) => {
		for (let i = 0; i &lt; contents.length; i++) {
			const element = contents[i];

			if (element.type === "dir") {

				// Recursively iterate through repository
				const directory = await PackageExportImportHelper.getApiObject(element.url);
				await importContents(directory);

			} else if (element.type === "file") {

				if (element.name.endsWith("." + packageFileExtension)) {

					// Extract and generate section
					const data = await PackageExportImportHelper.getApiObject(element.git_url);
					const packageContent = window.atob(data.content);
					const template = document.createElement("template");
					template.innerHTML = packageContent;

					const newSection = template.content.firstChild;
					newSection.classList.remove("section-visible");
					newSection.classList.add("section-hidden");
					const dataId = newSection.getAttribute("data-id");

					// Replace or insert section
					const oldSection = document.querySelector(`.section[data-id="${dataId}"]`);

					if (oldSection) {
						oldSection.replaceWith(newSection);
					} else {
						const sections = document.querySelector("#sections");
						const packagesAndSystemSections = Array.from(sections.querySelectorAll(".section[data-type='package'], .section[data-type='system']"));
						const lastSection = packagesAndSystemSections[packagesAndSystemSections.length - 1];
						sections.insertBefore(newSection, lastSection.nextSibling);
					}

					PackageManagementLogger.importedPackage(dataId);
				} else if (element.name.endsWith("README.md")) {
					// Don't import readme
				} else {

					// Import assets
					const data = await PackageExportImportHelper.getApiObject(element.git_url);
					const blob = PackageExportImportHelper.b64ToBlob(data.content, AssetMimeType.getMimeType(element.name));
					let asset = await AssetUtils.uploadBlob(element.name, blob);
					PackageManagementLogger.importedAsset(element.name);
				}
			}
		}
		resolve(true);
	});
};

exports.importByGitHub = async(url, folder) => {
	const dialogTitle = "Import Packages from GitHub";

	const accessToken = await PackageExportImportHelper.checkApiToken(dialogTitle);
	if (accessToken === false) return;

	webstrate.tag(`Tag of version ${webstrate.version} before package import`);
	PackageManagementLogger.actionStarted(dialogTitle);

	const repository = url.replace("https://github.com/", "");
	const api = apiPath + "/" + repository + "/" + contentPath;
	const path = folder ? "/" + folder : "";

	const contents = await PackageExportImportHelper.getApiObject(api + "/" + path);
	await importContents(contents);

	PackageManagementLogger.actionFinished(dialogTitle);

	// Reload all clients that have the same codestrate open to reinitialize the codestrate environment.
	Codestrate.reloadAll("Packages were imported. Therefore, the codestrate will reload after import is completed.");
};

/******************************************************************************/

const cleanUpRepo = (contents, commitData) => {
	return new Promise(async(resolve, reject) => {
		for (let i = 0; i &lt; contents.length; i++) {
			const element = contents[i];

			if (element.type === "dir") {
				const directory = await PackageExportImportHelper.getApiObject(element.url);
				await cleanUpRepo(directory, commitData);
			} else if (element.type === "file") {
				const element = contents[i];
				await PackageExportImportHelper.makeRequest("DELETE", element.url, JSON.stringify({
					message: "Cleanup: " + commitData.message,
					commiter: {
						name: commitData.name,
						email: commitData.email
					},
					sha: element.sha
				}));
			}
		}

		resolve(true);
	});
};

const pushFile = (path, content, commitData) => {
	return new Promise(async(resolve, reject) => {

		// Set sha if file is already in repo
		const commit = {
			message: commitData.message,
			commiter: {
				name: commitData.name,
				email: commitData.email
			},
			content: content
		};

		try {

			// Get parent folder of file, as if file is too big it will return 404
			const dir = await PackageExportImportHelper.getApiObject(path.replace(/\/[^\/]*$/, ""));
			const element = dir.find((el) => el.name === path.replace(/.*\//, ""));
			commit.sha = element.sha;

			const gitElement = await PackageExportImportHelper.getApiObject(element.git_url);

			if (window.atob(gitElement.content) === window.atob(content)) {
				console.log(`Skipped file "${path}" as contents are equal.`);
				return resolve(true);
			}
		} catch (e) {
			// Do nothing, file is not available in repo
		}

		// Send commit of file
		await PackageExportImportHelper.makeRequest("PUT", path, JSON.stringify(commit));
		resolve(true);
	});
};

exports.exportToGitHub = async(section) => {
	const dialogTitle = "Export Package to GitHub";

	const accessToken = await PackageExportImportHelper.checkApiToken(dialogTitle);
	if (accessToken === false) return;
	if (accessToken === "") {
		alert("You need to enter an access token to export to GitHub!", dialogTitle);
		return;
	}

	// Start export
	const exportSection = section.cloneNode(true);
	const properties = SectionPullingUtils.getSectionProperties(exportSection);

	// Show commit dialog
	const commitData = await PackageManagementDialogs.exportPackageToGitHubDialog(properties);
	if (!commitData) return;

	const repository = commitData.url.replace("https://github.com/", "");
	const api = apiPath + "/" + repository + "/" + contentPath;
	const path = commitData.folder ? "/" + commitData.folder : "";

	// Cleanup repo
	if (commitData.cleanUp) {
		const contents = await PackageExportImportHelper.getApiObject(api + "/" + path);
		await cleanUpRepo(contents, commitData);
	}

	// Remove transients
	const transients = Array.from(exportSection.querySelectorAll("transient"));
	transients.forEach(transient => transient.remove());

	// Add file
	await pushFile(api + path + "/" + PackageExportImportHelper.packageFileName(section) + "." + packageFileExtension, window.btoa(exportSection.outerHTML), commitData);

	// Add README.md
	let readMe = PackageExportImportHelper.generateReadMe(exportSection, properties);
	await pushFile(api + path + "/README.md", window.btoa(readMe), commitData);

	// Get assets list
	if (properties) {
		const assets = properties.assets;
		const reader  = new FileReader();

		// Add assets
		if (assets && Array.isArray(assets)) {
			for (let i = 0; i &lt; assets.length; i++) {
				let assetName = assets[i];
				let assetPath = window.location.origin + window.location.pathname + assetName;
				let response = await fetch(assetPath, { credentials: "include" });
				let blob = await response.blob();
				let data = await PackageExportImportHelper.blobToB64(blob);
				await pushFile(api + path + "/assets/" + assetName, data, commitData);
			}
		}
	}

	toast("Pushed package to GitHub");
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="MTEmfFRm" name="Package Export and Import Helper" __wid="w99SEYTj"><PRE data-type="content" type="text/javascript" id="package-export-import-helper" __wid="cTyF4iyc">let accessToken = "";

/******************************************************************************/

exports.packageFileName = (section) => `${section.getAttribute("data-id")}-${section.getAttribute("name") ? section.getAttribute("name").replace(/ /g, "_") : "No_Name"}`;

exports.generateReadMe = (exportSection, properties) => {
	let readMe = "";

	const sectionDocumentation = exportSection.querySelector(".section-documentation[data-type='content']");
	if (sectionDocumentation) readMe += sectionDocumentation.innerHTML.replace(/&lt;div>/g, "&lt;p>").replace(/&lt;\/div>/g, "&lt;/p>");

	if (properties) {
		readMe += `

# Properties

| Property | Value |
| :--- | :--- |
| Name | ${properties.name || "-"} |
| ID | ${properties.id || "-"} |
| Version | ${properties.version || "-"} |
| Description | ${properties.description || "-"} |
| Tags | ${properties.tags ? properties.tags.length > 0 ? "`" + properties.tags.join(", ") + "`" : ("-") : "-"} |
| Assets | ${properties.assets ? properties.assets.length > 0 ? "`" + properties.assets.join(", ") + "`" : ("-") : "-"} |
| Dependencies | ${properties.dependencies ? properties.dependencies.length > 0 ? "`" + JSON.stringify(properties.dependencies) + "`" : "-" : "-"} |
| Changelog | ${properties.changelog ? "`" + JSON.stringify(properties.changelog) + "`" : "-"} |`;
	}

	return readMe;
};

/******************************************************************************/

exports.checkApiToken = async(dialogTitle) => {
	return new Promise(async(resolve, reject) => {
		if (!accessToken) {
			accessToken = await prompt(`&lt;div>The GitHub API allows up to 60 REST calls per hour. Using an access token increases this limit to 5000. For pushing of packages an access token is always needed.&lt;/div>&lt;br>&lt;div>Enter a GitHub access token (optional):&lt;/div>`, "", dialogTitle);
		}
		resolve(accessToken);
	});
}

exports.makeRequest = (method, url, data = false) => {
	return new Promise((resolve, reject) => {
		const xhr = new XMLHttpRequest();

		// Add random string to prevent using cached versions
		const params = accessToken ? "?access_token=" + accessToken + "&" + Codestrate.util.randomString() : "?" + Codestrate.util.randomString()
		xhr.open(method, url.replace("?ref=master", "") + params);

		xhr.onload = function () {
			if (this.status >= 200 && this.status &lt; 300) {
				resolve(xhr.response);
			} else {
				reject({
					status: this.status,
					statusText: xhr.statusText
				});
			}
		};

		xhr.onerror = function () {
			reject({
				status: this.status,
				statusText: xhr.statusText
			});
		};

		xhr.send(data);
	});
};

exports.getApiObject = (url) => {
	return new Promise(async(resolve, reject) => {
		try {
			const object = await exports.makeRequest("GET", url);
			resolve(JSON.parse(object));
		} catch (e) {
			resolve(false);
		}
	});
};

/******************************************************************************/

exports.b64ToBlob = (b64Data, contentType = "", sliceSize = 512) => {
	const byteCharacters = atob(b64Data);
	const byteArrays = [];

	for (let offset = 0; offset &lt; byteCharacters.length; offset += sliceSize) {
		const slice = byteCharacters.slice(offset, offset + sliceSize);

		const byteNumbers = new Array(slice.length);
		for (let i = 0; i &lt; slice.length; i++) {
			byteNumbers[i] = slice.charCodeAt(i);
		}

		const byteArray = new Uint8Array(byteNumbers);

		byteArrays.push(byteArray);
	}

	const blob = new Blob(byteArrays, {type: contentType});
	return blob;
};

exports.blobToB64 = (blob) => {
	return new Promise((resolve, reject) => {
		const fileReader = new FileReader();
		fileReader.onload = (readerEvt) => {
			resolve(window.btoa(readerEvt.target.result));
		};
		fileReader.readAsBinaryString(blob);
	});
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="Ddw5QYTr" name="Package Import URL (disabled)" last-execution-state="success" style __wid="eLYgGURa"><PRE data-type="content" type="text/javascript" __wid="umkV874h">const PackageExportImport = require("#package-export-import");

/******************************************************************************/

const url_string =  window.location.href;
const url = new URL(url_string);
const value = url.searchParams.get("importPackage");

if (value) {
	(async() => {
		const result = await confirm(`Do you want to import packages from "${value}"?`, "Import Packages");
		if (result) {
			PackageExportImport.importByUrl(value);
		} else {
			window.location = window.location.origin + window.location.pathname;
		}
	})();
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="ZcGzgrsy" name="Package Export UI" run-on-load="true" draggable="false" style last-execution-state="success" __wid="dRua7kZK"><PRE data-type="content" type="text/javascript" __wid="gqxVCWmQ">const PackageExportImport = require("#package-export-import");
const ActionUtils = require("#action-utils");

/******************************************************************************/

const sectionQuery = document.liveQuerySelectorAll(".section-header").added((sectionHeader) => {
	const section = sectionHeader.closest(".section");
	if (!section || section.querySelector(".export-package")) return;

	const action = ActionUtils.create(() => {
		PackageExportImport.exportBySection(section);
	}, {
		classNames: "export-package",
		tooltip: true
	});

	sectionHeader.appendChild(action);

	const actionGithub = ActionUtils.create(() => {
		PackageExportImport.exportToGitHub(section);
	}, {
		classNames: "export-github-package",
		tooltip: true
	});

	sectionHeader.appendChild(actionGithub);
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="RsTYGeWK" name="Package Export UI Style" style __wid="tcEp7PTk"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="FZ4QHsia">html .section:not([data-type="package"]) .export-package,
html .section.uninstalled .export-package,
html .section:not([data-type="package"]) .export-github-package,
html .section.uninstalled .export-github-package {
	display: none;
}

html .section .export-package i:after {
	content: var(--arrow-down-bold-hexagon-outline);
	font-family: "Material Design Icons";
}

html .section .export-package:after {
	content: "Export Package";
}

html .section .export-github-package i:after {
	content: var(--github-circle);
	font-family: "Material Design Icons";
}

html .section .export-github-package:after {
	content: "Export Package to GitHub";
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="e9Wd4ts2" name="PackageÂ ManagementÂ Logger" draggable="false" style __wid="puMvkG6h"><PRE data-type="content" type="text/javascript" id="package-management-logger" __wid="Sfzw27pm">exports.logName = "Package Management";

/******************************************************************************/

exports.actionStarted = (action, rootDocument = false, rootVersion = false) => {
	Codestrate.persistentLog.info(`${action} started (version ${rootVersion ? rootVersion : webstrate.version}).`, exports.logName, rootDocument);
};

exports.actionFinished = (action, rootDocument = false, rootVersion = false) => {
	Codestrate.persistentLog.info(`${action} finished (version ${rootVersion ? rootVersion : webstrate.version}).`, exports.logName, rootDocument);
};

/******************************************************************************/

exports.installedPackage = (id) => {
	Codestrate.persistentLog.log(`Installed new package "${id}".`, exports.logName);
};

exports.installedNonPersistent = (id) => {
	Codestrate.persistentLog.log(`Installed non-persistant paragraphs of package "${id}".`, exports.logName);
};

exports.updatedPackage = (id) => {
	Codestrate.persistentLog.log(`Updated package "${id}".`, exports.logName);
};

/******************************************************************************/

exports.removedPackage = (id) => {
	Codestrate.persistentLog.log(`Removed package "${id}" without persistent paragraphs.`, exports.logName);
};

exports.removedPackagePersistent = (id, hasPersistent) => {
	Codestrate.persistentLog.log(`Removed package "${id}"${hasPersistent ? " with persistent paragraphs" : ""}.`, exports.logName);
};

/******************************************************************************/

exports.pushedNewPackage = (id, rootDocument) => {
	Codestrate.persistentLog.log(`Pushed new package "${id}".`, exports.logName);
	Codestrate.persistentLog.log(`New package "${id}" was pushed.`, exports.logName, rootDocument);
};

exports.pushedPackageUpdate = (id, rootDocument, url) => {
	Codestrate.persistentLog.log(`Pushed update to package "${id}".`, exports.logName);
	Codestrate.persistentLog.log(`Update to package "${id}" was pushed.`, exports.logName, rootDocument);
};

/******************************************************************************/

exports.pushedAsset = (id, assetName, rootDocument) => {
	Codestrate.persistentLog.log(`Pushed asset "${assetName}" of package "${id}".`, exports.logName);
	Codestrate.persistentLog.log(`Asset "${assetName}" of package "${id}" was pushed.`, exports.logName, rootDocument);
};

exports.pulledAsset = (id, assetName) => {
	Codestrate.persistentLog.log(`Pulled asset "${assetName}" of package "${id}".`, exports.logName);
};

/******************************************************************************/

exports.importedPackage = (id) => {
	Codestrate.persistentLog.log(`Imported package "${id}".`, exports.logName);
};

exports.importedAsset = (fileName) => {
	Codestrate.persistentLog.log(`Imported asset "${fileName}".`, exports.logName);
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="xGaF3wLU" draggable="false" style name="Package Repository Manager" __wid="zfKCEsqY"><PRE data-type="content" type="text/javascript" id="package-repository-manager" __wid="chph57HA">const defaultPackageRepository = {
	packageRepositoryName : "Codestrate-Packages",
	packageRepositoryTag: "HEAD"
};

const defaultPackageRepositorys = [
	defaultPackageRepository
];

const packageRepositoryKey = "package-repositories";
const currentPackageRepositoryKey = "current-package-repository";

/******************************************************************************/

exports.usesCookies = !!webstrate.user.cookies;

/******************************************************************************/

const getValue = (key) => {
	let value;
	if (exports.usesCookies) {
		value = webstrate.user.cookies.anywhere.get(key);
	} else if (localStorage) {
		value = JSON.parse(localStorage.getItem(key));
	}
	return value;
};

const setValue = (key, value) => {
	if (exports.usesCookies) {
		webstrate.user.cookies.anywhere.set(key, value);
	} else if (localStorage) {
		localStorage.setItem(key, JSON.stringify(value));
	}
};

/******************************************************************************/

const getPackageRepositories = () => {
	let packageRepositories = getValue(packageRepositoryKey);

	// Init if unavailable
	if (!packageRepositories ||
			!Array.isArray(packageRepositories) ||
			(packageRepositories.length === 0)) {
		packageRepositories = defaultPackageRepositorys;
		setPackageRepositories(packageRepositories);
	}

	exports.packageRepositories = packageRepositories;
	return packageRepositories;
};

const setPackageRepositories = (packageRepositories) => {
	setValue(packageRepositoryKey, packageRepositories);
	exports.packageRepositories = packageRepositories;
};

/******************************************************************************/

const getCurrentPackageRepository = () => {
	let currentPackageRepository = getValue(currentPackageRepositoryKey);

	// Init if unavailable
	if (!currentPackageRepository) {
		currentPackageRepository = defaultPackageRepository;
		setCurrentPackageRepository(currentPackageRepository);
	}

	exports.currentPackageRepository = currentPackageRepository;
	exports.currentPackageRepositoryName = currentPackageRepository.packageRepositoryName;
	exports.currentPackageRepositoryTag = currentPackageRepository.packageRepositoryTag;
	return currentPackageRepository;
};

const setCurrentPackageRepository = (currentPackageRepository) => {
	setValue(currentPackageRepositoryKey, currentPackageRepository);
	exports.currentPackageRepository = currentPackageRepository;
	exports.currentPackageRepositoryName = currentPackageRepository.packageRepositoryName;
	exports.currentPackageRepositoryTag = currentPackageRepository.packageRepositoryTag;
};

/******************************************************************************/

exports.packageRepositories = getPackageRepositories();
exports.packageRepositoryNames = () => {
	const names = [];
	return getPackageRepositories().map(repository => {
		const name = repository.packageRepositoryName;
		if (names.includes(name)) {
			return false;
		} else {
			names.push(name);
			return name;
		}
	}).filter(e => !!e).sort();
};
exports.packageRepositoryTags = () => {
	const tags = [];
	return getPackageRepositories().map(repository => {
		const tag = repository.packageRepositoryTag;
		if (tags.includes(tag)) {
			return false;
		} else {
			tags.push(tag);
			return tag;
		}
	}).filter(e => !!e).sort();
};

exports.currentPackageRepository = getCurrentPackageRepository();
exports.currentPackageRepositoryName = exports.currentPackageRepository.packageRepositoryName;
exports.currentPackageRepositoryTag = exports.currentPackageRepository.packageRepositoryTag;

/******************************************************************************/

exports.selectPackageRepository = (packageRepositoryName, packageRepositoryTag) => {
	setCurrentPackageRepository({
		packageRepositoryName: packageRepositoryName,
		packageRepositoryTag: packageRepositoryTag
	});
};

/******************************************************************************/

exports.addPackageRepository = (packageRepositoryName, packageRepositoryTag) => {
	const packageRepositories = getPackageRepositories();
	if (!packageRepositoryName || !packageRepositoryTag) return;
	if (packageRepositories.find(repository => (repository.packageRepositoryName === packageRepositoryName &&
																	 repository.packageRepositoryTag === packageRepositoryTag))) return;
	packageRepositories.push({ packageRepositoryName: packageRepositoryName, packageRepositoryTag: packageRepositoryTag });
	setPackageRepositories(packageRepositories);
};

/******************************************************************************/

exports.removePackageRepository = (packageRepositoryName, packageRepositoryTag) => {
	const packageRepositories = getPackageRepositories();
	const repositoryToRemove = packageRepositories.find(repository => ((repository.packageRepositoryName === packageRepositoryName) && (repository.packageRepositoryTag === packageRepositoryTag)));

	if (!repositoryToRemove) return false;

	const index = packageRepositories.indexOf(repositoryToRemove);
	packageRepositories.splice(index, 1);

	setPackageRepositories(packageRepositories);
};

/******************************************************************************/

exports.openPackageRepositoryManagerDialog = () => {
	const transient = document.createElement("transient");

	const elements = require("#dialog-template", {
		title: "Manage Package Repositories",
		message: `&lt;div>Package repositories are retrieved from ${exports.usesCookies ? "webstrate cookies" : "LocalStorage"}.&lt;/div>
&lt;table class="packages package-repositories">
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Tag&lt;/th>
&lt;th>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;/tbody>
&lt;/table>`,
		actions: `&lt;div class="button add">Add&lt;/div>
&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
		className: ""
	});

	elements.forEach(e => transient.appendChild(e));

	const createRow = (name = "", tag = "") => {
		const tr = document.createElement("tr");
		tr.innerHTML = `&lt;td class="package-repository-name" contenteditable="true">${name}&lt;/td>
&lt;td class="package-repository-tag" contenteditable="true">${tag}&lt;/td>`;

		const removeTd = document.createElement("td");
		removeTd.classList.add("remove-package-repository");
		removeTd.innerHTML = `&lt;i class="material-icons">&lt;/i>`;
		removeTd.addEventListener("click", () => tr.remove());

		tr.appendChild(removeTd);
		return tr;
	};

	const table = transient.querySelector(".package-repositories > tbody");
	const oldPackageRepositories = getPackageRepositories();
	oldPackageRepositories.forEach(repository => {
		table.appendChild(createRow(repository.packageRepositoryName, repository.packageRepositoryTag));
	});

	const addBtn = transient.querySelector(".add");
	const okBtn = transient.querySelector(".ok");
	const cancelBtn = transient.querySelector(".cancel");

	const add = () => {
		table.appendChild(createRow());
	};

	const ok = () => {
		const rows = Array.from(table.querySelectorAll("tr"));
		const packageRepositories = [];

		if (rows) {
			rows.forEach(row => {
				const name = row.querySelector(".package-repository-name");
				const tag = row.querySelector(".package-repository-tag");
				if (name && tag && name.innerHTML !== "" && tag.innerHTML !== "") {
					packageRepositories.push({packageRepositoryName: name.innerHTML, packageRepositoryTag: tag.innerHTML});
				}
			});
		}
		setPackageRepositories(packageRepositories);
		transient.remove();
		toast("Set new package repositories", 5000, () => setPackageRepositories(oldPackageRepositories), "Undo");
	};

	const cancel = () => {
		transient.remove();
	};

	addBtn.addEventListener("click", e => add());
	okBtn.addEventListener("click", e => ok());
	cancelBtn.addEventListener("click", e => cancel());

	document.body.appendChild(transient);
};</PRE></DIV><DIV class="paragraph body-paragraph collapsed" data-id="3EuDgYs5" name="Package Management Dialog Template" __wid="EMdGatvs"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="true" id="package-management-dialog-template" __wid="bDceXZMY"><DIV class="modal" __wid="9KNHhNDP"></DIV>
<DIV class="dialog packages ${className}" __wid="teRRYgJg">
	<DIV class="title" __wid="U9KZtKXW">${title}</DIV>
	<DIV class="body" __wid="q6SpyYmf">
		<DIV __wid="k7sbGgRp">Select the repository you want to install or update packages from:</DIV>
		<DIV class="pullData" __wid="DxkjkKzu">
			<SELECT class="repositories" __wid="xT5hHwV9">${PackageRepositoryManager.packageRepositories.map(repository => `<OPTION value="${repository.packageRepositoryName};${repository.packageRepositoryTag}" __wid="ZFGztatZ">${repository.packageRepositoryName} ${repository.packageRepositoryTag}</OPTION>`).join("")}</SELECT>
			<INPUT type="text" class="repository-name" placeholder="Repository Name" name="repository-name" title="Repository Name" required __wid="ZaakQTmY"/>
			<INPUT type="text" class="repository-tag" placeholder="Repository Tag" name="repository-tag" title="Repository Tag" required __wid="PwzTLwFR"/>
			<DIV class="update-package-list button" __wid="ehr7cm9n">Update List</DIV>
		</DIV>
		<DIV __wid="n53YRZSi">Select tags to filter for them:</DIV>
		<DIV class="tag-filter-container" __wid="PWdRrBDb"></DIV>
		<DIV __wid="5URpHhTt">Select the packages you want to install or update from <B __wid="RQCzy8J3"><SPAN class="current-repository" __wid="Nh2mTSd2"></SPAN></B>:</DIV>
		<TABLE class="packages install-and-update-packages" __wid="rbLgvb3X">
		<THEAD __wid="kNTausye">
		<TR __wid="8wkn3pBt">
			<TH __wid="dBaYL4fG"><I class="material-icons" id="checkbox-all" __wid="7GdBtZ33"></I></TH>
			<TH __wid="CPkveDPj">Status</TH>
			<TH __wid="wxAhNRy9">Installed Version</TH>
			<TH __wid="rVPtL7np">Repository Version</TH>
			<TH __wid="rXCTdMqV">Name</TH>
			<TH __wid="uMD9kBtU">Description</TH>
			<TH __wid="S7jPRUA5">Tags</TH>
			<TH __wid="RX5w4Ciy">Dependencies</TH>
			<TH __wid="4suyvC7S">Changelog</TH>
		</TR>
		</THEAD>
		<TBODY __wid="7gLze6ZT"></TBODY>
		</TABLE>
	</DIV>
	<DIV class="actions" __wid="X2i4yvag">
		<DIV class="button ok" __wid="mkMZSP69">OK</DIV>
		<DIV class="button cancel" __wid="9r4FWNWL">Cancel</DIV>
	</DIV>
</DIV></DIV></DIV><DIV class="paragraph code-paragraph collapsed" name="PackageÂ ManagementÂ Dialogs" data-id="7epQSVbJ" style __wid="aKnyjYyf"><PRE data-type="content" type="text/javascript" id="package-management-dialogs" __wid="Yd3saNQB">const SectionPullingUtils = require("#section-pulling-utils");
const PackageRepositoryManager = require("#package-repository-manager");

/******************************************************************************/

const packageSectionQuerySelector = ".section[data-type='package']";

/******************************************************************************/

exports.installAndUpdatePackagesDialog = () => {

	return new Promise((resolve, reject) => {

		const data = {};
		let currentPackageStati = [];
		let selectedTags = [];

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: "Install and Update Packages",
			message: `&lt;div>Select the repository you want to install or update packages from:&lt;/div>
&lt;div class="pullData">
	&lt;select class="repositories">${PackageRepositoryManager.packageRepositories.map(repository => `&lt;option value="${repository.packageRepositoryName};${repository.packageRepositoryTag}">${repository.packageRepositoryName} ${repository.packageRepositoryTag}&lt;/option>`).join("")}&lt;/select>
	&lt;input type="text" class="repository-name" placeholder="Repository Name" name="repository-name" title="Repository Name" required>
	&lt;input type="text" class="repository-tag" placeholder="Repository Tag" name="repository-tag" title="Repository Tag" required>
	&lt;div class="update-package-list button">Update List&lt;/div>
&lt;/div>
&lt;div>Select tags to filter for them:&lt;/div>
&lt;div class="tag-filter-container">&lt;/div>
&lt;div>Select the packages you want to install or update from &lt;b>&lt;span class="current-repository">&lt;/span>&lt;/b>:&lt;/div>
&lt;div class="package-search">
	&lt;input type="text" class="package-search-input" placeholder="Package Name" title="Search Packages">
&lt;/div>
&lt;table class="packages install-and-update-packages">
&lt;thead>
&lt;tr>
	&lt;th>&lt;i class="material-icons" id="checkbox-all">&lt;/th>
	&lt;th>Status&lt;/th>
	&lt;th>Installed Version&lt;/th>
	&lt;th>Repository Version&lt;/th>
	&lt;th>Name&lt;/th>
	&lt;th>Description&lt;/th>
	&lt;th>Tags&lt;/th>
	&lt;th>Dependencies&lt;/th>
	&lt;th>Changelog&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>&lt;/tbody>
&lt;/table>`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: "packages install-and-update-packages"
		});

		elements.forEach(e => transient.appendChild(e));

		const repositorySelect = transient.querySelector(".repositories");
		const repositoryNameInput = transient.querySelector(".repository-name");
		const repositoryTagInput = transient.querySelector(".repository-tag");
		const updatePackageListButton = transient.querySelector(".update-package-list");
		const currentRepositorySpan = transient.querySelector(".current-repository");
		const tagFilterContainer = transient.querySelector(".tag-filter-container");
		const packageSearchInput = transient.querySelector(".package-search-input");
		const checkboxAll = transient.querySelector("#checkbox-all");
		const tbody = transient.querySelector("table.packages tbody");

		// Repository selection
		const updateSelect = () => {
			repositorySelect.value = repositoryNameInput.value + ";" + repositoryTagInput.value;
		};

		const updateInputs = () => {
			const repository = repositorySelect.value.split(";");
			repositoryNameInput.value = repository[0];
			repositoryTagInput.value = repository[1];
		};

		const updateButton = () => {
			if (data.pullData && (data.pullData.pullFrom !== repositoryNameInput.value || data.pullData.pullVersion !== repositoryTagInput.value)) {
				updatePackageListButton.classList.add("update-needed");
			} else {
				updatePackageListButton.classList.remove("update-needed");
			}

			if (repositoryNameInput.value === "" || repositoryTagInput.value === "") {
				updatePackageListButton.classList.add("invalid");
			} else {
				updatePackageListButton.classList.remove("invalid");
			}
		};

		const updateTable = async() => {

			// Open dialog for repository selection
			if (repositoryNameInput.value === "" || repositoryTagInput.value === "") return;

			data.pullData = {
				pullFrom: repositoryNameInput.value,
				pullVersion: repositoryTagInput.value
			};

			tbody.innerHTML = "";
			tagFilterContainer.innerHTML = "";
			selectedTags = [];
			updateButton();

			// Pull Codestrate in iFrame
			data.url = SectionPullingUtils.generatePullUrl(data.pullData.pullFrom, data.pullData.pullVersion);
			const iframe = await SectionPullingUtils.loadPrototype(data.url + "?exec=no");
			if (!iframe) return;

			// Extract packages from pulled Codestrate and remove it
			data.prototypePackageSections = Array.from(iframe.contentWindow.document.querySelectorAll(packageSectionQuerySelector));
			const transient = iframe.parentNode;
			transient.remove();

			data.localPackageSections = Array.from(document.querySelectorAll(packageSectionQuerySelector));

			// Get stati of packages
			currentPackageStati = SectionPullingUtils.getSectionStati(
				SectionPullingUtils.getMultipleSectionProperties(data.prototypePackageSections),
				SectionPullingUtils.getMultipleSectionProperties(data.localPackageSections));

			currentRepositorySpan.innerText = data.pullData.pullFrom + " " + data.pullData.pullVersion;

			// Get tags, sort and make unique
			let tagList = [];
			currentPackageStati.filter(x => x.prototype).forEach(status => {
				if (Array.isArray(status.prototypeProperties.tags)) {
					tagList.push(...Array.from(status.prototypeProperties.tags));
				}
			});
			tagList = tagList.filter(function(item, pos) {
				return tagList.indexOf(item) == pos;
			});
			tagList = tagList.sort();
			tagFilterContainer.innerHTML = `${tagList.map(tag => `&lt;div class="tag-filter">${tag}&lt;/div>`).join("")}`;

			updateTableBody();
		};

		const updateTableBody = () => {
			tbody.innerHTML = "";
			tbody.innerHTML = `${currentPackageStati.filter(status => {
				if (status.prototype) {
					if (selectedTags.length === 0) {
						return true;
					} else if (Array.isArray(status.prototypeProperties.tags) && status.prototypeProperties.tags.length > 0) {
						for (let i = 0; i &lt; selectedTags.length; i++) {
							if (!status.prototypeProperties.tags.includes(selectedTags[i])) {
								return false;
							}
						}
						return true;
					}
				}
				return false;
			}).filter(status => {
				if (packageSearchInput.value !== "") {
					if (status.name.toLowerCase().indexOf(packageSearchInput.value.toLowerCase()) > -1) {
						return true;
					} else {
						return false;
					}
				} else {
					return true;
				}
			}).map(status => `&lt;tr local="${status.local}" version-changed="${status.versionChanged}" ${status.local ? `uninstalled="${status.localProperties.uninstalled ? "true" : "false"}"` : ""} data-id="${status.id}">
	&lt;td>&lt;i class="material-icons checkbox">&lt;/td>
	&lt;td>${status.local ? (status.localProperties.uninstalled ? "Persistent parts only" : (status.versionChanged !== undefined ? (status.versionChanged ? "Version changed" : "Up to date") : "Unknown version installed")) : "Not installed"}&lt;/td>
	&lt;td>${status.local ? (status.localProperties.version || "-") : "-"}&lt;/td>
	&lt;td>${status.prototypeProperties.version || "-"}&lt;/td>
	&lt;td>${status.prototypeProperties.name || "-"}&lt;/td>
	&lt;td>${status.prototypeProperties.description || "-"}&lt;/td>
	&lt;td>${Array.isArray(status.prototypeProperties.tags) ? (status.prototypeProperties.tags.length > 0 ? status.prototypeProperties.tags.map(tag => `${tag}`).join(", ") : "-") : "-"}&lt;/td>
	&lt;td>${Array.isArray(status.prototypeProperties.dependencies) ? (status.prototypeProperties.dependencies.length > 0 ? status.prototypeProperties.dependencies.map(dependency => `${dependency.name}`).join(", ") : "-") : "-"}&lt;/td>
	&lt;td>${status.prototypeProperties.changelog ? (status.prototypeProperties.changelog[status.prototypeProperties.version] || "-") : "-"}&lt;/td>
&lt;/tr>`).join("")}`;
			updateCheckboxAll();
		};

		const updateCheckboxAll = () => {
			const checked = (tbody.querySelector("tr.selected") !== null);
			const unchecked = (tbody.querySelector("tr:not(.selected)") !== null);

			if (checked) {
				if (unchecked) {
					checkboxAll.classList.add("indeterminate");
					checkboxAll.classList.remove("checked");
				} else {
					checkboxAll.classList.remove("indeterminate");
					checkboxAll.classList.add("checked");
				}
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
			}
		};

		// Repository selection events
		repositorySelect.addEventListener("change", () => {
			updateInputs();
			updateTable();
			updateButton();
		});
		repositoryNameInput.addEventListener("change", () => {
			updateSelect();
			updateButton();
		});
		repositoryTagInput.addEventListener("change", () => {
			updateSelect();
			updateButton();
		});

		repositoryNameInput.addEventListener("keydown", e => {
			e.stopPropagation();
			if (e.keyCode === 13) {
				e.preventDefault();
				updateTable();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		});

		repositoryTagInput.addEventListener("keydown", e => {
			e.stopPropagation();
			if (e.keyCode === 13) {
				e.preventDefault();
				updateTable();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		});

		updatePackageListButton.addEventListener("click", () => updateTable());

		// Checkbox events
		checkboxAll.addEventListener("click", () => {
			let selected;
			if (checkboxAll.classList.contains("checked")) {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
				selected = false;
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.add("checked");
				selected = true;
			}
			Array.from(tbody.querySelectorAll("tr")).forEach(tr => {
				if (selected) {
					tr.classList.add("selected");
				} else {
					tr.classList.remove("selected");
				}
			});
		});

		tbody.addEventListener("click", e => {
			if (e.target === null || e.target.closest("tr") === null) return;
			e.target.closest("tr").classList.toggle("selected");
			updateCheckboxAll();
		});

		repositoryNameInput.value = PackageRepositoryManager.currentPackageRepository.packageRepositoryName;
		repositoryTagInput.value = PackageRepositoryManager.currentPackageRepository.packageRepositoryTag;
		updateSelect();
		updateTable();

		// Tag filter event
		tagFilterContainer.addEventListener("click", e => {
			if (e.target === null || !e.target.classList.contains("tag-filter")) return;

			const newTag = e.target.innerText;
			if (selectedTags.includes(newTag)) {
				selectedTags.splice(selectedTags.indexOf(newTag), 1);
				e.target.classList.remove("selected");
			} else {
				selectedTags.push(newTag);
				e.target.classList.add("selected");
			}

			updateTableBody();
		});

		// Search
		packageSearchInput.addEventListener("keyup", e => {
			e.stopPropagation();
			if (e.keyCode === 13) {
				e.preventDefault();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
			updateTableBody();
		});

		// Dialog actions
		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");

		const ok = () => {
			PackageRepositoryManager.selectPackageRepository(data.pullData.pullFrom, data.pullData.pullVersion);
			PackageRepositoryManager.addPackageRepository(data.pullData.pullFrom, data.pullData.pullVersion);
			data.selectedPackageIds = Array.from(
					tbody.querySelectorAll("tr.selected")).map(tr => tr.getAttribute("data-id"));
			transient.remove();
			resolve(data);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);
		packageSearchInput.focus();
	});
};

/*****************************************************************/

exports.selectPackagesDialog = (packageProperties, showUninstalled = true, message = "Select the packages:", title = "Select Packages", repoSelection = false, repoSelectionMessage = "Select the repository:") => {

	return new Promise((resolve, reject) => {

		const data = {};

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: title,
			message: `${repoSelection ? `&lt;div>${repoSelectionMessage}&lt;/div>
&lt;div class="pullData">
	&lt;select class="repositories">${PackageRepositoryManager.packageRepositories.map(repository => `&lt;option value="${repository.packageRepositoryName};${repository.packageRepositoryTag}">${repository.packageRepositoryName} ${repository.packageRepositoryTag}&lt;/option>`).join("")}&lt;/select>
	&lt;input type="text" class="repository-name" placeholder="Repository Name" name="repository-name" title="Repository Name" required>
	&lt;input type="text" class="repository-tag" placeholder="Repository Tag" name="repository-tag" title="Repository Tag" required>
&lt;/div>` : ""}
&lt;div>${message}&lt;/div>
&lt;table class="packages select-packages">
&lt;thead>
&lt;tr>
	&lt;th>&lt;i class="material-icons" id="checkbox-all">&lt;/th>
	&lt;th>Installed Version&lt;/th>
	&lt;th>Name&lt;/th>
	&lt;th>Description&lt;/th>
	&lt;th>Dependencies&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
${packageProperties.filter(x => (showUninstalled || !x.uninstalled)).map(property => `&lt;tr uninstalled="${property.uninstalled}" data-id="${property.id}">
	&lt;td>&lt;i class="material-icons checkbox">&lt;/td>
	&lt;td>${property.version || "-"}&lt;/td>
	&lt;td>${property.name || "-"}&lt;/td>
	&lt;td>${property.description || "-"}&lt;/td>
	&lt;td>${Array.isArray(property.dependencies) ? (property.dependencies.length > 0 ? property.dependencies.map(dependency => `${dependency.name}`).join(", ") : "-") : "-"}&lt;/td>
&lt;/tr>`).join("")}
&lt;/tbody>
&lt;/table>`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: "packages select-packages"
		});

		elements.forEach(e => transient.appendChild(e));

		const repositorySelect = transient.querySelector(".repositories");
		const repositoryNameInput = transient.querySelector(".repository-name");
		const repositoryTagInput = transient.querySelector(".repository-tag");
		const checkboxAll = transient.querySelector("#checkbox-all");
		const tbody = transient.querySelector("table.packages tbody");

		// Repository selection
		if (repoSelection) {
			const updateSelect = () => {
				repositorySelect.value = repositoryNameInput.value + ";" + repositoryTagInput.value;
			};

			const updateInputs = () => {
				const repository = repositorySelect.value.split(";");
				repositoryNameInput.value = repository[0];
				repositoryTagInput.value = repository[1];
			};

			repositorySelect.addEventListener("change", () => updateInputs());
			repositoryNameInput.addEventListener("change", () => updateSelect());
			repositoryTagInput.addEventListener("change", () => updateSelect());

			repositoryNameInput.value = PackageRepositoryManager.currentPackageRepository.packageRepositoryName;
			repositoryTagInput.value = PackageRepositoryManager.currentPackageRepository.packageRepositoryTag;
			updateSelect();
		}

		// Checkboxes
		const updateCheckboxAll = () => {
			const checked = (tbody.querySelector("tr.selected") !== null);
			const unchecked = (tbody.querySelector("tr:not(.selected)") !== null);

			if (checked) {
				if (unchecked) {
					checkboxAll.classList.add("indeterminate");
					checkboxAll.classList.remove("checked");
				} else {
					checkboxAll.classList.remove("indeterminate");
					checkboxAll.classList.add("checked");
				}
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
			}
		};

		checkboxAll.addEventListener("click", () => {
			let selected;
			if (checkboxAll.classList.contains("checked")) {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.remove("checked");
				selected = false;
			} else {
				checkboxAll.classList.remove("indeterminate");
				checkboxAll.classList.add("checked");
				selected = true;
			}
			Array.from(tbody.querySelectorAll("tr")).forEach(tr => {
				if (selected) {
					tr.classList.add("selected");
				} else {
					tr.classList.remove("selected");
				}
			});
		});

		tbody.addEventListener("click", e => {
			if (e.target === null || e.target.closest("tr") === null) return;
			e.target.closest("tr").classList.toggle("selected");
			updateCheckboxAll();
		});

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");

		const ok = () => {
			if (repoSelection) {
				data.pullData = {
					pullFrom: repositoryNameInput.value,
					pullVersion: repositoryTagInput.value
				};
			}
			data.selectedPackageIds = Array.from(
					tbody.querySelectorAll("tr.selected")).map(tr => tr.getAttribute("data-id"));
			transient.remove();
			resolve(data);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);
	});
};

/******************************************************************************/

exports.importPackagesDialog = () => {

	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: "Import Packages",
			message: `&lt;div>Enter an URL to a zip-file or upload a zip-file:&lt;/div>
&lt;input class="import-package-url-input" type="url" placeholder="http://www.codestrates.org/packages.zip" pattern=".*\.zip$">
&lt;input class="import-package-file-input" type="file" accept="application/zip">
&lt;br>&lt;br>
&lt;div>Enter an GitHub URL to a repository and optionally a folder:&lt;/div>
&lt;input class="import-package-github-url-input" type="url" placeholder="https://github.com/User/Repository" pattern="https://github.com/.*">
&lt;input class="import-package-github-folder-input" placeholder="path/to/package (optional)">`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: "packages import-packages"
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");
		const urlInput = transient.querySelector(".import-package-url-input");
		const fileInput = transient.querySelector(".import-package-file-input");
		const gitHubUrlInput = transient.querySelector(".import-package-github-url-input");
		const gitHubFolderInput = transient.querySelector(".import-package-github-folder-input");

		const ok = () => {
			let result;

			if (fileInput.files.length === 1) {
				result = fileInput.files.item(0);
			} else if (urlInput.value !== "") {
				result = urlInput.value;
			} else if (gitHubUrlInput !== "") {
				result = {
					url: gitHubUrlInput.value,
					folder: gitHubFolderInput.value
				}
			}

			transient.remove();
			resolve(result);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		const inputAction = (e) => {
			e.stopPropagation();

			if (e.keyCode === 13) {
				e.preventDefault();
				ok();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		};

		urlInput.addEventListener("keydown", (e) => inputAction(e));
		gitHubUrlInput.addEventListener("keydown", (e) => inputAction(e));
		gitHubFolderInput.addEventListener("keydown", (e) => inputAction(e));

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);

		document.body.appendChild(transient);

		urlInput.focus();
	});
};

/******************************************************************************/

exports.exportPackageToGitHubDialog = (properties) => {

	return new Promise((resolve, reject) => {

		let url = "";
		let folder = "";
		if (properties && properties.github) {
			url = properties.github.url || "";
			folder = properties.github.folder || "";
		}

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: "Export Package to GitHub",
			message: `&lt;div>Enter the URL to the GitHub repository:&lt;/div>
&lt;input class="url-input" placeholder="https://github.com/User/Repository" value="${url}">
&lt;div>Enter a folder/folder (optional):&lt;/div>
&lt;input class="folder-input" placeholder="path/to/package (optional)" value="${folder}">
&lt;br>&lt;br>
&lt;div>Enter a commit message:&lt;/div>
&lt;input class="message-input">
&lt;div>Enter the name of the committer:&lt;/div>
&lt;input class="name-input" value="${webstrate.user.displayName}">
&lt;div>Enter the email of the committer:&lt;/div>
&lt;input class="email-input" value="${webstrate.user.username}@users.noreply.github.com">
&lt;br>&lt;br>
&lt;div>Do you want to clean up the repository before pushing?&lt;/div>
&lt;input class="cleanup-input" type="checkbox">`,
			actions: `&lt;div class="button ok">OK&lt;/div>
&lt;div class="button cancel">Cancel&lt;/div>`,
			className: "packages export-package-to-github"
		});

		elements.forEach(e => transient.appendChild(e));

		const okBtn = transient.querySelector(".ok");
		const cancelBtn = transient.querySelector(".cancel");
		const urlInput = transient.querySelector(".url-input");
		const folderInput = transient.querySelector(".folder-input");
		const messageInput = transient.querySelector(".message-input");
		const nameInput = transient.querySelector(".name-input");
		const emailInput = transient.querySelector(".email-input");
		const cleanUpInput = transient.querySelector(".cleanup-input");

		const ok = () => {
			const commitData = {
				url: urlInput.value,
				folder: folderInput.value,
				message: messageInput.value,
				name: nameInput.value,
				email: emailInput.value,
				cleanUp: cleanUpInput.checked
			}

			transient.remove();
			resolve(commitData);
		};

		const cancel = () => {
			transient.remove();
			resolve(false);
		};

		const inputAction = (e) => {
			e.stopPropagation();

			if (e.keyCode === 13) {
				e.preventDefault();
				ok();
			} else if (e.keyCode === 27) {
				e.preventDefault();
				cancel();
			}
		};

		okBtn.addEventListener("click", ok);
		cancelBtn.addEventListener("click", cancel);
		urlInput.addEventListener("keydown", (e) => inputAction(e));
		messageInput.addEventListener("keydown", (e) => inputAction(e));
		nameInput.addEventListener("keydown", (e) => inputAction(e));
		emailInput.addEventListener("keydown", (e) => inputAction(e));

		document.body.appendChild(transient);

		urlInput.focus();
	});
};</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Package Management Dialogs Style" data-id="aaSLkDgy" style __wid="qe3NLkRP"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="iNMm59FN">html .install-and-update-packages .body,
html .select-packages .body {
	max-width: 90vw;
}

html table.packages {
	border-collapse: collapse;
	margin-top: 16px;
}

html table.install-and-update-packages {
	width: 85vw;
}

html table.select-packages,
html table.package-repositories {
	width: 100%;
	max-height: 90vh;
}

html table.packages td,
html table.packages th {
	padding: 8px;
}

html table.packages .checkbox:before,
html table.packages #checkbox-all:before {
	content: "check_box_outline_blank";
}

html table.packages .selected .checkbox:before,
html table.packages #checkbox-all.checked:before {
	content: "check_box";
}

html table.packages #checkbox-all.indeterminate:before {
	content: "indeterminate_check_box";
}

html table.packages td,
html table.packages #checkbox-all {
	cursor: pointer;
}

/******************************************************************************/

html .packages .pullData,
html .packages .package-search {
	display: flex;
	margin-bottom: 24px;
	margin-top: 16px;
	flex-direction: row;
	align-items: center;
	justify-content: space-between;
	height: 48px;
	background: var(--color-primary-shade-2);
	padding: 8px;
	width: 100%;
}

html .packages .pullData > * {
	flex: 0 1 auto;
	height: 32px;
	margin: 0 !important;
}

html .packages .pullData > * + *,
html .packages .package-search > * + *{
	margin-left: 32px !important;
}

html .packages .pullData .repositories {
	width: auto;
	margin: 0;
}

html .packages .pullData .update-package-list,
html .packages .package-search .search-packages {
	flex: 0 0 auto;
}

html .packages .pullData .update-package-list:hover,
html .packages .package-search .search-packages:hover {
	background: var(--color-primary-shade-3);
}

html .packages .pullData .update-package-list.update-needed {
	background: rgba(var(--material-color-green-rgb), 0.75);
}

html .packages .pullData .update-package-list.update-needed:hover {
	background: var(--material-color-green);
}

html .packages .pullData .update-package-list.invalid {
	background: var(--material-color-grey) !important;
	cursor: default;
}

/******************************************************************************/

html table.packages tr:nth-child(even),
html table.packages thead {
	background: var(--color-primary-shade-2);
}

html table.packages tr[local="true"][version-changed="true"] {
	background: var(--material-color-orange);
	color: var(--material-color-grey-100);
}

html table.packages tr[local="true"][version-changed="false"] {
	background: var(--material-color-green);
	color: var(--material-color-grey-100);
}

html table.packages tr[local="true"][version-changed="undefined"] {
	background: var(--material-color-teal);
	color: var(--material-color-grey-100);
}

html table.packages tr[uninstalled="true"] {
	background: var(--material-color-red) !important;
	color: var(--material-color-grey-100);
}

/******************************************************************************/

html table.package-repositories .package-repository-name,
html table.package-repositories .package-repository-tag {
	cursor: text;
	outline: none;
}

html table.package-repositories .package-repository-name:empty:before {
	content: "name";
	opacity: 0.5;
}

html table.package-repositories .package-repository-tag:empty:before {
	content: "tag";
	opacity: 0.5;
}

html table.package-repositories .remove-package-repository {
	cursor: pointer;
}

html table.package-repositories .remove-package-repository:hover {
	color: var(--material-color-red);
}

html table.package-repositories .remove-package-repository i:after {
	content: "delete";
}

/******************************************************************************/

html .cleanup-input {
	width: auto !important;
	margin: 16px 0  0!important;
}

html .cleanup-input:after {
	content: "Cleanup Repository ";
	position: relative;
	float: left;
	white-space: nowrap;
	line-height: 13px;
	left: 20px;
}

/******************************************************************************/

html .tag-filter-container {
	display: flex;
	flex-wrap: wrap;
	margin-bottom: 16px;
	margin-top: 16px;
	flex-direction: row;
	align-items: flex-start;
	width: 100%;
}

html .tag-filter {
	flex: 0 1 auto;
	background: var(--color-primary-shade-3);
	color: var(--color-primary-text);
	border-radius: 16px;
	height: 32px;
	line-height: 16px;
	padding: 8px 12px;
	margin-right: 8px;
	margin-bottom: 8px;
	cursor: pointer;
}

html .tag-filter.selected {
	background: var(--color-accent);
	color: var(--color-accent-text);
}</STYLE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="RWa722Wd" name="Execute installed packages" run-on-load="true" last-execution-state="success" __wid="Uw9wQXYE"><PRE data-type="content" type="text/javascript" __wid="5tHuAGtD">const SectionPullingUtils = require('#section-pulling-utils');

let liveSelector = document.liveQuerySelectorAll('.section[data-type="package"]');
liveSelector.added((section) => {
	if (Codestrate.loaded) {
		const properties = SectionPullingUtils.getSectionProperties(section);

		let paragraphs = [...section.querySelectorAll('.code-paragraph[run-on-load="true"]')];
		Codestrate.executeParagraphsSync(paragraphs);

		toast(`Installed ${properties.name} package`);
	}
});</PRE></DIV></DIV><DIV class="section section-hidden" data-type="system" data-group="editing" data-id="NhNX5mz9" name="Fullscreen" __wid="shMJCaJ9"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="DExH2kba" draggable="false" __wid="UAG7tnPB"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="YB49iRAK"><H2 __wid="ghaP9Gbt">Description</H2><DIV __wid="TGxmnWLn">This section adds the functionality to view paragraphs in fullscreen. The fullscreen can be toggled in two modes: transient and persisted fullscreen. While in fullscreen the paragraph header is still visible. Upon locking a fullscreen paragraph it will be hidden.</DIV><H3 __wid="hxhrcSu3">Transient Fullscreen</H3><DIV __wid="TnejjzaT">The transient fullscreen is as the name says transient, so only locally. It only adds a transient attribute. It can be activated by clicking on the fullscreen icon in the paragraph header of a section.</DIV><DIV __wid="jXpqzSTS"><B __wid="67JXx3VE">Hint</B>: Activating the transient fullscreen while the persisted fullscreen is active, deactivates the fullscreen just locally.</DIV><H3 __wid="pB3dq4Yn">Persisted Fullscreen</H3><DIV __wid="4D3VuKtd">The persisted fullscreen adds a class to the paragraph, which is currently in fullscreen and therefore toggles it fullescreen on all clients. It can be toggled by long-pressing on the fullscreen icon or pressing the shortcut <KBD __wid="M7vekPTD">Ctrl</KBD>+<KBD __wid="VQAzAYAw">Shift</KBD>+<KBD __wid="F9F52Cmb">F</KBD>.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="S5yMHJz2" __wid="d64qqzZ9"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="Tp4RA3Mf">{
	"version": "1.2",
	"description": "Adds the functionality to view paragraphs in fullscreen.",
	"changelog":
	{
		"1.2": "Commands API used.",
		"1.1.1": "Added documentation.",
		"1.1": "Fixed z-index issue with toolbar.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" name="Paragraph Fullscreen Code" data-id="4nAY6Jw8" draggable="false" run-on-load="true" last-execution-state="success" style __wid="L6MVGMER"><PRE data-type="content" type="text/javascript" __wid="iDfLWi3N">const FullscreenUtils = require("#fullscreen-utils");

/******************************************************************************/

importLib([
	"hammer.min.js",
	"hammer-time.min.js"
]).then(() => {

	const ParagraphUtils = require("#paragraph-utils");

	let addFullscreenButton = (paragraph) => {

		let header = ParagraphUtils.getHeaderElement(paragraph);

		// Make sure to add action only once, e.g. triggered multiple times on paragraph drag and drop
		if (header.querySelector(".action.toggle-fullscreen")) {
			return;
		}

		let action = document.createElement("div");
		action.classList.add("action");
		action.classList.add("toggle-fullscreen");
		action.setAttribute("tooltip", "true");

		let icon = document.createElement("i");
		icon.classList.add("material-icons");
		action.appendChild(icon);
		header.appendChild(action);

		var mc = new Hammer.Manager(action);
		mc.add(new Hammer.Tap({
			event: "tap",
			taps: 1
		}));

		mc.add(new Hammer.Press({
			event: "longpress",
			time: 250
		}));

		mc.on("tap", () => {
			FullscreenUtils.toggleTransientFullscreen(paragraph);
		});
		mc.on("longpress", (event) => {
			FullscreenUtils.togglePersistedFullscreen(paragraph);
		});
	};

	document.liveQuerySelectorAll(".paragraph").added(addFullscreenButton);
});

/******************************************************************************/

Codestrate.addCommand("codestrates.fullscreen", "Fullscreen", (event) => {
	let paragraph;
	if (event !== null && event.target !== null) {
		let target = event.target;
		paragraph = target.closest(".paragraph");
	} else {
		paragraph = Codestrate.focussedParagraph;
	}

	if (!paragraph) {
		paragraph = document.querySelector(".paragraph.fullscreen:not([transient-fullscreen='false']),.paragraph[transient-fullscreen='true']");
	}

	if (paragraph) {
		FullscreenUtils.togglePersistedFullscreen(paragraph);
	}
});
Codestrate.addKeyBinding("codestrates.fullscreen", "ctrl+shift+f", true);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Update Fullscreen Indicator" data-id="mBmpfXnA" style draggable="false" run-on-load="true" last-execution-state="success" __wid="YgHfMqGB"><PRE data-type="content" type="text/javascript" __wid="j265CcMn">const FullscreenUtils = require("#fullscreen-utils");

/******************************************************************************/

let indicator = document.createElement("transient");
indicator.setAttribute("id", "fullscreen-indicator");
indicator.classList.add("hidden");
indicator.addEventListener("click", (event) => {
	let paragraph = document.querySelector(".paragraph.fullscreen");
	FullscreenUtils.setPersistedFullscreen(true, paragraph);
});
document.body.appendChild(indicator);

const updateFullscreenIndicator = () => {
	let persistedFullscreenParagraph = document.querySelector(".paragraph.fullscreen");
	let transientFullscreenParagraph = document.querySelector(".paragraph[transient-fullscreen]");
	// console.log("update here", persistedFullscreenParagraph);

	if (persistedFullscreenParagraph) {
		indicator.setAttribute("name", persistedFullscreenParagraph.getAttribute("name") || "No Name");
	}

	if (persistedFullscreenParagraph && transientFullscreenParagraph) {
		indicator.classList.remove("hidden");
	}
	else {
		indicator.classList.add("hidden");
	}
};

/******************************************************************************/

// Update state for fullscreen indicator
let liveSelector = document.liveQuerySelectorAll(".paragraph.fullscreen");
liveSelector.added(updateFullscreenIndicator);

document.documentElement.liveAttribute("class").changed(updateFullscreenIndicator);
document.documentElement.liveAttribute("transient-fullscreen").changed(updateFullscreenIndicator);</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="SShXZSND" name="Fullscreen Helper" style draggable="false" __wid="Bcrcraz9"><PRE data-type="content" type="text/javascript" id="fullscreen-utils" __wid="CFRpkwXu">const setFullscreen = (paragraph, enable, enableFullscreen, disableFullscreen) => {

	if (paragraph.classList.contains("collapsed")) {
		paragraph.classList.remove("collapsed");
	}

	let paragraphs = document.querySelectorAll(".paragraph.fullscreen,.paragraph[transient-fullscreen]");
	if (enable) {
		// Remove fullscreen from all paragraphs -> just in case
		Array.prototype.forEach.call(paragraphs, (paragraph) => disableFullscreen(paragraph));
		enableFullscreen();
	} else {
		disableFullscreen();

		// Remove fullscreen from all paragraphs -> just in case
		Array.prototype.forEach.call(paragraphs, (paragraph) => disableFullscreen(paragraph));

		// Refresh CodeMirror instances, otherwise they will be collapsed
		const contents = document.querySelectorAll(".section:not(.section-hidden) .paragraph:not(.collapsed) [data-type='content']");
		Array.prototype.forEach.call(contents, (content) => {
			if (content && content.__editor && content.__editor.editor) {
				content.__editor.editor.refresh();
			}
		});
	}
};

const setPersistedFullscreen = (enable, paragraph) => {

	// Disable transient fullscreen when set paragraph to real fullscreen
	if (enable) {
		setTransientFullscreen(false, paragraph, true);
	}

	const enableFullscreen = () => {
		paragraph.classList.add("fullscreen");
		document.body.classList.add("fullscreen");
		document.documentElement.classList.add("fullscreen");
		toast("Persisted fullscreen activated", 1500);
	};

	const disableFullscreen = (paragraph) => {
		if (paragraph) {
			paragraph.classList.remove("fullscreen");
		} else {

			// Replace body fullscreen with html fullscreen
			let documentElement = document.documentElement;
			if (documentElement.classList.contains("fullscreen")) {
				documentElement.classList.remove("fullscreen");
			}

			// @deprecated body fullscreen will be removed because it is replaced
			// by html fullscreen
			let body = document.body;
			if (body.classList.contains("fullscreen")) {
				body.classList.remove("fullscreen");
			}
			toast("Persisted fullscreen deactivated", 1500);
		}
	};

	setFullscreen(paragraph, enable, enableFullscreen, disableFullscreen);
};

const setTransientFullscreen = (enable, paragraph, removeAttribute = false) => {

	const enableFullscreen = () => {
		paragraph.setAttribute("transient-fullscreen", "true");
		document.body.setAttribute("transient-fullscreen", "true");
		document.documentElement.setAttribute("transient-fullscreen", "true");
	};

	const disableFullscreen = (paragraph) => {

		if (paragraph) {
			paragraph.setAttribute("transient-fullscreen", "false");

			if (removeAttribute) {
				paragraph.removeAttribute("transient-fullscreen");
			}
		} else {
			if (removeAttribute) {
				document.documentElement.removeAttribute("transient-fullscreen");
			} else {
				document.documentElement.setAttribute("transient-fullscreen", "false");
			}

			if (removeAttribute) {
				document.body.removeAttribute("transient-fullscreen");
			} else {
				document.body.setAttribute("transient-fullscreen", "false");
			}
		}
	};

	setFullscreen(paragraph, enable, enableFullscreen, disableFullscreen);
};

const togglePersistedFullscreen = (paragraph) => {
	const isFullscreen = paragraph.classList.contains("fullscreen");
	setPersistedFullscreen(!isFullscreen, paragraph);
};

const toggleTransientFullscreen = (paragraph) => {

	const isFullscreen = (
		// Paragraph is in fullscreen but transient-fullscreen is not set
		(
			document.body.classList.contains("fullscreen") &&
			!document.body.hasAttribute("transient-fullscreen")
		) ||
		document.body.matches("[transient-fullscreen='true']")
	);

	setTransientFullscreen(!isFullscreen, paragraph);
};

/******************************************************************************/

exports.setPersistedFullscreen = setPersistedFullscreen;
exports.setTransientFullscreen = setTransientFullscreen;
exports.togglePersistedFullscreen = togglePersistedFullscreen;
exports.toggleTransientFullscreen = toggleTransientFullscreen;</PRE></DIV>
<DIV class="paragraph style-paragraph locked collapsed" data-id="8deBC5eW" name="Fullscreen Indicator" style __wid="8fDuEjzv"><STYLE data-type="content" type="text/css" codemirror="true" contenteditable="false" __wid="mdLrUunq">#fullscreen-indicator {
	position: fixed;
	right: 0;
	top: 100px;
	width: 30px;
	height: 400px;
	cursor: pointer;

	color:  rgba(255, 255, 255, 0.2);
	background: rgba(0, 0, 0, 0.2);
	border-radius: 2px;
	z-index: 201;
}

#fullscreen-indicator:hover {
	color: inherit;
	background: rgba(0, 0, 0, 0.3);
}

#fullscreen-indicator:before {
	padding-left: 7px;
	padding-bottom: 7px;
	content: attr(icon);
	position: relative;
	display: inline-block;
	transform: rotate(90deg) translate3d(0, -100%, 0);
	transform-origin: 0 0 0;

	font-family: "Material Icons";
	font-weight: normal;
	font-style: normal;
	/* font-size: 24px; */
	display: inline-block;
	line-height: 1;
	text-transform: none;
	letter-spacing: normal;
	word-wrap: normal;
	white-space: nowrap;
	direction: ltr;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizeLegibility;
	-moz-osx-font-smoothing: grayscale;
	font-feature-settings: "liga";
}

#fullscreen-indicator:after {
	padding: 5px;
	padding-left: 10px;
	content: attr(name);
	display: inline-block;
	width: 200px;
	position: relative;
	transform: rotate(90deg) translate3d(0, -100%, 0);
	transform-origin: 0 0 0;
}

#fullscreen-indicator.hidden {
	display: none;
}</STYLE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="AXwP6QBU" name="Fullscreen Style" draggable="false" __wid="M5xp9H59"><STYLE data-type="content" type="text/css" codemirror="true" contenteditable="true" class="themable" __wid="qKJMVn44">html body.fullscreen:not([transient-fullscreen="false"]),
html body[transient-fullscreen="true"] {
	overflow: hidden;
}

html body.fullscreen:not([transient-fullscreen="false"]) #snackbar,
html body[transient-fullscreen="true"] #snackbar {
	z-index: 375;
}

html body.fullscreen:not([transient-fullscreen="false"]) .section,
html body[transient-fullscreen="true"] .section {
	width: 0;
	height: 0;
	padding: 0;
	margin: 0;
}

/* Hides section toolbar */
html body.fullscreen:not([transient-fullscreen="false"]) .section .section-header,
html body[transient-fullscreen="true"] .section .section-header {
	opacity: 0;
	pointer-events: none;
}

html .paragraph.fullscreen:not([transient-fullscreen="false"]),
html .paragraph[transient-fullscreen="true"] {
	position: fixed;
	left: 0;
	top: 0;
	bottom: 0;
	right: 0;
	width: 100vw;
	height: 100vh;
	z-index: 300;
	margin: 0;
	background: var(--color-primary-shade-2);
	-webkit-overflow-scrolling: touch; /* enable elastic scroll on touch devices */
}

/* Move transient-fullscreen above fullscreen */
html .paragraph[transient-fullscreen="true"] {
	z-index: 350;
}

/* Prevent input on paragraphs not in fullscreen view */
html body.fullscreen:not([transient-fullscreen="false"]) .paragraph:not(.fullscreen):not([transient-fullscreen="true"]),
html body[transient-fullscreen="true"] .paragraph:not([transient-fullscreen="true"]) {
	pointer-events: none;
}

html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header,
html .paragraph[transient-fullscreen="true"] .paragraph-header {
	position: fixed;
	z-index: 1;
}

/* "Hide" paragraph utils when in locked fullscreen view */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header {
	height: 0;
}

html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header > .toggle-fullscreen:hover,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header > .toggle-fullscreen:hover {
	opacity: 1.0;
}

/* Position toggle fullscreen button in locked fullscreen view */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header > .toggle-fullscreen,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header > .toggle-fullscreen {
	position: absolute;
	top: 15px;
	right: 34px;
	opacity: 0;
	transition: opacity 250ms ease-in-out;
}

html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header > .lock-content:hover,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header > .lock-content:hover {
	opacity: 1.0;
}

/* Position toggle fullscreen button in locked fullscreen view */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header > .lock-content,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header > .lock-content {
	position: absolute;
	top: 15px;
	right: 0;
	opacity: 0;
	transition: opacity 250ms ease-in-out;
}

/* !!! Bug: make actions interactive */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .action,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header .action {
	pointer-events: initial;
}

/* Hide paragraph icon */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header:before,
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header:before {
	display: none;
}

html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .delete-paragraph,
html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .drag-handle,
html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .collapse-expand,
html .paragraph[transient-fullscreen="true"] .paragraph-header .delete-paragraph,
html .paragraph[transient-fullscreen="true"] .paragraph-header .drag-handle,
html .paragraph[transient-fullscreen="true"] .paragraph-header .collapse-expand {
	display: none;
}

/* Hide all paragraph actions excluding lock and toggle fullscreen */
html .paragraph.locked.fullscreen:not([transient-fullscreen="false"]) .paragraph-header > *:not(.lock-content):not(.toggle-fullscreen),
html .paragraph.locked[transient-fullscreen="true"] .paragraph-header > *:not(.lock-content):not(.toggle-fullscreen) {
	display: none;
}

html .paragraph.fullscreen:not([transient-fullscreen="false"]) .CodeMirror,
html .paragraph[transient-fullscreen="true"] .CodeMirror {
	width: 100vw;
	height: 100vh;
	overflow: hidden !important;
	overflow-y: auto;
}


html .paragraph.fullscreen:not([transient-fullscreen="false"]):not(.locked) .CodeMirror,
html .paragraph[transient-fullscreen="true"]:not(.locked) .CodeMirror {
	height: calc(100vh - 30px);
	overflow: auto;
}

/* This is a HACK as text paragraph cannot be scrolled in fullscreen otherwise */
html .paragraph.body-paragraph.fullscreen:not([transient-fullscreen="false"]) [data-type="content"],
html .paragraph.body-paragraph[transient-fullscreen="true"] [data-type="content"] {
	margin: 0;
	padding: 0;
	width: 100vw;
	height: 100vh;
	overflow: auto;
}

/* Move CodeMirror down to make space for fixed paragraph utils */
html .paragraph.fullscreen:not([transient-fullscreen="false"]):not(.locked) .CodeMirror,
html .paragraph[transient-fullscreen="true"]:not(.locked) .CodeMirror,
html .paragraph.fullscreen:not([transient-fullscreen="false"]):not(.locked) [data-type="content"],
html .paragraph[transient-fullscreen="true"]:not(.locked) [data-type="content"] {
	margin-top: 30px;
}

/******************************************************************************/

/* Icon Fullscreen */
html .paragraph .paragraph-header .toggle-fullscreen i:after {
	content: "fullscreen";
}

/* Tooltip Fullscreen */
html .paragraph .paragraph-header .toggle-fullscreen:after {
	content: "Fullscreen";
}

/* Icon Exit Fullscreen */
html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .toggle-fullscreen i:after,
html .paragraph[transient-fullscreen="true"] .paragraph-header .toggle-fullscreen i:after {
	content: "fullscreen_exit";
}

/* Tooltip Exit Fullscreen */
html .paragraph.fullscreen:not([transient-fullscreen="false"]) .paragraph-header .toggle-fullscreen:after,
html .paragraph[transient-fullscreen="true"] .paragraph-header .toggle-fullscreen:after {
	content: "Exit Fullscreen";
}</STYLE></DIV></DIV><DIV class="section section-hidden" name="Code Execution UI" data-type="system" data-group="editing" data-id="q3HngXx6" __wid="RQWD6GB8"><DIV class="paragraph body-paragraph locked collapsed" draggable="false" name="Documentation" data-id="qx646KUk" __wid="gmuT2zyb"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="fR5npvns"><H2 __wid="2hLbBN9D">Description</H2><DIV __wid="mEuBhQAz">TODO</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="RBUbyafL" __wid="Z2AJcnxB"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="R9Z3HBAZ">{
	"version": "1.0",
	"description": "Provides actions on code paragraphs to run code or 'run-on-load'.",
	"changelog":
	{
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph code-paragraph collapsed" draggable="false" style run-on-load="true" name="Paragraph Code Execution Actions" last-execution-state="success" data-id="4JG7preM" __wid="fqrM4WbP"><PRE data-type="content" type="text/javascript" __wid="kffnRFWa">const ParagraphUtils = require("#paragraph-utils");

/******************************************************************************/

const runOnLoadAttributeName = "run-on-load";

const addExecuteAction = (paragraph) => {
	ParagraphUtils.addHeaderAction(paragraph, "execute-paragraph", () => {
		Codestrate.runCode(paragraph);
		toast(`Executing code of paragraph "${paragraph.getAttribute("name") || "No Name"}"`);
	}, {
		tooltip: true
	});
};

const addExecuteOnLoadAction = (paragraph) => {
	ParagraphUtils.addHeaderAction(paragraph, "run-on-load-paragraph", () => {

		if (paragraph.hasAttribute(runOnLoadAttributeName)) {
			paragraph.removeAttribute(runOnLoadAttributeName);
		} else {
			paragraph.setAttribute(runOnLoadAttributeName, "true");
		}
	}, {
		tooltip: true
	});
};

const addToggleConsoleAction = (paragraph) => {
	ParagraphUtils.addHeaderAction(paragraph, "toggle-console-paragraph", () => {
		if (paragraph.console) {
			const console = paragraph.console;
			console.toggle();
		}
	}, {
		tooltip: true
	});
};

/******************************************************************************/

document.liveQuerySelectorAll(".code-paragraph").added(paragraph => {

	// Only apply action to code paragraphs
	if (!paragraph.querySelector("pre[data-type='content']")) return;

	const header = ParagraphUtils.getHeaderElement(paragraph);
	const content = ParagraphUtils.getContentElement(paragraph);
// 	ParagraphUtils.addSelectElement(header, "type", content, []);

	addExecuteOnLoadAction(paragraph);
	addToggleConsoleAction(paragraph);
	addExecuteAction(paragraph);
});</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" name="Code Failure Handling" run-on-load="true" last-execution-state="success" style draggable="false" data-id="yd2ZzdY9" __wid="UzVZPC4u"><PRE data-type="content" type="text/javascript" __wid="Bce85Ghf">Codestrate.addEventListener("successruncode", event => {
	// window.console.log(event);

	const { paragraph } = event;

	paragraph.setAttribute("last-execution-state", "success");
});

Codestrate.addEventListener("errorruncode", event => {
	// window.console.log(event);

	const { paragraph } = event;

	paragraph.setAttribute("last-execution-state", "error");
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Paragraph Code Execution" data-id="HHcUjYwH" draggable="false" __wid="Vbda6k5p"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="MZLvBLfg">html .paragraph .execute-paragraph,
html .paragraph .run-on-load-paragraph,
html .paragraph .toggle-console-paragraph {
	margin-left: 5px;
}

html .paragraph .run-on-load-paragraph {
	margin-right: 10px;
}

html .paragraph[run-on-load] .run-on-load-paragraph.action {
	opacity: 1.0;
	pointer-events: all;
}

/* Icon Execute Code */
html .paragraph .execute-paragraph i:after {
	content: "play_circle_outline";
}

/* Tooltip Execute Code */
html .paragraph .execute-paragraph:after {
	content: "Execute Code";
}

/* Icon Execute Code on Load */
html .paragraph .run-on-load-paragraph i:after {
	content: "directions_run";
}

/* Tooltip Enable Execute Code on Load */
html .paragraph .run-on-load-paragraph:after {
	content: "Enable Execute Code on Load";
}

/* Icon Console */
html .paragraph .toggle-console-paragraph i:after {
	content: "message";
}

/* Tooltip Console */
html .paragraph .toggle-console-paragraph:after {
	content: "Toggle Console";
}

html .paragraph[run-on-load] .run-on-load-paragraph i:after {
	color: var(--material-color-light-green);
}

/* Tooltip Disable Execute Code on Load */
html .paragraph[run-on-load] .run-on-load-paragraph:after {
	content: "Disable Execute Code on Load";
}

html .paragraph[last-execution-state="error"] .toggle-console-paragraph {
	opacity: 1.0;
}

html .paragraph[last-execution-state="error"] .toggle-console-paragraph i:after {
	color: var(--material-color-red);
}

html .paragraph .paragraph-header .type-input {
	opacity: 0;
}

html .paragraph .paragraph-header:hover .type-input {
	opacity: 1;
}

html .paragraph .paragraph-header .type-input:before {
	content: "type: ";
}</STYLE></DIV></DIV><DIV class="section section-hidden" name="CodeMirror" data-type="system" data-group="editing" data-id="w3Chj5iH" __wid="zZtYdJfd"><DIV class="paragraph body-paragraph locked collapsed" draggable="false" name="Documentation" data-id="WFLXUc55" __wid="caK8kBdm"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation hide-variable-names" __wid="D9Hbn6CU"><H2 __wid="X7mKxkzE">Description</H2><DIV __wid="Wzsj5axS">CodeMirror integration, touching the code below should be done with <I __wid="bNPM2tsi">serious </I>care.</DIV><DIV __wid="hyxGpQjG"><BR __wid="V83pMEvA"/></DIV><DIV __wid="6FbcXuWY">Using CodeMirror versionÂ <DIV class="variable" contenteditable="false" data-name="version" __wid="Arx27Ktz"></DIV><SPAN style="font-size: 11pt;" __wid="iW7DVamL">.</SPAN></DIV><H2 __wid="Sp8Csx5R">Modes</H2><DIV __wid="SJfMjWTg"><SPAN style="font-size: 11pt;" __wid="A3nDtzP3"><DIV class="variable" contenteditable="false" data-name="modes" __wid="RCG3w4sR"></DIV></SPAN></DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="Ldb88iyx" __wid="y7xHLvXu"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="N27BycSj">{
	"version": "1.0.1",
	"description": "CodeMirror integration into Codestrates.",
	"changelog":
	{
		"1.0.1": "Added description.",
		"1.0": "Initital Release"
	}
}</PRE></DIV>

<DIV class="paragraph code-paragraph collapsed" draggable="false" name="Base Editor" data-id="CvXXTasc" __wid="DBQAHDSz"><PRE data-type="content" type="text/javascript" id="base-editor" class="editors" __wid="uWYskTeL">const ClientManager = require("#client-manager");

/******************************************************************************/

/**
 * Base class for editors.
 */
class Editor {

	constructor(target, editorOptions) {
		this.target = target;

		const contenteditable = target.getAttribute("contenteditable");
		let readOnly = contenteditable && contenteditable === "false" ? true : false;

		// Allow custom editor options.
		this.editorOptions = Object.assign({
			autoCloseBrackets: true,
			autoCloseTags: true,
			matchBrackets: true,
			matchTags: true,
			styleActiveLine: true,
			/*highlightSelectionMatches: {
				showToken: /\w/
			},*/
			theme: "monokai",
			indentUnit: 2,
			tabSize: 2,
			indentWithTabs: true,
			lineWrapping: true,
			lineNumbers: true,
			extraKeys: {},
			readOnly: readOnly,
			foldGutter: true,
			gutters: ["CodeMirror-lint-markers", "CodeMirror-linenumbers", "CodeMirror-foldgutter"],
			lint: {
				esversion: 6
			},
			rulers: [{column: 80}, {column: 100}]
		}, editorOptions);

		target.liveAttribute("contenteditable").changed(value => {
			let readOnly = value && value === "false" ? true : false;
			//         window.console.log(value, this.editor);
			this.readOnly = readOnly;
		});

		target.liveAttribute("type").changed(mode => {
			// Live attribute is also triggered for inital value when editor has not been instantiated
			if (mode && this.editor) {
				this.editor.setOption("mode", mode);
			}
		});

		// Wait to set mode on codestrateloaded because additional CodeMirror modes
		// can be loaded after CodeMirror integration
		const updateModeOnLoaded = () => {
			let mode = target.getAttribute("type");
			this.editor.setOption("mode", mode);
			window.removeEventListener("codestrateloaded", updateModeOnLoaded);
		};
		window.addEventListener("codestrateloaded", updateModeOnLoaded);

		// This is a hack because the this.editor is available after subclass initialized the CodeMirror editor
		setTimeout(() => {
			let keyMap = this.buildKeyMap();

			// Normalize key map
			let normalizedKeyMap = CodeMirror.normalizeKeyMap(keyMap);

			// A convenient shortcut to format content
			this.editor.addKeyMap(normalizedKeyMap);
		}, 0);

		// Add cursor activity only if target is not in a transient subtree
		if (!target.closest("transient")) {

			// This is a hack because the this.editor is available after subclass initialized the CodeMirror editor
			setTimeout(() => {
				// Shared cursors / markers
				this.editor.on("cursorActivity", () => {
					var range = this.editor.doc.sel.ranges[0];
					target.webstrate.signal(range);
				});

					//	This results in CodeMirror getting focus after blur
// 				// remove selection on blur, CodeMirror otherwise keeps selection active
// 				this.editor.on("blur", () => {
// 					this.editor.setSelection({ line: 0, ch: 0 }, { line: 0, ch: 0});
// 				});

				const markers = {};
				target.webstrate.on("signal", (sel, clientId) => {
					if (clientId === webstrate.clientId) return;

					if (markers[clientId]) markers[clientId].clear();

					const color = ClientManager.getClientColor(clientId);
					const backgroundColor = ClientManager.getClientColorInRGBA(clientId, 0.3);

					if (sel.anchor.line > sel.head.line ||
							(sel.anchor.line == sel.head.line && sel.anchor.ch > sel.head.ch)) { // Backwards selection
						let temp = sel.anchor;
						sel.anchor = sel.head;
						sel.head = temp;
					}

					if (sel.anchor.line == sel.head.line && sel.anchor.ch == sel.head.ch) {
						var widget = document.createElement("span");
						widget.classList.add("remoteCursor");
						widget.setAttribute("style", `outline: 1px solid ${color}`);
						markers[clientId] = this.editor.doc.setBookmark(sel.anchor, {
							widget: widget
						});
					} else {
						markers[clientId] = this.editor.doc.markText(sel.anchor, sel.head, {
							className: "remoteSelection",
							css: `background-color: ${backgroundColor};`
						});
					}
				});

				webstrate.on("clientPart", (clientId) => {
					if (!markers[clientId]) return;
					markers[clientId].clear();
					delete markers[clientId];
				});
			}, 0);
		}
	}

	/**
	 * Returns formatted content.
	 *
	 * @param {string} content Content to format.
	 *
	 * @return {string} Formatted content.
	*/
	formatContent(content) {
		return content;
	}

	buildKeyMap() {

		let keyMap = {
			// Code formatting within paragraph that has focus
			"Shift-Alt-F": (cm) => {
				let content = cm.getValue();
				content = this.formatContent(content);
				cm.setValue(content);
				return true;
			}
		};

		if (Codestrate.OS.isMac()) {
			keyMap = Object.assign({}, keyMap, {
				// Avoid browser save website dialog
				"Cmd-S": (cm) => {
					return true;
				}
			});
		} else {
			keyMap = Object.assign({}, keyMap, {
				// Avoid browser save website dialog
				"Ctrl-S": (cm) => {
					return true;
				}
			});
		}

		return keyMap;
	}

	set readOnly(readOnly) {
		if (this.editor) {
			this.editor.setOption("readOnly", readOnly);
		}
	}

	get readOnly() {
		if (this.editor) {
			return this.editor.getOption("readOnly");
		}
		throw new Error("editor not initialized");
	}
}

exports.Editor = Editor;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Code Editor" data-id="Gy9JEzBe" __wid="hsvAwSXT"><PRE data-type="content" type="text/javascript" id="code-editor" class="editors" __wid="dch5wy6E">const {
  Editor
} = require("#base-editor");

/**
 * Code editor
 */
class CodeEditor extends Editor {

  constructor(target, parent, editorOptions) {

    super(target, editorOptions);

    // window.console.log("default editor");

    this.suppress = false;
    this.timer = null;

    if (parent === undefined) parent = target;

    this.textNode = target.firstChild;

		// the descriptor is necessary to override the textContent property on the text node and to make
		// the editor update when textContent is set through JavaScript
		const textContentDescriptor = Object.getOwnPropertyDescriptor(Node.prototype, "textContent");

    // window.console.log(this.textNode, target);

    if (!this.textNode || this.textNode.nodeType !== 3) {
      console.error("First child node of target is not a text node", target);
      throw Error("First child node of target is not a text node");
    }
    const transient = document.createElement("transient");
    transient.setAttribute("class", "default-editor");

    const textArea = document.createElement("textarea");
    transient.appendChild(textArea);

    // Insert code editor before console
    if (parent.console && parent.console.container) {
      const consoleContainer = parent.console.container;
      parent.insertBefore(transient, consoleContainer);
    } else {
      parent.appendChild(transient);
    }

    this.editor = CodeMirror.fromTextArea(textArea, this.editorOptions);

    this.editor.setValue(this.textNode.textContent);
    setTimeout(() => {
      this.editor.refresh();
    }, 0);

    // Add text events only if target (and text node) is not in a transient subtree
    if (!target.closest("transient")) {

      const insertTextCallback = (pos, val) => {
        this.editor.off("change", editorChangeCallback);
        this.editor.replaceRange(val, this.editor.posFromIndex(pos));
        this.editor.on("change", editorChangeCallback);
      };

      const deleteTextCallback = (pos, val) => {
        var from = this.editor.posFromIndex(pos);
        var to = this.editor.posFromIndex(pos + val.length);
        this.editor.off("change", editorChangeCallback);
        this.editor.replaceRange("", from, to);
        this.editor.on("change", editorChangeCallback);
      };

      this.textNode.webstrate.on("insertText", insertTextCallback);
      this.textNode.webstrate.on("deleteText", deleteTextCallback);

			// overriding the textContent property of the textNode to update the editor whenever content
			// on the text node is set locally through JavaScript
      Object.defineProperty(this.textNode, "textContent", {
        set: (value) => {
// 					window.console.log('textContent is called');
          this.editor.off("change", editorChangeCallback);
          let returnValue = textContentDescriptor.set.call(this.textNode, value);
					this.editor.setValue(this.textNode.textContent);
					setTimeout(() => {
// 						window.console.log('update editor is called');
						this.editor.refresh();
					}, 0);
          this.editor.on("change", editorChangeCallback);
					return returnValue;
        },
				get: () => {
					return textContentDescriptor.get.call(this.textNode);
				}
      });
    }

    const editorChangeCallback = () => {
      var newVal = this.editor.getValue();
      newVal = newVal.length === 0 ? " " : newVal;
			textContentDescriptor.set.call(this.textNode, newVal);
    };

    this.editor.on("change", editorChangeCallback);

    // Update the editor on paste. This fixes a bug that occurs sometimes
    // when pasting large portions of code into the editor.
    this.editor.on("paste", () => {
      setTimeout(() => {
        this.editor.refresh();
      }, 0);
    });
  }

  /**
   * Returns formatted content.
   *
   * @param {string} content Content to format.
   *
   * @return {string} Formatted content.
   */
  formatContent(content) {
    const type = this.editorOptions.mode;

    const beautifyOptions = {
      indent_size: 2,
      indent_char: " ",
      indent_with_tabs: false,
      eol: "\n",
      end_with_newline: false,
      indent_level: 0,
      preserve_newlines: true,
      max_preserve_newlines: 5,
      space_in_paren: false,
      space_in_empty_paren: false,
      jslint_happy: true,
      space_after_anon_function: false,
      brace_style: "collapse",
      break_chained_methods: false,
      keep_array_indentation: false,
      unescape_strings: false,
      wrap_line_length: 0,
      e4x: false,
      comma_first: false,
      operator_position: "before-newline"
    };

    switch (type) {
    case "text/javascript":
      return js_beautify(content, beautifyOptions);
    case "text/css":
      return css_beautify(content, beautifyOptions);
    default:
      console.log(`no beautifier for ${type} installed`);
      break;
    }
    return content;
  }
}
exports.CodeEditor = CodeEditor;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="HTML Editor" draggable="false" data-id="5HXrC3wK" __wid="EcxHxiUj"><PRE data-type="content" type="text/javascript" id="html-editor" class="editors" __wid="rDSDbWsb">const {
	Editor
} = require("#base-editor");

/**
 * HTML editor synchronizing content between contenteditable element and
 * a CodeMirror instance.
 */
class HTMLEditor extends Editor {

	constructor(target, editorOptions) {

		super(target, Object.assign({
			mode: "htmlmixed",
			rulers: false
		}, editorOptions));

		// window.console.log("html editor");

		const parent = target.parentElement;

		const transient = document.createElement("transient");
		transient.setAttribute("class", "html-editor hidden");

		const textArea = document.createElement("textarea");
		transient.appendChild(textArea);

		// Insert code editor before console
		if (parent.console && parent.console.container) {
			const consoleContainer = parent.console.container;
			parent.insertBefore(transient, consoleContainer);
		} else {
			parent.appendChild(transient);
		}

		this.editor = CodeMirror.fromTextArea(textArea, this.editorOptions);

		this.updateEditor = () => {
			let html = target.innerHTML;
			this.editor.setValue(html);
			setTimeout(() => {
				this.editor.refresh();
			}, 0);
		};

		let observer;
		this.enableMutationObserver = () => {

			// Only allow one observer
			if (observer) return;

			// Listen to any updates that happen inside of the target element and update
			// the CodeMirror instance accordingly. For now, any update will override
			// contents of the CodeMirror and transient changes get lost.
			observer = new MutationObserver(mutations => {
				this.updateEditor();
			});
			observer.observe(target, {
				childList: true,
				characterData: true,
				subtree: true,
				attributes: true
			});
		};

		this.disableMutationObserver = () => {
			if (observer) {
				observer.disconnect();
				observer = null;
			}
		};

		// Update the editor on paste. This fixes a bug that occurs sometimes
		// when pasting large portions of code into the editor.
		this.editor.on("paste", () => {
			setTimeout(() => {
				this.editor.refresh();
			}, 0);
		});
	}

	/**
   * Returns formatted content.
   *
   * @param {string} content Content to format.
   *
   * @return {string} Formatted content.
   */
	formatContent(content) {
		return html_beautify(content, {
			indent_size: 2,
			indent_char: " ",
			indent_with_tabs: false,
			eol: "\n",
			end_with_newline: false,
			indent_level: 0,
			preserve_newlines: true,
			max_preserve_newlines: 5,
			space_in_paren: false,
			space_in_empty_paren: false,
			jslint_happy: false,
			space_after_anon_function: false,
			brace_style: "collapse",
			break_chained_methods: false,
			keep_array_indentation: false,
			unescape_strings: false,
			wrap_line_length: 0,
			e4x: false,
			comma_first: false,
			operator_position: "before-newline"
		});
	}

	buildKeyMap() {
		let keyMap = super.buildKeyMap();

		if (Codestrate.OS.isMac()) {
			keyMap = Object.assign({}, keyMap, {
				// A convenient save option to save html instead of showing the open file dialog.
				"Cmd-S": (cm) => {
					this.saveHtml();
				}
			});
		} else {
			keyMap = Object.assign({}, keyMap, {
				// A convenient save option to save html instead of showing the open file dialog.
				"Ctrl-S": (cm) => {
					this.saveHtml();
				}
			});
		}

		return keyMap;
	}

	// Save html and persist it with Webstrates
	saveHtml() {
		const cursor = this.editor.getCursor();

		let html = this.editor.getValue();
		this.target.innerHTML = html;

		setTimeout(() => {
			this.editor.setCursor(cursor);
		}, 0);
	}
}

exports.HTMLEditor = HTMLEditor;</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="CodeMirror Integration Code" draggable="false" data-id="yvE9WeT6" run-on-load="true" last-execution-state="success" style __wid="kwVsRHEL"><PRE data-type="content" type="text/javascript" __wid="nRuydcw5">// Import CodeMirror basics style
importStyle([
	"codemirror.css",

	"codemirror-addon-simplescrollbars.css",
	"codemirror-addon-dialog.css", // Remove when using custom dialog implementation
	"codemirror-addon-show-hint.css",
	"codemirror-addon-foldgutter.css",
	"codemirror-addon-matchesonscrollbar.css",
	"codemirror-addon-lint.css",
	"codemirror-addon-merge.css"
]);

importLib([
	"codemirror.js",

	//"codemirror-addon-dialog.js", // use custom dialog implementation

	"codemirror-addon-annotatescrollbar.js",
	"codemirror-addon-simplescrollbars.js",
	"codemirror-addon-scrollpastend.js",

	"codemirror-addon-show-hint.js",
	"codemirror-addon-javascript-hint.js",
	"codemirror-addon-xml-hint.js",
	"codemirror-addon-html-hint.js",
	"codemirror-addon-css-hint.js",
	"codemirror-addon-anyword-hint.js",

	"codemirror-addon-comment.js",
	"codemirror-addon-continuecomment.js",

	"codemirror-addon-foldcode.js",
	"codemirror-addon-foldgutter.js",
	"codemirror-addon-brace-fold.js",
	"codemirror-addon-xml-fold.js",
	"codemirror-addon-markdown-fold.js",
	"codemirror-addon-comment-fold.js",
	"codemirror-addon-indent-fold.js",
	"codemirror-addon-rulers.js",
	"codemirror-addon-merge.js",

	"codemirror-addon-matchbrackets.js",
	"codemirror-addon-matchtags.js",
	"codemirror-addon-closebrackets.js",
	"codemirror-addon-closetag.js",

	"codemirror-addon-searchcursor.js",
	"codemirror-addon-match-highlighter.js",
	"codemirror-addon-matchesonscrollbar.js",
	"codemirror-addon-jump-to-line.js",
	"codemirror-addon-search.js",
	"codemirror-addon-active-line.js",

	"codemirror-linter-jshint.js",
	"codemirror-linter-htmlhint.js",
	"codemirror-linter-csslint.js",
	"codemirror-linter-jsonlint.js",

	//"codemirror-addon-lint.js", // Use transient version instead
	"codemirror-addon-javascript-lint.js",
	"codemirror-addon-html-lint.js",
	"codemirror-addon-css-lint.js",
	"codemirror-addon-json-lint.js",

	"codemirror-mode-xml.js",
	"codemirror-mode-htmlmixed.js",
	"codemirror-mode-javascript.js",
	"codemirror-mode-css.js",
	"codemirror-mode-go.js",
	"codemirror-mode-markdown.js",
	"codemirror-mode-gfm.js",

	"beautify.js",
	"beautify-css.js",
	"beautify-html.js"
]).then(() => {

	// Customized linter that uses transient overlays when hovering over a linter error or linter info
	require("#codemirror-addon-lint-transient");

	// Print CodeMirror version.
	Variable("version").set(`&lt;transient>${CodeMirror.version}&lt;/transient>`);

	// Print installed CodeMirror modes.
	let modes = Object.keys(CodeMirror.modes).filter((m) => m !== "null");
	modes = modes.map(m => { return `&lt;li>${m}&lt;/li>`; }).join("\r\n");
	Variable("modes").set(`&lt;transient>&lt;ul>${modes}&lt;/ul>&lt;/transient>`);

	const { CodeEditor } = require("#code-editor");
	const { HTMLEditor } = require("#html-editor");

	const extraKeys = {
		"Ctrl-Space": "autocomplete",
		"Cmd-/": "toggleComment"
	};

	//////////
	// magic
	//////////

	const sectionSelector = ".section";
	const sectionHiddenClass = "section-hidden";

	const codeSelectors = [
		"pre[type]",
		"*[codemirror='true']"
	];

	const createEditor = function (element) {

		// debugger;

		// window.console.log("create editor for element %o", element);

		if (!element.__editor) {
			const codeType = element.getAttribute("type");

			let editor;
			if ((!codeType || codeType === "text/html") && element.hasAttribute("contenteditable")) {
				editor = new HTMLEditor(element, { extraKeys });
			} else {
				editor = new CodeEditor(element, element.parentElement, {
					mode: codeType,
					extraKeys
				});
			}

			element.__editor = editor;
		}
	};

	const hasCodeType = (node) => {
		return node.matches(codeSelectors.join(","));
	};

	const isSectionVisible = (node) => {
		// Only create editor if section is visible
		const section = node.closest(sectionSelector);
		// console.log("isSectionVisible", section, section.classList.contains(sectionHiddenClass));
		return section && !section.classList.contains(sectionHiddenClass);
	};

	const isCodeEditor = (node) => {
		return hasCodeType(node) && node.__editor;
	};

	const destroyEditor = (node) => {
		node.__editor.editor.toTextArea();
	};

	const magic = (node) => {
		// Continue if section is not visible
		if (!isSectionVisible(node)) return;

		if (!isCodeEditor(node) && hasCodeType(node)) {
			createEditor(node);
		} else {
			const subNodes = node.querySelectorAll(codeSelectors.join(","));
			Array.prototype.forEach.call(subNodes, (subNode) => {

				// Continue if section is not visible
				if (!isSectionVisible(subNode)) return;

				// Ignore sub nodes if any of the ancestor nodes have a class template
				if (subNode.closest(".template")) return;

				if (!isCodeEditor(subNode) && hasCodeType(subNode)) {
					createEditor(subNode);
				}
			});
		}
	};

	document.liveQuerySelectorAll(codeSelectors.join(",")).added(code => {
		// console.log("code", code);
		magic(code);
	});

	document.liveQuerySelectorAll(sectionSelector).added(section => {
		// console.log("section", section);

		section.liveAttribute("class").changed(() => {
			// console.log("section hidden? ", section.classList.contains(sectionHiddenClass));

			if (!section.classList.contains(sectionHiddenClass)) {
				magic(section);
			}
		});
	});
});</PRE></DIV><DIV class="paragraph code-paragraph locked collapsed" draggable="false" name="CodeMirror OpenDialog" run-on-load="true" last-execution-state="success" data-id="Ki28VD7x" __wid="RAPPt5gc"><PRE data-type="content" type="text/javascript" contenteditable="false" __wid="WFnEvZi2">// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

// Open simple dialogs on top of an editor. Relies on dialog.css.

(function(mod) {
  if (typeof exports == "object" && typeof module == "object") // CommonJS
    mod(require("../../lib/codemirror"));
  else if (typeof define == "function" && define.amd) // AMD
    define(["../../lib/codemirror"], mod);
  else // Plain browser env
    mod(CodeMirror);
})(function(CodeMirror) {
  function dialogDiv(cm, template, bottom) {
    var wrap = cm.getWrapperElement();
    var dialog;
    dialog = wrap.appendChild(document.createElement("div"));
    if (bottom)
      dialog.className = "CodeMirror-dialog CodeMirror-dialog-bottom";
    else
      dialog.className = "CodeMirror-dialog CodeMirror-dialog-top";

    if (typeof template == "string") {
      dialog.innerHTML = template;
    } else { // Assuming it's a detached DOM element.
      dialog.appendChild(template);
    }
    return dialog;
  }

  function closeNotification(cm, newVal) {
    if (cm.state.currentNotificationClose)
      cm.state.currentNotificationClose();
    cm.state.currentNotificationClose = newVal;
  }

  CodeMirror.defineExtension("openDialog", function(template, callback, options) {
    if (!options) options = {};

    closeNotification(this, null);

    var dialog = dialogDiv(this, template, options.bottom);
    var closed = false, me = this;
    function close(newVal) {
      if (typeof newVal == 'string') {
        inp.value = newVal;
      } else {
        if (closed) return;
        closed = true;
        dialog.parentNode.removeChild(dialog);
        me.focus();

        if (options.onClose) options.onClose(dialog);
      }
    }

    var inp = dialog.getElementsByTagName("input")[0], button;
    if (inp) {
      inp.focus();

      if (options.value) {
        inp.value = options.value;
        if (options.selectValueOnOpen !== false) {
          inp.select();
        }
      }

      if (options.onInput)
        CodeMirror.on(inp, "input", function(e) { options.onInput(e, inp.value, close);});
      if (options.onKeyUp)
        CodeMirror.on(inp, "keyup", function(e) {options.onKeyUp(e, inp.value, close);});

      CodeMirror.on(inp, "keydown", function(e) {
        if (options && options.onKeyDown && options.onKeyDown(e, inp.value, close)) { return; }
        if (e.keyCode == 27 || (options.closeOnEnter !== false && e.keyCode == 13)) {
          inp.blur();
          CodeMirror.e_stop(e);
          close();
        }
        if (e.keyCode == 13) callback(inp.value, e);
      });

      if (options.closeOnBlur !== false) CodeMirror.on(inp, "blur", close);
    } else if (button = dialog.getElementsByTagName("button")[0]) {
      CodeMirror.on(button, "click", function() {
        close();
        me.focus();
      });

      if (options.closeOnBlur !== false) CodeMirror.on(button, "blur", close);

      button.focus();
    }
    return close;
  });

  CodeMirror.defineExtension("openConfirm", function(template, callbacks, options) {
    closeNotification(this, null);
    var dialog = dialogDiv(this, template, options && options.bottom);
    var buttons = dialog.getElementsByTagName("button");
    var closed = false, me = this, blurring = 1;
    function close() {
      if (closed) return;
      closed = true;
      dialog.parentNode.removeChild(dialog);
      me.focus();
    }
    buttons[0].focus();
    for (var i = 0; i &lt; buttons.length; ++i) {
      var b = buttons[i];
      (function(callback) {
        CodeMirror.on(b, "click", function(e) {
          CodeMirror.e_preventDefault(e);
          close();
          if (callback) callback(me);
        });
      })(callbacks[i]);
      CodeMirror.on(b, "blur", function() {
        --blurring;
        setTimeout(function() { if (blurring &lt;= 0) close(); }, 200);
      });
      CodeMirror.on(b, "focus", function() { ++blurring; });
    }
  });

  /*
   * openNotification
   * Opens a notification, that can be closed with an optional timer
   * (default 5000ms timer) and always closes on click.
   *
   * If a notification is opened while another is opened, it will close the
   * currently opened one and open the new one immediately.
   */
  CodeMirror.defineExtension("openNotification", function(template, options) {
    closeNotification(this, close);
    var dialog = dialogDiv(this, template, options && options.bottom);
    var closed = false, doneTimer;
    var duration = options && typeof options.duration !== "undefined" ? options.duration : 5000;

    function close() {
      if (closed) return;
      closed = true;
      clearTimeout(doneTimer);
      dialog.parentNode.removeChild(dialog);
    }

    CodeMirror.on(dialog, 'click', function(e) {
      CodeMirror.e_preventDefault(e);
      close();
    });

    if (duration)
      doneTimer = setTimeout(close, duration);

    return close;
  });
});</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Editor Utils" data-id="Sc5xz6BJ" __wid="w8TSbn3Z"><PRE data-type="content" type="text/javascript" id="editor-utils" __wid="XmTmHdTa">exports.editorDragDrop = (bool) => {
	const contents = document.querySelectorAll("[data-type='content']");
	Array.prototype.forEach.call(contents, (content) => {
		if (content.__editor) {
			content.__editor.editor.setOption("dragDrop", bool);
		}
	});
};</PRE></DIV><DIV class="paragraph code-paragraph locked collapsed" name="Codemirror Addon Lint Transient" data-id="tLZkwit3" __wid="HcWQ2akb"><PRE data-type="content" type="text/javascript" id="codemirror-addon-lint-transient" contenteditable="false" __wid="g2t8s3dd">// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

(function(mod) {
  if (typeof exports == "object" && typeof module == "object") // CommonJS
    mod(require("../../lib/codemirror"));
  else if (typeof define == "function" && define.amd) // AMD
    define(["../../lib/codemirror"], mod);
  else // Plain browser env
    mod(CodeMirror);
})(function(CodeMirror) {
  "use strict";
  var GUTTER_ID = "CodeMirror-lint-markers";

  function showTooltip(e, content) {
    var tt = document.createElement("div");
    tt.className = "CodeMirror-lint-tooltip";
    tt.appendChild(content.cloneNode(true));
    //document.body.appendChild(tt);
		var transient = document.createElement("transient");
		transient.appendChild(tt);
		document.body.appendChild(transient);

    function position(e) {
      if (!tt.parentNode) return CodeMirror.off(document, "mousemove", position);
      tt.style.top = Math.max(0, e.clientY - tt.offsetHeight - 5) + "px";
      tt.style.left = (e.clientX + 5) + "px";
    }
    CodeMirror.on(document, "mousemove", position);
    position(e);
    if (tt.style.opacity != null) tt.style.opacity = 1;
    return tt;
  }
  function rm(elt) {
    //if (elt.parentNode) elt.parentNode.removeChild(elt);
		var pelt = elt.parentNode;
		if (pelt) {
			if (pelt.parentNode) pelt.parentNode.removeChild(pelt);
		}
  }
  function hideTooltip(tt) {
    if (!tt.parentNode) return;
    if (tt.style.opacity == null) rm(tt);
    tt.style.opacity = 0;
    setTimeout(function() { rm(tt); }, 600);
  }

  function showTooltipFor(e, content, node) {
    var tooltip = showTooltip(e, content);
    function hide() {
      CodeMirror.off(node, "mouseout", hide);
      if (tooltip) { hideTooltip(tooltip); tooltip = null; }
    }
    var poll = setInterval(function() {
      if (tooltip) for (var n = node;; n = n.parentNode) {
        if (n && n.nodeType == 11) n = n.host;
        if (n == document.body) return;
        if (!n) { hide(); break; }
      }
      if (!tooltip) return clearInterval(poll);
    }, 400);
    CodeMirror.on(node, "mouseout", hide);
  }

  function LintState(cm, options, hasGutter) {
    this.marked = [];
    this.options = options;
    this.timeout = null;
    this.hasGutter = hasGutter;
    this.onMouseOver = function(e) { onMouseOver(cm, e); };
    this.waitingFor = 0
  }

  function parseOptions(_cm, options) {
    if (options instanceof Function) return {getAnnotations: options};
    if (!options || options === true) options = {};
    return options;
  }

  function clearMarks(cm) {
    var state = cm.state.lint;
    if (state.hasGutter) cm.clearGutter(GUTTER_ID);
    for (var i = 0; i &lt; state.marked.length; ++i)
      state.marked[i].clear();
    state.marked.length = 0;
  }

  function makeMarker(labels, severity, multiple, tooltips) {
    var marker = document.createElement("div"), inner = marker;
    marker.className = "CodeMirror-lint-marker-" + severity;
    if (multiple) {
      inner = marker.appendChild(document.createElement("div"));
      inner.className = "CodeMirror-lint-marker-multiple";
    }

    if (tooltips != false) CodeMirror.on(inner, "mouseover", function(e) {
      showTooltipFor(e, labels, inner);
    });

    return marker;
  }

  function getMaxSeverity(a, b) {
    if (a == "error") return a;
    else return b;
  }

  function groupByLine(annotations) {
    var lines = [];
    for (var i = 0; i &lt; annotations.length; ++i) {
      var ann = annotations[i], line = ann.from.line;
      (lines[line] || (lines[line] = [])).push(ann);
    }
    return lines;
  }

  function annotationTooltip(ann) {
    var severity = ann.severity;
    if (!severity) severity = "error";
    var tip = document.createElement("div");
    tip.className = "CodeMirror-lint-message-" + severity;
    if (typeof ann.messageHTML != 'undefined') {
        tip.innerHTML = ann.messageHTML;
    } else {
        tip.appendChild(document.createTextNode(ann.message));
    }
    return tip;
  }

  function lintAsync(cm, getAnnotations, passOptions) {
    var state = cm.state.lint
    var id = ++state.waitingFor
    function abort() {
      id = -1
      cm.off("change", abort)
    }
    cm.on("change", abort)
    getAnnotations(cm.getValue(), function(annotations, arg2) {
      cm.off("change", abort)
      if (state.waitingFor != id) return
      if (arg2 && annotations instanceof CodeMirror) annotations = arg2
      updateLinting(cm, annotations)
    }, passOptions, cm);
  }

  function startLinting(cm) {
    var state = cm.state.lint, options = state.options;
    /*
     * Passing rules in `options` property prevents JSHint (and other linters) from complaining
     * about unrecognized rules like `onUpdateLinting`, `delay`, `lintOnChange`, etc.
     */
    var passOptions = options.options || options;
    var getAnnotations = options.getAnnotations || cm.getHelper(CodeMirror.Pos(0, 0), "lint");
    if (!getAnnotations) return;
    if (options.async || getAnnotations.async) {
      lintAsync(cm, getAnnotations, passOptions)
    } else {
      var annotations = getAnnotations(cm.getValue(), passOptions, cm);
      if (!annotations) return;
      if (annotations.then) annotations.then(function(issues) {
        updateLinting(cm, issues);
      });
      else updateLinting(cm, annotations);
    }
  }

  function updateLinting(cm, annotationsNotSorted) {
    clearMarks(cm);
    var state = cm.state.lint, options = state.options;

    var annotations = groupByLine(annotationsNotSorted);

    for (var line = 0; line &lt; annotations.length; ++line) {
      var anns = annotations[line];
      if (!anns) continue;

      var maxSeverity = null;
      var tipLabel = state.hasGutter && document.createDocumentFragment();

      for (var i = 0; i &lt; anns.length; ++i) {
        var ann = anns[i];
        var severity = ann.severity;
        if (!severity) severity = "error";
        maxSeverity = getMaxSeverity(maxSeverity, severity);

        if (options.formatAnnotation) ann = options.formatAnnotation(ann);
        if (state.hasGutter) tipLabel.appendChild(annotationTooltip(ann));

        if (ann.to) state.marked.push(cm.markText(ann.from, ann.to, {
          className: "CodeMirror-lint-mark-" + severity,
          __annotation: ann
        }));
      }

      if (state.hasGutter)
        cm.setGutterMarker(line, GUTTER_ID, makeMarker(tipLabel, maxSeverity, anns.length > 1,
                                                       state.options.tooltips));
    }
    if (options.onUpdateLinting) options.onUpdateLinting(annotationsNotSorted, annotations, cm);
  }

  function onChange(cm) {
    var state = cm.state.lint;
    if (!state) return;
    clearTimeout(state.timeout);
    state.timeout = setTimeout(function(){startLinting(cm);}, state.options.delay || 500);
  }

  function popupTooltips(annotations, e) {
    var target = e.target || e.srcElement;
    var tooltip = document.createDocumentFragment();
    for (var i = 0; i &lt; annotations.length; i++) {
      var ann = annotations[i];
      tooltip.appendChild(annotationTooltip(ann));
    }
    showTooltipFor(e, tooltip, target);
  }

  function onMouseOver(cm, e) {
    var target = e.target || e.srcElement;
    if (!/\bCodeMirror-lint-mark-/.test(target.className)) return;
    var box = target.getBoundingClientRect(), x = (box.left + box.right) / 2, y = (box.top + box.bottom) / 2;
    var spans = cm.findMarksAt(cm.coordsChar({left: x, top: y}, "client"));

    var annotations = [];
    for (var i = 0; i &lt; spans.length; ++i) {
      var ann = spans[i].__annotation;
      if (ann) annotations.push(ann);
    }
    if (annotations.length) popupTooltips(annotations, e);
  }

  CodeMirror.defineOption("lint", false, function(cm, val, old) {
    if (old && old != CodeMirror.Init) {
      clearMarks(cm);
      if (cm.state.lint.options.lintOnChange !== false)
        cm.off("change", onChange);
      CodeMirror.off(cm.getWrapperElement(), "mouseover", cm.state.lint.onMouseOver);
      clearTimeout(cm.state.lint.timeout);
      delete cm.state.lint;
    }

    if (val) {
      var gutters = cm.getOption("gutters"), hasLintGutter = false;
      for (var i = 0; i &lt; gutters.length; ++i) if (gutters[i] == GUTTER_ID) hasLintGutter = true;
      var state = cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter);
      if (state.options.lintOnChange !== false)
        cm.on("change", onChange);
      if (state.options.tooltips != false && state.options.tooltips != "gutter")
        CodeMirror.on(cm.getWrapperElement(), "mouseover", state.onMouseOver);

      startLinting(cm);
    }
  });

  CodeMirror.defineExtension("performLint", function() {
    if (this.state.lint) startLinting(this);
  });
});</PRE></DIV>
<DIV class="paragraph style-paragraph collapsed" name="CodeMirror Integration CSS" draggable="false" data-id="xjJqeVWB" __wid="Pq6Pi7zc"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="8pSbfT5Q">html .CodeMirror {
	isolation: isolate;
	height: auto;
	font-family: var(--font-monospace);
	font-size: 0.875rem;
	line-height: 1.25;
	height: auto;
	-webkit-font-smoothing: antialiased;
	clear: both;
}

html .paragraph.body-paragraph > transient.hidden {
	display: none;
}

html .paragraph.body-paragraph transient.html-editor:before {
	content: "HTML of the above body paragraph";
	display: block;
	margin-top: 20px;
	background-color: var(--color-primary-shade-1);
	padding: 4px;
	border-radius: 2px;
	pointer-events: none;
	clear: both;
}

/******************************************************************************/

/* Icon Save HTML */
html .paragraph .paragraph-header .save-html i:after {
	content: "save";
}

/* Tooltip Save HTML */
html .paragraph .paragraph-header .save-html:after {
	content: "Save HTML";
}

html .paragraph .paragraph-header .toggle-html i:after {
	content: "visibility";
}

html .paragraph .paragraph-header .toggle-html:after {
	content: "Toggle HTML Editor";
}</STYLE></DIV>
<DIV class="paragraph style-paragraph collapsed" name="CodeMirror Monokai Theme" draggable="false" data-id="63U8sryX" __wid="Cf4tqGMZ"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="zQr6mwqr">/* Based on Sublime Text's Monokai theme */

html .cm-s-monokai.CodeMirror {
	background: none;
	color: var(--color-primary-text);
}

html .cm-s-monokai .CodeMirror-dialog {
	background: var(--color-primary-shade-1);
}

html .cm-s-monokai.CodeMirror div {

}

html .cm-s-monokai div.CodeMirror-selected {
	background: rgba(var(--color-accent-rgb), 0.1);
}
html .cm-s-monokai .CodeMirror-line::selection,
html .cm-s-monokai .CodeMirror-line > span::selection,
html .cm-s-monokai .CodeMirror-line > span > span::selection {
	background: rgba(73, 72, 62, .99);

}
html .cm-s-monokai .CodeMirror-line::-moz-selection,
html .cm-s-monokai .CodeMirror-line > span::-moz-selection,
html .cm-s-monokai .CodeMirror-line > span > span::-moz-selection {
	background: rgba(73, 72, 62, .99);

}
html .cm-s-monokai .CodeMirror-gutters {
	background: none;
	border-right: 0px;
}

html .cm-s-monokai .CodeMirror-guttermarker {
	color: var(--color-primary-text);
}

html .cm-s-monokai .CodeMirror-guttermarker-subtle {
	color: #d0d0d0;
}

html .cm-s-monokai .CodeMirror-linenumber {
	color:rgb(135, 135, 129);
}

html .cm-s-monokai .CodeMirror-cursor {
	border-left: 1px solid #f8f8f0;
}

html .cm-s-monokai span.cm-comment {
	color: rgb(135, 135, 129);
}

html .cm-s-monokai span.cm-atom {
	color: #ae81ff;
}

html .cm-s-monokai span.cm-number {
	color: #ae81ff;
}


html .cm-s-monokai span.cm-property,
html .cm-s-monokai span.cm-attribute {
	color: #a6e22e;
}

html .cm-s-monokai span.cm-keyword {
	color: rgb(234, 53, 134);
}

html .cm-s-monokai span.cm-builtin {
	color: #66d9ef;
}

html .cm-s-monokai span.cm-string {
	color: #e6db74;
}


html .cm-s-monokai span.cm-variable {
	color: #f8f8f2;
}

html .cm-s-monokai span.cm-variable-2 {
	color: #9effff;
}

html .cm-s-monokai span.cm-variable-3 {
	color: #66d9ef;
}

html .cm-s-monokai span.cm-def {
	color: #fd971f;
}

html .cm-s-monokai span.cm-bracket {
	color: #f8f8f2;
}

html .cm-s-monokai span.cm-tag {
	color: rgb(234, 53, 134);
}

html .cm-s-monokai span.cm-header {
	color: #ae81ff;
}

html .cm-s-monokai span.cm-link {
	color: #ae81ff;
}

html .cm-s-monokai span.cm-error {
	background: rgb(234, 53, 134);
	color: #f8f8f0;
}

html .cm-s-monokai .CodeMirror-activeline-background {
	background: rgba(var(--color-accent-rgb), 0.05);
}

html .paragraph.locked .cm-s-monokai .CodeMirror-activeline-background {
	display: none;
}

html .cm-s-monokai .CodeMirror-matchingbracket {
	text-decoration: underline;
	color: var(--color-primary-text) !important;
}

html .cm-s-monokai span.cm-matchhighlight {
	background: #353;
}</STYLE></DIV>
<DIV class="paragraph style-paragraph collapsed" data-id="Mf3uBNUQ" name="Tabs, Linebreaks and Rulers" __wid="5aKdSPWb"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" contenteditable="true" __wid="qFJ6Dwh5">html .CodeMirror-rulers {
	color: var(--color-primary-text);
	opacity: 0.1;
	z-index: 2;
	max-height: calc(100% - 8px) !important;
	min-height: calc(100% - 8px) !important;
	top: 0;
	margin: 4px 0;
}

html .cm-tab {
	background: linear-gradient(to right, rgba(0, 0, 0, 0) 5%, var(--color-primary-text) 6%, var(--color-primary-text) 95%, rgba(0, 0, 0, 0) 96%);
	height: 0.05em;
	vertical-align: middle;
	opacity: 0.2;
}

/*html .CodeMirror-code > div > pre > span::after, .CodeMirror-line > span::after {
	content: "Â¬";
	color: var(--color-primary-text);
	opacity: 0.2;
}*/</STYLE></DIV></DIV><DIV name="Assets" class="section section-hidden" data-type="system" data-id="yfRLVs2U" __wid="TW8L9xDb"><DIV class="paragraph body-paragraph locked collapsed" name="Documentation" data-id="uyJ3rDdC" style __wid="5Z4He8Hf"><DIV data-type="content" contenteditable="false" class="section-documentation" type="text/html" codemirror="true" __wid="qZMvbmcN"><H2 __wid="a8YvL7rU">Description</H2><DIV __wid="BK3vwrz3">TODO</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" name="Properties" data-id="xCRkA7iz" __wid="94T2rJaw"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="iLHjSZye">{
	"version": "1.1",
	"description": "Adds utils to upload and drop files as Webstrates assets.",
	"changelog":
	{
		"1.1": "Moved 'add file' action to text tools package.",
		"1.0": "Initital Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Asset Utils Code" draggable="false" style data-id="ZEUFBDeK" __wid="SPacvyUZ"><PRE data-type="content" type="text/javascript" id="asset-utils" __wid="XnmGRKH4">// 1024 bytes * 1024 kB * 100 => 100 MB
const MAX_FILE_SIZE = 1024 * 1024 * 100;
const MAX_PREVIEW_FILE_SIZE = 1024 * 1024 * 20;

const acceptFileOrThrowError = (file) => {
	if (file.size > MAX_FILE_SIZE) {
		throw new Error(`File size of ${file.name} is to large. Maximum file size is ${MAX_FILE_SIZE} bytes.`);
	}

	return true;
};

/******************************************************************************/

exports.uploadFiles = (files, onUploaded, onBeforeUpload, onError) => {

	if (files.length === 0) {
		return;
	}

	files.forEach((file) => {

		try {
			acceptFileOrThrowError(file);

			// window.console.log("file", file);

			const uuid = Codestrate.util.randomString();

			const reader = new FileReader();
			reader.onload = function (e) {
				const asset = {
					uuid: uuid,
					fileName: file.name,
					mimeType: file.type,
					source: e.target.result
				};

				if (file.size &lt;= MAX_PREVIEW_FILE_SIZE) {
					if (typeof onBeforeUpload === "function") {
						onBeforeUpload(asset);
					}
				}

				const formData = new FormData();
				formData.append("file", file, file.name);

				const request = new XMLHttpRequest();
				request.open("POST", window.location.pathname);
				request.send(formData);
				request.addEventListener("load", (e) => {
					const asset = JSON.parse(request.responseText);
					asset.uuid = uuid;
					asset.source = asset.fileName;

					onUploaded(asset);
				});
			};
			reader.readAsDataURL(file);
		} catch (error) {
			onError(error);
		}
	});
};

/******************************************************************************/

exports.uploadBlob = (assetName, blob, onBeforeUpload, uploadPath = window.location.pathname) => {

	return new Promise((resolve, reject) => {
		try {
			acceptFileOrThrowError(blob);

			const uuid = Codestrate.util.randomString();

			const asset = {
				uuid: uuid,
				fileName: assetName,
				mimeType: blob.type,
				source: blob
			};

			if (typeof onBeforeUpload === "function") {
				onBeforeUpload(asset);
			}

			const formData = new FormData();
			formData.append("file", blob, assetName);

			const request = new XMLHttpRequest();
			request.open("POST", uploadPath);
			request.send(formData);
			request.addEventListener("load", (e) => {
				const asset = JSON.parse(request.responseText);
				asset.uuid = uuid;
				asset.source = asset.fileName;

				resolve(asset);
			});
		} catch (error) {
			reject(error);
		}
	});
};

/******************************************************************************/

exports.getElementFromAsset = (asset) => {

	let node;

	switch (asset.mimeType) {
		case "image/jpeg":
		case "image/png":
			node = document.createElement("img");
			node.setAttribute("src", asset.source);
			break;
		case "audio/mp3":
			node = document.createElement("audio");
			node.setAttribute("src", asset.source);
			node.setAttribute("controls", "true");
			break;
		case "video/mp4":
			node = document.createElement("video");
			node.setAttribute("src", asset.source);
			node.setAttribute("controls", "true");
			break;
		default:
			node = document.createElement("a");
			node.setAttribute("href", asset.source);
			node.setAttribute("target", "_blank");
			node.innerHTML = asset.source;
			break;
	}

	// Disable (text) selection. It is, for example, necessary to make links clickeable.
	// node.setAttribute("contenteditable", "false");
	return node;
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="pcmfPS8B" name="Asset MIME-Type" draggable="false" style __wid="dvAtHnHz"><PRE data-type="content" type="text/javascript" id="asset-mime-type" __wid="NaPvHzBB">/*
 Copyright (c) 2013 Gildas Lormeau. All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:

 1. Redistributions of source code must retain the above copyright notice,
 this list of conditions and the following disclaimer.

 2. Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in
 the documentation and/or other materials provided with the distribution.

 3. The names of the authors may not be used to endorse or promote products
 derived from this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,
 INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,
 INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,
 INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

(function() {
	"use strict";
	var table = {
		"application" : {
			"andrew-inset" : "ez",
			"annodex" : "anx",
			"atom+xml" : "atom",
			"atomcat+xml" : "atomcat",
			"atomserv+xml" : "atomsrv",
			"bbolin" : "lin",
			"cap" : [ "cap", "pcap" ],
			"cu-seeme" : "cu",
			"davmount+xml" : "davmount",
			"dsptype" : "tsp",
			"ecmascript" : [ "es", "ecma" ],
			"futuresplash" : "spl",
			"hta" : "hta",
			"java-archive" : "jar",
			"java-serialized-object" : "ser",
			"java-vm" : "class",
			"javascript" : "js",
			"m3g" : "m3g",
			"mac-binhex40" : "hqx",
			"mathematica" : [ "nb", "ma", "mb" ],
			"msaccess" : "mdb",
			"msword" : [ "doc", "dot" ],
			"mxf" : "mxf",
			"oda" : "oda",
			"ogg" : "ogx",
			"pdf" : "pdf",
			"pgp-keys" : "key",
			"pgp-signature" : [ "asc", "sig" ],
			"pics-rules" : "prf",
			"postscript" : [ "ps", "ai", "eps", "epsi", "epsf", "eps2", "eps3" ],
			"rar" : "rar",
			"rdf+xml" : "rdf",
			"rss+xml" : "rss",
			"rtf" : "rtf",
			"smil" : [ "smi", "smil" ],
			"xhtml+xml" : [ "xhtml", "xht" ],
			"xml" : [ "xml", "xsl", "xsd" ],
			"xspf+xml" : "xspf",
			"zip" : "zip",
			"vnd.android.package-archive" : "apk",
			"vnd.cinderella" : "cdy",
			"vnd.google-earth.kml+xml" : "kml",
			"vnd.google-earth.kmz" : "kmz",
			"vnd.mozilla.xul+xml" : "xul",
			"vnd.ms-excel" : [ "xls", "xlb", "xlt", "xlm", "xla", "xlc", "xlw" ],
			"vnd.ms-pki.seccat" : "cat",
			"vnd.ms-pki.stl" : "stl",
			"vnd.ms-powerpoint" : [ "ppt", "pps", "pot" ],
			"vnd.oasis.opendocument.chart" : "odc",
			"vnd.oasis.opendocument.database" : "odb",
			"vnd.oasis.opendocument.formula" : "odf",
			"vnd.oasis.opendocument.graphics" : "odg",
			"vnd.oasis.opendocument.graphics-template" : "otg",
			"vnd.oasis.opendocument.image" : "odi",
			"vnd.oasis.opendocument.presentation" : "odp",
			"vnd.oasis.opendocument.presentation-template" : "otp",
			"vnd.oasis.opendocument.spreadsheet" : "ods",
			"vnd.oasis.opendocument.spreadsheet-template" : "ots",
			"vnd.oasis.opendocument.text" : "odt",
			"vnd.oasis.opendocument.text-master" : "odm",
			"vnd.oasis.opendocument.text-template" : "ott",
			"vnd.oasis.opendocument.text-web" : "oth",
			"vnd.openxmlformats-officedocument.spreadsheetml.sheet" : "xlsx",
			"vnd.openxmlformats-officedocument.spreadsheetml.template" : "xltx",
			"vnd.openxmlformats-officedocument.presentationml.presentation" : "pptx",
			"vnd.openxmlformats-officedocument.presentationml.slideshow" : "ppsx",
			"vnd.openxmlformats-officedocument.presentationml.template" : "potx",
			"vnd.openxmlformats-officedocument.wordprocessingml.document" : "docx",
			"vnd.openxmlformats-officedocument.wordprocessingml.template" : "dotx",
			"vnd.smaf" : "mmf",
			"vnd.stardivision.calc" : "sdc",
			"vnd.stardivision.chart" : "sds",
			"vnd.stardivision.draw" : "sda",
			"vnd.stardivision.impress" : "sdd",
			"vnd.stardivision.math" : [ "sdf", "smf" ],
			"vnd.stardivision.writer" : [ "sdw", "vor" ],
			"vnd.stardivision.writer-global" : "sgl",
			"vnd.sun.xml.calc" : "sxc",
			"vnd.sun.xml.calc.template" : "stc",
			"vnd.sun.xml.draw" : "sxd",
			"vnd.sun.xml.draw.template" : "std",
			"vnd.sun.xml.impress" : "sxi",
			"vnd.sun.xml.impress.template" : "sti",
			"vnd.sun.xml.math" : "sxm",
			"vnd.sun.xml.writer" : "sxw",
			"vnd.sun.xml.writer.global" : "sxg",
			"vnd.sun.xml.writer.template" : "stw",
			"vnd.symbian.install" : [ "sis", "sisx" ],
			"vnd.visio" : [ "vsd", "vst", "vss", "vsw" ],
			"vnd.wap.wbxml" : "wbxml",
			"vnd.wap.wmlc" : "wmlc",
			"vnd.wap.wmlscriptc" : "wmlsc",
			"vnd.wordperfect" : "wpd",
			"vnd.wordperfect5.1" : "wp5",
			"x-123" : "wk",
			"x-7z-compressed" : "7z",
			"x-abiword" : "abw",
			"x-apple-diskimage" : "dmg",
			"x-bcpio" : "bcpio",
			"x-bittorrent" : "torrent",
			"x-cbr" : [ "cbr", "cba", "cbt", "cb7" ],
			"x-cbz" : "cbz",
			"x-cdf" : [ "cdf", "cda" ],
			"x-cdlink" : "vcd",
			"x-chess-pgn" : "pgn",
			"x-cpio" : "cpio",
			"x-csh" : "csh",
			"x-debian-package" : [ "deb", "udeb" ],
			"x-director" : [ "dcr", "dir", "dxr", "cst", "cct", "cxt", "w3d", "fgd", "swa" ],
			"x-dms" : "dms",
			"x-doom" : "wad",
			"x-dvi" : "dvi",
			"x-httpd-eruby" : "rhtml",
			"x-font" : "pcf.Z",
			"x-freemind" : "mm",
			"x-gnumeric" : "gnumeric",
			"x-go-sgf" : "sgf",
			"x-graphing-calculator" : "gcf",
			"x-gtar" : [ "gtar", "taz" ],
			"x-hdf" : "hdf",
			"x-httpd-php" : [ "phtml", "pht", "php" ],
			"x-httpd-php-source" : "phps",
			"x-httpd-php3" : "php3",
			"x-httpd-php3-preprocessed" : "php3p",
			"x-httpd-php4" : "php4",
			"x-httpd-php5" : "php5",
			"x-ica" : "ica",
			"x-info" : "info",
			"x-internet-signup" : [ "ins", "isp" ],
			"x-iphone" : "iii",
			"x-iso9660-image" : "iso",
			"x-java-jnlp-file" : "jnlp",
			"x-jmol" : "jmz",
			"x-killustrator" : "kil",
			"x-koan" : [ "skp", "skd", "skt", "skm" ],
			"x-kpresenter" : [ "kpr", "kpt" ],
			"x-kword" : [ "kwd", "kwt" ],
			"x-latex" : "latex",
			"x-lha" : "lha",
			"x-lyx" : "lyx",
			"x-lzh" : "lzh",
			"x-lzx" : "lzx",
			"x-maker" : [ "frm", "maker", "frame", "fm", "fb", "book", "fbdoc" ],
			"x-ms-wmd" : "wmd",
			"x-ms-wmz" : "wmz",
			"x-msdos-program" : [ "com", "exe", "bat", "dll" ],
			"x-msi" : "msi",
			"x-netcdf" : [ "nc", "cdf" ],
			"x-ns-proxy-autoconfig" : [ "pac", "dat" ],
			"x-nwc" : "nwc",
			"x-object" : "o",
			"x-oz-application" : "oza",
			"x-pkcs7-certreqresp" : "p7r",
			"x-python-code" : [ "pyc", "pyo" ],
			"x-qgis" : [ "qgs", "shp", "shx" ],
			"x-quicktimeplayer" : "qtl",
			"x-redhat-package-manager" : "rpm",
			"x-ruby" : "rb",
			"x-sh" : "sh",
			"x-shar" : "shar",
			"x-shockwave-flash" : [ "swf", "swfl" ],
			"x-silverlight" : "scr",
			"x-stuffit" : "sit",
			"x-sv4cpio" : "sv4cpio",
			"x-sv4crc" : "sv4crc",
			"x-tar" : "tar",
			"x-tcl" : "tcl",
			"x-tex-gf" : "gf",
			"x-tex-pk" : "pk",
			"x-texinfo" : [ "texinfo", "texi" ],
			"x-trash" : [ "~", "%", "bak", "old", "sik" ],
			"x-troff" : [ "t", "tr", "roff" ],
			"x-troff-man" : "man",
			"x-troff-me" : "me",
			"x-troff-ms" : "ms",
			"x-ustar" : "ustar",
			"x-wais-source" : "src",
			"x-wingz" : "wz",
			"x-x509-ca-cert" : [ "crt", "der", "cer" ],
			"x-xcf" : "xcf",
			"x-xfig" : "fig",
			"x-xpinstall" : "xpi",
			"applixware" : "aw",
			"atomsvc+xml" : "atomsvc",
			"ccxml+xml" : "ccxml",
			"cdmi-capability" : "cdmia",
			"cdmi-container" : "cdmic",
			"cdmi-domain" : "cdmid",
			"cdmi-object" : "cdmio",
			"cdmi-queue" : "cdmiq",
			"docbook+xml" : "dbk",
			"dssc+der" : "dssc",
			"dssc+xml" : "xdssc",
			"emma+xml" : "emma",
			"epub+zip" : "epub",
			"exi" : "exi",
			"font-tdpfr" : "pfr",
			"gml+xml" : "gml",
			"gpx+xml" : "gpx",
			"gxf" : "gxf",
			"hyperstudio" : "stk",
			"inkml+xml" : [ "ink", "inkml" ],
			"ipfix" : "ipfix",
			"json" : "json",
			"jsonml+json" : "jsonml",
			"lost+xml" : "lostxml",
			"mads+xml" : "mads",
			"marc" : "mrc",
			"marcxml+xml" : "mrcx",
			"mathml+xml" : "mathml",
			"mbox" : "mbox",
			"mediaservercontrol+xml" : "mscml",
			"metalink+xml" : "metalink",
			"metalink4+xml" : "meta4",
			"mets+xml" : "mets",
			"mods+xml" : "mods",
			"mp21" : [ "m21", "mp21" ],
			"mp4" : "mp4s",
			"oebps-package+xml" : "opf",
			"omdoc+xml" : "omdoc",
			"onenote" : [ "onetoc", "onetoc2", "onetmp", "onepkg" ],
			"oxps" : "oxps",
			"patch-ops-error+xml" : "xer",
			"pgp-encrypted" : "pgp",
			"pkcs10" : "p10",
			"pkcs7-mime" : [ "p7m", "p7c" ],
			"pkcs7-signature" : "p7s",
			"pkcs8" : "p8",
			"pkix-attr-cert" : "ac",
			"pkix-crl" : "crl",
			"pkix-pkipath" : "pkipath",
			"pkixcmp" : "pki",
			"pls+xml" : "pls",
			"prs.cww" : "cww",
			"pskc+xml" : "pskcxml",
			"reginfo+xml" : "rif",
			"relax-ng-compact-syntax" : "rnc",
			"resource-lists+xml" : "rl",
			"resource-lists-diff+xml" : "rld",
			"rls-services+xml" : "rs",
			"rpki-ghostbusters" : "gbr",
			"rpki-manifest" : "mft",
			"rpki-roa" : "roa",
			"rsd+xml" : "rsd",
			"sbml+xml" : "sbml",
			"scvp-cv-request" : "scq",
			"scvp-cv-response" : "scs",
			"scvp-vp-request" : "spq",
			"scvp-vp-response" : "spp",
			"sdp" : "sdp",
			"set-payment-initiation" : "setpay",
			"set-registration-initiation" : "setreg",
			"shf+xml" : "shf",
			"sparql-query" : "rq",
			"sparql-results+xml" : "srx",
			"srgs" : "gram",
			"srgs+xml" : "grxml",
			"sru+xml" : "sru",
			"ssdl+xml" : "ssdl",
			"ssml+xml" : "ssml",
			"tei+xml" : [ "tei", "teicorpus" ],
			"thraud+xml" : "tfi",
			"timestamped-data" : "tsd",
			"vnd.3gpp.pic-bw-large" : "plb",
			"vnd.3gpp.pic-bw-small" : "psb",
			"vnd.3gpp.pic-bw-var" : "pvb",
			"vnd.3gpp2.tcap" : "tcap",
			"vnd.3m.post-it-notes" : "pwn",
			"vnd.accpac.simply.aso" : "aso",
			"vnd.accpac.simply.imp" : "imp",
			"vnd.acucobol" : "acu",
			"vnd.acucorp" : [ "atc", "acutc" ],
			"vnd.adobe.air-application-installer-package+zip" : "air",
			"vnd.adobe.formscentral.fcdt" : "fcdt",
			"vnd.adobe.fxp" : [ "fxp", "fxpl" ],
			"vnd.adobe.xdp+xml" : "xdp",
			"vnd.adobe.xfdf" : "xfdf",
			"vnd.ahead.space" : "ahead",
			"vnd.airzip.filesecure.azf" : "azf",
			"vnd.airzip.filesecure.azs" : "azs",
			"vnd.amazon.ebook" : "azw",
			"vnd.americandynamics.acc" : "acc",
			"vnd.amiga.ami" : "ami",
			"vnd.anser-web-certificate-issue-initiation" : "cii",
			"vnd.anser-web-funds-transfer-initiation" : "fti",
			"vnd.antix.game-component" : "atx",
			"vnd.apple.installer+xml" : "mpkg",
			"vnd.apple.mpegurl" : "m3u8",
			"vnd.aristanetworks.swi" : "swi",
			"vnd.astraea-software.iota" : "iota",
			"vnd.audiograph" : "aep",
			"vnd.blueice.multipass" : "mpm",
			"vnd.bmi" : "bmi",
			"vnd.businessobjects" : "rep",
			"vnd.chemdraw+xml" : "cdxml",
			"vnd.chipnuts.karaoke-mmd" : "mmd",
			"vnd.claymore" : "cla",
			"vnd.cloanto.rp9" : "rp9",
			"vnd.clonk.c4group" : [ "c4g", "c4d", "c4f", "c4p", "c4u" ],
			"vnd.cluetrust.cartomobile-config" : "c11amc",
			"vnd.cluetrust.cartomobile-config-pkg" : "c11amz",
			"vnd.commonspace" : "csp",
			"vnd.contact.cmsg" : "cdbcmsg",
			"vnd.cosmocaller" : "cmc",
			"vnd.crick.clicker" : "clkx",
			"vnd.crick.clicker.keyboard" : "clkk",
			"vnd.crick.clicker.palette" : "clkp",
			"vnd.crick.clicker.template" : "clkt",
			"vnd.crick.clicker.wordbank" : "clkw",
			"vnd.criticaltools.wbs+xml" : "wbs",
			"vnd.ctc-posml" : "pml",
			"vnd.cups-ppd" : "ppd",
			"vnd.curl.car" : "car",
			"vnd.curl.pcurl" : "pcurl",
			"vnd.dart" : "dart",
			"vnd.data-vision.rdz" : "rdz",
			"vnd.dece.data" : [ "uvf", "uvvf", "uvd", "uvvd" ],
			"vnd.dece.ttml+xml" : [ "uvt", "uvvt" ],
			"vnd.dece.unspecified" : [ "uvx", "uvvx" ],
			"vnd.dece.zip" : [ "uvz", "uvvz" ],
			"vnd.denovo.fcselayout-link" : "fe_launch",
			"vnd.dna" : "dna",
			"vnd.dolby.mlp" : "mlp",
			"vnd.dpgraph" : "dpg",
			"vnd.dreamfactory" : "dfac",
			"vnd.ds-keypoint" : "kpxx",
			"vnd.dvb.ait" : "ait",
			"vnd.dvb.service" : "svc",
			"vnd.dynageo" : "geo",
			"vnd.ecowin.chart" : "mag",
			"vnd.enliven" : "nml",
			"vnd.epson.esf" : "esf",
			"vnd.epson.msf" : "msf",
			"vnd.epson.quickanime" : "qam",
			"vnd.epson.salt" : "slt",
			"vnd.epson.ssf" : "ssf",
			"vnd.eszigno3+xml" : [ "es3", "et3" ],
			"vnd.ezpix-album" : "ez2",
			"vnd.ezpix-package" : "ez3",
			"vnd.fdf" : "fdf",
			"vnd.fdsn.mseed" : "mseed",
			"vnd.fdsn.seed" : [ "seed", "dataless" ],
			"vnd.flographit" : "gph",
			"vnd.fluxtime.clip" : "ftc",
			"vnd.framemaker" : [ "fm", "frame", "maker", "book" ],
			"vnd.frogans.fnc" : "fnc",
			"vnd.frogans.ltf" : "ltf",
			"vnd.fsc.weblaunch" : "fsc",
			"vnd.fujitsu.oasys" : "oas",
			"vnd.fujitsu.oasys2" : "oa2",
			"vnd.fujitsu.oasys3" : "oa3",
			"vnd.fujitsu.oasysgp" : "fg5",
			"vnd.fujitsu.oasysprs" : "bh2",
			"vnd.fujixerox.ddd" : "ddd",
			"vnd.fujixerox.docuworks" : "xdw",
			"vnd.fujixerox.docuworks.binder" : "xbd",
			"vnd.fuzzysheet" : "fzs",
			"vnd.genomatix.tuxedo" : "txd",
			"vnd.geogebra.file" : "ggb",
			"vnd.geogebra.tool" : "ggt",
			"vnd.geometry-explorer" : [ "gex", "gre" ],
			"vnd.geonext" : "gxt",
			"vnd.geoplan" : "g2w",
			"vnd.geospace" : "g3w",
			"vnd.gmx" : "gmx",
			"vnd.grafeq" : [ "gqf", "gqs" ],
			"vnd.groove-account" : "gac",
			"vnd.groove-help" : "ghf",
			"vnd.groove-identity-message" : "gim",
			"vnd.groove-injector" : "grv",
			"vnd.groove-tool-message" : "gtm",
			"vnd.groove-tool-template" : "tpl",
			"vnd.groove-vcard" : "vcg",
			"vnd.hal+xml" : "hal",
			"vnd.handheld-entertainment+xml" : "zmm",
			"vnd.hbci" : "hbci",
			"vnd.hhe.lesson-player" : "les",
			"vnd.hp-hpgl" : "hpgl",
			"vnd.hp-hpid" : "hpid",
			"vnd.hp-hps" : "hps",
			"vnd.hp-jlyt" : "jlt",
			"vnd.hp-pcl" : "pcl",
			"vnd.hp-pclxl" : "pclxl",
			"vnd.hydrostatix.sof-data" : "sfd-hdstx",
			"vnd.ibm.minipay" : "mpy",
			"vnd.ibm.modcap" : [ "afp", "listafp", "list3820" ],
			"vnd.ibm.rights-management" : "irm",
			"vnd.ibm.secure-container" : "sc",
			"vnd.iccprofile" : [ "icc", "icm" ],
			"vnd.igloader" : "igl",
			"vnd.immervision-ivp" : "ivp",
			"vnd.immervision-ivu" : "ivu",
			"vnd.insors.igm" : "igm",
			"vnd.intercon.formnet" : [ "xpw", "xpx" ],
			"vnd.intergeo" : "i2g",
			"vnd.intu.qbo" : "qbo",
			"vnd.intu.qfx" : "qfx",
			"vnd.ipunplugged.rcprofile" : "rcprofile",
			"vnd.irepository.package+xml" : "irp",
			"vnd.is-xpr" : "xpr",
			"vnd.isac.fcs" : "fcs",
			"vnd.jam" : "jam",
			"vnd.jcp.javame.midlet-rms" : "rms",
			"vnd.jisp" : "jisp",
			"vnd.joost.joda-archive" : "joda",
			"vnd.kahootz" : [ "ktz", "ktr" ],
			"vnd.kde.karbon" : "karbon",
			"vnd.kde.kchart" : "chrt",
			"vnd.kde.kformula" : "kfo",
			"vnd.kde.kivio" : "flw",
			"vnd.kde.kontour" : "kon",
			"vnd.kde.kpresenter" : [ "kpr", "kpt" ],
			"vnd.kde.kspread" : "ksp",
			"vnd.kde.kword" : [ "kwd", "kwt" ],
			"vnd.kenameaapp" : "htke",
			"vnd.kidspiration" : "kia",
			"vnd.kinar" : [ "kne", "knp" ],
			"vnd.koan" : [ "skp", "skd", "skt", "skm" ],
			"vnd.kodak-descriptor" : "sse",
			"vnd.las.las+xml" : "lasxml",
			"vnd.llamagraphics.life-balance.desktop" : "lbd",
			"vnd.llamagraphics.life-balance.exchange+xml" : "lbe",
			"vnd.lotus-1-2-3" : "123",
			"vnd.lotus-approach" : "apr",
			"vnd.lotus-freelance" : "pre",
			"vnd.lotus-notes" : "nsf",
			"vnd.lotus-organizer" : "org",
			"vnd.lotus-screencam" : "scm",
			"vnd.lotus-wordpro" : "lwp",
			"vnd.macports.portpkg" : "portpkg",
			"vnd.mcd" : "mcd",
			"vnd.medcalcdata" : "mc1",
			"vnd.mediastation.cdkey" : "cdkey",
			"vnd.mfer" : "mwf",
			"vnd.mfmp" : "mfm",
			"vnd.micrografx.flo" : "flo",
			"vnd.micrografx.igx" : "igx",
			"vnd.mif" : "mif",
			"vnd.mobius.daf" : "daf",
			"vnd.mobius.dis" : "dis",
			"vnd.mobius.mbk" : "mbk",
			"vnd.mobius.mqy" : "mqy",
			"vnd.mobius.msl" : "msl",
			"vnd.mobius.plc" : "plc",
			"vnd.mobius.txf" : "txf",
			"vnd.mophun.application" : "mpn",
			"vnd.mophun.certificate" : "mpc",
			"vnd.ms-artgalry" : "cil",
			"vnd.ms-cab-compressed" : "cab",
			"vnd.ms-excel.addin.macroenabled.12" : "xlam",
			"vnd.ms-excel.sheet.binary.macroenabled.12" : "xlsb",
			"vnd.ms-excel.sheet.macroenabled.12" : "xlsm",
			"vnd.ms-excel.template.macroenabled.12" : "xltm",
			"vnd.ms-fontobject" : "eot",
			"vnd.ms-htmlhelp" : "chm",
			"vnd.ms-ims" : "ims",
			"vnd.ms-lrm" : "lrm",
			"vnd.ms-officetheme" : "thmx",
			"vnd.ms-powerpoint.addin.macroenabled.12" : "ppam",
			"vnd.ms-powerpoint.presentation.macroenabled.12" : "pptm",
			"vnd.ms-powerpoint.slide.macroenabled.12" : "sldm",
			"vnd.ms-powerpoint.slideshow.macroenabled.12" : "ppsm",
			"vnd.ms-powerpoint.template.macroenabled.12" : "potm",
			"vnd.ms-project" : [ "mpp", "mpt" ],
			"vnd.ms-word.document.macroenabled.12" : "docm",
			"vnd.ms-word.template.macroenabled.12" : "dotm",
			"vnd.ms-works" : [ "wps", "wks", "wcm", "wdb" ],
			"vnd.ms-wpl" : "wpl",
			"vnd.ms-xpsdocument" : "xps",
			"vnd.mseq" : "mseq",
			"vnd.musician" : "mus",
			"vnd.muvee.style" : "msty",
			"vnd.mynfc" : "taglet",
			"vnd.neurolanguage.nlu" : "nlu",
			"vnd.nitf" : [ "ntf", "nitf" ],
			"vnd.noblenet-directory" : "nnd",
			"vnd.noblenet-sealer" : "nns",
			"vnd.noblenet-web" : "nnw",
			"vnd.nokia.n-gage.data" : "ngdat",
			"vnd.nokia.n-gage.symbian.install" : "n-gage",
			"vnd.nokia.radio-preset" : "rpst",
			"vnd.nokia.radio-presets" : "rpss",
			"vnd.novadigm.edm" : "edm",
			"vnd.novadigm.edx" : "edx",
			"vnd.novadigm.ext" : "ext",
			"vnd.oasis.opendocument.chart-template" : "otc",
			"vnd.oasis.opendocument.formula-template" : "odft",
			"vnd.oasis.opendocument.image-template" : "oti",
			"vnd.olpc-sugar" : "xo",
			"vnd.oma.dd2+xml" : "dd2",
			"vnd.openofficeorg.extension" : "oxt",
			"vnd.openxmlformats-officedocument.presentationml.slide" : "sldx",
			"vnd.osgeo.mapguide.package" : "mgp",
			"vnd.osgi.dp" : "dp",
			"vnd.osgi.subsystem" : "esa",
			"vnd.palm" : [ "pdb", "pqa", "oprc" ],
			"vnd.pawaafile" : "paw",
			"vnd.pg.format" : "str",
			"vnd.pg.osasli" : "ei6",
			"vnd.picsel" : "efif",
			"vnd.pmi.widget" : "wg",
			"vnd.pocketlearn" : "plf",
			"vnd.powerbuilder6" : "pbd",
			"vnd.previewsystems.box" : "box",
			"vnd.proteus.magazine" : "mgz",
			"vnd.publishare-delta-tree" : "qps",
			"vnd.pvi.ptid1" : "ptid",
			"vnd.quark.quarkxpress" : [ "qxd", "qxt", "qwd", "qwt", "qxl", "qxb" ],
			"vnd.realvnc.bed" : "bed",
			"vnd.recordare.musicxml" : "mxl",
			"vnd.recordare.musicxml+xml" : "musicxml",
			"vnd.rig.cryptonote" : "cryptonote",
			"vnd.rn-realmedia" : "rm",
			"vnd.rn-realmedia-vbr" : "rmvb",
			"vnd.route66.link66+xml" : "link66",
			"vnd.sailingtracker.track" : "st",
			"vnd.seemail" : "see",
			"vnd.sema" : "sema",
			"vnd.semd" : "semd",
			"vnd.semf" : "semf",
			"vnd.shana.informed.formdata" : "ifm",
			"vnd.shana.informed.formtemplate" : "itp",
			"vnd.shana.informed.interchange" : "iif",
			"vnd.shana.informed.package" : "ipk",
			"vnd.simtech-mindmapper" : [ "twd", "twds" ],
			"vnd.smart.teacher" : "teacher",
			"vnd.solent.sdkm+xml" : [ "sdkm", "sdkd" ],
			"vnd.spotfire.dxp" : "dxp",
			"vnd.spotfire.sfs" : "sfs",
			"vnd.stepmania.package" : "smzip",
			"vnd.stepmania.stepchart" : "sm",
			"vnd.sus-calendar" : [ "sus", "susp" ],
			"vnd.svd" : "svd",
			"vnd.syncml+xml" : "xsm",
			"vnd.syncml.dm+wbxml" : "bdm",
			"vnd.syncml.dm+xml" : "xdm",
			"vnd.tao.intent-module-archive" : "tao",
			"vnd.tcpdump.pcap" : [ "pcap", "cap", "dmp" ],
			"vnd.tmobile-livetv" : "tmo",
			"vnd.trid.tpt" : "tpt",
			"vnd.triscape.mxs" : "mxs",
			"vnd.trueapp" : "tra",
			"vnd.ufdl" : [ "ufd", "ufdl" ],
			"vnd.uiq.theme" : "utz",
			"vnd.umajin" : "umj",
			"vnd.unity" : "unityweb",
			"vnd.uoml+xml" : "uoml",
			"vnd.vcx" : "vcx",
			"vnd.visionary" : "vis",
			"vnd.vsf" : "vsf",
			"vnd.webturbo" : "wtb",
			"vnd.wolfram.player" : "nbp",
			"vnd.wqd" : "wqd",
			"vnd.wt.stf" : "stf",
			"vnd.xara" : "xar",
			"vnd.xfdl" : "xfdl",
			"vnd.yamaha.hv-dic" : "hvd",
			"vnd.yamaha.hv-script" : "hvs",
			"vnd.yamaha.hv-voice" : "hvp",
			"vnd.yamaha.openscoreformat" : "osf",
			"vnd.yamaha.openscoreformat.osfpvg+xml" : "osfpvg",
			"vnd.yamaha.smaf-audio" : "saf",
			"vnd.yamaha.smaf-phrase" : "spf",
			"vnd.yellowriver-custom-menu" : "cmp",
			"vnd.zul" : [ "zir", "zirz" ],
			"vnd.zzazz.deck+xml" : "zaz",
			"voicexml+xml" : "vxml",
			"widget" : "wgt",
			"winhlp" : "hlp",
			"wsdl+xml" : "wsdl",
			"wspolicy+xml" : "wspolicy",
			"x-ace-compressed" : "ace",
			"x-authorware-bin" : [ "aab", "x32", "u32", "vox" ],
			"x-authorware-map" : "aam",
			"x-authorware-seg" : "aas",
			"x-blorb" : [ "blb", "blorb" ],
			"x-bzip" : "bz",
			"x-bzip2" : [ "bz2", "boz" ],
			"x-cfs-compressed" : "cfs",
			"x-chat" : "chat",
			"x-conference" : "nsc",
			"x-dgc-compressed" : "dgc",
			"x-dtbncx+xml" : "ncx",
			"x-dtbook+xml" : "dtb",
			"x-dtbresource+xml" : "res",
			"x-eva" : "eva",
			"x-font-bdf" : "bdf",
			"x-font-ghostscript" : "gsf",
			"x-font-linux-psf" : "psf",
			"x-font-otf" : "otf",
			"x-font-pcf" : "pcf",
			"x-font-snf" : "snf",
			"x-font-ttf" : [ "ttf", "ttc" ],
			"x-font-type1" : [ "pfa", "pfb", "pfm", "afm" ],
			"x-font-woff" : "woff",
			"x-freearc" : "arc",
			"x-gca-compressed" : "gca",
			"x-glulx" : "ulx",
			"x-gramps-xml" : "gramps",
			"x-install-instructions" : "install",
			"x-lzh-compressed" : [ "lzh", "lha" ],
			"x-mie" : "mie",
			"x-mobipocket-ebook" : [ "prc", "mobi" ],
			"x-ms-application" : "application",
			"x-ms-shortcut" : "lnk",
			"x-ms-xbap" : "xbap",
			"x-msbinder" : "obd",
			"x-mscardfile" : "crd",
			"x-msclip" : "clp",
			"x-msdownload" : [ "exe", "dll", "com", "bat", "msi" ],
			"x-msmediaview" : [ "mvb", "m13", "m14" ],
			"x-msmetafile" : [ "wmf", "wmz", "emf", "emz" ],
			"x-msmoney" : "mny",
			"x-mspublisher" : "pub",
			"x-msschedule" : "scd",
			"x-msterminal" : "trm",
			"x-mswrite" : "wri",
			"x-nzb" : "nzb",
			"x-pkcs12" : [ "p12", "pfx" ],
			"x-pkcs7-certificates" : [ "p7b", "spc" ],
			"x-research-info-systems" : "ris",
			"x-silverlight-app" : "xap",
			"x-sql" : "sql",
			"x-stuffitx" : "sitx",
			"x-subrip" : "srt",
			"x-t3vm-image" : "t3",
			"x-tads" : "gam",
			"x-tex" : "tex",
			"x-tex-tfm" : "tfm",
			"x-tgif" : "obj",
			"x-xliff+xml" : "xlf",
			"x-xz" : "xz",
			"x-zmachine" : [ "z1", "z2", "z3", "z4", "z5", "z6", "z7", "z8" ],
			"xaml+xml" : "xaml",
			"xcap-diff+xml" : "xdf",
			"xenc+xml" : "xenc",
			"xml-dtd" : "dtd",
			"xop+xml" : "xop",
			"xproc+xml" : "xpl",
			"xslt+xml" : "xslt",
			"xv+xml" : [ "mxml", "xhvml", "xvml", "xvm" ],
			"yang" : "yang",
			"yin+xml" : "yin",
			"envoy" : "evy",
			"fractals" : "fif",
			"internet-property-stream" : "acx",
			"olescript" : "axs",
			"vnd.ms-outlook" : "msg",
			"vnd.ms-pkicertstore" : "sst",
			"x-compress" : "z",
			"x-compressed" : "tgz",
			"x-gzip" : "gz",
			"x-perfmon" : [ "pma", "pmc", "pml", "pmr", "pmw" ],
			"x-pkcs7-mime" : [ "p7c", "p7m" ],
			"ynd.ms-pkipko" : "pko"
		},
		"audio" : {
			"amr" : "amr",
			"amr-wb" : "awb",
			"annodex" : "axa",
			"basic" : [ "au", "snd" ],
			"flac" : "flac",
			"midi" : [ "mid", "midi", "kar", "rmi" ],
			"mpeg" : [ "mpga", "mpega", "mp2", "mp3", "m4a", "mp2a", "m2a", "m3a" ],
			"mpegurl" : "m3u",
			"ogg" : [ "oga", "ogg", "spx" ],
			"prs.sid" : "sid",
			"x-aiff" : [ "aif", "aiff", "aifc" ],
			"x-gsm" : "gsm",
			"x-ms-wma" : "wma",
			"x-ms-wax" : "wax",
			"x-pn-realaudio" : "ram",
			"x-realaudio" : "ra",
			"x-sd2" : "sd2",
			"x-wav" : "wav",
			"adpcm" : "adp",
			"mp4" : "mp4a",
			"s3m" : "s3m",
			"silk" : "sil",
			"vnd.dece.audio" : [ "uva", "uvva" ],
			"vnd.digital-winds" : "eol",
			"vnd.dra" : "dra",
			"vnd.dts" : "dts",
			"vnd.dts.hd" : "dtshd",
			"vnd.lucent.voice" : "lvp",
			"vnd.ms-playready.media.pya" : "pya",
			"vnd.nuera.ecelp4800" : "ecelp4800",
			"vnd.nuera.ecelp7470" : "ecelp7470",
			"vnd.nuera.ecelp9600" : "ecelp9600",
			"vnd.rip" : "rip",
			"webm" : "weba",
			"x-aac" : "aac",
			"x-caf" : "caf",
			"x-matroska" : "mka",
			"x-pn-realaudio-plugin" : "rmp",
			"xm" : "xm",
			"mid" : [ "mid", "rmi" ]
		},
		"chemical" : {
			"x-alchemy" : "alc",
			"x-cache" : [ "cac", "cache" ],
			"x-cache-csf" : "csf",
			"x-cactvs-binary" : [ "cbin", "cascii", "ctab" ],
			"x-cdx" : "cdx",
			"x-chem3d" : "c3d",
			"x-cif" : "cif",
			"x-cmdf" : "cmdf",
			"x-cml" : "cml",
			"x-compass" : "cpa",
			"x-crossfire" : "bsd",
			"x-csml" : [ "csml", "csm" ],
			"x-ctx" : "ctx",
			"x-cxf" : [ "cxf", "cef" ],
			"x-embl-dl-nucleotide" : [ "emb", "embl" ],
			"x-gamess-input" : [ "inp", "gam", "gamin" ],
			"x-gaussian-checkpoint" : [ "fch", "fchk" ],
			"x-gaussian-cube" : "cub",
			"x-gaussian-input" : [ "gau", "gjc", "gjf" ],
			"x-gaussian-log" : "gal",
			"x-gcg8-sequence" : "gcg",
			"x-genbank" : "gen",
			"x-hin" : "hin",
			"x-isostar" : [ "istr", "ist" ],
			"x-jcamp-dx" : [ "jdx", "dx" ],
			"x-kinemage" : "kin",
			"x-macmolecule" : "mcm",
			"x-macromodel-input" : [ "mmd", "mmod" ],
			"x-mdl-molfile" : "mol",
			"x-mdl-rdfile" : "rd",
			"x-mdl-rxnfile" : "rxn",
			"x-mdl-sdfile" : [ "sd", "sdf" ],
			"x-mdl-tgf" : "tgf",
			"x-mmcif" : "mcif",
			"x-mol2" : "mol2",
			"x-molconn-Z" : "b",
			"x-mopac-graph" : "gpt",
			"x-mopac-input" : [ "mop", "mopcrt", "mpc", "zmt" ],
			"x-mopac-out" : "moo",
			"x-ncbi-asn1" : "asn",
			"x-ncbi-asn1-ascii" : [ "prt", "ent" ],
			"x-ncbi-asn1-binary" : [ "val", "aso" ],
			"x-pdb" : [ "pdb", "ent" ],
			"x-rosdal" : "ros",
			"x-swissprot" : "sw",
			"x-vamas-iso14976" : "vms",
			"x-vmd" : "vmd",
			"x-xtel" : "xtel",
			"x-xyz" : "xyz"
		},
		"image" : {
			"gif" : "gif",
			"ief" : "ief",
			"jpeg" : [ "jpeg", "jpg", "jpe" ],
			"pcx" : "pcx",
			"png" : "png",
			"svg+xml" : [ "svg", "svgz" ],
			"tiff" : [ "tiff", "tif" ],
			"vnd.djvu" : [ "djvu", "djv" ],
			"vnd.wap.wbmp" : "wbmp",
			"x-canon-cr2" : "cr2",
			"x-canon-crw" : "crw",
			"x-cmu-raster" : "ras",
			"x-coreldraw" : "cdr",
			"x-coreldrawpattern" : "pat",
			"x-coreldrawtemplate" : "cdt",
			"x-corelphotopaint" : "cpt",
			"x-epson-erf" : "erf",
			"x-icon" : "ico",
			"x-jg" : "art",
			"x-jng" : "jng",
			"x-nikon-nef" : "nef",
			"x-olympus-orf" : "orf",
			"x-photoshop" : "psd",
			"x-portable-anymap" : "pnm",
			"x-portable-bitmap" : "pbm",
			"x-portable-graymap" : "pgm",
			"x-portable-pixmap" : "ppm",
			"x-rgb" : "rgb",
			"x-xbitmap" : "xbm",
			"x-xpixmap" : "xpm",
			"x-xwindowdump" : "xwd",
			"bmp" : "bmp",
			"cgm" : "cgm",
			"g3fax" : "g3",
			"ktx" : "ktx",
			"prs.btif" : "btif",
			"sgi" : "sgi",
			"vnd.dece.graphic" : [ "uvi", "uvvi", "uvg", "uvvg" ],
			"vnd.dwg" : "dwg",
			"vnd.dxf" : "dxf",
			"vnd.fastbidsheet" : "fbs",
			"vnd.fpx" : "fpx",
			"vnd.fst" : "fst",
			"vnd.fujixerox.edmics-mmr" : "mmr",
			"vnd.fujixerox.edmics-rlc" : "rlc",
			"vnd.ms-modi" : "mdi",
			"vnd.ms-photo" : "wdp",
			"vnd.net-fpx" : "npx",
			"vnd.xiff" : "xif",
			"webp" : "webp",
			"x-3ds" : "3ds",
			"x-cmx" : "cmx",
			"x-freehand" : [ "fh", "fhc", "fh4", "fh5", "fh7" ],
			"x-pict" : [ "pic", "pct" ],
			"x-tga" : "tga",
			"cis-cod" : "cod",
			"pipeg" : "jfif"
		},
		"message" : {
			"rfc822" : [ "eml", "mime", "mht", "mhtml", "nws" ]
		},
		"model" : {
			"iges" : [ "igs", "iges" ],
			"mesh" : [ "msh", "mesh", "silo" ],
			"vrml" : [ "wrl", "vrml" ],
			"x3d+vrml" : [ "x3dv", "x3dvz" ],
			"x3d+xml" : [ "x3d", "x3dz" ],
			"x3d+binary" : [ "x3db", "x3dbz" ],
			"vnd.collada+xml" : "dae",
			"vnd.dwf" : "dwf",
			"vnd.gdl" : "gdl",
			"vnd.gtw" : "gtw",
			"vnd.mts" : "mts",
			"vnd.vtu" : "vtu"
		},
		"text" : {
			"cache-manifest" : [ "manifest", "appcache" ],
			"calendar" : [ "ics", "icz", "ifb" ],
			"css" : "css",
			"csv" : "csv",
			"h323" : "323",
			"html" : [ "html", "htm", "shtml", "stm" ],
			"iuls" : "uls",
			"mathml" : "mml",
			"plain" : [ "txt", "text", "brf", "conf", "def", "list", "log", "in", "bas" ],
			"richtext" : "rtx",
			"scriptlet" : [ "sct", "wsc" ],
			"texmacs" : [ "tm", "ts" ],
			"tab-separated-values" : "tsv",
			"vnd.sun.j2me.app-descriptor" : "jad",
			"vnd.wap.wml" : "wml",
			"vnd.wap.wmlscript" : "wmls",
			"x-bibtex" : "bib",
			"x-boo" : "boo",
			"x-c++hdr" : [ "h++", "hpp", "hxx", "hh" ],
			"x-c++src" : [ "c++", "cpp", "cxx", "cc" ],
			"x-component" : "htc",
			"x-dsrc" : "d",
			"x-diff" : [ "diff", "patch" ],
			"x-haskell" : "hs",
			"x-java" : "java",
			"x-literate-haskell" : "lhs",
			"x-moc" : "moc",
			"x-pascal" : [ "p", "pas" ],
			"x-pcs-gcd" : "gcd",
			"x-perl" : [ "pl", "pm" ],
			"x-python" : "py",
			"x-scala" : "scala",
			"x-setext" : "etx",
			"x-tcl" : [ "tcl", "tk" ],
			"x-tex" : [ "tex", "ltx", "sty", "cls" ],
			"x-vcalendar" : "vcs",
			"x-vcard" : "vcf",
			"n3" : "n3",
			"prs.lines.tag" : "dsc",
			"sgml" : [ "sgml", "sgm" ],
			"troff" : [ "t", "tr", "roff", "man", "me", "ms" ],
			"turtle" : "ttl",
			"uri-list" : [ "uri", "uris", "urls" ],
			"vcard" : "vcard",
			"vnd.curl" : "curl",
			"vnd.curl.dcurl" : "dcurl",
			"vnd.curl.scurl" : "scurl",
			"vnd.curl.mcurl" : "mcurl",
			"vnd.dvb.subtitle" : "sub",
			"vnd.fly" : "fly",
			"vnd.fmi.flexstor" : "flx",
			"vnd.graphviz" : "gv",
			"vnd.in3d.3dml" : "3dml",
			"vnd.in3d.spot" : "spot",
			"x-asm" : [ "s", "asm" ],
			"x-c" : [ "c", "cc", "cxx", "cpp", "h", "hh", "dic" ],
			"x-fortran" : [ "f", "for", "f77", "f90" ],
			"x-opml" : "opml",
			"x-nfo" : "nfo",
			"x-sfv" : "sfv",
			"x-uuencode" : "uu",
			"webviewhtml" : "htt"
		},
		"video" : {
			"3gpp" : "3gp",
			"annodex" : "axv",
			"dl" : "dl",
			"dv" : [ "dif", "dv" ],
			"fli" : "fli",
			"gl" : "gl",
			"mpeg" : [ "mpeg", "mpg", "mpe", "m1v", "m2v", "mp2", "mpa", "mpv2" ],
			"mp4" : [ "mp4", "mp4v", "mpg4" ],
			"quicktime" : [ "qt", "mov" ],
			"ogg" : "ogv",
			"vnd.mpegurl" : [ "mxu", "m4u" ],
			"x-flv" : "flv",
			"x-la-asf" : [ "lsf", "lsx" ],
			"x-mng" : "mng",
			"x-ms-asf" : [ "asf", "asx", "asr" ],
			"x-ms-wm" : "wm",
			"x-ms-wmv" : "wmv",
			"x-ms-wmx" : "wmx",
			"x-ms-wvx" : "wvx",
			"x-msvideo" : "avi",
			"x-sgi-movie" : "movie",
			"x-matroska" : [ "mpv", "mkv", "mk3d", "mks" ],
			"3gpp2" : "3g2",
			"h261" : "h261",
			"h263" : "h263",
			"h264" : "h264",
			"jpeg" : "jpgv",
			"jpm" : [ "jpm", "jpgm" ],
			"mj2" : [ "mj2", "mjp2" ],
			"vnd.dece.hd" : [ "uvh", "uvvh" ],
			"vnd.dece.mobile" : [ "uvm", "uvvm" ],
			"vnd.dece.pd" : [ "uvp", "uvvp" ],
			"vnd.dece.sd" : [ "uvs", "uvvs" ],
			"vnd.dece.video" : [ "uvv", "uvvv" ],
			"vnd.dvb.file" : "dvb",
			"vnd.fvt" : "fvt",
			"vnd.ms-playready.media.pyv" : "pyv",
			"vnd.uvvu.mp4" : [ "uvu", "uvvu" ],
			"vnd.vivo" : "viv",
			"webm" : "webm",
			"x-f4v" : "f4v",
			"x-m4v" : "m4v",
			"x-ms-vob" : "vob",
			"x-smv" : "smv"
		},
		"x-conference" : {
			"x-cooltalk" : "ice"
		},
		"x-world" : {
			"x-vrml" : [ "vrm", "vrml", "wrl", "flr", "wrz", "xaf", "xof" ]
		}
	};

	var mimeTypes = (function() {
		var type, subtype, val, index, mimeTypes = {};
		for (type in table) {
			if (table.hasOwnProperty(type)) {
				for (subtype in table[type]) {
					if (table[type].hasOwnProperty(subtype)) {
						val = table[type][subtype];
						if (typeof val == "string") {
							mimeTypes[val] = type + "/" + subtype;
						} else {
							for (index = 0; index &lt; val.length; index++) {
								mimeTypes[val[index]] = type + "/" + subtype;
							}
						}
					}
				}
			}
		}
		return mimeTypes;
	})();

	exports.getMimeType = function(filename) {
		var defaultValue = "application/octet-stream";
		return filename && mimeTypes[filename.split(".").pop().toLowerCase()] || defaultValue;
	};

})();</PRE></DIV><DIV class="paragraph code-paragraph collapsed" draggable="false" name="Drop Assets Code" data-id="rx3eU4qQ" run-on-load="true" style last-execution-state="success" __wid="tuf47aQU"><PRE data-type="content" type="text/javascript" __wid="KDKR2Zpg">const AssetUtils = require("#asset-utils");

/******************************************************************************/

const handleFileDrop = (event, onUploaded, onBeforeUpload, onError) => {
	const files = Array.from(event.dataTransfer.files);
	AssetUtils.uploadFiles(files, onUploaded, onBeforeUpload, onError);
};

/**
 * Returns true if the drop transfer types contain "Files", and returns false otherwise.
 *
 * @param {Object} event A drop event.
 *
 * @return True if the drop transfer types contain "Files" as type.
 */
const isFileDrop = (event) => {
	if (event.dataTransfer.types) {
		return event.dataTransfer.types.some((type) => type === "Files");
	}
	return false;
};

const addDropListener = (content) => {

	// Listen for a drop
	content.addEventListener("drop", (event) => {

		// console.log("drop here", event);

		// Only continue on file drop
		if (!isFileDrop(event)) return;

		// Prevent the default behavior
		event.preventDefault();

		// Get the position where file(s) where dropped
		const range = document.caretRangeFromPoint(event.clientX, event.clientY);

		/**
		 * Called when asset uploaded completely
		 */
		const onUploaded = (asset) => {
			let node = AssetUtils.getElementFromAsset(asset);

			const uploadInProgress = content.querySelector(`[data-upload-id="${asset.uuid}"]`);

			if (uploadInProgress) {
				uploadInProgress.parentElement.replaceChild(node, uploadInProgress);
			} else {
				range.insertNode(node);
			}
		};

		/**
		 * Called before asset is going to be uploaded
		 */
		const onBeforeUpload = (asset) => {

			let node = AssetUtils.getElementFromAsset(asset);

			const uploadInProgress = document.createElement("transient");
			uploadInProgress.setAttribute("data-upload-id", asset.uuid);
			uploadInProgress.setAttribute("class", "upload-in-progress");
			uploadInProgress.appendChild(node);

			range.insertNode(uploadInProgress);
		};

		/**
		 * Called when an error occurs during drop
		 */
		const onError = (error) => {
			toast(error);
		};

		// Handle file drop with uploaded, before upload, and error callbacks
		handleFileDrop(event, onUploaded, onBeforeUpload, onError);
	});
};

/******************************************************************************/

// Get the text paragraph
var contents = document.liveQuerySelectorAll(".paragraph.body-paragraph [data-type='content']");
contents.added((content) => {
	// console.log("add content", content);
	addDropListener(content);
});</PRE></DIV>

<DIV class="paragraph code-paragraph collapsed" name="Local File System for Upload Assets (unfinished)" last-execution-state="success" style draggable="false" data-id="ZbWviw3z" __wid="uf33dMcR"><PRE data-type="content" type="text/javascript" __wid="w39uwmpU">// https://developer.mozilla.org/en-US/docs/Web/API/File_and_Directory_Entries_API/Introduction

const requestedBytes = 1024 * 1024 * 100; // 100MB

// Taking care of the browser-specific prefix
window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;

const errorHandler = (error) => {
	var msg = "";

	switch (error.code) {
		case FileError.QUOTA_EXCEEDED_ERR:
			msg = "QUOTA_EXCEEDED_ERR";
			break;
		case FileError.NOT_FOUND_ERR:
			msg = "NOT_FOUND_ERR";
			break;
		case FileError.SECURITY_ERR:
			msg = "SECURITY_ERR";
			break;
		case FileError.INVALID_MODIFICATION_ERR:
			msg = "INVALID_MODIFICATION_ERR";
			break;
		case FileError.INVALID_STATE_ERR:
			msg = "INVALID_STATE_ERR";
			break;
		default:
			msg = "Unknown Error";
			break;
	}

	console.error(`Error: ${msg}`, error);
};

const writeFile = async(fs, name, content, type = "text/plain") => {
	return new Promise((resolve, reject) => {
		fs.root.getFile(name, {
			create: true
		}, function (fileEntry) {

			// Create a FileWriter object for our FileEntry (log.txt).
			fileEntry.createWriter(function (fileWriter) {

				fileWriter.onwriteend = function (e) {
					console.log('Write completed.');
					resolve(e);
				};

				fileWriter.onerror = function (e) {
					console.log('Write failed: ' + e.toString());
					reject(e);
				};

				// Create a new Blob and write it to log.txt.
				var blob = new Blob([content], {
					type
				});

				fileWriter.write(blob);

			}, errorHandler);

		}, errorHandler);
	});
};

// Read file
const readFile = async(fs, name) => {
	return new Promise((resolve, reject) => {
		fs.root.getFile(name, {}, (fileEntry) => {

			// Get a File object representing the file,
			// then use FileReader to read its contents.
			fileEntry.file((file) => {
				var reader = new FileReader();

				reader.onloadend = function (e) {
					// var txtArea = document.createElement('textarea');
					// txtArea.value = this.result;
					// document.body.appendChild(txtArea);
					resolve(this.result);
				};

				// This was not part of the example and might not work
				// reader.onerror = function (e) {
				// 	console.log('Read failed: ' + e.toString());
				// 	reject(e);
				// };

				reader.readAsText(file);
			}, errorHandler);
		}, errorHandler);
	});
};

/**
 * name - the unique name assigned by the browser to the file system.
 * root - the read-only DirectoryEntry object representing the root of the file system.
 */
const onInitFs = (fs) => {
	console.log(fs);

	(async() => {
		let fileName = "foobar.txt";
		let content = "hello world"
		await writeFile(fs, fileName, content);
		let fileContent = await readFile(fs, fileName);

		console.log(`"${content}" === "${fileContent}"`, content === fileContent);
	})();
};

// The first parameter defines the type of storage: persistent or temporary
// Next, set the size of space needed (in bytes)
// initFs is the success callback
// And the last one is the error callback
// for denial of access and other errors.
window.requestFileSystem(window.TEMPORARY, requestedBytes, onInitFs, errorHandler);</PRE></DIV><DIV class="paragraph style-paragraph collapsed" draggable="false" name="Drop Assets Style" data-id="smjHTJUJ" __wid="mYk5kxcV"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="LVE9iLak">html .paragraph [data-type="content"] .upload-in-progress {
	opacity: 0.25;
}

html .paragraph [data-type="content"] video,
html .paragraph [data-type="content"] img {
	max-width: 100%;
}</STYLE></DIV></DIV><DIV class="section section-hidden" name="Help Dialog" data-type="system" data-id="33LePuGS" __wid="WmqszSt3"><DIV class="paragraph body-paragraph locked collapsed" data-id="wcNnbcmy" name="Documentation" style draggable="false" __wid="RadaeyZX"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="tFWhhhb5"><H2 __wid="ZXqYCfZC">Description</H2><DIV __wid="n8DK5Ppz">Adds a help dialog, which can be opend pressing "F1" or using the "Help" entry in the global menu. The help dialog shows shortcuts and an introductory video about Codestrates.</DIV></DIV></DIV><DIV class="paragraph data-paragraph locked collapsed" data-id="Ji9ezFPZ" name="Properties" draggable="false" style __wid="d2QTeiRG"><PRE data-type="content" type="application/json" contenteditable="false" class="section-properties" __wid="8gFvMRT6">{
	"version": "1.2",
	"description": "Shows a help dialog with shortcuts and introductory video.",
	"changelog":
	{
		"1.2": "Commands API used.",
		"1.1": "Adjusted to new dialog Material Design.",
		"1.0": "Initital Release"
	}
}</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Shortcuts PC" draggable="false" style data-id="xd63C8ye" __wid="A5wUXYP7"><PRE data-type="content" type="text/javascript" id="shortcuts-pc" __wid="nhiH2k8P">exports.shortcuts = {
	"F1": "This help menu",
	"Shift + Alt + F": "Formats content in a code paragraph",
	"Shift + Tab": "Formats selected content in code paragraphs",
	"Ctrl + F": "Search in a code paragraph",
	"Ctrl + S": "Saves HTML in body paragraph when editing through the HTML editor"
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" data-id="DptM4BZ7" name="Shortcuts Mac" draggable="false" style __wid="NhjHnUNV"><PRE data-type="content" type="text/javascript" id="shortcuts-mac" __wid="dcK9VS84">exports.shortcuts = {
	"F1": "This help menu",
	"Shift + Alt + F": "Formats content in a code paragraph",
	"Shift + Tab": "Formats selected content in code paragraphs",
	"Cmd + F": "Search in a code paragraph",
	"Cmd + S": "Saves HTML in body paragraph when editing through the HTML editor"
};</PRE></DIV><DIV class="paragraph code-paragraph collapsed" name="Help Dialog Code" run-on-load="true" style last-execution-state="success" data-id="wNKv7kCW" __wid="DZdBjckJ"><PRE data-type="content" type="text/javascript" __wid="mPW6WLQC">const GlobalMenuUtils = require("#global-menu-utils");

/******************************************************************************/

const getOSShortcuts = () => {
	if (Codestrate.OS.isMac()) {
		return require("#shortcuts-mac", null, false).shortcuts;
	}
	return require("#shortcuts-pc", null, false).shortcuts;
};

const videoUrl = "Codestrates.mp4";

/******************************************************************************/

const toggleHelp = () => {
	const helpDialog = document.querySelector(".dialog.help");
	if (helpDialog) {
		const transient = helpDialog.parentElement;
		transient.remove();
	} else {
		showHelpDialog();
	}
};

const showHelpDialog = (packageStati) => {

	let shortcuts = getOSShortcuts();

	return new Promise((resolve, reject) => {

		const transient = document.createElement("transient");

		const elements = require("#dialog-template", {
			title: "Help",
			message: `&lt;div id="explanation">
			Codestrates is a research prototype for developing webstrates in a literate computing inspired fashion. It is still under heavy development, and may features are still experimental and undocumented. Below is a short list of the keyboard shortcuts available and a brief intro screencast to the basic features of Codestrates.&lt;br>&lt;br>
			Visit &lt;a href="https://webstrates.github.io" draggable="false">webtrates.github.io&lt;/a> for the documentation of &lt;a href="http://webstrates.net" draggable="false">Webstrates&lt;/a> and for more information about Codestrates visit &lt;a href="http://codestrates.org" draggable="false">codestrates.org&lt;/a>.
		&lt;/div>
		&lt;div id="shortcuts">
			&lt;div class="help-title">Shortcuts&lt;/div>
			&lt;ul>${Object.keys(shortcuts).map(key => `&lt;li>
&lt;span class="key">${key}&lt;/span>
&lt;span class="action">${shortcuts[key]}&lt;/span>
&lt;/li>`).join("")}&lt;/ul>
		&lt;/div>
		&lt;div id="intro">
			&lt;div class="help-title">Introduction video&lt;/div>
			&lt;div class="video">
				&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/7HedZZoFC-s?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen="">&lt;/iframe>
			&lt;/div>
		&lt;/div>`,
			actions: `&lt;div class="button close">Close&lt;/div>`,
			className: "help"
		});

		elements.forEach(e => transient.appendChild(e));

		const closeBtn = transient.querySelector(".close");

		const onClose = () => {
			transient.remove();
			resolve(true);
		};

		closeBtn.addEventListener("click", onClose);

		document.body.appendChild(transient);
	});
};

/******************************************************************************/

Codestrate.addCommand("codestrates.help", "Help", () => {
	toggleHelp();
});
Codestrate.addKeyBinding("codestrates.help", "f1", true);

GlobalMenuUtils.addButton("Help", "help-button", () => {
	Codestrate.executeCommand("codestrates.help");
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" data-id="M5jKghq9" style name="Help Dialog Style" __wid="7WQ4EbnQ"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="k4A25szH">html .dialog.help {
	z-index: 450;
}

html .dialog.help .body {
	width: 70rem;
	max-width: calc(100vw - 32px);
	max-height: calc(100vh - 180px);
}

html .dialog.help #explanation {
	margin-bottom: 24px;
}

html .dialog.help #shortcuts {
	width: 33%;
	float: left;
}

html .dialog.help #intro {
	margin-left: 35%;
}

/******************************************************************************/

html .dialog.help a {
	color: var(--color-secondary-text);
}

html .dialog.help .help-title {
	font-size: 24px;
	margin-bottom: 12px;
}

html .dialog.help #intro .video {
	width: 100%;
	text-align: center;
}

html .dialog.help #shortcuts li {
	margin-bottom: 16px;
}

html .dialog.help #shortcuts .key {
	margin: 0 5px 0 0;
	color: #eee;
	border-radius: 3px;
	padding: 3px 7px;
	min-width: 1em;
	box-shadow: inset 0 0 2px #5a5a5a, 0 0.1em 0.11em rgba(0, 0, 0, 0.9);
	cursor: default;
	background: #000;
	text-align: center;
	text-shadow: none;
	background-color: #101010;
	background-repeat: repeat-x;
	font-family: monospace;
	font-size: 14px;
}

html .dialog.help #shortcuts .action {
	line-height: 150%;
}

/******************************************************************************/

html #global-menu .help-button {
	order: 990;
}</STYLE></DIV></DIV><DIV class="section section-hidden" data-id="4CsvECcC" name="Section Browser" data-type="system" data-group="editing" __wid="n8FvCww5"><DIV class="paragraph body-paragraph locked collapsed" data-id="eRw5qerB" draggable="false" style name="Documentation" __wid="ECagWZCJ"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="false" class="section-documentation" __wid="tVP4n5Zk"><H2 __wid="ycQHwEjY">Description</H2><DIV __wid="Nc6mEgJh">This is a prototype implementation of a section browser in the side menu.</DIV><H2 __wid="acMvhtGr">Usage</H2><DIV __wid="Ujr3xJBK"><UL __wid="QSi8xvmT"><LI __wid="T4bEXBsP">Click sections to expand/collapse</LI><LI __wid="bzn8aaDE">Click paragraph to scroll them into view</LI><LI __wid="Cv5DJsRG">Click section eye to toggle visbility</LI></UL><H2 __wid="mxUCAqqY">Bugs, ideas and ToDo</H2></DIV><DIV __wid="hW3kkyBP"><UL __wid="tHfVhAsf"><LI __wid="XjKaSLtj"><STRIKE __wid="CfYNvvhY">Refresh CodeMirror instances on visibility change</STRIKE></LI><LI __wid="ayXjY8Pj"><STRIKE __wid="AgtKaQ2h">Toggle visibility and expand paragraph when clicking a paragraph</STRIKE></LI><LI __wid="pNNEYfgR">Integrate properly in Roman's sidebar code<BR __wid="gfpXEWUn"/></LI><LI __wid="UbGNiwbQ"><STRIKE __wid="tbHkdPHh">Overflow of sections with many paragraphs. Scrolling?</STRIKE></LI><LI __wid="W25WYtcD">Disable scrolling of main window when scrolling in section tree. But how?</LI></UL></DIV></DIV></DIV><DIV class="paragraph data-paragraph collapsed locked" data-id="b24ajcq7" name="Properties" __wid="6YuTeYQk"><PRE data-type="content" type="application/json" class="section-properties" contenteditable="false" __wid="CcffrRJm">{
	"version": "1.2.1",
	"description": "This is a prototype implementation of a section browser in the side menu.",
	"changelog":
	{
		"1.0": "Initital Release",
		"1.1": "Adjusted style a bit.",
		"1.2": "Added toggle to hide user, system or package sections.",
		"1.2.1": "Fixed issue with section-visible or section-hidden."
	}
}</PRE></DIV>

<DIV class="paragraph body-paragraph collapsed" data-id="srnWpw3v" name="Description" style draggable="false" __wid="gPQkD4aZ"><DIV data-type="content" type="text/html" codemirror="true" contenteditable="true" __wid="9UckrVpv"><H1 __wid="7QFaSHsS">Section browser</H1><DIV __wid="xJkgiKsN">This is a prototype implementation of a section browser in the side menu.</DIV><DIV __wid="5B6ee9pb"><BR __wid="3JqsfV52"/></DIV><DIV __wid="cjsTD7LR">Usage:</DIV><DIV __wid="DetnBbCb"><UL __wid="7FepBZqT"><LI __wid="StRRCLtL">Click sections to expand/collapse</LI><LI __wid="PPmQBJzf">Click paragraph to scroll them into view</LI><LI __wid="JtqHtNAc">Click section eye to toggle visbility</LI></UL><DIV __wid="jC8MfPCF">Bugs, ideas and ToDo</DIV></DIV><DIV __wid="zQGVfAiU"><UL __wid="Qd5KGjpJ"><LI __wid="trFq7e6X"><STRIKE __wid="LTL2fxSf">Refresh CodeMirror instances on visibility change</STRIKE></LI><LI __wid="P2Kj6WBZ"><STRIKE __wid="NeD8c6J6">Toggle visibility and expand paragraph when clicking a paragraph</STRIKE></LI><LI __wid="zLNY3isX">Integrate properly in Roman's sidebar code<BR __wid="NxAfwdfK"/></LI><LI __wid="h8grPPrS"><STRIKE __wid="7U93e6t8">Overflow of sections with many paragraphs. Scrolling?</STRIKE></LI><LI __wid="NgNJn4Df">Disable scrolling of main window when scrolling in section tree. But how?</LI></UL></DIV></DIV></DIV><DIV class="paragraph code-paragraph collapsed" data-id="VyGHLw6Z" style name="Global Menu Section Tree" run-on-load="true" last-execution-state="success" draggable="false" __wid="qhqi96Uq"><PRE data-type="content" type="text/javascript" __wid="7aiKqv9i">const GlobalMenuUtils = require("#global-menu-utils");

/******************************************************************************/

const sectionTree = document.createElement("ul");
sectionTree.id = "section-tree";

GlobalMenuUtils.addMenuItem(sectionTree);
GlobalMenuUtils.addDivider("section-tree");</PRE></DIV>
<DIV class="paragraph code-paragraph collapsed" last-execution-state="success" name="Section Browser" run-on-load="true" style data-id="FDSSymJu" __wid="MaU3QVDk"><PRE data-type="content" type="text/javascript" __wid="hMNyALGp">var SectionItem = function (section) {
  section.__sectionItem = this;
  this.section = section;
  // Create a list item for the section
  this.li = document.createElement("li");
  // Per default this is closed
  this.li.classList.add("closed");

  // Create an element indicating if a section is expanded or not
  this.expander = document.createElement("span");
  this.expander.classList.add("expander");
  this.expander.innerHTML = '&lt;i class="material-icons">keyboard_arrow_right&lt;/i>';
  this.li.appendChild(this.expander);

  // Create an element used for showing and toggling visibility
  this.visibility = document.createElement("span");
  this.visibility.classList.add("visibility");
  this.visibility.innerHTML = '&lt;i class="material-icons">&lt;/i>';
  this.li.appendChild(this.visibility);
  if (this.section.classList.contains("section-hidden")) {
    this.li.classList.add("hidden");
    this.visibility.firstChild.innerText = "visibility_off";
  } else {
    this.li.classList.add("visible");
    this.visibility.firstChild.innerText = "visibility";
  }

  // Create an element used for showing if a section is a system section
  this.type = document.createElement("span");
  this.type.classList.add("type");
  this.type.innerHTML = '&lt;i class="material-icons">&lt;/i>';
  this.li.appendChild(this.type);
  if (this.section.getAttribute("data-type")) {
    if (this.section.getAttribute("data-type") === "system") {
      this.li.setAttribute("data-type", "system");
    } else if (this.section.getAttribute("data-type") === "package") {
      this.li.setAttribute("data-type", "package");
    }
  }

  // Create the title of a section
  this.title = document.createElement("span");
  this.title.classList.add("title");
  var sectionName = this.section.getAttribute("name");
  this.title.innerText = sectionName && sectionName.length > 0 ? sectionName : "No Name";
  this.li.appendChild(this.title);

  // Create the list of paragraphs
  this.ul = document.createElement("ul");
  this.li.appendChild(this.ul);

  // Create all the paragraph objects
  this.createParagraphItems();

  // When clicking the list item it toggles open/clised
  this.li.addEventListener("click", (e) => {
    this.li.classList.toggle("closed");
    if (this.li.classList.contains("closed")) {
      this.expander.innerHTML = '&lt;i class="material-icons">keyboard_arrow_right&lt;/i>';
    } else {
      this.expander.innerHTML = '&lt;i class="material-icons">keyboard_arrow_down&lt;/i>';
    }
  });

  // If the visibility icon is clicked, visibility of the section is toggled
  this.visibility.addEventListener("click", (e) => {
    e.stopPropagation();

		// do not use this.section.classList.toggle("section-hidden"), otherwise it may break the style
		// under certain circumstances, e.g., when both classes are set or no class is set then the
		// section will remove or add both at the same time
    if (this.section.classList.contains("section-hidden")) {
      this.section.classList.remove("section-hidden");
      this.section.classList.add("section-visible");
    }
		else {
      this.section.classList.remove("section-visible");
      this.section.classList.add("section-hidden");
    }
  });

  // A mutation observer is used to observe changes to attributes and children
  this.mo = new MutationObserver(() => {
    this.ul.innerHTML = "";
    var sectionName = this.section.getAttribute("name");
    this.title.innerText = sectionName && sectionName.length > 0 ? sectionName : "No Name";
    if (this.section.classList.contains("section-hidden")) {
      this.li.classList.add("hidden");
      this.visibility.firstChild.innerText = "visibility_off";
    } else {
      this.li.classList.remove("hidden");
      this.visibility.firstChild.innerText = "visibility";

      // CodeMirror requires a refresh on the editor if any of the parent or container styles changed.
      var contents = Array.from(this.section.querySelectorAll('.paragraph:not(.collapsed) [data-type="content"]'));

      contents.forEach(content => {
        if (content && content.__editor && content.__editor.editor) {
          content.__editor.editor.refresh();
        }
      });
    }
    if (this.section.getAttribute("data-type")) {
      if (this.section.getAttribute("data-type") === "system") {
        this.li.setAttribute("data-type", "system");
      } else if (this.section.getAttribute("data-type") === "package") {
        this.li.setAttribute("data-type", "package");
      }
    } else {
      this.li.removeAttribute("data-type");
    }
    this.createParagraphItems();
  });

  this.mo.observe(this.section, {
    attributes: true,
    childList: true
  });
};

SectionItem.prototype.createParagraphItems = function () {
  Array.from(this.section.querySelectorAll(".paragraph")).forEach((paragraph) => {
    var paragraphItem = new ParagraphItem(paragraph);
    this.ul.appendChild(paragraphItem.li);
  });
};

var ParagraphItem = function (paragraph) {
  paragraph.__paragraphItem = this;
  this.paragraph = paragraph;

  // Create a list item for the paragraph
  this.li = document.createElement("li");

  // Create an element for showing and toggling collapse
  this.collapse = document.createElement("span");
  this.collapse.innerHTML = '&lt;i class="material-icons">&lt;/i>';
  this.collapse.classList.add("collapse");
  this.li.appendChild(this.collapse);
  if (this.paragraph.classList.contains("collapsed")) {
    this.collapse.firstChild.innerText = "radio_button_unchecked";
  } else {
    this.collapse.firstChild.innerText = "radio_button_checked";
  }

  // Create an element for the title of the paragraph
  this.title = document.createElement("span");
  this.title.classList.add("title");
  this.title.innerText = paragraph.getAttribute("name");
  this.li.appendChild(this.title);

  // Observe changes to the attributes of the paragraph
  this.mo = new MutationObserver(() => {
    this.title.innerText = paragraph.getAttribute("name");
    if (this.paragraph.classList.contains("collapsed")) {
      this.collapse.firstChild.innerText = "radio_button_unchecked";
    } else {
      this.collapse.firstChild.innerText = "radio_button_checked";
    }
  });

  this.mo.observe(this.paragraph, {
    attributes: true
  });

  // If the paragraph is clicked, scroll it into view
  this.li.addEventListener("click", (e) => {
    e.stopPropagation();
    this.paragraph.classList.remove("collapsed");
    this.paragraph.closest(".section").classList.remove("section-hidden");
    this.paragraph.scrollIntoView();
  });

  // If the visibility icon is clicked, visibility of the section is toggled
  this.collapse.addEventListener("click", (e) => {
    e.stopPropagation();
    this.paragraph.classList.toggle("collapsed");
  });
};

/******************************************************************************/

var tree = document.querySelector("#global-menu #section-tree");
tree.innerHTML = "";

var controls = document.createElement("div");
controls.classList.add("section-tree-controls");

var toggleUserSections = document.createElement("span");
toggleUserSections.title = "Toggle User Sections";
toggleUserSections.classList.add("toggle-user-sections");
toggleUserSections.innerHTML = '&lt;i class="material-icons">&lt;/i>';
toggleUserSections.addEventListener("click", () => {
  tree.classList.toggle("hide-user-sections");
});
controls.appendChild(toggleUserSections);

var togglePackageSections = document.createElement("span");
togglePackageSections.title = "Toggle Package Sections";
togglePackageSections.classList.add("toggle-package-sections");
togglePackageSections.innerHTML = '&lt;i class="material-icons">&lt;/i>';
togglePackageSections.addEventListener("click", () => {
  tree.classList.toggle("hide-package-sections");
});
controls.appendChild(togglePackageSections);
tree.classList.toggle("hide-package-sections");

var toggleSystemSections = document.createElement("span");
toggleSystemSections.title = "Toggle System Sections";
toggleSystemSections.classList.add("toggle-system-sections");
toggleSystemSections.innerHTML = '&lt;i class="material-icons">&lt;/i>';
toggleSystemSections.addEventListener("click", () => {
  tree.classList.toggle("hide-system-sections");
});
controls.appendChild(toggleSystemSections);
tree.classList.toggle("hide-system-sections");

tree.appendChild(controls);

/******************************************************************************/

document.liveQuerySelectorAll(".section").added(section => {
  var sectionItem = new SectionItem(section);
  sectionItem.li.setAttribute("section-id", section.getAttribute("data-id"));
  tree.appendChild(sectionItem.li);
});

document.liveQuerySelectorAll(".section").removed(section => {
  var sectionItem = tree.querySelector(`li[section-id="${section.getAttribute("data-id")}"]`);
  if (sectionItem) tree.removeChild(sectionItem);
});</PRE></DIV><DIV class="paragraph style-paragraph collapsed" name="Section Browser Style" draggable="false" data-id="6tj93nGL" __wid="2xJhRdiL"><STYLE data-type="content" type="text/css" codemirror="true" class="themable" __wid="uLimT4Qk">html #section-tree {
	margin: 0px;
	padding-left: 8px;
	padding-right: 16px;
	user-select: none;
	overflow: auto;
	list-style: none;
	order: 980;
	display: flex;
	flex-direction: column;
}

html hr.section-tree {
	order: 980;
}

/******************************************************************************/

html #section-tree li {
	color: var(--color-text-primary);
	vertical-align: middle;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
	cursor: pointer;
	display: flex;
	align-items: center;
	flex-shrink: 0;
}

html #section-tree > li {
	flex-wrap: wrap;
}

html #section-tree .closed ul {
	display: none;
}

html #section-tree li.hidden {
	opacity: 0.5;
}

html #section-tree li .title {
	margin-left: 0.5em;
	vertical-align: middle;
	overflow: hidden;
	text-overflow: ellipsis;
}

html #section-tree > li > .title {
	max-width: 174px;
}

/* Fix for disappearing icons bug */
html #section-tree li i {
	display: flex;
}

html #section-tree li .type {
	margin-left: 5px;
}

html #section-tree li ul {
	width: 100%;
	display: flex;
	flex-direction: column;
	flex-wrap: nowrap;
}

/******************************************************************************/

html #section-tree li .type i:after,
html #section-tree .section-tree-controls .toggle-user-sections i:after {
	content: "person";
}

html #section-tree li[data-type="system"] .type i:after,
html #section-tree .section-tree-controls .toggle-system-sections i:after {
	content: var(--settings);
	font-family: "Material Design Icons";
}

html #section-tree li[data-type="package"] .type i:after,
html #section-tree .section-tree-controls .toggle-package-sections i:after {
	content: var(--cube-outline);
	font-family: "Material Design Icons";
}

/******************************************************************************/

html #section-tree .section-tree-controls {
	display: flex;
	justify-content: space-evenly;
	margin: 4px;
	flex-shrink: 0;
}

html #section-tree .section-tree-controls span {
	cursor: pointer;
}

html #section-tree.hide-user-sections .toggle-user-sections,
html #section-tree.hide-system-sections .toggle-system-sections,
html #section-tree.hide-package-sections .toggle-package-sections {
	opacity: 0.5;
}

html #section-tree.hide-user-sections li.hidden:not([data-type]),
html #section-tree.hide-system-sections li.hidden[data-type="system"],
html #section-tree.hide-package-sections li.hidden[data-type="package"] {
	display: none;
}</STYLE></DIV></DIV></DIV>

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































	</BODY></html>
